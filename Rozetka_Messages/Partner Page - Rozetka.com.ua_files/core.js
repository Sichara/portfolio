var MooTools={version:'1.11'};function $defined(obj){return(obj!=undefined)};function $type(obj){if(!$defined(obj))return false;if(obj.htmlElement)return'element';var type=typeof obj;if(type=='object'&&obj.nodeName){switch(obj.nodeType){case 1:return'element';case 3:return(/\S/).test(obj.nodeValue)?'textnode':'whitespace'}}if(type=='object'||type=='function'){switch(obj.constructor){case Array:return'array';case RegExp:return'regexp';case Class:return'class'}if(typeof obj.length=='number'){if(obj.item)return'collection';if(obj.callee)return'arguments'}}return type};function $merge(){var mix={};for(var i=0;i<arguments.length;i++){for(var property in arguments[i]){var ap=arguments[i][property];var mp=mix[property];if(mp&&$type(ap)=='object'&&$type(mp)=='object')mix[property]=$merge(mp,ap);else mix[property]=ap}}return mix};var $extend=function(){var args=arguments;if(!args[1])args=[this,args[0]];for(var property in args[1]){if(window.opera){try{args[0][property]=args[1][property]}catch(e){console.log()}}else{args[0][property]=args[1][property]}}return args[0]};var $native=function(){for(var i=0,l=arguments.length;i<l;i++){arguments[i].extend=function(props){for(var prop in props){if(!this.prototype[prop])this.prototype[prop]=props[prop];if(!this[prop])this[prop]=$native.generic(prop)}}}};$native.generic=function(prop){return function(bind){return this.prototype[prop].apply(bind,Array.prototype.slice.call(arguments,1))}};$native(Function,Array,String,Number);function $chk(obj){return!!(obj||obj===0)};function $pick(obj,picked){return $defined(obj)?obj:picked};function $random(min,max){return Math.floor(Math.random()*(max-min+1)+min)};function $time(){return new Date().getTime()};function $clear(timer){clearTimeout(timer);clearInterval(timer);return null};var Abstract=function(obj){obj=obj||{};obj.extend=$extend;return obj};var Window=new Abstract(window);var Document=new Abstract(document);document.head=document.getElementsByTagName('head')[0];window.xpath=!!(document.evaluate);if(window.ActiveXObject)window.ie=window[window.XMLHttpRequest?'ie7':'ie6']=true;else if(document.childNodes&&!document.all&&!navigator.taintEnabled)window.webkit=window[window.xpath?'webkit420':'webkit419']=true;else if(document.getBoxObjectFor!=null||window.mozInnerScreenX!=null)window.gecko=true;if(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)){window.FirefoxVersion=new Number(RegExp.$1);window.ff4AndGreater=(window.FirefoxVersion>=4)}window.khtml=window.webkit;Object.extend=$extend;if(typeof HTMLElement=='undefined'){var HTMLElement=function(){};if(window.webkit)document.createElement("iframe");HTMLElement.prototype=(window.webkit)?window["[[DOMElement.prototype]]"]:{}}HTMLElement.prototype.htmlElement=function(){};if(window.ie6)try{document.execCommand("BackgroundImageCache",false,true)}catch(e){};var Class=function(properties){var klass=function(){return(arguments[0]!==null&&this.initialize&&$type(this.initialize)=='function')?this.initialize.apply(this,arguments):this};$extend(klass,this);klass.prototype=properties;klass.constructor=Class;return klass};Class.empty=function(){};Class.prototype={extend:function(properties){var proto=new this(null);for(var property in properties){var pp=proto[property];proto[property]=Class.Merge(pp,properties[property])}return new Class(proto)},implement:function(){for(var i=0,l=arguments.length;i<l;i++)$extend(this.prototype,arguments[i])}};Class.Merge=function(previous,current){if(previous&&previous!=current){var type=$type(current);if(type!=$type(previous))return current;switch(type){case'function':var merged=function(){this.parent=arguments.callee.parent;return current.apply(this,arguments)};merged.parent=previous;return merged;case'object':return $merge(previous,current)}}return current};var Chain=new Class({chain:function(fn){this.chains=this.chains||[];this.chains.push(fn);return this},callChain:function(){if(this.chains&&this.chains.length)this.chains.shift().delay(10,this)},clearChain:function(){this.chains=[]}});var Events=new Class({addEvent:function(type,fn){if(fn!=Class.empty){this.$events=this.$events||{};this.$events[type]=this.$events[type]||[];this.$events[type].include(fn)}return this},fireEvent:function(type,args,delay){if(this.$events&&this.$events[type]){this.$events[type].each(function(fn){fn.create({'bind':this,'delay':delay,'arguments':args})()},this)}return this},removeEvent:function(type,fn){if(this.$events&&this.$events[type])this.$events[type].remove(fn);return this}});var Options=new Class({setOptions:function(){this.options=$merge.apply(null,[this.options].extend(arguments));if(this.addEvent){for(var option in this.options){if($type(this.options[option]=='function')&&(/^on[A-Z]/).test(option))this.addEvent(option,this.options[option])}}return this}});Array.extend({forEach:function(fn,bind){for(var i=0,j=this.length;i<j;i++)fn.call(bind,this[i],i,this)},filter:function(fn,bind){var results=[];for(var i=0,j=this.length;i<j;i++){if(fn.call(bind,this[i],i,this))results.push(this[i])}return results},map:function(fn,bind){var results=[];for(var i=0,j=this.length;i<j;i++)results[i]=fn.call(bind,this[i],i,this);return results},every:function(fn,bind){for(var i=0,j=this.length;i<j;i++){if(!fn.call(bind,this[i],i,this))return false}return true},some:function(fn,bind){for(var i=0,j=this.length;i<j;i++){if(fn.call(bind,this[i],i,this))return true}return false},indexOf:function(item,from){var len=this.length;for(var i=(from<0)?Math.max(0,len+from):from||0;i<len;i++){if(this[i]===item)return i}return-1},copy:function(start,length){start=start||0;if(start<0)start=this.length+start;length=length||(this.length-start);var newArray=[];for(var i=0;i<length;i++)newArray[i]=this[start++];return newArray},remove:function(item){var i=0;var len=this.length;while(i<len){if(this[i]===item){this.splice(i,1);len--}else{i++}}return this},contains:function(item,from){return this.indexOf(item,from)!=-1},associate:function(keys){var obj={},length=Math.min(this.length,keys.length);for(var i=0;i<length;i++)obj[keys[i]]=this[i];return obj},extend:function(array){for(var i=0,j=array.length;i<j;i++)this.push(array[i]);return this},merge:function(array){for(var i=0,l=array.length;i<l;i++)this.include(array[i]);return this},include:function(item){if(!this.contains(item))this.push(item);return this},getRandom:function(){return this[$random(0,this.length-1)]||null},getLast:function(){return this[this.length-1]||null}});Array.prototype.each=Array.prototype.forEach;Array.each=Array.forEach;function $A(array){return Array.copy(array)};function $each(iterable,fn,bind){if(iterable&&typeof iterable.length=='number'&&$type(iterable)!='object'){Array.forEach(iterable,fn,bind)}else{for(var name in iterable)fn.call(bind||iterable,iterable[name],name)}};Array.prototype.test=Array.prototype.contains;String.extend({test:function(regex,params){return(($type(regex)=='string')?new RegExp(regex,params):regex).test(this)},toInt:function(){return parseInt(this,10)},toFloat:function(){return parseFloat(this)},camelCase:function(){return this.replace(/-\D/g,function(match){return match.charAt(1).toUpperCase()})},hyphenate:function(){return this.replace(/\w[A-Z]/g,function(match){return(match.charAt(0)+'-'+match.charAt(1).toLowerCase())})},capitalize:function(){return this.replace(/\b[a-z]/g,function(match){return match.toUpperCase()})},trim:function(){return this.replace(/^\s+|\s+$/g,'')},clean:function(){return this.replace(/\s{2,}/g,' ').trim()},rgbToHex:function(array){var rgb=this.match(/\d{1,3}/g);return(rgb)?rgb.rgbToHex(array):false},hexToRgb:function(array){var hex=this.match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/);return(hex)?hex.slice(1).hexToRgb(array):false},contains:function(string,s){return(s)?(s+this+s).indexOf(s+string+s)>-1:this.indexOf(string)>-1},escapeRegExp:function(){return this.replace(/([.*+?^${}()|[\]\/\\])/g,'\\$1')}});Array.extend({rgbToHex:function(array){if(this.length<3)return false;if(this.length==4&&this[3]==0&&!array)return'transparent';var hex=[];for(var i=0;i<3;i++){var bit=(this[i]-0).toString(16);hex.push((bit.length==1)?'0'+bit:bit)}return array?hex:'#'+hex.join('')},hexToRgb:function(array){if(this.length!=3)return false;var rgb=[];for(var i=0;i<3;i++){rgb.push(parseInt((this[i].length==1)?this[i]+this[i]:this[i],16))}return array?rgb:'rgb('+rgb.join(',')+')'}});Function.extend({create:function(options){var fn=this;options=$merge({'bind':fn,'event':false,'arguments':null,'delay':false,'periodical':false,'attempt':false},options);if($chk(options.arguments)&&$type(options.arguments)!='array')options.arguments=[options.arguments];return function(event){var args;if(options.event){event=event||window.event;args=[(options.event===true)?event:new options.event(event)];if(options.arguments)args.extend(options.arguments)}else args=options.arguments||arguments;var returns=function(){return fn.apply($pick(options.bind,fn),args)};if(options.delay)return setTimeout(returns,options.delay);if(options.periodical)return setInterval(returns,options.periodical);if(options.attempt)try{return returns()}catch(err){return false};return returns()}},pass:function(args,bind){return this.create({'arguments':args,'bind':bind})},attempt:function(args,bind){return this.create({'arguments':args,'bind':bind,'attempt':true})()},bind:function(bind,args){return this.create({'bind':bind,'arguments':args})},bindAsEventListener:function(bind,args){return this.create({'bind':bind,'event':true,'arguments':args})},delay:function(delay,bind,args){return this.create({'delay':delay,'bind':bind,'arguments':args})()},periodical:function(interval,bind,args){return this.create({'periodical':interval,'bind':bind,'arguments':args})()}});Number.extend({toInt:function(){return parseInt(this)},toFloat:function(){return parseFloat(this)},limit:function(min,max){return Math.min(max,Math.max(min,this))},round:function(precision){precision=Math.pow(10,precision||0);return Math.round(this*precision)/precision},times:function(fn){for(var i=0;i<this;i++)fn(i)}});var Element=new Class({initialize:function(el,props){if($type(el)=='string'){if(window.ie&&props&&(props.name||props.type)&&window.ieversion<9){var name=(props.name)?' name="'+props.name+'"':'';var type=(props.type)?' type="'+props.type+'"':'';delete props.name;delete props.type;el='<'+el+name+type+'>'}el=document.createElement(el)}el=$(el);return(!props||!el)?el:el.set(props)}});var Elements=new Class({initialize:function(elements){return(elements)?$extend(elements,this):this}});Elements.extend=function(props){for(var prop in props){this.prototype[prop]=props[prop];this[prop]=$native.generic(prop)}};function $(el){if(!el)return null;if(el.htmlElement)return Garbage.collect(el);if([window,document].contains(el))return el;var type=$type(el);if(type=='string'){el=document.getElementById(el);type=(el)?'element':false}if(type!='element')return null;if(el.htmlElement)return Garbage.collect(el);if(['object','embed'].contains(el.tagName.toLowerCase()))return el;$extend(el,Element.prototype);el.htmlElement=function(){};return Garbage.collect(el)};document.getElementsBySelector=document.getElementsByTagName;function $$(){var elements=[];for(var i=0,j=arguments.length;i<j;i++){var selector=arguments[i];switch($type(selector)){case'element':elements.push(selector);case'boolean':break;case false:break;case'string':selector=document.getElementsBySelector(selector,true);default:elements.extend(selector)}}return $$.unique(elements)};$$.unique=function(array){var elements=[];for(var i=0,l=array.length;i<l;i++){if(array[i].$included)continue;var element=$(array[i]);if(element&&!element.$included){element.$included=true;elements.push(element)}}for(var n=0,d=elements.length;n<d;n++)elements[n].$included=null;return new Elements(elements)};Elements.Multi=function(property){return function(){var args=arguments;var items=[];var elements=true;for(var i=0,j=this.length,returns;i<j;i++){returns=this[i][property].apply(this[i],args);if($type(returns)!='element')elements=false;items.push(returns)};return(elements)?$$.unique(items):items}};Element.extend=function(properties){for(var property in properties){HTMLElement.prototype[property]=properties[property];Element.prototype[property]=properties[property];Element[property]=$native.generic(property);var elementsProperty=(Array.prototype[property])?property+'Elements':property;Elements.prototype[elementsProperty]=Elements.Multi(property)}};Element.extend({set:function(props){for(var prop in props){var val=props[prop];switch(prop){case'styles':this.setStyles(val);break;case'events':if(this.addEvents)this.addEvents(val);break;case'properties':this.setProperties(val);break;default:this.setProperty(prop,val)}}return this},inject:function(el,where){el=$(el);switch(where){case'before':el.parentNode.insertBefore(this,el);break;case'after':var next=el.getNext();if(!next)el.parentNode.appendChild(this);else el.parentNode.insertBefore(this,next);break;case'top':var first=el.firstChild;if(first){el.insertBefore(this,first);break}default:el.appendChild(this)}return this},injectBefore:function(el){return this.inject(el,'before')},injectAfter:function(el){return this.inject(el,'after')},injectInside:function(el){return this.inject(el,'bottom')},injectTop:function(el){return this.inject(el,'top')},adopt:function(){var elements=[];$each(arguments,function(argument){elements=elements.concat(argument)});$$(elements).inject(this);return this},remove:function(){if(this.parentNode){return this.parentNode.removeChild(this)}else if(window.ie){return this.removeNode()}},clone:function(contents){var el=$(this.cloneNode(contents!==false));if(!el.$events)return el;el.$events={};for(var type in this.$events)el.$events[type]={'keys':$A(this.$events[type].keys),'values':$A(this.$events[type].values)};return el.removeEvents()},replaceWith:function(el){el=$(el);this.parentNode.replaceChild(el,this);return el},appendText:function(text){this.appendChild(document.createTextNode(text));return this},hasClass:function(className){return this.className.contains(className,' ')},addClass:function(className){if(!this.hasClass(className))this.className=(this.className+' '+className).clean();return this},removeClass:function(className){this.className=this.className.replace(new RegExp('(^|\\s)'+className+'(?:\\s|$)'),'$1').clean();return this},toggleClass:function(className){return this.hasClass(className)?this.removeClass(className):this.addClass(className)},setStyle:function(property,value){switch(property){case'opacity':return this.setOpacity(parseFloat(value));case'float':property=(window.ie)?'styleFloat':'cssFloat'}property=property.camelCase();switch($type(value)){case'number':if(!['zIndex','zoom'].contains(property))value+='px';break;case'array':value='rgb('+value.join(',')+')'}this.style[property]=value;return this},setStyles:function(source){switch($type(source)){case'object':Element.setMany(this,'setStyle',source);break;case'string':this.style.cssText=source}return this},setOpacity:function(opacity){if(opacity==0){if(this.style.visibility!="hidden")this.style.visibility="hidden"}else{if(this.style.visibility!="visible")this.style.visibility="visible"}if(!this.currentStyle||!this.currentStyle.hasLayout)this.style.zoom=1;if(window.ie)this.style.filter=(opacity==1)?'':"alpha(opacity="+opacity*100+")";this.style.opacity=this.$tmp.opacity=opacity;return this},getStyle:function(property){property=property.camelCase();var result=this.style[property];if(!$chk(result)){if(property=='opacity')return this.$tmp.opacity;result=[];for(var style in Element.Styles){if(property==style){Element.Styles[style].each(function(s){var style=this.getStyle(s);result.push(parseInt(style)?style:'0px')},this);if(property=='border'){var every=result.every(function(bit){return(bit==result[0])});return(every)?result[0]:false}return result.join(' ')}}if(property.contains('border')){if(Element.Styles.border.contains(property)){return['Width','Style','Color'].map(function(p){return this.getStyle(property+p)},this).join(' ')}else if(Element.borderShort.contains(property)){return['Top','Right','Bottom','Left'].map(function(p){return this.getStyle('border'+p+property.replace('border',''))},this).join(' ')}}if(document.defaultView)result=document.defaultView.getComputedStyle(this,null).getPropertyValue(property.hyphenate());else if(this.currentStyle)result=this.currentStyle[property]}if(window.ie)result=Element.fixStyle(property,result,this);if(result&&property.test(/color/i)&&result.contains('rgb')){return result.split('rgb').splice(1,4).map(function(color){return color.rgbToHex()}).join(' ')}return result},getStyles:function(){return Element.getMany(this,'getStyle',arguments)},walk:function(brother,start){brother+='Sibling';var el=(start)?this[start]:this[brother];while(el&&$type(el)!='element')el=el[brother];return $(el)},getPrevious:function(){return this.walk('previous')},getNext:function(){return this.walk('next')},getFirst:function(){return this.walk('next','firstChild')},getLast:function(){return this.walk('previous','lastChild')},getParent:function(){return $(this.parentNode)},getChildren:function(){return $$(this.childNodes)},hasChild:function(el){return!!$A(this.getElementsByTagName('*')).contains(el)},getProperty:function(property){var index=Element.Properties[property];if(index)return this[index];var flag=Element.PropertiesIFlag[property]||0;var msie=navigator.userAgent.toLowerCase().match(/msie\s+(\d)/);if(!window.ie||flag||msie&&msie[1]>=7)return this.getAttribute(property,flag);var node=this.attributes[property];return(node)?node.nodeValue:null},removeProperty:function(property){var index=Element.Properties[property];if(index)this[index]='';else this.removeAttribute(property);return this},getProperties:function(){return Element.getMany(this,'getProperty',arguments)},setProperty:function(property,value){var index=Element.Properties[property];if(index)this[index]=value;else this.setAttribute(property,value);return this},setProperties:function(source){return Element.setMany(this,'setProperty',source)},setHTML:function(){this.innerHTML=$A(arguments).join('');return this},setText:function(text){var tag=this.getTag();if(['style','script'].contains(tag)){if(window.ie){if(tag=='style')this.styleSheet.cssText=text;else if(tag=='script')this.setProperty('text',text);return this}else{this.removeChild(this.firstChild);return this.appendText(text)}}this[$defined(this.innerText)?'innerText':'textContent']=text;return this},getText:function(){var tag=this.getTag();if(['style','script'].contains(tag)){if(window.ie){if(tag=='style')return this.styleSheet.cssText;else if(tag=='script')return this.getProperty('text')}else{return this.innerHTML}}return($pick(this.innerText,this.textContent))},getTag:function(){return this.tagName.toLowerCase()},empty:function(){Garbage.trash(this.getElementsByTagName('*'));return this.setHTML('')}});Element.fixStyle=function(property,result,element){if($chk(parseInt(result)))return result;if(['height','width'].contains(property)){var values=(property=='width')?['left','right']:['top','bottom'];var size=0;values.each(function(value){size+=element.getStyle('border-'+value+'-width').toInt()+element.getStyle('padding-'+value).toInt()});return element['offset'+property.capitalize()]-size+'px'}else if(property.test(/border(.+)Width|margin|padding/)){return'0px'}return result};Element.Styles={'border':[],'padding':[],'margin':[]};['Top','Right','Bottom','Left'].each(function(direction){for(var style in Element.Styles)Element.Styles[style].push(style+direction)});Element.borderShort=['borderWidth','borderStyle','borderColor'];Element.getMany=function(el,method,keys){var result={};$each(keys,function(key){result[key]=el[method](key)});return result};Element.setMany=function(el,method,pairs){for(var key in pairs)el[method](key,pairs[key]);return el};Element.Properties=new Abstract({'class':'className','for':'htmlFor','colspan':'colSpan','rowspan':'rowSpan','accesskey':'accessKey','tabindex':'tabIndex','maxlength':'maxLength','readonly':'readOnly','frameborder':'frameBorder','value':'value','disabled':'disabled','checked':'checked','multiple':'multiple','selected':'selected'});Element.PropertiesIFlag={'href':2,'src':2};Element.Methods={Listeners:{addListener:function(type,fn){if(this.addEventListener)this.addEventListener(type,fn,false);else this.attachEvent('on'+type,fn);return this},removeListener:function(type,fn){if(this.removeEventListener)this.removeEventListener(type,fn,false);else this.detachEvent('on'+type,fn);return this}}};window.extend(Element.Methods.Listeners);document.extend(Element.Methods.Listeners);Element.extend(Element.Methods.Listeners);var Garbage={elements:[],collect:function(el){if(!el.$tmp){Garbage.elements.push(el);el.$tmp={'opacity':1}}return el},trash:function(elements){for(var i=0,j=elements.length,el;i<j;i++){if(!(el=elements[i])||!el.$tmp)continue;if(el.$events)el.fireEvent('trash').removeEvents();for(var p in el.$tmp)el.$tmp[p]=null;for(var d in Element.prototype)el[d]=null;Garbage.elements[Garbage.elements.indexOf(el)]=null;el.htmlElement=el.$tmp=el=null}Garbage.elements.remove(null)},empty:function(){Garbage.collect(window);Garbage.collect(document);Garbage.trash(Garbage.elements)}};window.addListener('beforeunload',function(){window.addListener('unload',Garbage.empty);if(window.ie)window.addListener('unload',CollectGarbage)});var Event=new Class({initialize:function(event){if(event&&event.$extended)return event;this.$extended=true;event=event||window.event;this.event=event;this.type=event.type;this.target=event.target||event.srcElement;if(this.target.nodeType==3)this.target=this.target.parentNode;this.shift=event.shiftKey;this.control=event.ctrlKey;this.alt=event.altKey;this.meta=event.metaKey;if(['DOMMouseScroll','mousewheel'].contains(this.type)){this.wheel=(event.wheelDelta)?event.wheelDelta/120:-(event.detail||0)/3}else if(this.type.contains('key')){this.code=event.which||event.keyCode;for(var name in Event.keys){if(Event.keys[name]==this.code){this.key=name;break}}if(this.type=='keydown'){var fKey=this.code-111;if(fKey>0&&fKey<13)this.key='f'+fKey}this.key=this.key||String.fromCharCode(this.code).toLowerCase()}else if(this.type.test(/(click|mouse|menu)/)){this.page={'x':event.pageX||event.clientX+document.documentElement.scrollLeft,'y':event.pageY||event.clientY+document.documentElement.scrollTop};this.client={'x':event.pageX?event.pageX-window.pageXOffset:event.clientX,'y':event.pageY?event.pageY-window.pageYOffset:event.clientY};this.rightClick=(event.which==3)||(event.button==2);switch(this.type){case'mouseover':this.relatedTarget=event.relatedTarget||event.fromElement;break;case'mouseout':this.relatedTarget=event.relatedTarget||event.toElement}this.fixRelatedTarget()}return this},stop:function(){return this.stopPropagation().preventDefault()},stopPropagation:function(){if(this.event.stopPropagation)this.event.stopPropagation();else this.event.cancelBubble=true;return this},preventDefault:function(){if(this.event.preventDefault)this.event.preventDefault();else this.event.returnValue=false;return this}});Event.fix={relatedTarget:function(){if(this.relatedTarget&&this.relatedTarget.nodeType==3)this.relatedTarget=this.relatedTarget.parentNode},relatedTargetGecko:function(){try{Event.fix.relatedTarget.call(this)}catch(e){this.relatedTarget=this.target}}};Event.prototype.fixRelatedTarget=(window.gecko)?Event.fix.relatedTargetGecko:Event.fix.relatedTarget;Event.keys=new Abstract({'enter':13,'up':38,'down':40,'left':37,'right':39,'esc':27,'space':32,'backspace':8,'tab':9,'delete':46});Element.Methods.Events={addEvent:function(type,fn){this.$events=this.$events||{};this.$events[type]=this.$events[type]||{'keys':[],'values':[]};if(this.$events[type].keys.contains(fn))return this;this.$events[type].keys.push(fn);var realType=type;var custom=Element.Events[type];if(custom){if(custom.add)custom.add.call(this,fn);if(custom.map)fn=custom.map;if(custom.type)realType=custom.type}if(!this.addEventListener)fn=fn.create({'bind':this,'event':true});this.$events[type].values.push(fn);return(Element.NativeEvents.contains(realType))?this.addListener(realType,fn):this},removeEvent:function(type,fn){if(!this.$events||!this.$events[type])return this;var pos=this.$events[type].keys.indexOf(fn);if(pos==-1)return this;var key=this.$events[type].keys.splice(pos,1)[0];var value=this.$events[type].values.splice(pos,1)[0];var custom=Element.Events[type];if(custom){if(custom.remove)custom.remove.call(this,fn);if(custom.type)type=custom.type}return(Element.NativeEvents.contains(type))?this.removeListener(type,value):this},addEvents:function(source){return Element.setMany(this,'addEvent',source)},removeEvents:function(type){if(!this.$events)return this;if(!type){for(var evType in this.$events)this.removeEvents(evType);this.$events=null}else if(this.$events[type]){this.$events[type].keys.each(function(fn){this.removeEvent(type,fn)},this);this.$events[type]=null}return this},fireEvent:function(type,args,delay){if(this.$events&&this.$events[type]){this.$events[type].keys.each(function(fn){fn.create({'bind':this,'delay':delay,'arguments':args})()},this)}return this},cloneEvents:function(from,type){if(!from.$events)return this;if(!type){for(var evType in from.$events)this.cloneEvents(from,evType)}else if(from.$events[type]){from.$events[type].keys.each(function(fn){this.addEvent(type,fn)},this)}return this}};window.extend(Element.Methods.Events);document.extend(Element.Methods.Events);Element.extend(Element.Methods.Events);Element.Events=new Abstract({'mouseenter':{type:'mouseover',map:function(event){event=new Event(event);if(event.relatedTarget!=this&&!this.hasChild(event.relatedTarget))this.fireEvent('mouseenter',event)}},'mouseleave':{type:'mouseout',map:function(event){event=new Event(event);if(event.relatedTarget!=this&&!this.hasChild(event.relatedTarget))this.fireEvent('mouseleave',event)}},'mousewheel':{type:(window.gecko)?'DOMMouseScroll':'mousewheel'}});Element.NativeEvents=['click','dblclick','mouseup','mousedown','mousewheel','DOMMouseScroll','mouseover','mouseout','mousemove','keydown','keypress','keyup','load','unload','beforeunload','resize','move','focus','blur','change','submit','reset','select','error','abort','contextmenu','scroll'];Function.extend({bindWithEvent:function(bind,args){return this.create({'bind':bind,'arguments':args,'event':Event})}});Elements.extend({filterByTag:function(tag){return new Elements(this.filter(function(el){return(Element.getTag(el)==tag)}))},filterByClass:function(className,nocash){var elements=this.filter(function(el){return(el.className&&el.className.contains(className,' '))});return(nocash)?elements:new Elements(elements)},filterById:function(id,nocash){var elements=this.filter(function(el){return(el.id==id)});return(nocash)?elements:new Elements(elements)},filterByAttribute:function(name,operator,value,nocash){var elements=this.filter(function(el){var current=Element.getProperty(el,name);if(typeof(current)!='string')return false;if(!current)return false;if(!operator)return true;switch(operator){case'=':return(current==value);case'*=':return(current.contains(value));case'^=':return(current.substr(0,value.length)==value);case'$=':return(current.substr(current.length-value.length)==value);case'!=':return(current!=value);case'~=':return current.contains(value,' ')}return false});return(nocash)?elements:new Elements(elements)}});function $E(selector,filter){return($(filter)||document).getElement(selector)};function $ES(selector,filter){return($(filter)||document).getElementsBySelector(selector)};$$.shared={'regexp':/^(\w*|\*)(?:#([\w-]+)|\.([\w-]+))?(?:\[(\w+)(?:([!*^$]?=)["']?([^"'\]]*)["']?)?])?$/,'xpath':{getParam:function(items,context,param,i){var temp=[context.namespaceURI?'xhtml:':'',param[1]];if(param[2])temp.push('[@id="',param[2],'"]');if(param[3])temp.push('[contains(concat(" ", @class, " "), " ',param[3],' ")]');if(param[4]){if(param[5]&&param[6]){switch(param[5]){case'*=':temp.push('[contains(@',param[4],', "',param[6],'")]');break;case'^=':temp.push('[starts-with(@',param[4],', "',param[6],'")]');break;case'$=':temp.push('[substring(@',param[4],', string-length(@',param[4],') - ',param[6].length,' + 1) = "',param[6],'"]');break;case'=':temp.push('[@',param[4],'="',param[6],'"]');break;case'!=':temp.push('[@',param[4],'!="',param[6],'"]')}}else{temp.push('[@',param[4],']')}}items.push(temp.join(''));return items},getItems:function(items,context,nocash){var elements=[];var xpath=document.evaluate('.//'+items.join('//'),context,$$.shared.resolver,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);for(var i=0,j=xpath.snapshotLength;i<j;i++)elements.push(xpath.snapshotItem(i));return(nocash)?elements:new Elements(elements.map($))}},'normal':{getParam:function(items,context,param,i){if(i==0){if(param[2]){var el=context.getElementById(param[2]);if(!el||((param[1]!='*')&&(Element.getTag(el)!=param[1])))return false;items=[el]}else{items=$A(context.getElementsByTagName(param[1]))}}else{items=$$.shared.getElementsByTagName(items,param[1]);if(param[2])items=Elements.filterById(items,param[2],true)}if(param[3])items=Elements.filterByClass(items,param[3],true);if(param[4])items=Elements.filterByAttribute(items,param[4],param[5],param[6],true);return items},getItems:function(items,context,nocash){return(nocash)?items:$$.unique(items)}},resolver:function(prefix){return(prefix=='xhtml')?'http://www.w3.org/1999/xhtml':false},getElementsByTagName:function(context,tagName){var found=[];for(var i=0,j=context.length;i<j;i++)found.extend(context[i].getElementsByTagName(tagName));return found}};$$.shared.method=(window.xpath)?'xpath':'normal';Element.Methods.Dom={getElements:function(selector,nocash){var items=[];selector=selector.trim().split(' ');for(var i=0,j=selector.length;i<j;i++){var sel=selector[i];var param=sel.match($$.shared.regexp);if(!param)break;param[1]=param[1]||'*';var temp=$$.shared[$$.shared.method].getParam(items,this,param,i);if(!temp)break;items=temp}return $$.shared[$$.shared.method].getItems(items,this,nocash)},getElement:function(selector){return $(this.getElements(selector,true)[0]||false)},getElementsBySelector:function(selector,nocash){var elements=[];selector=selector.split(',');for(var i=0,j=selector.length;i<j;i++)elements=elements.concat(this.getElements(selector[i],true));return(nocash)?elements:$$.unique(elements)}};Element.extend({getElementById:function(id){var el=document.getElementById(id);if(!el)return false;for(var parent=el.parentNode;parent!=this;parent=parent.parentNode){if(!parent)return false}return el},getElementsByClassName:function(className){return this.getElements('.'+className)}});document.extend(Element.Methods.Dom);Element.extend(Element.Methods.Dom);Element.extend({getValue:function(){switch(this.getTag()){case'select':var values=[];$each(this.options,function(option){if(option.selected)values.push($pick(option.value,option.text))});return(this.multiple)?values:values[0];case'input':if(!(this.checked&&['checkbox','radio'].contains(this.type))&&!['hidden','text','password'].contains(this.type))break;case'textarea':return this.value}return false},getFormElements:function(){return $$(this.getElementsByTagName('input'),this.getElementsByTagName('select'),this.getElementsByTagName('textarea'))},toQueryString:function(){var queryString=[];this.getFormElements().each(function(el){var name=el.name;var value=el.getValue();if(value===false||!name||el.disabled)return;var qs=function(val){queryString.push(name+'='+encodeURIComponent(val))};if($type(value)=='array')value.each(qs);else qs(value)});return queryString.join('&')}});Element.extend({scrollTo:function(x,y){this.scrollLeft=x;this.scrollTop=y},getSize:function(){return{'scroll':{'x':this.scrollLeft,'y':this.scrollTop},'size':{'x':this.offsetWidth,'y':this.offsetHeight},'scrollSize':{'x':this.scrollWidth,'y':this.scrollHeight}}},getPosition:function(overflown){overflown=overflown||[];var el=this,left=0,top=0;do{left+=el.offsetLeft||0;top+=el.offsetTop||0;el=el.offsetParent}while(el);overflown.each(function(element){left-=element.scrollLeft||0;top-=element.scrollTop||0});return{'x':left,'y':top}},getTop:function(overflown){return this.getPosition(overflown).y},getLeft:function(overflown){return this.getPosition(overflown).x},getCoordinates:function(overflown){var position=this.getPosition(overflown);var obj={'width':this.offsetWidth,'height':this.offsetHeight,'left':position.x,'top':position.y};obj.right=obj.left+obj.width;obj.bottom=obj.top+obj.height;return obj}});Element.Events.domready={add:function(fn){if(window.loaded){fn.call(this);return}var domReady=function(){if(window.loaded)return;window.loaded=true;window.timer=$clear(window.timer);this.fireEvent('domready')}.bind(this);if(document.readyState&&window.webkit){window.timer=function(){if(['loaded','complete'].contains(document.readyState))domReady()}.periodical(50)}else if(document.readyState&&window.ie){if(!$('ie_ready')){var src=(window.location.protocol=='https:')?'://0':'javascript:void(0)';document.write('<script id="ie_ready" defer src="'+src+'"><\/script>');$('ie_ready').onreadystatechange=function(){if(this.readyState=='complete')domReady()}}}else{window.addListener("load",domReady);document.addListener("DOMContentLoaded",domReady)}}};window.onDomReady=function(fn){return this.addEvent('domready',fn)};window.extend({getWidth:function(){if(this.webkit419)return this.innerWidth;if(this.opera)return document.body.clientWidth;return document.documentElement.clientWidth},getHeight:function(){if(this.webkit419)return this.innerHeight;if(this.opera)return document.body.clientHeight;return document.documentElement.clientHeight},getScrollWidth:function(){if(this.ie)return Math.max(document.documentElement.offsetWidth,document.documentElement.scrollWidth);if(this.webkit)return document.body.scrollWidth;return document.documentElement.scrollWidth},getScrollHeight:function(){if(this.ie)return Math.max(document.documentElement.offsetHeight,document.documentElement.scrollHeight);if(this.webkit){if(window.ff4AndGreater&&(window.FirefoxVersion>=8))return document.documentElement.scrollHeight;return document.body.scrollHeight}return document.documentElement.scrollHeight},getScrollLeft:function(){return this.pageXOffset||document.documentElement.scrollLeft},getScrollTop:function(){return this.pageYOffset||document.documentElement.scrollTop},getSize:function(){return{'size':{'x':this.getWidth(),'y':this.getHeight()},'scrollSize':{'x':this.getScrollWidth(),'y':this.getScrollHeight()},'scroll':{'x':this.getScrollLeft(),'y':this.getScrollTop()}}},getPosition:function(){return{'x':0,'y':0}}});var Fx={};Fx.Base=new Class({options:{onStart:Class.empty,onComplete:Class.empty,onCancel:Class.empty,transition:function(p){return-(Math.cos(Math.PI*p)-1)/2},duration:500,unit:'px',wait:true,fps:50},initialize:function(options){this.element=this.element||null;this.setOptions(options);if(this.options.initialize)this.options.initialize.call(this)},step:function(){var time=$time();if(time<this.time+this.options.duration){this.delta=this.options.transition((time-this.time)/this.options.duration);this.setNow();this.increase()}else{this.stop(true);this.set(this.to);this.fireEvent('onComplete',this.element,10);this.callChain()}},set:function(to){this.now=to;this.increase();return this},setNow:function(){this.now=this.compute(this.from,this.to)},compute:function(from,to){return(to-from)*this.delta+from},start:function(from,to){if(!this.options.wait)this.stop();else if(this.timer)return this;this.from=from;this.to=to;this.change=this.to-this.from;this.time=$time();this.timer=this.step.periodical(Math.round(1000/this.options.fps),this);this.fireEvent('onStart',this.element);return this},stop:function(end){if(!this.timer)return this;this.timer=$clear(this.timer);if(!end)this.fireEvent('onCancel',this.element);return this},custom:function(from,to){return this.start(from,to)},clearTimer:function(end){return this.stop(end)}});Fx.Base.implement(new Chain,new Events,new Options);Fx.CSS={select:function(property,to){if(property.test(/color/i))return this.Color;var type=$type(to);if((type=='array')||(type=='string'&&to.contains(' ')))return this.Multi;return this.Single},parse:function(el,property,fromTo){if(!fromTo.push)fromTo=[fromTo];var from=fromTo[0],to=fromTo[1];if(!$chk(to)){to=from;from=el.getStyle(property)}var css=this.select(property,to);return{'from':css.parse(from),'to':css.parse(to),'css':css}}};Fx.CSS.Single={parse:function(value){return parseFloat(value)},getNow:function(from,to,fx){return fx.compute(from,to)},getValue:function(value,unit,property){if(unit=='px'&&property!='opacity')value=Math.round(value);return value+unit}};Fx.CSS.Multi={parse:function(value){return value.push?value:value.split(' ').map(function(v){return parseFloat(v)})},getNow:function(from,to,fx){var now=[];for(var i=0;i<from.length;i++)now[i]=fx.compute(from[i],to[i]);return now},getValue:function(value,unit,property){if(unit=='px'&&property!='opacity')value=value.map(Math.round);return value.join(unit+' ')+unit}};Fx.CSS.Color={parse:function(value){return value.push?value:value.hexToRgb(true)},getNow:function(from,to,fx){var now=[];for(var i=0;i<from.length;i++)now[i]=Math.round(fx.compute(from[i],to[i]));return now},getValue:function(value){return'rgb('+value.join(',')+')'}};Fx.Style=Fx.Base.extend({initialize:function(el,property,options){this.element=$(el);this.property=property;this.parent(options)},hide:function(){return this.set(0)},setNow:function(){this.now=this.css.getNow(this.from,this.to,this)},set:function(to){this.css=Fx.CSS.select(this.property,to);return this.parent(this.css.parse(to))},start:function(from,to){if(this.timer&&this.options.wait)return this;var parsed=Fx.CSS.parse(this.element,this.property,[from,to]);this.css=parsed.css;return this.parent(parsed.from,parsed.to)},increase:function(){this.element.setStyle(this.property,this.css.getValue(this.now,this.options.unit,this.property))}});Element.extend({effect:function(property,options){return new Fx.Style(this,property,options)}});Fx.Styles=Fx.Base.extend({initialize:function(el,options){this.element=$(el);this.parent(options)},setNow:function(){for(var p in this.from)this.now[p]=this.css[p].getNow(this.from[p],this.to[p],this)},set:function(to){var parsed={};this.css={};for(var p in to){this.css[p]=Fx.CSS.select(p,to[p]);parsed[p]=this.css[p].parse(to[p])}return this.parent(parsed)},start:function(obj){if(this.timer&&this.options.wait)return this;this.now={};this.css={};var from={},to={};for(var p in obj){var parsed=Fx.CSS.parse(this.element,p,obj[p]);from[p]=parsed.from;to[p]=parsed.to;this.css[p]=parsed.css}return this.parent(from,to)},increase:function(){for(var p in this.now)this.element.setStyle(p,this.css[p].getValue(this.now[p],this.options.unit,p))}});Element.extend({effects:function(options){return new Fx.Styles(this,options)}});Fx.Elements=Fx.Base.extend({initialize:function(elements,options){this.elements=$$(elements);this.parent(options)},setNow:function(){for(var i in this.from){var iFrom=this.from[i],iTo=this.to[i],iCss=this.css[i],iNow=this.now[i]={};for(var p in iFrom)iNow[p]=iCss[p].getNow(iFrom[p],iTo[p],this)}},set:function(to){var parsed={};this.css={};for(var i in to){var iTo=to[i],iCss=this.css[i]={},iParsed=parsed[i]={};for(var p in iTo){iCss[p]=Fx.CSS.select(p,iTo[p]);iParsed[p]=iCss[p].parse(iTo[p])}}return this.parent(parsed)},start:function(obj){if(this.timer&&this.options.wait)return this;this.now={};this.css={};var from={},to={};for(var i in obj){var iProps=obj[i],iFrom=from[i]={},iTo=to[i]={},iCss=this.css[i]={};for(var p in iProps){var parsed=Fx.CSS.parse(this.elements[i],p,iProps[p]);iFrom[p]=parsed.from;iTo[p]=parsed.to;iCss[p]=parsed.css}}return this.parent(from,to)},increase:function(){for(var i in this.now){var iNow=this.now[i],iCss=this.css[i];for(var p in iNow)this.elements[i].setStyle(p,iCss[p].getValue(iNow[p],this.options.unit,p))}}});Fx.Scroll=Fx.Base.extend({options:{overflown:[],offset:{'x':0,'y':0},wheelStops:true},initialize:function(element,options){this.now=[];this.element=$(element);this.bound={'stop':this.stop.bind(this,false)};this.parent(options);if(this.options.wheelStops){this.addEvent('onStart',function(){document.addEvent('mousewheel',this.bound.stop)}.bind(this));this.addEvent('onComplete',function(){document.removeEvent('mousewheel',this.bound.stop)}.bind(this))}},setNow:function(){for(var i=0;i<2;i++)this.now[i]=this.compute(this.from[i],this.to[i])},scrollTo:function(x,y){if(this.timer&&this.options.wait)return this;var el=this.element.getSize();var values={'x':x,'y':y};for(var z in el.size){var max=el.scrollSize[z]-el.size[z];if($chk(values[z]))values[z]=($type(values[z])=='number')?values[z].limit(0,max):max;else values[z]=el.scroll[z];values[z]+=this.options.offset[z]}return this.start([el.scroll.x,el.scroll.y],[values.x,values.y])},toTop:function(){return this.scrollTo(false,0)},toBottom:function(){return this.scrollTo(false,'full')},toLeft:function(){return this.scrollTo(0,false)},toRight:function(){return this.scrollTo('full',false)},toElement:function(el){var parent=this.element.getPosition(this.options.overflown);var target=$(el).getPosition(this.options.overflown);return this.scrollTo(target.x-parent.x,target.y-parent.y)},increase:function(){this.element.scrollTo(this.now[0],this.now[1])}});Fx.Slide=Fx.Base.extend({options:{mode:'vertical'},initialize:function(el,options){this.element=$(el);this.wrapper=new Element('div',{'styles':$extend(this.element.getStyles('margin'),{'overflow':'hidden'})}).injectAfter(this.element).adopt(this.element);this.element.setStyle('margin',0);this.setOptions(options);this.now=[];this.parent(this.options);this.open=true;this.addEvent('onComplete',function(){this.open=(this.now[0]===0)});if(window.webkit419)this.addEvent('onComplete',function(){if(this.open)this.element.remove().inject(this.wrapper)})},setNow:function(){for(var i=0;i<2;i++)this.now[i]=this.compute(this.from[i],this.to[i])},vertical:function(){this.margin='margin-top';this.layout='height';this.offset=this.element.offsetHeight},horizontal:function(){this.margin='margin-left';this.layout='width';this.offset=this.element.offsetWidth},slideIn:function(mode){this[mode||this.options.mode]();return this.start([this.element.getStyle(this.margin).toInt(),this.wrapper.getStyle(this.layout).toInt()],[0,this.offset])},slideOut:function(mode){this[mode||this.options.mode]();return this.start([this.element.getStyle(this.margin).toInt(),this.wrapper.getStyle(this.layout).toInt()],[-this.offset,0])},hide:function(mode){this[mode||this.options.mode]();this.open=false;return this.set([-this.offset,0])},show:function(mode){this[mode||this.options.mode]();this.open=true;return this.set([0,this.offset])},toggle:function(mode){if(this.wrapper.offsetHeight==0||this.wrapper.offsetWidth==0)return this.slideIn(mode);return this.slideOut(mode)},increase:function(){this.element.setStyle(this.margin,this.now[0]+this.options.unit);this.wrapper.setStyle(this.layout,this.now[1]+this.options.unit)}});Fx.Transition=function(transition,params){params=params||[];if($type(params)!='array')params=[params];return $extend(transition,{easeIn:function(pos){return transition(pos,params)},easeOut:function(pos){return 1-transition(1-pos,params)},easeInOut:function(pos){return(pos<=0.5)?transition(2*pos,params)/2:(2-transition(2*(1-pos),params))/2}})};Fx.Transitions=new Abstract({linear:function(p){return p}});Fx.Transitions.extend=function(transitions){for(var transition in transitions){Fx.Transitions[transition]=new Fx.Transition(transitions[transition]);Fx.Transitions.compat(transition)}};Fx.Transitions.compat=function(transition){['In','Out','InOut'].each(function(easeType){Fx.Transitions[transition.toLowerCase()+easeType]=Fx.Transitions[transition]['ease'+easeType]})};Fx.Transitions.extend({Pow:function(p,x){return Math.pow(p,x[0]||6)},Expo:function(p){return Math.pow(2,8*(p-1))},Circ:function(p){return 1-Math.sin(Math.acos(p))},Sine:function(p){return 1-Math.sin((1-p)*Math.PI/2)},Back:function(p,x){x=x[0]||1.618;return Math.pow(p,2)*((x+1)*p-x)},Bounce:function(p){var value;for(var a=0,b=1;1;a+=b,b/=2){if(p>=(7-4*a)/11){value=-Math.pow((11-6*a-11*p)/4,2)+b*b;break}}return value},Elastic:function(p,x){return Math.pow(2,10*--p)*Math.cos(20*p*Math.PI*(x[0]||1)/3)}});['Quad','Cubic','Quart','Quint'].each(function(transition,i){Fx.Transitions[transition]=new Fx.Transition(function(p){return Math.pow(p,[i+2])});Fx.Transitions.compat(transition)});var Drag={};Drag.Base=new Class({options:{handle:false,unit:'px',onStart:Class.empty,onBeforeStart:Class.empty,onComplete:Class.empty,onSnap:Class.empty,onDrag:Class.empty,limit:false,modifiers:{x:'left',y:'top'},grid:false,snap:6},initialize:function(el,options){this.setOptions(options);this.element=$(el);this.handle=$(this.options.handle)||this.element;this.mouse={'now':{},'pos':{}};this.value={'start':{},'now':{}};this.bound={'start':this.start.bindWithEvent(this),'check':this.check.bindWithEvent(this),'drag':this.drag.bindWithEvent(this),'stop':this.stop.bind(this)};this.attach();if(this.options.initialize)this.options.initialize.call(this)},attach:function(){this.handle.addEvent('mousedown',this.bound.start);return this},detach:function(){this.handle.removeEvent('mousedown',this.bound.start);return this},start:function(event){this.fireEvent('onBeforeStart',this.element);this.mouse.start=event.page;var limit=this.options.limit;this.limit={'x':[],'y':[]};for(var z in this.options.modifiers){if(!this.options.modifiers[z])continue;this.value.now[z]=this.element.getStyle(this.options.modifiers[z]).toInt();this.mouse.pos[z]=event.page[z]-this.value.now[z];if(limit&&limit[z]){for(var i=0;i<2;i++){if($chk(limit[z][i]))this.limit[z][i]=($type(limit[z][i])=='function')?limit[z][i]():limit[z][i]}}}if($type(this.options.grid)=='number')this.options.grid={'x':this.options.grid,'y':this.options.grid};document.addListener('mousemove',this.bound.check);document.addListener('mouseup',this.bound.stop);this.fireEvent('onStart',this.element);event.stop()},check:function(event){var distance=Math.round(Math.sqrt(Math.pow(event.page.x-this.mouse.start.x,2)+Math.pow(event.page.y-this.mouse.start.y,2)));if(distance>this.options.snap){document.removeListener('mousemove',this.bound.check);document.addListener('mousemove',this.bound.drag);this.drag(event);this.fireEvent('onSnap',this.element)}event.stop()},drag:function(event){this.out=false;this.mouse.now=event.page;for(var z in this.options.modifiers){if(!this.options.modifiers[z])continue;this.value.now[z]=this.mouse.now[z]-this.mouse.pos[z];if(this.limit[z]){if($chk(this.limit[z][1])&&(this.value.now[z]>this.limit[z][1])){this.value.now[z]=this.limit[z][1];this.out=true}else if($chk(this.limit[z][0])&&(this.value.now[z]<this.limit[z][0])){this.value.now[z]=this.limit[z][0];this.out=true}}if(this.options.grid[z])this.value.now[z]-=(this.value.now[z]%this.options.grid[z]);this.element.setStyle(this.options.modifiers[z],this.value.now[z]+this.options.unit)}this.fireEvent('onDrag',this.element);event.stop()},stop:function(){document.removeListener('mousemove',this.bound.check);document.removeListener('mousemove',this.bound.drag);document.removeListener('mouseup',this.bound.stop);this.fireEvent('onComplete',this.element)}});Drag.Base.implement(new Events,new Options);Element.extend({makeResizable:function(options){return new Drag.Base(this,$merge({modifiers:{x:'width',y:'height'}},options))}});Drag.Move=Drag.Base.extend({options:{droppables:[],container:false,overflown:[]},initialize:function(el,options){this.setOptions(options);this.element=$(el);this.droppables=$$(this.options.droppables);this.container=$(this.options.container);this.position={'element':this.element.getStyle('position'),'container':false};if(this.container)this.position.container=this.container.getStyle('position');if(!['relative','absolute','fixed'].contains(this.position.element))this.position.element='absolute';var top=this.element.getStyle('top').toInt();var left=this.element.getStyle('left').toInt();if(this.position.element=='absolute'&&!['relative','absolute','fixed'].contains(this.position.container)){top=$chk(top)?top:this.element.getTop(this.options.overflown);left=$chk(left)?left:this.element.getLeft(this.options.overflown)}else{top=$chk(top)?top:0;left=$chk(left)?left:0}this.element.setStyles({'top':top,'left':left,'position':this.position.element});this.parent(this.element)},start:function(event){this.overed=null;if(this.container){var cont=this.container.getCoordinates();var el=this.element.getCoordinates();if(this.position.element=='absolute'&&!['relative','absolute','fixed'].contains(this.position.container)){this.options.limit={'x':[cont.left,cont.right-el.width],'y':[cont.top,cont.bottom-el.height]}}else{this.options.limit={'y':[0,cont.height-el.height],'x':[0,cont.width-el.width]}}}this.parent(event)},drag:function(event){this.parent(event);var overed=this.out?false:this.droppables.filter(this.checkAgainst,this).getLast();if(this.overed!=overed){if(this.overed)this.overed.fireEvent('leave',[this.element,this]);this.overed=overed?overed.fireEvent('over',[this.element,this]):null}return this},checkAgainst:function(el){el=el.getCoordinates(this.options.overflown);var now=this.mouse.now;return(now.x>el.left&&now.x<el.right&&now.y<el.bottom&&now.y>el.top)},stop:function(){if(this.overed&&!this.out)this.overed.fireEvent('drop',[this.element,this]);else this.element.fireEvent('emptydrop',this);this.parent();return this}});Element.extend({makeDraggable:function(options){return new Drag.Move(this,options)}});var XHR=new Class({options:{method:'post',async:true,onRequest:Class.empty,onSuccess:Class.empty,onFailure:Class.empty,urlEncoded:true,encoding:'utf-8',autoCancel:false,headers:{}},setTransport:function(){this.transport=(window.XMLHttpRequest)?new XMLHttpRequest():(window.ie?new ActiveXObject('Microsoft.XMLHTTP'):false);return this},initialize:function(options){this.setTransport().setOptions(options);this.options.isSuccess=this.options.isSuccess||this.isSuccess;this.headers={};if(this.options.urlEncoded&&this.options.method=='post'){var encoding=(this.options.encoding)?'; charset='+this.options.encoding:'';this.setHeader('Content-type','application/x-www-form-urlencoded'+encoding)}if(this.options.initialize)this.options.initialize.call(this)},onStateChange:function(){if(this.transport.readyState!=4||!this.running)return;this.running=false;var status=0;try{status=this.transport.status}catch(e){};if(this.options.isSuccess.call(this,status))this.onSuccess();else this.onFailure();this.transport.onreadystatechange=Class.empty},isSuccess:function(status){return((status>=200)&&(status<300))},onSuccess:function(){this.response={'text':this.transport.responseText,'xml':this.transport.responseXML};this.fireEvent('onSuccess',[this.response.text,this.response.xml]);this.callChain()},onFailure:function(){this.fireEvent('onFailure',this.transport)},setHeader:function(name,value){this.headers[name]=value;return this},send:function(url,data){if(this.options.autoCancel)this.cancel();else if(this.running)return this;this.running=true;if(data&&this.options.method=='get'){url=url+(url.contains('?')?'&':'?')+data;data=null}this.transport.open(this.options.method.toUpperCase(),url,this.options.async);this.transport.onreadystatechange=this.onStateChange.bind(this);if((this.options.method=='post')&&this.transport.overrideMimeType){};$extend(this.headers,this.options.headers);for(var type in this.headers)try{this.transport.setRequestHeader(type,this.headers[type])}catch(e){};this.fireEvent('onRequest');this.transport.send($pick(data,null));return this},cancel:function(){if(!this.running)return this;this.running=false;this.transport.abort();this.transport.onreadystatechange=Class.empty;this.setTransport();this.fireEvent('onCancel');return this}});XHR.implement(new Chain,new Events,new Options);var Ajax=XHR.extend({options:{data:null,update:null,onComplete:Class.empty,evalScripts:false,evalResponse:false,token_cookie_name:'uid',token_field_name:'request_token',protect_always:'1'},initialize:function(url,options){this.addEvent('onSuccess',this.onComplete);this.setOptions(options);this.options.data=this.options.data||this.options.postBody;if(!['post','get'].contains(this.options.method)){this._method='_method='+this.options.method;this.options.method='post'}this.parent();this.setHeader('X-Requested-With','XMLHttpRequest');this.setHeader('Accept','text/javascript, text/html, application/xml, text/xml, */*');this.url=url},onComplete:function(){if(this.options.update)$(this.options.update).empty().setHTML(this.response.text);if(this.options.evalScripts||this.options.evalResponse)this.evalScripts();this.fireEvent('onComplete',[this.response.text,this.response.xml],20)},request:function(data){data=data||this.options.data;if(this.options.protect_always==='1'&&this.options.method==='post'){if(!$defined(data))data={};data[this.options.token_field_name]=Cookie.get(this.options.token_cookie_name)}switch($type(data)){case'element':data=$(data).toQueryString();break;case'object':data=Object.toQueryString(data)}if(this._method)data=(data)?[this._method,data].join('&'):this._method;return this.send(this.url,data)},evalScripts:function(){var script,scripts;if(this.options.evalResponse||(/(ecma|java)script/).test(this.getHeader('Content-type')))scripts=this.response.text;else{scripts=[];var regexp=/<script[^>]*>([\s\S]*?)<\/script>/gi;while((script=regexp.exec(this.response.text)))scripts.push(script[1]);scripts=scripts.join('\n')}if(scripts)(window.execScript)?window.execScript(scripts):window.setTimeout(scripts,0)},getHeader:function(name){try{return this.transport.getResponseHeader(name)}catch(e){};return null}});Object.toQueryString=function(source){var queryString=[];for(var property in source)queryString.push(encodeURIComponent(property)+'='+encodeURIComponent(source[property]));return queryString.join('&')};Element.extend({send:function(options){return new Ajax(this.getProperty('action'),$merge({data:this.toQueryString()},options,{method:'post'})).request()}});var Cookie=new Abstract({options:{domain:false,path:false,duration:false,secure:false},set:function(key,value,options){options=$merge(this.options,options);value=encodeURIComponent(value);if(options.domain)value+='; domain='+options.domain;if(options.path)value+='; path='+options.path;if(options.duration){var date=new Date();date.setTime(date.getTime()+options.duration*24*60*60*1000);value+='; expires='+date.toGMTString()}if(options.secure)value+='; secure';document.cookie=key+'='+value;return $extend(options,{'key':key,'value':value})},get:function(key){var value=document.cookie.match('(?:^|;)\\s*'+key.escapeRegExp()+'=([^;]*)');return value?decodeURIComponent(value[1]):false},remove:function(cookie,options){if($type(cookie)=='object')this.set(cookie.key,'',$merge(cookie,{duration:-1}));else this.set(cookie,'',$merge(options,{duration:-1}))}});var Json={toString:function(obj){switch($type(obj)){case'string':return'"'+obj.replace(/(["\\])/g,'\\$1')+'"';case'array':return'['+obj.map(Json.toString).join(',')+']';case'object':var string=[];for(var property in obj)string.push(Json.toString(property)+':'+Json.toString(obj[property]));return'{'+string.join(',')+'}';case'number':if(isFinite(obj))break;case false:return'null'}return String(obj)},evaluate:function(str,secure){return(($type(str)!='string')||(secure&&!str.test(/^("(\\.|[^"\\\n\r])*?"|[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t])+?$/)))?null:eval('('+str+')')}};Json.Remote=XHR.extend({initialize:function(url,options){this.url=url;this.addEvent('onSuccess',this.onComplete);this.parent(options);this.setHeader('X-Request','JSON')},send:function(obj){return this.parent(this.url,'json='+Json.toString(obj))},onComplete:function(){this.fireEvent('onComplete',[Json.evaluate(this.response.text,this.options.secure)])}});var Asset=new Abstract({javascript:function(source,properties){properties=$merge({'onload':Class.empty},properties);var script=new Element('script',{'src':source}).addEvents({'load':properties.onload,'readystatechange':function(){if(this.readyState=='complete')this.fireEvent('load')}});delete properties.onload;return script.setProperties(properties).inject(document.head)},css:function(source,properties){return new Element('link',$merge({'rel':'stylesheet','media':'screen','type':'text/css','href':source},properties)).inject(document.head)},image:function(source,properties){properties=$merge({'onload':Class.empty,'onabort':Class.empty,'onerror':Class.empty},properties);var image=new Image();image.src=source;var element=new Element('img',{'src':source});['load','abort','error'].each(function(type){var event=properties['on'+type];delete properties['on'+type];element.addEvent(type,function(){this.removeEvent(type,arguments.callee);event.call(this)})});if(image.width&&image.height)element.fireEvent('load',element,1);return element.setProperties(properties)},images:function(sources,options){options=$merge({onComplete:Class.empty,onProgress:Class.empty},options);if(!sources.push)sources=[sources];var images=[];var counter=0;sources.each(function(source){var img=new Asset.image(source,{'onload':function(){options.onProgress.call(this,counter);counter++;if(counter==sources.length)options.onComplete()}});images.push(img)});return new Elements(images)}});var Hash=new Class({length:0,initialize:function(object){this.obj=object||{};this.setLength()},get:function(key){return(this.hasKey(key))?this.obj[key]:null},hasKey:function(key){return(key in this.obj)},set:function(key,value){if(!this.hasKey(key))this.length++;this.obj[key]=value;return this},setLength:function(){this.length=0;for(var p in this.obj)this.length++;return this},remove:function(key){if(this.hasKey(key)){delete this.obj[key];this.length--}return this},each:function(fn,bind){$each(this.obj,fn,bind)},extend:function(obj){$extend(this.obj,obj);return this.setLength()},merge:function(){this.obj=$merge.apply(null,[this.obj].extend(arguments));return this.setLength()},empty:function(){this.obj={};this.length=0;return this},keys:function(){var keys=[];for(var property in this.obj)keys.push(property);return keys},values:function(){var values=[];for(var property in this.obj)values.push(this.obj[property]);return values}});function $H(obj){return new Hash(obj)};Hash.Cookie=Hash.extend({initialize:function(name,options){this.name=name;this.options=$extend({'autoSave':true},options||{});this.load()},save:function(){if(this.length==0){Cookie.remove(this.name,this.options);return true}var str=Json.toString(this.obj);if(str.length>4096)return false;Cookie.set(this.name,str,this.options);return true},load:function(){this.obj=Json.evaluate(Cookie.get(this.name),true)||{};this.setLength()}});Hash.Cookie.Methods={};['extend','set','merge','empty','remove'].each(function(method){Hash.Cookie.Methods[method]=function(){Hash.prototype[method].apply(this,arguments);if(this.options.autoSave)this.save();return this}});Hash.Cookie.implement(Hash.Cookie.Methods);var Color=new Class({initialize:function(color,type){type=type||(color.push?'rgb':'hex');var rgb,hsb;switch(type){case'rgb':rgb=color;hsb=rgb.rgbToHsb();break;case'hsb':rgb=color.hsbToRgb();hsb=color;break;default:rgb=color.hexToRgb(true);hsb=rgb.rgbToHsb()}rgb.hsb=hsb;rgb.hex=rgb.rgbToHex();return $extend(rgb,Color.prototype)},mix:function(){var colors=$A(arguments);var alpha=($type(colors[colors.length-1])=='number')?colors.pop():50;var rgb=this.copy();colors.each(function(color){color=new Color(color);for(var i=0;i<3;i++)rgb[i]=Math.round((rgb[i]/ 100 * (100 - alpha)) + (color[i] /100*alpha))});return new Color(rgb,'rgb')},invert:function(){return new Color(this.map(function(value){return 255-value}))},setHue:function(value){return new Color([value,this.hsb[1],this.hsb[2]],'hsb')},setSaturation:function(percent){return new Color([this.hsb[0],percent,this.hsb[2]],'hsb')},setBrightness:function(percent){return new Color([this.hsb[0],this.hsb[1],percent],'hsb')}});function $RGB(r,g,b){return new Color([r,g,b],'rgb')};function $HSB(h,s,b){return new Color([h,s,b],'hsb')};Array.extend({rgbToHsb:function(){var red=this[0],green=this[1],blue=this[2];var hue,saturation,brightness;var max=Math.max(red,green,blue),min=Math.min(red,green,blue);var delta=max-min;brightness=max/255;saturation=(max!=0)?delta/max:0;if(saturation==0){hue=0}else{var rr=(max-red)/delta;var gr=(max-green)/delta;var br=(max-blue)/delta;if(red==max)hue=br-gr;else if(green==max)hue=2+rr-br;else hue=4+gr-rr;hue/=6;if(hue<0)hue++}return[Math.round(hue*360),Math.round(saturation*100),Math.round(brightness*100)]},hsbToRgb:function(){var br=Math.round(this[2]/100*255);if(this[1]==0){return[br,br,br]}else{var hue=this[0]%360;var f=hue%60;var p=Math.round((this[2]*(100-this[1]))/10000*255);var q=Math.round((this[2]*(6000-this[1]*f))/600000*255);var t=Math.round((this[2]*(6000-this[1]*(60-f)))/600000*255);switch(Math.floor(hue/60)){case 0:return[br,t,p];case 1:return[q,br,p];case 2:return[p,br,t];case 3:return[p,q,br];case 4:return[t,p,br];case 5:return[br,p,q]}}return false}});var Scroller=new Class({options:{area:20,velocity:1,onChange:function(x,y){this.element.scrollTo(x,y)}},initialize:function(element,options){this.setOptions(options);this.element=$(element);this.mousemover=([window,document].contains(element))?$(document.body):this.element},start:function(){this.coord=this.getCoords.bindWithEvent(this);this.mousemover.addListener('mousemove',this.coord)},stop:function(){this.mousemover.removeListener('mousemove',this.coord);this.timer=$clear(this.timer)},getCoords:function(event){this.page=(this.element==window)?event.client:event.page;if(!this.timer)this.timer=this.scroll.periodical(50,this)},scroll:function(){var el=this.element.getSize();var pos=this.element.getPosition();var change={'x':0,'y':0};for(var z in this.page){if(this.page[z]<(this.options.area+pos[z])&&el.scroll[z]!=0)change[z]=(this.page[z]-this.options.area-pos[z])*this.options.velocity;else if(this.page[z]+this.options.area>(el.size[z]+pos[z])&&el.scroll[z]+el.size[z]!=el.scrollSize[z])change[z]=(this.page[z]-el.size[z]+this.options.area-pos[z])*this.options.velocity}if(change.y||change.x)this.fireEvent('onChange',[el.scroll.x+change.x,el.scroll.y+change.y])}});Scroller.implement(new Events,new Options);var Slider=new Class({options:{onChange:Class.empty,onComplete:Class.empty,onTick:function(pos){this.knob.setStyle(this.p,pos)},mode:'horizontal',steps:100,offset:0},initialize:function(el,knob,options){this.element=$(el);this.knob=$(knob);this.setOptions(options);this.previousChange=-1;this.previousEnd=-1;this.step=-1;this.element.addEvent('mousedown',this.clickedElement.bindWithEvent(this));var mod,offset;switch(this.options.mode){case'horizontal':this.z='x';this.p='left';mod={'x':'left','y':false};offset='offsetWidth';break;case'vertical':this.z='y';this.p='top';mod={'x':false,'y':'top'};offset='offsetHeight'}this.max=this.element[offset]-this.knob[offset]+(this.options.offset*2);this.half=this.knob[offset]/2;this.getPos=this.element['get'+this.p.capitalize()].bind(this.element);this.knob.setStyle('position','relative').setStyle(this.p,-this.options.offset);var lim={};lim[this.z]=[-this.options.offset,this.max-this.options.offset];this.drag=new Drag.Base(this.knob,{limit:lim,modifiers:mod,snap:0,onStart:function(){this.draggedKnob()}.bind(this),onDrag:function(){this.draggedKnob()}.bind(this),onComplete:function(){this.draggedKnob();this.end()}.bind(this)});if(this.options.initialize)this.options.initialize.call(this)},set:function(step){this.step=step.limit(0,this.options.steps);this.checkStep();this.end();this.fireEvent('onTick',this.toPosition(this.step));return this},clickedElement:function(event){var position=event.page[this.z]-this.getPos()-this.half;position=position.limit(-this.options.offset,this.max-this.options.offset);this.step=this.toStep(position);this.checkStep();this.end();this.fireEvent('onTick',position)},draggedKnob:function(){this.step=this.toStep(this.drag.value.now[this.z]);this.checkStep()},checkStep:function(){if(this.previousChange!=this.step){this.previousChange=this.step;this.fireEvent('onChange',this.step)}},end:function(){if(this.previousEnd!==this.step){this.previousEnd=this.step;this.fireEvent('onComplete',this.step+'')}},toStep:function(position){return Math.round((position+this.options.offset)/this.max*this.options.steps)},toPosition:function(step){return this.max*step/this.options.steps}});Slider.implement(new Events);Slider.implement(new Options);var SmoothScroll=Fx.Scroll.extend({initialize:function(options){this.parent(window,options);this.links=(this.options.links)?$$(this.options.links):$$(document.links);var location=window.location.href.match(/^[^#]*/)[0]+'#';this.links.each(function(link){if(link.href.indexOf(location)!=0)return;var anchor=link.href.substr(location.length);if(anchor&&$(anchor))this.useLink(link,anchor)},this);if(!window.webkit419)this.addEvent('onComplete',function(){window.location.hash=this.anchor})},useLink:function(link,anchor){link.addEvent('click',function(event){this.anchor=anchor;this.toElement(anchor);event.stop()}.bindWithEvent(this))}});var Sortables=new Class({options:{handles:false,onStart:Class.empty,onComplete:Class.empty,ghost:true,snap:3,onDragStart:function(element,ghost){ghost.setStyle('opacity',0.7);element.setStyle('opacity',0.7)},onDragComplete:function(element,ghost){element.setStyle('opacity',1);ghost.remove();this.trash.remove()}},initialize:function(list,options){this.setOptions(options);this.list=$(list);this.elements=this.list.getChildren();this.handles=(this.options.handles)?$$(this.options.handles):this.elements;this.bound={'start':[],'moveGhost':this.moveGhost.bindWithEvent(this)};for(var i=0,l=this.handles.length;i<l;i++){this.bound.start[i]=this.start.bindWithEvent(this,this.elements[i])}this.attach();if(this.options.initialize)this.options.initialize.call(this);this.bound.move=this.move.bindWithEvent(this);this.bound.end=this.end.bind(this)},attach:function(){this.handles.each(function(handle,i){handle.addEvent('mousedown',this.bound.start[i])},this)},detach:function(){this.handles.each(function(handle,i){handle.removeEvent('mousedown',this.bound.start[i])},this)},start:function(event,el){this.active=el;this.coordinates=this.list.getCoordinates();if(this.options.ghost){var position=el.getPosition();this.offset=event.page.y-position.y;this.trash=new Element('div').inject(document.body);this.ghost=el.clone().inject(this.trash).setStyles({'position':'absolute','left':position.x,'top':event.page.y-this.offset});document.addListener('mousemove',this.bound.moveGhost);this.fireEvent('onDragStart',[el,this.ghost])}document.addListener('mousemove',this.bound.move);document.addListener('mouseup',this.bound.end);this.fireEvent('onStart',el);event.stop()},moveGhost:function(event){var value=event.page.y-this.offset;value=value.limit(this.coordinates.top,this.coordinates.bottom-this.ghost.offsetHeight);this.ghost.setStyle('top',value);event.stop()},move:function(event){var now=event.page.y;this.previous=this.previous||now;var up=((this.previous-now)>0);var prev=this.active.getPrevious();var next=this.active.getNext();if(prev&&up&&now<prev.getCoordinates().bottom)this.active.injectBefore(prev);if(next&&!up&&now>next.getCoordinates().top)this.active.injectAfter(next);this.previous=now},serialize:function(converter){return this.list.getChildren().map(converter||function(el){return this.elements.indexOf(el)},this)},end:function(){this.previous=null;document.removeListener('mousemove',this.bound.move);document.removeListener('mouseup',this.bound.end);if(this.options.ghost){document.removeListener('mousemove',this.bound.moveGhost);this.fireEvent('onDragComplete',[this.active,this.ghost])}this.fireEvent('onComplete',this.active)}});Sortables.implement(new Events,new Options);var Tips=new Class({options:{onShow:function(tip){tip.setStyle('visibility','visible')},onHide:function(tip){tip.setStyle('visibility','hidden')},maxTitleChars:30,showDelay:100,hideDelay:100,className:'tool',offsets:{'x':16,'y':16},fixed:false},initialize:function(elements,options){this.setOptions(options);this.toolTip=new Element('div',{'class':this.options.className+'-tip','styles':{'position':'absolute','top':'0','left':'0','visibility':'hidden'}}).inject(document.body);this.wrapper=new Element('div').inject(this.toolTip);$$(elements).each(this.build,this);if(this.options.initialize)this.options.initialize.call(this)},build:function(el){el.$tmp.myTitle=(el.href&&el.getTag()=='a')?el.href.replace('http://',''):(el.rel||false);if(el.title){var dual=el.title.split('::');if(dual.length>1){el.$tmp.myTitle=dual[0].trim();el.$tmp.myText=dual[1].trim()}else{el.$tmp.myText=el.title}el.removeAttribute('title')}else{el.$tmp.myText=false}if(el.$tmp.myTitle&&el.$tmp.myTitle.length>this.options.maxTitleChars)el.$tmp.myTitle=el.$tmp.myTitle.substr(0,this.options.maxTitleChars-1)+"&hellip;";el.addEvent('mouseenter',function(event){this.start(el);if(!this.options.fixed)this.locate(event);else this.position(el)}.bind(this));if(!this.options.fixed)el.addEvent('mousemove',this.locate.bindWithEvent(this));var end=this.end.bind(this);el.addEvent('mouseleave',end);el.addEvent('trash',end)},start:function(el){this.wrapper.empty();if(el.$tmp.myTitle){this.title=new Element('span').inject(new Element('div',{'class':this.options.className+'-title'}).inject(this.wrapper)).setHTML(el.$tmp.myTitle)}if(el.$tmp.myText){this.text=new Element('span').inject(new Element('div',{'class':this.options.className+'-text'}).inject(this.wrapper)).setHTML(el.$tmp.myText)}$clear(this.timer);this.timer=this.show.delay(this.options.showDelay,this)},end:function(event){$clear(this.timer);this.timer=this.hide.delay(this.options.hideDelay,this)},position:function(element){var pos=element.getPosition();this.toolTip.setStyles({'left':pos.x+this.options.offsets.x,'top':pos.y+this.options.offsets.y})},locate:function(event){var win={'x':window.getWidth(),'y':window.getHeight()};var scroll={'x':window.getScrollLeft(),'y':window.getScrollTop()};var tip={'x':this.toolTip.offsetWidth,'y':this.toolTip.offsetHeight};var prop={'x':'left','y':'top'};for(var z in prop){var pos=event.page[z]+this.options.offsets[z];if((pos+tip[z]-scroll[z])>win[z])pos=event.page[z]-this.options.offsets[z]-tip[z];this.toolTip.setStyle(prop[z],pos)}},show:function(){if(this.options.timeout)this.timer=this.hide.delay(this.options.timeout,this);this.fireEvent('onShow',[this.toolTip])},hide:function(){this.fireEvent('onHide',[this.toolTip])}});Tips.implement(new Events,new Options);var Group=new Class({initialize:function(){this.instances=$A(arguments);this.events={};this.checker={}},addEvent:function(type,fn){this.checker[type]=this.checker[type]||{};this.events[type]=this.events[type]||[];if(this.events[type].contains(fn))return false;else this.events[type].push(fn);this.instances.each(function(instance,i){instance.addEvent(type,this.check.bind(this,[type,instance,i]))},this);return this},check:function(type,instance,i){this.checker[type][i]=true;var every=this.instances.every(function(current,j){return this.checker[type][j]||false},this);if(!every)return;this.checker[type]={};this.events[type].each(function(event){event.call(this,this.instances,instance)},this)}});var Accordion=Fx.Elements.extend({options:{onActive:Class.empty,onBackground:Class.empty,display:0,show:false,height:true,width:false,opacity:true,fixedHeight:false,fixedWidth:false,wait:false,alwaysHide:false},initialize:function(){var options,togglers,elements,container;$each(arguments,function(argument,i){switch($type(argument)){case'object':options=argument;break;case'element':container=$(argument);break;default:var temp=$$(argument);if(!togglers)togglers=temp;else elements=temp}});this.togglers=togglers||[];this.elements=elements||[];this.container=$(container);this.setOptions(options);this.previous=-1;if(this.options.alwaysHide)this.options.wait=true;if($chk(this.options.show)){this.options.display=false;this.previous=this.options.show}if(this.options.start){this.options.display=false;this.options.show=false}this.effects={};if(this.options.opacity)this.effects.opacity='fullOpacity';if(this.options.width)this.effects.width=this.options.fixedWidth?'fullWidth':'offsetWidth';if(this.options.height)this.effects.height=this.options.fixedHeight?'fullHeight':'scrollHeight';for(var i=0,l=this.togglers.length;i<l;i++)this.addSection(this.togglers[i],this.elements[i]);this.elements.each(function(el,i){if(this.options.show===i){this.fireEvent('onActive',[this.togglers[i],el])}else{for(var fx in this.effects)el.setStyle(fx,0)}},this);this.parent(this.elements);if($chk(this.options.display))this.display(this.options.display)},addSection:function(toggler,element,pos){toggler=$(toggler);element=$(element);var test=this.togglers.contains(toggler);var len=this.togglers.length;this.togglers.include(toggler);this.elements.include(element);if(len&&(!test||pos)){pos=$pick(pos,len-1);toggler.injectBefore(this.togglers[pos]);element.injectAfter(toggler)}else if(this.container&&!test){toggler.inject(this.container);element.inject(this.container)}var idx=this.togglers.indexOf(toggler);toggler.addEvent('click',this.display.bind(this,idx));if(this.options.height)element.setStyles({'padding-top':0,'border-top':'none','padding-bottom':0,'border-bottom':'none'});if(this.options.width)element.setStyles({'padding-left':0,'border-left':'none','padding-right':0,'border-right':'none'});element.fullOpacity=1;if(this.options.fixedWidth)element.fullWidth=this.options.fixedWidth;if(this.options.fixedHeight)element.fullHeight=this.options.fixedHeight;element.setStyle('overflow','hidden');if(!test){for(var fx in this.effects)element.setStyle(fx,0)}return this},display:function(index){index=($type(index)=='element')?this.elements.indexOf(index):index;if((this.timer&&this.options.wait)||(index===this.previous&&!this.options.alwaysHide))return this;this.previous=index;var obj={};this.elements.each(function(el,i){obj[i]={};var hide=(i!=index)||(this.options.alwaysHide&&(el.offsetHeight>0));this.fireEvent(hide?'onBackground':'onActive',[this.togglers[i],el]);for(var fx in this.effects)obj[i][fx]=hide?0:el[this.effects[fx]]},this);return this.start(obj)},showThisHideOpen:function(index){return this.display(index)}});Fx.Accordion=Accordion;if(window.opera){try{document.domain="rozetka.com.ua"}catch(e){console.log(e)}}else{document.domain="rozetka.com.ua"}$$.shared.regexp=/^(\w*|\*)(?:#([\w-]+)|\.([\w-]+))?(?:\[([\w-]+)(?:([!*^$]?=)["']?([^"']*)["']?)?])?$/;function $defined_list(obj,list){if($defined(obj)){if(list&&list.length){return $defined_list(obj[list[0]],list.slice(1,list.length))};return true}else{return false}};function formatDataProperty(prop){return prop.replace('data-','').camelCase()};var UID=1;$uid=(window.ActiveXObject)?function(item){return(item.uid||(item.uid=[UID++]))[0]}:function(item){return item.uid||(item.uid=UID++)};$uid(window);$uid(document);var storage={};var getProp=function(uid){return(storage[uid]||(storage[uid]={}))};window.extend({getWidth:function(){if(this.webkit419)return this.innerWidth;return document.documentElement.clientWidth},getHeight:function(){if(this.webkit419)return this.innerHeight;return document.documentElement.clientHeight}});Array.extend({getRandomFrom:function(num){var arr=$A(this);var result=[];for(var i=0;i<num&&arr.length;i++)result.include(arr.splice($random(0,arr.length-1),1)[0]);return result},clone:function(){var i=this.length,clone=[i];while(i--){clone[i]=cloneOf(this[i])}return clone},min:function(){return Math.min.apply(null,this)},max:function(){return Math.max.apply(null,this)}});var addEventOnce_fn=function(type,fn){var events=this,apply=fn.apply;fn.apply=function(thisArg,argArray){events.removeEvent(type,fn);fn.apply=apply;return fn.apply(thisArg,argArray)};this.addEvent(type,fn);return this};Events.implement({addEventOnce:addEventOnce_fn});Element.extend({addEventOnce:addEventOnce_fn,getParentByName:function(name,limit){limit=limit||5;var parent=this;for(var i=0;i<limit;i++){if(parent.getTag()!=='html'){parent=parent.getParent();if(parent&&parent.getAttribute('name')==name){break}}}return(i==limit)?null:parent},getParentByClass:function(name,limit){limit=limit||5;var parent=this;for(var i=0;i<limit;i++){if(parent.getTag()!=='html'){parent=parent.getParent();if(parent&&parent.hasClass(name)){break}}}return parent},getVisibleParent:function(limit){limit=limit||5;var parent=this;for(var i=0;i<limit;i++){if(!parent.isVisible()){parent=parent.getParent();if(parent&&parent.isVisible()){break}}}return parent},isValid:function(){var is_hint=function(){return this.getProperty('hint')?this.isValueEqualHint():false}.bind(this),value=this.value,is_pattern_valid=function(){if(this.getProperty('trim')){value=value.trim()}return this.getProperty('pattern')?value.test(new RegExp(this.getProperty('pattern'),'gi')):this.getProperty('_pattern')?value.test(new RegExp(this.getProperty('_pattern'),'gi')):true}.bind(this);return!this.getProperty('name')||this.blocked||this.disabled||!this.isVisible()||((this.getProperty('_required')||this.getProperty('required'))?this.value.trim()!=''&&is_pattern_valid()&&!is_hint():(this.value.trim()==''||is_pattern_valid())||is_hint())},notValid:function(){return this.getFormElements().filter(function(el){return!el.isValid()})},highlightReset:function(){return this.setStyles({'background-color':''})},highlightFieldsReset:function(){this.getFormElements().each(function(el){if(['text','textarea','password','select-one','select-multiple'].contains(el.type))el.highlightReset()});return this},highlightError:function(){var fx=new Fx.Styles(this,{duration:400});fx.start({'background-color':['#ffffff','#ffa6a6']}).chain(function(){fx.start({'background-color':'#ffd6d6'})});return this},checkFields:function(){this.highlightFieldsReset();var elems=this.notValid(),index,highlightResetEvents=['keyup','change'],onchange=function(){if(!!this.value.trim()){this.highlightReset()}};if(elems.length){this.fireEvent('onFieldsCheckFailed',[elems]);elems[0].focus();elems.each(function(el){el.highlightError();for(index=0;index<highlightResetEvents.length;index++){el.removeEvent(highlightResetEvents[index],onchange);el.addEvent(highlightResetEvents[index],onchange)}});return false}return true},toQueryString:function(){var queryString=[];this.getFormElements().each(function(el){var name=el.name;var value=el.getValue();if(value===false||!name||el.disabled||el.blocked)return;var qs=function(val){queryString.push(name+'='+encodeURIComponent(val))};if($type(value)=='array')value.each(qs);else qs(value)});return queryString.join('&')},trySend:function(options){this.fireEvent('onBeforeSend');if(this.checkFields()){this.coverUpHints();this.tryUrchinTracker('_utry');if(!options)options={};this.processStart($defined(options.process)?options.process:'<img src="https://i.rozetka.com.ua/design/ajax.gif" alt="AJAX process"/>');if(!this.action)this.setProperty('action','/cgi-bin/form.php');if(!options.headers){options.headers={ajaxAction:this.getAjaxAction()}}else if(!options.headers.ajaxAction){options.headers.ajaxAction=this.getAjaxAction()}var start_time=new Date().getTime();if(!options.onComplete)options.onComplete=function(){this.processStop();this.showUpHints();var Response=new Response_class(arguments[0]);if(Response.isDone()){this.fireEvent('onResponseDone',[Response]);this.tryUrchinTracker('_udone')}else if(Response.isError()){if(!arguments[0]){var label="  "}else if(typeof arguments[0]!="object"){try{var resp=eval('('+arguments[0]+')');if(!$defined(resp.code))throw'err'}catch(e){var resp={message:{content:arguments[0],code:parseInt('5')}}}var label=!$defined(resp.message)?arguments[0]:resp.message.code+':'+(new Element('span')).setHTML(resp.message.content).getText()}else{var label=arguments[0].status+' '+arguments[0].statusText}this.fireEvent('onResponseError',[Response,label]);App.trackEvent('Errors','Send form',label,(new Date().getTime()-start_time));this.fireEvent('onResponseError')}Response.doAction();if($defined(Response.Message))App.showMessage(Response.Message);this.fireEvent('onAfterComplete',[Response])}.bind(this);if(!options.onFailure)options.onFailure=options.onComplete;this.send(options);return true}else{return false}},getAjaxAction:function(){if(this.action){var get=App.parseGET(App.parseURL(this.action).search);return!$defined(get.r)?'':get.r+(get.action?"#"+get.action:'')}else{return location.href}},getStyleRec:function(style){var value=this.getStyle(style);if((value==''||value=='transparent')&&this.getParent()){return this.getParent().getTag()!=='html'?$(this.getParent()).getStyleRec(style):'#FFF'}return value},processStart:function(tpl,top_position){this.processStop();var h=this.offsetHeight;this.process=new Element('div').setStyles({height:h,width:this.offsetWidth,'text-align':'center',position:'relative','z-index':100,'margin-bottom':-h});new Element('div').setStyles({width:'100%',height:'100%','background-color':this.getStyleRec('background-color'),opacity:'0.6'}).injectInside(this.process);var proc=new Element('div').setHTML(App.getHTML(tpl,{})).setStyles({margin:'0 auto','text-align':'center',position:'relative'}).injectInside(this.process.injectTop(this));!top_position&&proc.setStyle('margin-top',-((h+proc.offsetHeight)/2).toInt());top_position&&proc.setStyle('top','-100%')&&proc.setStyle('margin-top',(top_position-(proc.offsetHeight)/2))},processStop:function(){if($type(this.process)=='element'){this.process.remove();this.process=null}},tryUrchinTracker:function(property){var value=this.getProperty(property);if(value)App.tryUrchinTracker(value)},hintStyles:{'font-style':'italic','color':'#CCC'},showHints:function(){this.getElements('form').each(function(form){form.hintFields=form.getElements('input[hint]').merge(form.getElements('textarea[hint]'));form.hintFields.each(function(el){el.isValueEqualHint=function(){return this.value.replace(/[\n\r]/g,'')==this.getProperty('hint').replace(/[\n\r]/g,'')};el.onfocus=el.hideHint=function(){if(this.isValueEqualHint()){this.value='';this.setStyles({'font-style':'','color':''})}};el.onblur=el.showHint=function(){if(this.value==''||this.isValueEqualHint()){this.setStyles(this.hintStyles);(function(){this.value=this.getProperty('hint')}).delay(10,this)}};if(!document.activeElement||document.activeElement!=el)el.showHint()})})},coverUpHints:function(){if($defined(this.hintFields))this.hintFields.each(function(el){el.hideHint()})},showUpHints:function(){if($defined(this.hintFields))this.hintFields.each(function(el){el.showHint()})},showDefault:function(){this.getElements('input[default]').each(function(el){if(el.value==''){var value=el.getProperty('default');if(value.substr(0,11)=='javascript:'){el.value=eval(value.substr(11))}else{el.value=value}}})},checkForms:function(){this.getElements('form').each(function(form){form.addEvent('submit',function(e){if(this.getProperty('name')==='submit-by-ajax'){new Event(e).stop();this.trySend()}else if(!this.checkFields()){new Event(e).stop()}else{this.coverUpHints()}}.bind(form))})},setFocus:function(){$A(this).every(function(el){el=$(el);if(el.value==''&&el.getProperty('ban_autofocus')!="1"){el.focus();return 0}else return 1})},selectRange:function(start,end){if(this.setSelectionRange){this.focus();this.setSelectionRange(start,end)}else{var value=this.getProperty('value');var diff=value.substr(start,end-start).replace(/\r/g,'').length;start=value.substr(0,start).replace(/\r/g,'').length;var range=this.createTextRange();range.collapse(true);range.moveEnd('character',start+diff);range.moveStart('character',start);range.select()}return this},setCursorPos:function(pos){return this.selectRange(pos,pos)},isDisplayed:function(){return this.getStyle('display')!='none'},isVisible:function(){var w=this.offsetWidth,h=this.offsetHeight;return(w==0&&h==0)?false:(w>0&&h>0)?true:this.style.display!='none'},toggle:function(){return this[this.isDisplayed()?'hide':'show']()},hide:function(){var d;try{d=this.getStyle('display')}catch(e){}if(d=='none')return this;return this.setStyle('display','none')},show:function(display){if(!display&&this.isDisplayed())return this;display=display||'block';return this.setStyle('display',(display=='none')?'block':display)},retrieve:function(property,dflt){var storage=getProp($uid(this)),prop=storage[property];if(dflt!=null&&prop==null)prop=storage[property]=dflt;return prop!=null?prop:null},store:function(property,value){var storage=getProp($uid(this));storage[property]=value;return this},data:function(property,force){var data=this.retrieve('dataCollection'),ii=0,len,hasData=false,attribs;if(!data||force===true){data={};attribs=this.attributes||[];for(len=attribs.length;ii<len;++ii){if(attribs[ii].name.indexOf('data-')===0){data[formatDataProperty(attribs[ii].name)]=attribs[ii].value;hasData=true}}if(!hasData)data=null;this.store('dataCollection',data)}return property?data[formatDataProperty(property)]||null:data},getPosition:function(overflown){var position;overflown=overflown||[];if(this.getBoundingClientRect){var bound=this.getBoundingClientRect(),body=document.body,docElem=document.documentElement,scroll={x:window.pageXOffset||docElem.scrollLeft||body.scrollLeft,y:window.pageYOffset||docElem.scrollTop||body.scrollTop},client={x:docElem.clientLeft||body.clientLeft||0,y:docElem.clientTop||body.clientTop||0};position={x:bound.left.toInt()+scroll.x-client.x,y:bound.top.toInt()+scroll.y-client.y}}else{var el=this,left=0,top=0;do{left+=el.offsetLeft||0;top+=el.offsetTop||0;el=el.offsetParent}while(el);position={'x':left,'y':top}}overflown.each(function(element){position.x-=element.scrollLeft||0;position.y-=element.scrollTop||0});return position}});String.extend({trim:function(chars){return ltrim(rtrim(chars))},ltrim:function(chars){chars=chars||"\\s";return this.replace(new RegExp("^["+chars+"]+","g"),"")},rtrim:function(chars){chars=chars||"\\s";return this.replace(new RegExp("["+chars+"]+$","g"),"")},url_encode:function(string){return escape(this._utf8_encode(this))},url_decode:function(){return this._utf8_decode(unescape(this))},_utf8_encode:function(string){string=string.replace(/\r\n/g,"\n");var utftext="";for(var n=0;n<string.length;n++){var c=string.charCodeAt(n);if(c<128){utftext+=String.fromCharCode(c)}else if((c>127)&&(c<2048)){utftext+=String.fromCharCode((c>>6)|192);utftext+=String.fromCharCode((c&63)|128)}else{utftext+=String.fromCharCode((c>>12)|224);utftext+=String.fromCharCode(((c>>6)&63)|128);utftext+=String.fromCharCode((c&63)|128)}}return utftext},_utf8_decode:function(utftext){var string="";var i=0;var c=c1=c2=0;while(i<utftext.length){c=utftext.charCodeAt(i);if(c<128){string+=String.fromCharCode(c);i++}else if((c>191)&&(c<224)){c2=utftext.charCodeAt(i+1);string+=String.fromCharCode(((c&31)<<6)|(c2&63));i+=2}else{c2=utftext.charCodeAt(i+1);c3=utftext.charCodeAt(i+2);string+=String.fromCharCode(((c&15)<<12)|((c2&63)<<6)|(c3&63));i+=3}}return string}});Element.Events.hashchange={add:function(){var hash=self.location.hash;var hashchange=function(){if(hash==self.location.hash)return;else hash=self.location.hash;var value=(hash.indexOf('#')==0?hash.substr(1):hash);window.fireEvent('hashchange',value);document.fireEvent('hashchange',value)};if("onhashchange"in window){window.onhashchange=hashchange}else{hashchange.periodical(50)}}};function crc32(str){var crc=0;var table="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D";var x=0;var y=0;crc=crc^(-1);for(var i=0,iTop=str.length;i<iTop;i++){y=(crc^str.charCodeAt(i))&0xFF;x="0x"+table.substr(y*9,8);crc=(crc>>>8)^x}return crc^(-1)}function md5cycle(x,k){var a=x[0],b=x[1],c=x[2],d=x[3];a=ff(a,b,c,d,k[0],7,-680876936);d=ff(d,a,b,c,k[1],12,-389564586);c=ff(c,d,a,b,k[2],17,606105819);b=ff(b,c,d,a,k[3],22,-1044525330);a=ff(a,b,c,d,k[4],7,-176418897);d=ff(d,a,b,c,k[5],12,1200080426);c=ff(c,d,a,b,k[6],17,-1473231341);b=ff(b,c,d,a,k[7],22,-45705983);a=ff(a,b,c,d,k[8],7,1770035416);d=ff(d,a,b,c,k[9],12,-1958414417);c=ff(c,d,a,b,k[10],17,-42063);b=ff(b,c,d,a,k[11],22,-1990404162);a=ff(a,b,c,d,k[12],7,1804603682);d=ff(d,a,b,c,k[13],12,-40341101);c=ff(c,d,a,b,k[14],17,-1502002290);b=ff(b,c,d,a,k[15],22,1236535329);a=gg(a,b,c,d,k[1],5,-165796510);d=gg(d,a,b,c,k[6],9,-1069501632);c=gg(c,d,a,b,k[11],14,643717713);b=gg(b,c,d,a,k[0],20,-373897302);a=gg(a,b,c,d,k[5],5,-701558691);d=gg(d,a,b,c,k[10],9,38016083);c=gg(c,d,a,b,k[15],14,-660478335);b=gg(b,c,d,a,k[4],20,-405537848);a=gg(a,b,c,d,k[9],5,568446438);d=gg(d,a,b,c,k[14],9,-1019803690);c=gg(c,d,a,b,k[3],14,-187363961);b=gg(b,c,d,a,k[8],20,1163531501);a=gg(a,b,c,d,k[13],5,-1444681467);d=gg(d,a,b,c,k[2],9,-51403784);c=gg(c,d,a,b,k[7],14,1735328473);b=gg(b,c,d,a,k[12],20,-1926607734);a=hh(a,b,c,d,k[5],4,-378558);d=hh(d,a,b,c,k[8],11,-2022574463);c=hh(c,d,a,b,k[11],16,1839030562);b=hh(b,c,d,a,k[14],23,-35309556);a=hh(a,b,c,d,k[1],4,-1530992060);d=hh(d,a,b,c,k[4],11,1272893353);c=hh(c,d,a,b,k[7],16,-155497632);b=hh(b,c,d,a,k[10],23,-1094730640);a=hh(a,b,c,d,k[13],4,681279174);d=hh(d,a,b,c,k[0],11,-358537222);c=hh(c,d,a,b,k[3],16,-722521979);b=hh(b,c,d,a,k[6],23,76029189);a=hh(a,b,c,d,k[9],4,-640364487);d=hh(d,a,b,c,k[12],11,-421815835);c=hh(c,d,a,b,k[15],16,530742520);b=hh(b,c,d,a,k[2],23,-995338651);a=ii(a,b,c,d,k[0],6,-198630844);d=ii(d,a,b,c,k[7],10,1126891415);c=ii(c,d,a,b,k[14],15,-1416354905);b=ii(b,c,d,a,k[5],21,-57434055);a=ii(a,b,c,d,k[12],6,1700485571);d=ii(d,a,b,c,k[3],10,-1894986606);c=ii(c,d,a,b,k[10],15,-1051523);b=ii(b,c,d,a,k[1],21,-2054922799);a=ii(a,b,c,d,k[8],6,1873313359);d=ii(d,a,b,c,k[15],10,-30611744);c=ii(c,d,a,b,k[6],15,-1560198380);b=ii(b,c,d,a,k[13],21,1309151649);a=ii(a,b,c,d,k[4],6,-145523070);d=ii(d,a,b,c,k[11],10,-1120210379);c=ii(c,d,a,b,k[2],15,718787259);b=ii(b,c,d,a,k[9],21,-343485551);x[0]=add32(a,x[0]);x[1]=add32(b,x[1]);x[2]=add32(c,x[2]);x[3]=add32(d,x[3])}function cmn(q,a,b,x,s,t){a=add32(add32(a,q),add32(x,t));return add32((a<<s)|(a>>>(32-s)),b)}function ff(a,b,c,d,x,s,t){return cmn((b&c)|((~b)&d),a,b,x,s,t)}function gg(a,b,c,d,x,s,t){return cmn((b&d)|(c&(~d)),a,b,x,s,t)}function hh(a,b,c,d,x,s,t){return cmn(b^c^d,a,b,x,s,t)}function ii(a,b,c,d,x,s,t){return cmn(c^(b|(~d)),a,b,x,s,t)}function md51(s){txt='';var n=s.length,state=[1732584193,-271733879,-1732584194,271733878],i;for(i=64;i<=s.length;i+=64){md5cycle(state,md5blk(s.substring(i-64,i)))}s=s.substring(i-64);var tail=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(i=0;i<s.length;i++)tail[i>>2]|=s.charCodeAt(i)<<((i%4)<<3);tail[i>>2]|=0x80<<((i%4)<<3);if(i>55){md5cycle(state,tail);for(i=0;i<16;i++)tail[i]=0}tail[14]=n*8;md5cycle(state,tail);return state}function md5blk(s){var md5blks=[],i;for(i=0;i<64;i+=4){md5blks[i>>2]=s.charCodeAt(i)+(s.charCodeAt(i+1)<<8)+(s.charCodeAt(i+2)<<16)+(s.charCodeAt(i+3)<<24)}return md5blks}var hex_chr='0123456789abcdef'.split('');function rhex(n){var s='',j=0;for(;j<4;j++)s+=hex_chr[(n>>(j*8+4))&0x0F]+hex_chr[(n>>(j*8))&0x0F];return s}function hex(x){for(var i=0;i<x.length;i++)x[i]=rhex(x[i]);return x.join('')}function md5(s){return hex(md51(s))}function add32(a,b){return(a+b)&0xFFFFFFFF}if(md5('hello')!='5d41402abc4b2a76b9719d911017c592'){function add32(x,y){var lsw=(x&0xFFFF)+(y&0xFFFF),msw=(x>>16)+(y>>16)+(lsw>>16);return(msw<<16)|(lsw&0xFFFF)}}var mergeOne=function(source,key,current){switch($type(current)){case'object':if($type(source[key])=='object')Object.merge(source[key],current);else source[key]=Object.clone(current);break;case'array':source[key]=current.clone();break;default:source[key]=current}return source};var cloneOf=function(item){switch($type(item)){case'array':return item.clone();case'object':return Object.clone(item);default:return item}};Object.extend({merge:function(source,k,v){if($type(k)=='string')return mergeOne(source,k,v);for(var i=1,l=arguments.length;i<l;i++){var object=arguments[i];for(var key in object)mergeOne(source,key,object[key])}return source},clone:function(object){var clone={};for(var key in object)clone[key]=cloneOf(object[key]);return clone},append:function(original){for(var i=1,l=arguments.length;i<l;i++){var extended=arguments[i]||{};for(var key in extended)original[key]=extended[key]}return original}});(function(){var hasOwnProperty=Object.prototype.hasOwnProperty;Object.extend({forEach:function(object,fn,bind){for(var key in object){if(hasOwnProperty.call(object,key))fn.call(bind,object[key],key,object)}},subset:function(object,keys){var results={};for(var i=0,l=keys.length;i<l;i++){var k=keys[i];if(k in object)results[k]=object[k]}return results},map:function(object,fn,bind){var results={};for(var key in object){if(hasOwnProperty.call(object,key))results[key]=fn.call(bind,object[key],key,object)}return results},filter:function(object,fn,bind){var results={};for(var key in object){var value=object[key];if(hasOwnProperty.call(object,key)&&fn.call(bind,value,key,object))results[key]=value}return results},every:function(object,fn,bind){for(var key in object){if(hasOwnProperty.call(object,key)&&!fn.call(bind,object[key],key))return false}return true},some:function(object,fn,bind){for(var key in object){if(hasOwnProperty.call(object,key)&&fn.call(bind,object[key],key))return true}return false},keys:function(object){var keys=[];for(var key in object){if(hasOwnProperty.call(object,key))keys.push(key)}return keys},values:function(object){var values=[];for(var key in object){if(hasOwnProperty.call(object,key))values.push(object[key])}return values},getLength:function(object){return Object.keys(object).length},keyOf:function(object,value){for(var key in object){if(hasOwnProperty.call(object,key)&&object[key]===value)return key}return null},contains:function(object,value){return Object.keyOf(object,value)!=null},toQueryString:function(object,base){var queryString=[];Object.each(object,function(value,key){if(base)key=base+'['+key+']';var result;switch(typeof value){case'object':result=Object.toQueryString(value,key);break;case'array':var qs={};value.each(function(val,i){qs[i]=val});result=Object.toQueryString(qs,key);break;default:result=key+'='+encodeURIComponent(value)}if(value!=null)queryString.push(result)});return queryString.join('&')}});Object.each=Object.forEach})();Element.NativeEvents.push('touchstart','touchend');Garbage.collect=function(el){return el};Element.extend({setOpacity:function(opacity){if(opacity==0){if(this.style.visibility!="hidden")this.style.visibility="hidden"}else{if(this.style.visibility!="visible")this.style.visibility="visible"}if(!this.currentStyle||!this.currentStyle.hasLayout)this.style.zoom=1;if(window.ie)this.style.filter=(opacity==1)?'':"alpha(opacity="+opacity*100+")";this.style.opacity=opacity;return this},getStyle:function(property){property=property.camelCase();var result=this.style[property];if(!$chk(result)){result=[];for(var style in Element.Styles){if(property==style){Element.Styles[style].each(function(s){var style=this.getStyle(s);result.push(parseInt(style)?style:'0px')},this);if(property=='border'){var every=result.every(function(bit){return(bit==result[0])});return(every)?result[0]:false}return result.join(' ')}}if(property.contains('border')){if(Element.Styles.border.contains(property)){return['Width','Style','Color'].map(function(p){return this.getStyle(property+p)},this).join(' ')}else if(Element.borderShort.contains(property)){return['Top','Right','Bottom','Left'].map(function(p){return this.getStyle('border'+p+property.replace('border',''))},this).join(' ')}}if(document.defaultView)result=document.defaultView.getComputedStyle(this,null).getPropertyValue(property.hyphenate());else if(this.currentStyle)result=this.currentStyle[property]}if(window.ie)result=Element.fixStyle(property,result,this);if(result&&property.test(/color/i)&&result.contains('rgb')){return result.split('rgb').splice(1,4).map(function(color){return color.rgbToHex()}).join(' ')}return result}});var TrimPath;(function(){if(TrimPath==null)TrimPath=new Object();if(TrimPath.evalEx==null)TrimPath.evalEx=function(src){return eval(src)};var UNDEFINED;if(Array.prototype.pop==null)Array.prototype.pop=function(){if(this.length===0){return UNDEFINED}return this[--this.length]};if(Array.prototype.push==null)Array.prototype.push=function(){for(var i=0;i<arguments.length;++i){this[this.length]=arguments[i]}return this.length};TrimPath.parseTemplate=function(tmplContent,optTmplName,optEtc){if(optEtc==null)optEtc=TrimPath.parseTemplate_etc;var funcSrc=parse(tmplContent,optTmplName,optEtc);var func=TrimPath.evalEx(funcSrc,optTmplName,1);if(func!=null)return new optEtc.Template(optTmplName,tmplContent,funcSrc,func,optEtc);return null};try{String.prototype.process=function(context,optFlags){var template=TrimPath.parseTemplate(this,null);if(template!=null)return template.process(context,optFlags);return this}}catch(e){};TrimPath.parseTemplate_etc={};TrimPath.parseTemplate_etc.statementTag="forelse|for|if|elseif|else|var|macro";TrimPath.parseTemplate_etc.statementDef={"if":{delta:1,prefix:"if (",suffix:"){",paramMin:1},"else":{delta:0,prefix:"} else {"},"elseif":{delta:0,prefix:"} else if (",suffix:"){",paramDefault:"true"},"/if":{delta:-1,prefix:"}"},"for":{delta:1,paramMin:3,prefixFunc:function(stmtParts,state,tmplName,etc){if(stmtParts[2]!="in")throw new etc.ParseError(tmplName,state.line,"bad for loop statement: "+stmtParts.join(' '));var iterVar=stmtParts[1];var listVar="__LIST__"+iterVar;return["var ",listVar," = ",stmtParts[3],";","var __LENGTH_STACK__;","if (typeof(__LENGTH_STACK__) == 'undefined' || !__LENGTH_STACK__.length) __LENGTH_STACK__ = new Array();","__LENGTH_STACK__[__LENGTH_STACK__.length] = 0;","if ((",listVar,") != null){ ","var ",iterVar,"_ct = 0;","for (var ",iterVar,"_index in ",listVar,"){ ",iterVar,"_ct++;","if (typeof(",listVar,"[",iterVar,"_index]) == 'function'){continue;}","__LENGTH_STACK__[__LENGTH_STACK__.length - 1]++;","var ",iterVar," = ",listVar,"[",iterVar,"_index];"].join("")}},"forelse":{delta:0,prefix:"} } if (__LENGTH_STACK__[__LENGTH_STACK__.length - 1] == 0){ if (",suffix:"){",paramDefault:"true"},"/for":{delta:-1,prefix:"} }; delete __LENGTH_STACK__[__LENGTH_STACK__.length - 1];"},"var":{delta:0,prefix:"var ",suffix:";"},"macro":{delta:1,prefixFunc:function(stmtParts,state,tmplName,etc){var macroName=stmtParts[1].split('(')[0];return["var ",macroName," = function",stmtParts.slice(1).join(' ').substring(macroName.length),"{ var _OUT_arr = []; var _OUT = { write: function(m){ if (m) _OUT_arr.push(m); } }; "].join('')}},"/macro":{delta:-1,prefix:" return _OUT_arr.join(''); };"}};TrimPath.parseTemplate_etc.modifierDef={"eat":function(v){return""},"escape":function(s){return String(s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},"capitalize":function(s){return String(s).toUpperCase()},"default":function(s,d){return s!=null?s:d},"money":function(c){if(isNaN(c))return'NaN';c=(''+Math.round(c*100)/100).match(/(\d*)\.?(\d*)/);while(c[2].length<2){c[2]+=0}return c[1]+'.'+c[2]},"integer":function(c){if(isNaN(c))return'NaN';return parseInt(c)},"fractional":function(c){if(isNaN(c))return'NaN';var a=(''+c).match(/\.(\d*)$/);return a&&a[1]?a[1]:"00"},"morphology":function(num,prfxs){prfxs=prfxs||['','',''];num=''+num;if(num.match(/^(.*)(11|12|13|14|15|16|17|18|19)$/))return prfxs[2];if(num.match(/^(.*)1$/))return prfxs[0];if(num.match(/^(.*)(2|3|4)$/))return prfxs[1];if(num.match(/^(.*)$/))return prfxs[2]}};TrimPath.parseTemplate_etc.modifierDef.h=TrimPath.parseTemplate_etc.modifierDef.escape;TrimPath.parseTemplate_etc.Template=function(tmplName,tmplContent,funcSrc,func,etc){this.process=function(context,flags){if(context==null)context={};if(context._MODIFIERS==null)context._MODIFIERS={};if(context.defined==null)context.defined=function(str){return(context[str]!=undefined)};for(var k in etc.modifierDef){if(context._MODIFIERS[k]==null)context._MODIFIERS[k]=etc.modifierDef[k]}if(flags==null)flags={};var resultArr=[];var resultOut={write:function(m){resultArr.push(m)}};try{func(resultOut,context,flags)}catch(e){if(flags.throwExceptions==true)throw e;var result=new String(resultArr.join("")+"[ERROR: "+e.toString()+(e.message?'; '+e.message:'')+"]");result["exception"]=e;return result}return resultArr.join("")};this.name=tmplName;this.source=tmplContent;this.sourceFunc=funcSrc;this.toString=function(){return"TrimPath.Template ["+tmplName+"]"}};TrimPath.parseTemplate_etc.ParseError=function(name,line,message){this.name=name;this.line=line;this.message=message};TrimPath.parseTemplate_etc.ParseError.prototype.toString=function(){return("TrimPath template ParseError in "+this.name+": line "+this.line+", "+this.message)};var parse=function(body,tmplName,etc){body=cleanWhiteSpace(body);var funcText=["var TrimPath_Template_TEMP = function(_OUT, _CONTEXT, _FLAGS){ with (_CONTEXT){"];var state={stack:[],line:1};var endStmtPrev=-1;while(endStmtPrev+1<body.length){var begStmt=endStmtPrev;begStmt=body.indexOf("{",begStmt+1);while(begStmt>=0){var endStmt=body.indexOf('}',begStmt+1);var stmt=body.substring(begStmt,endStmt);var blockrx=stmt.match(/^\{(cdata|minify|eval)/);if(blockrx){var blockType=blockrx[1];var blockMarkerBeg=begStmt+blockType.length+1;var blockMarkerEnd=body.indexOf('}',blockMarkerBeg);if(blockMarkerEnd>=0){var blockMarker;if(blockMarkerEnd-blockMarkerBeg<=0){blockMarker="{/"+blockType+"}"}else{blockMarker=body.substring(blockMarkerBeg+1,blockMarkerEnd)}var blockEnd=body.indexOf(blockMarker,blockMarkerEnd+1);if(blockEnd>=0){emitSectionText(body.substring(endStmtPrev+1,begStmt),funcText);var blockText=body.substring(blockMarkerEnd+1,blockEnd);if(blockType=='cdata'){emitText(blockText,funcText)}else if(blockType=='minify'){emitText(scrubWhiteSpace(blockText),funcText)}else if(blockType=='eval'){if(blockText!=null&&blockText.length>0)funcText.push('_OUT.write( (function(){ '+blockText+' })() );')}begStmt=endStmtPrev=blockEnd+blockMarker.length-1}}}else if(body.charAt(begStmt-1)!='$'&&body.charAt(begStmt-1)!='\\'){var offset=(body.charAt(begStmt+1)=='/'?2:1);if(body.substring(begStmt+offset,begStmt+10+offset).search(TrimPath.parseTemplate_etc.statementTag)==0)break}begStmt=body.indexOf("{",begStmt+1)}if(begStmt<0)break;var endStmt=body.indexOf("}",begStmt+1);if(endStmt<0)break;emitSectionText(body.substring(endStmtPrev+1,begStmt),funcText);emitStatement(body.substring(begStmt,endStmt+1),state,funcText,tmplName,etc);endStmtPrev=endStmt}emitSectionText(body.substring(endStmtPrev+1),funcText);if(state.stack.length!=0)throw new etc.ParseError(tmplName,state.line,"unclosed, unmatched statement(s): "+state.stack.join(","));funcText.push("}}; TrimPath_Template_TEMP");return funcText.join("")};var emitStatement=function(stmtStr,state,funcText,tmplName,etc){var parts=stmtStr.slice(1,-1).split(' ');var stmt=etc.statementDef[parts[0]];if(stmt==null){emitSectionText(stmtStr,funcText);return}if(stmt.delta<0){if(state.stack.length<=0)throw new etc.ParseError(tmplName,state.line,"close tag does not match any previous statement: "+stmtStr);state.stack.pop()}if(stmt.delta>0)state.stack.push(stmtStr);if(stmt.paramMin!=null&&stmt.paramMin>=parts.length)throw new etc.ParseError(tmplName,state.line,"statement needs more parameters: "+stmtStr);if(stmt.prefixFunc!=null)funcText.push(stmt.prefixFunc(parts,state,tmplName,etc));else funcText.push(stmt.prefix);if(stmt.suffix!=null){if(parts.length<=1){if(stmt.paramDefault!=null)funcText.push(stmt.paramDefault)}else{for(var i=1;i<parts.length;i++){if(i>1)funcText.push(' ');funcText.push(parts[i])}}funcText.push(stmt.suffix)}};var emitSectionText=function(text,funcText){if(text.length<=0)return;emitSectionTextLine(text,funcText)};var emitSectionTextLine=function(line,funcText){var endMarkPrev='}';var endExprPrev=-1;while(endExprPrev+endMarkPrev.length<line.length){var begMark="${",endMark="}";var begExpr=line.indexOf(begMark,endExprPrev+endMarkPrev.length);if(begExpr<0)break;if(line.charAt(begExpr+2)=='%'){begMark="${%";endMark="%}"}var endExpr=line.indexOf(endMark,begExpr+begMark.length);if(endExpr<0)break;emitText(line.substring(endExprPrev+endMarkPrev.length,begExpr),funcText);var exprArr=line.substring(begExpr+begMark.length,endExpr).replace(/\|\|/g,"#@@#").split('|');for(var k in exprArr){if(exprArr[k].replace)exprArr[k]=exprArr[k].replace(/#@@#/g,'||')}funcText.push('_OUT.write(');emitExpression(exprArr,exprArr.length-1,funcText);funcText.push(');');endExprPrev=endExpr;endMarkPrev=endMark}emitText(line.substring(endExprPrev+endMarkPrev.length),funcText)};var emitText=function(text,funcText){if(text==null||text.length<=0)return;text=text.replace(/\\/g,'\\\\');text=text.replace(/\n/g,'\\n');text=text.replace(/"/g,'\\"');funcText.push('_OUT.write("');funcText.push(text);funcText.push('");')};var emitExpression=function(exprArr,index,funcText){var expr=exprArr[index];if(index<=0){funcText.push(expr);return}var parts=expr.split(':');funcText.push('_MODIFIERS["');funcText.push(parts[0]);funcText.push('"](');emitExpression(exprArr,index-1,funcText);if(parts.length>1){funcText.push(',');funcText.push(parts[1])}funcText.push(')')};var cleanWhiteSpace=function(result){result=result.replace(/\t/g,"    ");result=result.replace(/\r\n/g,"\n");result=result.replace(/\r/g,"\n");result=result.replace(/^(\s*\S*(\s+\S+)*)\s*$/,'$1');return result};var scrubWhiteSpace=function(result){result=result.replace(/^\s+/g,"");result=result.replace(/\s+$/g,"");result=result.replace(/\s+/g," ");result=result.replace(/^(\s*\S*(\s+\S+)*)\s*$/,'$1');return result};TrimPath.parseDOMTemplate=function(elementId,optDocument,optEtc){if(optDocument==null)optDocument=document;var element=optDocument.getElementById(elementId);var content=element.value;if(content==null)content=element.innerHTML;content=content.replace(/&lt;/g,"<").replace(/&gt;/g,">");return TrimPath.parseTemplate(content,elementId,optEtc)};TrimPath.processDOMTemplate=function(elementId,context,optFlags,optDocument,optEtc){return TrimPath.parseDOMTemplate(elementId,optDocument,optEtc).process(context,optFlags)}})();var PluginEvents_class=new Class({firePluginEvent:function(event_name){var event=null;if(document['createEvent']){event=document.createEvent("HTMLEvents");event.initEvent(event_name,"true","false");document.dispatchEvent(event)}}});var EmptyStorage_class=new Class({Class:'EmptyStorage_class',initialize:function(){},init:function(){return this},available:function(){return true},"set":function(key,value){if(console&&console.log){console.log('Alert: empty storage don\'t set KEY:'+key+' and VALUE:'+value)}},"get":function(key){if(console&&console.log){console.log('Alert: empty storage don\'t get KEY:'+key)}return null},"remove":function(key){if(console&&console.log){console.log('Alert: empty storage don\'t remove KEY:'+key)}},exist:function(key){if(console&&console.log){console.log('Alert: empty storage don\'t exist KEY:'+key)}}});var LocalStorage_class=EmptyStorage_class.extend({Class:'LocalStorage_class',_storage_service:null,initialize:function(){this.parent();if(window.localStorage){try{window.localStorage.setItem('_tmptest','tmpval');this._storage_service=window.localStorage;window.localStorage.removeItem('_tmptest');window.localStorage.length=100}catch(e){}}},available:function(){return!!this._storage_service},"set":function(key,value){if(this._storage_service===Object(this._storage_service)){this._storage_service[key]=JSON.stringify(value)}},"get":function(key){var result=null;if(this._storage_service.hasOwnProperty(key)&&this._storage_service[key]!=undefined){try{result=JSON.parse(this._storage_service[key])}catch(e){}}return result},"remove":function(key){delete this._storage_service[key]},exist:function(key){return!!(this._storage_service.hasOwnProperty(key))}});var LocalStorageCrossDomain_class=LocalStorage_class.extend({Class:'LocalStorageCrossDomain_class',_iframeElement:null,_storage_service_cross_domain:null,_temporary_storage:{},options:{domain:'rozetka.com.ua',iframe_src:location.protocol+'//rg.rozetka.com.ua/iframe_recent_goods',origin:location.protocol+'//rg.rozetka.com.ua'},init:function(){this.parent();this._firstload();return this},initCrossDomainStorage:function(){var updateLocalStorage=function(e){try{if(e.origin&&e.origin==this.options.origin){var data=JSON.parse(e.data),event=new CustomEvent("initCrossDomainStorageComplete");for(var item in data){if(typeof data[item].item_name!='undefined'){window.localStorage.setItem(data[item].item_name,data[item].item_value)}}if(window.removeEventListener){window.removeEventListener("message",updateLocalStorage.bind(this),false)}else{window.detachEvent("onmessage",updateLocalStorage.bind(this))}Object.keys(this._temporary_storage).each(function(key){this.set(key,this._temporary_storage[key])}.bind(this));this._temporary_storage={};document.dispatchEvent(event)}}catch(error){}}.bind(this);if(window.postMessage&&window.JSON&&window.localStorage){if(window.addEventListener){window.addEventListener("message",updateLocalStorage.bind(this),false)}else{window.attachEvent("onmessage",updateLocalStorage.bind(this))}window.localStorage.clear();this._iframeElement.contentWindow.postMessage({'action':'getStorage'},this.options.iframe_src);this._storage_service_cross_domain=window.localStorage}},available:function(){return!!(this._storage_service_cross_domain||this.parent())},"sendPostMessage":function(params){this._iframeElement.contentWindow.postMessage(params,this.options.iframe_src)},"set":function(key,value){if(this._storage_service_cross_domain){this._storage_service_cross_domain[key]=JSON.stringify(value);this._iframeElement.contentWindow.postMessage({'action':'setItem','item_name':key,'item_value':JSON.stringify(value)},this.options.iframe_src)}else{this._temporary_storage[key]=value}this.parent(key,value)},"get":function(key){var result=null,service=this._storage_service_cross_domain||this._storage_service;if(service===Object(service)&&service.hasOwnProperty(key)&&service[key]!=undefined){try{result=JSON.parse(service[key])}catch(e){}}return result},"getAll":function(){return this._storage_service_cross_domain},"remove":function(key){if(this._storage_service_cross_domain){delete this._storage_service_cross_domain[key];this._iframeElement.contentWindow.postMessage({'action':'delStorage','item_name':key},this.options.iframe_src)}this.parent(key)},exist:function(key){var result=false;if(this._storage_service_cross_domain){result=this._storage_service_cross_domain.hasOwnProperty(key)}return result||this.parent(key)},syncronize:function(key_for_check,keys_change){var i,source,recipient;if(this._storage_service_cross_domain===Object(this._storage_service_cross_domain)&&this._storage_service===Object(this._storage_service)&&(this._storage_service_cross_domain.hasOwnProperty(key_for_check)||this._storage_service.hasOwnProperty(key_for_check))&&this._storage_service_cross_domain[key_for_check]!=this._storage_service[key_for_check]){if(!this._storage_service[key_for_check]||this._storage_service_cross_domain[key_for_check]>this._storage_service[key_for_check]){recipient=this._storage_service;source=this._storage_service_cross_domain}else{recipient=this._storage_service_cross_domain;source=this._storage_service}recipient[key_for_check]=source[key_for_check];for(i=0;i<keys_change.length;i++){recipient[keys_change[i]]=source[keys_change[i]]}}},_firstload:function(){App.addOnDomReady(function(){this.loadIFrame()}.bind(this))},loadIFrame:function(){if(this.options.iframe_src){if(window.opera){try{document.domain=this.options.domain}catch(e){console.log(e)}}else{document.domain=this.options.domain}this._iframeElement=document.createElement('iframe');this._iframeElement.src=this.options.iframe_src;this._iframeElement.width=0;this._iframeElement.height=0;this._iframeElement.hide();document.body.insertBefore(this._iframeElement,document.body.firstChild);this._iframeElement.addEvent('load',this._onLoadFrame.bind(this))}},_onLoadFrame:function(){this.initCrossDomainStorage();this.fireEvent('CrossDomainIFrameReady')}});var CookieStorage_class=EmptyStorage_class.extend({Class:'CookieStorage_class',available:function(){return true},"set":function(key,value){Cookie.set(key,JSON.stringify(value),{duration:30,domain:'rozetka.com.ua',path:'/'})},"get":function(key){var ret=null,evt=Cookie.get(key);if(evt){ret=JSON.parse(evt)}return ret},"remove":function(key){Cookie.remove(key,{domain:'rozetka.com.ua',path:'/'})},exist:function(key){return!!(Cookie.get(key))}});var Storage_class=new Class({adapters:[LocalStorage_class,CookieStorage_class,EmptyStorage_class],initialize:function(){this.adapters.each(function(adapter_class){if(!this.available){var adapter=new adapter_class();if(adapter.available()){$extend(this,adapter)}}}.bind(this))}});Storage_class.implement(new Options());EmptyStorage_class.implement(new Options(),new Events());var App={_default_storage_class:'Storage_class',_storage:null,setStorageClass:function(storage){this._storage=storage},getStorage:function(){var storage_constructor;if(this._storage==null){storage_constructor=App.getConstructorByClassName(this._default_storage_class);this._storage=new storage_constructor()}return this._storage},isDesktop:function(){return(!$defined(window.device_type)||device_type=="computer")&&!this.isTouchDevice()},isTouchDevice:function(){return(('ontouchstart'in window)||(window.navigator.MaxTouchPoints>0)||(window.navigator.msMaxTouchPoints>0))},setRule:function(selector,rule){var styleSheets=document.styleSheets[document.styleSheets.length-1];if($defined(styleSheets.addRule)){styleSheets.addRule(selector,rule)}else if($defined(styleSheets.insertRule)){styleSheets.insertRule(selector+" {"+rule+"}",styleSheets.cssRules.length)}},parseURL:function(url){var REGEX=/^((\w+):\/\/((\w+):?(\w+)?@)?(([^\/\?:]+):?(\d+)?)?)?(\/?[^\?#]+)?\??([^#]+)?#?([\w-]*)/;var fields={'href':0,'username':4,'password':5,'port':8,'protocol':2,'host':7,'hostname':7,'pathname':9,'search':10,'hash':11};var result={};var r=REGEX.exec(url);for(var field in fields)result[field]=r[fields[field]]?r[fields[field]]:'';if(result.hash)result.hash='#'+result.hash;if(result.search)result.search='?'+result.search;return result},parseGET:function(get,pref,sep){pref=pref||'?';sep=sep||'&';var result={};(get.slice(0,1)==pref?get.slice(1):get).split(sep).each(function(i){if(i.indexOf('=')!=-1){result[i.slice(0,i.indexOf('='))]=decodeURIComponent(i.slice(i.indexOf('=')+1))}else{result[i]=i}});return result},buildUrl:function(url,params){var nodes=url.split('/');if(nodes[nodes.length-2].indexOf('=')!=-1){var url_params=App.parseGET('#'+nodes[nodes.length-2],'#',';');for(name in url_params){if(!$defined(params[name])){params[name]=url_params[name]}}}else{nodes[nodes.length]=''}var query=[];for(name in params){query.push(name+'='+params[name])}nodes[nodes.length-2]=query.join(';');return nodes.join('/')},getGETData:function(get){var result={};for(key in get){if(key.substr(0,5)==='data['){result[key.replace(/data\[([\w-]*)\]([\w-]*)/,"$1$2")]=get[key]}}return result},tryUrchinTracker:function(url){url=this.parseURL(url);if(typeof(pageTracker)!='undefined'){pageTracker._trackPageview(url.pathname)}else if(window._gaq!=undefined){_gaq.push(['_trackPageview',url.pathname])}},trackEvent:function(category,action,opt_label,opt_value,opt_noninteraction){if(typeof(pageTracker)!='undefined'){pageTracker._trackEvent(category,action,opt_label,opt_value,opt_noninteraction)}else if(window._gaq!=undefined){_gaq.push(['_trackEvent',category,action,opt_label,opt_value,opt_noninteraction])}},trackOutboundLink:function(link,category,action,opt_label,opt_value){try{var pageTracker=_gat._createTracker('UA-203518-1');pageTracker._trackEvent(category,action,opt_label,opt_value);setTimeout('document.location = "'+link.href+'"',100)}catch(err){}},trackGTMEvent:function(event,track_raw){if(dataLayer!==undefined){if(!track_raw){event.event="OWOX";if(event.eventAction==='delete'){event.eventAction='remove'}}dataLayer.push(event)}},passiveTrackEvent:function(category,action,opt_label,opt_value){this.trackEvent(category,action,opt_label,opt_value,true)},trackSocial:function(social_network,social_action,opt_target,opt_page_path){if(typeof(pageTracker)!='undefined'){pageTracker._trackSocial(social_network,social_action,opt_target,opt_page_path)}else if(window._gaq!=undefined){_gaq.push(['_trackSocial',social_network,social_action,opt_target,opt_page_path])}},trackExitPage:function(link){this.trackEvent('Exit page','click by title',link.getText());this.trackEvent('Exit page','click by URL',link.href)},setCustomVar:function(index,name,value,opt_scope){if(typeof(pageTracker)!='undefined'){pageTracker._setCustomVar(index,name,value,opt_scope)}else if(window._gaq!=undefined){_gaq.push(['_setCustomVar',index,name,value,opt_scope])}else if(window.console){console.log('Warning! Custom var "'+name+' '+value+'" does not set.')}},deleteCustomVar:function(index){if(typeof(pageTracker)!='undefined'){pageTracker._deleteCustomVar(index)}else if(window._gaq!=undefined){_gaq.push(['_deleteCustomVar',index])}},getAjaxPoint:function(params){if(!$defined(params.r))params.r=escape(location.pathname);return'/cgi-bin/form.php?'+Object.toQueryString(params)},tpl_cache:{},getHTML:function(tpl,data){var t=this.tpl_cache[tpl];if(t==undefined){t=TrimPath.parseTemplate(tpl);this.tpl_cache[tpl]=t}return t.process(data)},'session_already':0,'session_json':{},domIsReady:false,onDomReady:function(){this.domIsReady=true;App.fireEvent('domready')},addOnDomReady:function(fn){this.domIsReady?fn():this.addEvent('domready',fn)},enrolMsgBlock:function(msg){if(!$defined(msg.clear)){msg.clear=function(){this.setHTML('')};App.addEvent('newmessage',msg.clear.bind(msg))}return msg},showMessage:function(Message){this.addOnDomReady.delay(80,this,function(){if(!$defined(App.msg_block)){var elem='';if(elem=$E('div[name=app-message]')){App.setMessageBlock(elem)}else if(elem=$E('h1')){App.setMessageBlock(new Element('div').injectAfter(elem))}else{alert(Message.getContent())}}if($defined(App.msg_block))App.msg_block.setHTML(Message.getContentTpl())})},setMessageBlock:function(elem){return App.enrolMsgBlock(App.msg_block=elem)},log:function(obj){if(Cookie.get("debug")&&typeof console!=='undefined'&&$defined(console.log)){console.debug(obj)}else{obj.toString()}},err:function(){if(Cookie.get("debug")&&typeof console!=='undefined'&&$defined(console.error)){console.error(arguments[0],arguments[1])}},debug:function(key){key?Cookie.set('debug',key,{duration:183,domain:'rozetka.com.ua',path:'/'}):Cookie.remove('debug',{domain:'rozetka.com.ua',path:'/'})},onUserSignChangeReload:function(){var reloader=function(){User.addEvent('signChange',function(){window.ie6||window.ie7?location.replace(location.protocol+'//'+location.host+location.pathname+(location.search?'?'+location.search:'')):location.reload()})};S.checkup?reloader():S.addEvent('loadS',reloader)},getConstructorByClassName:function(class_name){var constructor=window[class_name];return constructor},getSelectorByTemplate:function(tpl,data){return App.getHTML(tpl,data)},getSessionJSON:function(callback){if(this.session_already){callback(this.session_json)}document.addEvent('loadS',callback)},sessionReady:function(session_json){this.session_json=session_json;this.session_already=1},escape:function(str){var translate=[],ret=[],i=0;for(i=0x410;i<=0x44F;i++){translate[i]=i-0x350}translate[0x401]=0xA8;translate[0x451]=0xB8;for(i=0;i<str.length;i++){var n=str.charCodeAt(i);if(translate[n]!=undefined){n=translate[n]}if(n<=0xFF){ret.push(n)}}return window.escape(String.fromCharCode.apply(null,ret))},unescape:function(str){var untranslate=[],str=window.unescape(str),ret=[],i=0,n=null;for(i=0x44F;i>=0x410;i--){untranslate[i-0x350]=i}untranslate[0xA8]=0x401;untranslate[0xB8]=0x451;for(i=0;i<str.length;i++){n=str.charCodeAt(i);if(untranslate[n]!=undefined){n=untranslate[n]}if(n<=untranslate[0xFF]){ret.push(n)}}return String.fromCharCode.apply(null,ret)},onPageLoad:function(){this.pageIsLoad=true;App.fireEvent('pageLoad')},addOnPageLoad:function(fn){this.pageIsLoad?fn():this.addEvent('pageLoad',fn)},htmlSpecialChars:function(string){var specialChars,x;specialChars={'&':"&amp;",'<':"&lt;",'>':"&gt;",'"':"&quot;"};if(string){for(x in specialChars){string=string.replace(new RegExp(x,"g"),specialChars[x])}}return string},tagFilter:function(string,clear_all_tag,white_list){var reg_teg,reg_attr,teg_name,teg_data,attr_data,true_attr,for_replace=[];clear_all_tag=clear_all_tag||false;reg_teg=new RegExp('<([^/^>^ ]+)(\\s+)?([^>]+)?>([^>]*<\/[^>]+>)?','g');reg_attr=new RegExp('(\\w+)\\s*=\\s*"[^"]*"','g');if(!white_list){white_list={'img':{'src':true,'alt':true,}}}if(clear_all_tag){string=string.replace(reg_teg,'')}else{while((teg_data=reg_teg.exec(string))!=null){teg_name=teg_data[1].toLowerCase();if(white_list[teg_name]){true_attr=[];while((attr_data=reg_attr.exec(teg_data[0]))!=null){if(white_list[teg_name][attr_data[1].toLowerCase()]){true_attr.push(attr_data[0])}}if(true_attr.length){for_replace.push({'from':teg_data[0],'to':'<'+teg_data[1]+' '+true_attr.join(' ')+'>'})}else{for_replace.push({'from':teg_data[0],'to':''})}}else{for_replace.push({'from':teg_data[0],'to':''})}}for_replace.each(function(obj){string=string.replace(obj.from,obj.to)})}return string}};$extend(App,new Events());if(window.ie){domReadyForIe(App.onDomReady.bind(App))}else{window.addEvent('domready',App.onDomReady.bind(App))}document.addEvent('loadS',App.sessionReady.bind(App));function domReadyForIe(fn){var testElement=document.createElement('div');(function(){try{testElement.doScroll();fn()}catch(e){setTimeout(arguments.callee,20)}})()};var S={data:{},checkup:0,expire:'1380'*1000,is_renew_sended:false,tagname_last_server_update:'session_update_from_server',tagname_session_json:'session_json',cookie_update_session:'session_update_from_server',cookie_disable_ls:'disable_session_ls',disabled_zones:[],last_updated:0,_time_delay_set:null,_min_interval:10*1000,setForceCookie:function(){Cookie.set(this.cookie_update_session,1,{duration:1,domain:'.rozetka.com.ua',path:'/'})},removeForceCookie:function(){Cookie.remove(this.cookie_update_session,{domain:'.rozetka.com.ua',path:'/'})},issetForceCookie:function(){return Cookie.get(this.cookie_update_session)},isNeedLoadFromServer:function(forced){var need_update,storage,cookie_force,is_disabled_zone=null;if(!forced){storage=App.getStorage();cookie_force=this.issetForceCookie();is_disabled_zone=this.checkDisabledZones();if(cookie_force&&!is_disabled_zone){this.removeForceCookie()}if(Cookie.get(this.cookie_disable_ls)){Cookie.remove(this.cookie_disable_ls,{domain:'rozetka.com.ua',path:'/'});this.disable_localstorage=true}if(is_disabled_zone){if(!cookie_force){this.setForceCookie()}this.disable_localstorage=true}this.last_updated=storage?storage.get(this.tagname_last_server_update):null;need_update=(this.last_updated!=null&&storage.get(this.tagname_session_json)&&!cookie_force&&!this.disable_localstorage)?this.last_updated+this.expire<new Date().getTime():true}else{need_update=true}return need_update},load:function(forced,is_auto){var xhr,sid,httpOnly_sid,session_prefix;if(this.isNeedLoadFromServer(forced)){httpOnly_sid=Cookie.get("ho_sid");sid=Cookie.get("sid");if(sid||httpOnly_sid){session_prefix=(sid)?sid:"get_session";xhr=new Ajax("/s/"+((forced||is_auto)?'session':session_prefix)+".json?"+Math.random());xhr.setOptions({method:'get',onComplete:function(text){try{var data=eval('('+text+')')}catch(e){App.err('   S ',arguments[0])}this.last_updated=new Date(xhr.getHeader('Date')).valueOf();this.load.delay(this.calculateDelay(),this,[false,true]);this._time_delay_set=new Date().getTime();if(typeof data!=='undefined'){this.onLoad(data)}}.bind(this),onFailure:function(){this.last_updated=1;this.load.delay(this.calculateDelay(),this,[false,true]);this._time_delay_set=new Date().getTime()}.bind(this)}).request()}else{this.fireEventLoadS({},true);if(this._time_delay_set<new Date().getTime()-this._min_interval){this.load.delay(this.calculateDelay(),this,[false,true]);this._time_delay_set=new Date().getTime()}}}else{this.loadFromStorage();if(this._time_delay_set<new Date().getTime()-this._min_interval){this.load.delay(this.calculateDelay(),this,[false,true]);this._time_delay_set=new Date().getTime()}}},calculateDelay:function(){var delay;if(this.last_updated){delay=this.expire-(new Date().getTime()-this.last_updated)}else{delay=this.expire}if(delay<0){delay=this._min_interval}return delay},syncStorages:function(force){var storage=App.getStorage();if(!this.disable_localstorage){if(storage){if(force){this._doSyncStorages(storage)}else{storage.addEvent('CrossDomainIFrameReady',function(){this._doSyncStorages(storage)}.bind(this))}}}else if(storage){this.removeStorageSession()}},_doSyncStorages:function(storage){var old_value=this.tagname_last_server_update;storage.syncronize(this.tagname_last_server_update,[this.tagname_session_json]);if(old_value!=storage.get(this.tagname_last_server_update)){this.loadFromStorage()}},onLoad:function(data){this.fireEvent('BeforeSetMessage',data);if(data.message){App.showMessage(new Message_class(data.message));delete data.message}if(!this.disable_localstorage){this.setStorageSession(data)}this.data=data;this.fireEventLoadS(this.data,false)},setStorageSession:function(data){var storage=App.getStorage();if(storage){storage.set(this.tagname_session_json,data);storage.set(this.tagname_last_server_update,new Date().getTime())}},removeStorageSession:function(){var storage=App.getStorage();if(storage){storage.remove(this.tagname_last_server_update);storage.remove(this.tagname_session_json)}},disableZones:function(zones){for(var zone in zones){if(zones.hasOwnProperty(zone)){this.disabled_zones.push(App.parseURL(zones[zone]).hostname)}}},checkDisabledZones:function(){var result=false;for(var zone in this.disabled_zones){if(this.disabled_zones.hasOwnProperty(zone)&&window.location.hostname===this.disabled_zones[zone]){result=true;break}}return result},loadFromStorage:function(){var data,storage=App.getStorage();data=storage?storage.get(this.tagname_session_json):null;if(data){if(data.message){App.showMessage(new Message_class(data.message));delete data.message;storage.set(this.tagname_session_json,data)}this.data=data;this.fireEventLoadS(this.data,false)}else{this.load(true)}},fireEventLoadS:function(data,is_sid){this.fireEvent('loadS',data);document.fireEvent('loadS',data);if(is_sid){this.fireEvent('noSID')}this.checkup=1},renew:function(url){var options={};if(!this.is_renew_sended){if(!url){url='/cgi-bin/form.php'}options={onComplete:function(resp){S.load(true)},headers:{'ajaxAction':'https://my.rozetka.com.ua/session/#renew'}};new Ajax(url,options).request();this.is_renew_sended=true}}};$extend(S,new Events());var InitElements=Class({initElements:function(selector,container){var elems=null;if($type(selector)=='string'){elems=selector.length?$E(selector,container):null}else if(['element','collection',false].contains($type(selector))||$type(selector.initialize)=='function'){elems=selector}else if($type(selector)=='array'){elems=$$();selector.each(function(item){elems=$$(elems,($type(item)=='string'?$ES(item,container):item))},this)}else if($type(selector)=='object'){elems={};Object.each(selector,function(item,key){elems[key]=this.initElements(item,container)},this)}else{App.log('illegal type',$type(selector),'of',selector)}return elems}});var ActiveSelect=new Class({activeSelect:function(container){$ES('select[id$=_select]',container).each(function(el){el.field=$E('#'+el.id.substr(0,el.id.length-7)+'_field',container);el.onChange=function(){if(this.value=='new'){this.field.show().getFormElements().every(function(field){return field.getValue()||field.focus()})}else{this.field.hide()}this.field.getFormElements().each(function(el){el.blocked=this.value=='new'?0:1},this)};el.addEvent('change',el.onChange.bind(el));el.addEvent('openField',el.onChange.bind(el));el.onChange()})}});Events.implement({attachToObserver:function(events){var property_name;for(property_name in this){if(this[property_name]instanceof Function&&property_name.substring(0,2)=='on'){if(!this.options||!(this.options[property_name]instanceof Function)){this.addEvent(property_name,this[property_name])}}}Observer.register(this,events)}});var Observer_class=new Class({_objects:[],_events:{},_event_handlers:{},register:function(object,events){var i,j,event_name;for(i=0;i<events.length;i++){if(this._events[events[i]]==undefined){this._events[events[i]]=[];for(j=0;j<this._objects.length;j++){this._objects[j].addEvent(events[i],this._getEventHandler(events[i]))}}this._events[events[i]][this._events[events[i]].length]=object}for(event_name in this._events){object.addEvent(event_name,this._getEventHandler(event_name))}this._objects[this._objects.length]=object},_getEventHandler:function(event_name){var event_handler=this._event_handlers[event_name];if(event_handler==undefined){event_handler=function(){var i,external_event_name;for(i=0;i<this._events[event_name].length;i++){external_event_name='on';external_event_name+=event_name.charAt(0).toUpperCase();external_event_name+=event_name.substr(1);this._events[event_name][i].fireEvent(external_event_name,arguments)}}.bind(this);this._event_handlers[event_name]=event_handler}return event_handler}});var Observer=new Observer_class();var UTAAbstract_class=new Class({Class:'UTAAbstract_class',_object:null,_default_fields:{'hitType':'timing'},initialize:function(object,fields){this._object=object;if(fields){$extend(this._default_fields,fields)}if(window.ga){this.initEvents()}else{App.addOnDomReady(this.initEvents.bind(this))}},initEvents:function(){},trackEvent:function(data){var convert_data=[];$extend(data,this._default_fields);Object.keys(data).each(function(key){convert_data.push({name:key,value:data[key]})});document.fireEvent('uta',{extend_event:convert_data})},getTime:function(){return new Date().getTime()},reset:function(){}});var RozetkaEvents_class=new Class({Class:'RozetkaEvents_class',events:{'Profile':/^(cart|wishlist|waitlist|personal_info|personal-information\/(popup|comment_block)\/(add|close)|change-password|subscribes|review-request)$/,'Credit':/^(open|click|order)$/,'similar_goods':/.*/,'goods_actions_3d':/.*/,'goods_actions_comment':/^(comment|reply|comment\sfull|rating)$/,'goods_actions_compare':/^(add|delete|\d+)$/,'goods_actions_waitlist':/^add-waitlist$/,'goods_actions_wishlist':/^add-wishlist$/,'goods_actions_video':/^(Closed|Quality|Error|Start|Pause|Resume|VideoEnded|Buffering|Scrub|LeftPage)$/,'goods_actions_overview':/^(open|click)$/,'to_cart':/^(catalog-add|page-add|popup-add|delete|kit-from-cart-add|kit-page-add|kit-delete|promotion-add|not-added)$/,'authorization':/^success$/,'banners_bigpromo':/^(switch|click)$/,'comment_voting':/^(positive|negative)$/,'series':/^(open|click)$/,'social':/^(|Twitter|Facebook|\s|vkontakte_paid|review-motivation)$/,'click-list':/.*/,'click-tile':/.*/,'click-new_tile':/.*/,'open-list':/^(open|load)$/,'open-tile':/^(open|load)$/,'open-new_tile':/^(open|load)$/,'Checkout':/^(click|fill|select-type|checkbox|focus|error|color\/product\/order|cart-save)$/,'Success':/^(click|fill|select-type|checkbox|focus|error|color\/product\/order|cart-save)$/,'Coupons':/^(show|try-apply|fail|success|cancel)$/,'Forms':/^(feedback|order-problem)$/,'Special clubs':/^.*$/,'Shop-review':/^(convenience-vote|manager-vote|delivery-vote|payment-vote|submit)$/,'Main':/^.*$/,'Product page':/^.*$/,'Catalog':/^.*$/,'Article':/^.*$/,'News':/^.*$/,'Cart':/^.*$/,'Promotion page':/^.*$/,'Compare':/^.*$/,'Brandshop-bosch':/^.*$/,'SSC':/^.*$/,'Promo birthday':/^.*$/},section:null,_storage_data:{goods:{},GTM_events:{}},_params:{place:null,category:null,cart_category:null},_checkEvent:function(category,action){if(this.events[category]&&this.events[category].test(action)){var registred=true}else{var registred=false;if(window.console){console.log('Event \''+action+'\' in category \''+category+'\' not registred')}}return registred},trackEvent:function(category,action,opt_label,opt_value,opt_noninteraction){category=category||this.getParam('category');if(this._checkEvent(category,action)){action=action?String(action):null;opt_label=opt_label?String(opt_label):null;opt_value=opt_value?parseInt(opt_value):null;App.trackEvent(category,action,opt_label,opt_value,opt_noninteraction)}},passiveTrackEvent:function(category,action,opt_label,opt_value){this.trackEvent(category,action,opt_label,opt_value,true)},getData:function(type,name){if($defined(this._storage_data[type])){return this._storage_data[type][name]}},setData:function(type,name,value){if($defined(this._storage_data[type])&&name){this._storage_data[type][name]=value}},getGoodsData:function(goods_id){var data;goods_id=goods_id||this.getGoodsId();data=this.getData('goods',goods_id);return data?data.section+'/'+(data.producer||'')+'/'+data.id:goods_id},setGoodsData:function(data){var value={};if(data&&data.id){value.id=data.id;value.section=data.section||data.parent||data.parent_id;value.producer=data.producer||data.producer_id;value.top_section=data.top_section;value.price=data.price;this.setData('goods',value.id,value)}},setSection:function(section){this.section=section},getSection:function(){return this.section},setGoodsId:function(goods_id){this.goods_id=goods_id},getGoodsId:function(){return this.goods_id},setParam:function(name,value){if(this._params[name]!==undefined){this._params[name]=value}else if(window.console){console.log('Events param \''+name+'\' not registred')}},getParam:function(name){return this._params[name]},addTrackingEvent:function(element,event,category,action,opt_label,opt_value,opt_noninteraction){if(this._checkEvent(category,action)){element.addEvent(event,function(e){new Event(e).stop();this.trackEvent(category,action,opt_label,opt_value,opt_noninteraction)}.bind(this))}},trackSocial:function(long_title,short_title){App.trackSocial(long_title,'share');this.trackEvent('social','review-motivation',short_title)}});var JSLogger_class=new Class({error_count:0,options:{handlers:['toAnalytics']},initialize:function(options){this.setOptions(options);this._attachOwnHandlers()},_attachOwnHandlers:function(){this.options.handlers.each(function(handler_name){if(this[handler_name]){this.addEvent('javaScriptError',this[handler_name])}},this)},attachErrorHandler:function(handler,scope){var error_handler=scope?handler.bind(scope):handler;this.addEvent('javaScriptError',error_handler)},toAnalytics:function(msg,url,line,index){if(window.dataLayer!==undefined){App.trackGTMEvent({'eventCategory':'JS Error','eventAction':msg,'eventLabel':navigator.userAgent,'eventLocation':url,'eventPosition':line,'eventNoninteraction':true})}else{App.trackEvent('JS Error',msg,navigator.userAgent+' -> '+url+" : "+line,index,true)}},handleError:function(msg,url,line){this.error_count++;this.fireEvent('javaScriptError',[msg,url,line,this.error_count]);App.err("["+this.error_count+"] Javascript   "+line+"  "+url+": "+msg);return true}});JSLogger_class.implement(new Options(),new Events());var LazyLoad_class=new Class({_axis:null,_images:null,_boundScroll:null,options:{range:200,axis:"y",useFade:true,fadeDuration:100},_images_selector:"img[data_src]",_realSrcAttribute:"data_src",initialize:function(options){this.setOptions(options);this._boundScroll=this.onScroll.bind(this);this._axis=this.options.axis;this.renewImages();App.addEvent('timedResize',this._onTimedResize.bind(this));App.addEvent('renewImages',this.renewImages.bind(this))},setAxis:function(axis){this._axis=axis;this.renewImages()},_bindScrollEvent:function(){window.addEvent("scroll",this._boundScroll)},_unbindScrollEvent:function(){window.removeEvent("scroll",this._boundScroll)},renewImages:function(){this._images=$(document.body).getElements(this._images_selector);this._showImagesInRange();if(this._images.length>0){this._bindScrollEvent()}},onScroll:function(){this._showImagesInRange()},_onTimedResize:function(data){this._showImagesInRange()},_showImagesInRange:function(){var window_size=window.getSize(),show_range,retained_images,i,image;show_range=window_size.scroll[this._axis]+window_size.size[this._axis]+this.options.range;retained_images=[];for(i=0;i<this._images.length;i++){image=this._images[i];if(this.getPosition(image)[this._axis]<show_range){this.loadImage(image)}else{retained_images.push(image)}}this._images=retained_images;if(!this._images.length){this._unbindScrollEvent()}},loadImage:function(image){var src=image.getAttribute(this._realSrcAttribute),duration;if(src){image.removeAttribute(this._realSrcAttribute);if(this.options.useFade){duration=this.options.fadeDuration;image.addEventOnce("load",function(){var fx=new Fx.Style(image,'opacity',{'duration':duration});fx.start(0,1)});image.setStyle("opacity",0)}image.src=src;this.fireEvent("imageLoaded",[image])}},getPosition:function(image){var position,parent;position=image.getPosition();if(!image.isVisible()){parent=image.getVisibleParent();if(parent){position=parent.getPosition()}}return position}});LazyLoad_class.implement(new Options(),new Events());var Response_class=Class({Class:'Response_class',initialize:function(resp){try{resp=eval('('+resp+')');if(!$defined(resp.code))throw'err'}catch(e){App.err('    : ',resp);resp={message:{},code:this.CODE.ERROR};resp.message.content="  . , , &nbsp; .";resp.message.code=parseInt('5')}if($defined(resp.message)){this.Message=new Message_class(resp.message);delete resp.message}$extend(this,resp);return this},isError:function(){return this.code&this.CODE.ERROR},isDone:function(){return this.code&this.CODE.DONE},isVoid:function(){return this.code==this.CODE.VOID},doAction:function(){if($defined(this.action)){if(this.action&this.ACTION.S_LOAD){$defined(this.S)?S.onLoad(this.S):S.load(true)}if(this.action&this.ACTION.USER_AUTH){User.SignIn(this.Message)}if(this.action&this.ACTION.LOCATION){location.href=this.location;App.fireEvent('newLocation')}if(this.action&this.ACTION.RELOAD){window.ie6||window.ie7?location.replace(location.protocol+'//'+location.host+location.pathname+(location.search?'?'+location.search:'')):location.reload()}}},CODE:{VOID:'0'.toInt(),DONE:'1'.toInt(),ERROR:'2'.toInt()},ACTION:{S_LOAD:'1'.toInt(),USER_AUTH:'2'.toInt(),LOCATION:'4'.toInt(),RELOAD:'16'.toInt(),MENU_LOAD:'8'.toInt()}});var Message_class=new Class({CODE:{NOTIFY:2,DONE:1,CONFIRM:3,ALERT:4,ERROR:5,REQUIRED_AUTHORIZE:6},options:{tpl:'<div class="message code${code}">${content}</div>'},initialize:function(message){$extend(this,message);this.isShown=0},getContent:function(){if(this.isShown){return''}else{App.fireEvent('newmessage');this.isShown=1;return this.content}},getContentTpl:function(tpl){return this.getContent()?App.getHTML(tpl?tpl:this.options.tpl,this):''},isError:function(){return this.code&this.CODE.ERROR},isDone:function(){return this.code&this.CODE.DONE}});Message_class.implement(new Options);(function(){var ua=navigator.userAgent.toLowerCase(),UA=ua.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,'unknown',0],mode=UA[1]=='ie'&&document.documentMode;var Browser=this.Browser=$merge({Engine:{name:'unknown',version:0},Platform:{name:(window.orientation!=undefined)?'ipod':(navigator.platform.match(/mac|win|linux/i)||['other'])[0].toLowerCase()},Features:{xpath:!!(document.evaluate),air:!!(window.runtime),query:!!(document.querySelector)},Plugins:{},Engines:{presto:function(){return(!window.opera)?false:((arguments.callee.caller)?960:((document.getElementsByClassName)?950:925))},trident:function(){return(!window.ActiveXObject)?false:((window.XMLHttpRequest)?((document.querySelectorAll)?6:5):4)},webkit:function(){return(navigator.taintEnabled)?false:((Browser.Features.xpath)?((Browser.Features.query)?525:420):419)},gecko:function(){return(!document.getBoxObjectFor&&window.mozInnerScreenX==null)?false:((document.getElementsByClassName)?19:18)}},name:(UA[1]=='version')?UA[3]:UA[1],version:mode||parseFloat((UA[1]=='opera'&&UA[4])?UA[4]:UA[2])},Browser||{});Browser.Platform[Browser.Platform.name]=true;Browser.detect=function(){for(var engine in this.Engines){var version=this.Engines[engine]();if(version){this.Engine={name:engine,version:version};this.Engine[engine]=this.Engine[engine+version]=true;break}}return{name:engine,version:version}};Browser.detect()}).call(this);var Menu_class=new Class({Class:'Menu_class',options:{tpl:'',S:[],xhrNodes:{}},initialize:function(){this.S=[];S.addEvent('loadS4menu',this.update.bind(this));S.addEvent('loadS',function(S){this.update($defined(S.menu)?S.menu:null)}.bind(this))},init:function(id){if(!id){id='menu'+$random(0,100000);document.write("<div id='"+id+"'></div>")}this.elem=$(id);if(S.checkup)this.update(this.S)},update:function(S){this.S=S&&S.length?S:this.options.S;if($defined(this.elem)){this.elem.setHTML(App.getHTML(this.options.tpl,{nodes:this.S,isActive:this.isActive,isMediate:this.isMediate}));for(var name in this.options.xhrNodes){var elem=this.elem.getElement('[name='+name+']');if(elem){elem.addClass('xhr');var menu=this;elem.addEvent('click',function(e){new Event(e).stop();menu.options.xhrNodes[this.name]()})}}}},isActive:function(node){var url=App.parseURL(node.href);return(url.host?url.host===location.host:true)&&location.pathname.replace(/\/$/g,"")===url.pathname.replace(/\/$/g,"")},isMediate:function(node){var url=App.parseURL(node.href);return(url.host?url.host===location.host:true)&&location.pathname.search(url.pathname.replace(/\/$/g,""))===0}});Menu_class.implement(new Options);var Popup_class=new Class({_isOpened:false,_overlay:null,_popups:[],options:{floatingX:true,floatingY:true,single:true,closeOnCOS:true,closeOnEsc:true,holdon:false},initialize:function(tpl,pElem){this.elem=new Element('div');this.tpl=tpl;if(pElem){this.pElem=pElem}else{App.addOnDomReady(this._setAsMoadal.bind(this))}document.addEvent('closeOtherPopups',this._onCloseOtherPopups.bind(this));this.attachToObserver(['contentUpdate'])},_onCloseOtherPopups:function(){if(!this.options.holdon){this.close()}},overlayON:function(property){if(!this._overlay){this._overlay=new Overlay_class(property)}},setContent:function(tpl,data){this._updateBody();this.content.setHTML(App.getHTML(tpl,data));this.form=this.getElement('form');this.msg=this.getElement('[name=msg]');if(this.msg)this.msg=App.enrolMsgBlock(this.msg);this.getElements(".xhr").each(function(el){el.addEvent('click',function(e){new Event(e).stop();this.fireEvent(el.name)}.bind(this))}.bind(this));this._setCloseControls();this.fireEvent('contentUpdate',this)},open:function(){if(!this._isOpened){if(this.options.single){document.fireEvent('closeOtherPopups')}this.elem.injectTop($(this.pElem));this._isOpened=true;this._onOpen();this.fireEvent('open')}return this},close:function(){if(this._isOpened){this.fireEvent('beforeClose');this.elem.remove();this._isOpened=false;this._onClose();this.fireEvent('close')}return this},getElement:function(sel){return this.elem.getElement(sel)},getElements:function(sel){return this.elem.getElements(sel)},_updateBody:function(){this.elem.setHTML(App.getHTML(this.tpl,this));this._setCloseControls();this.content=this.getElement('[name=content]');if(this.options.closeOnEsc){window.addEvent('keydown',this._onCloseOnEsc.bind(this))}if(!this._closePopup){this._closePopup=(function(e){if(!this.elem.hasChild(new Event(e).target)){this.close()}}).bind(this)}},_onCloseOnEsc:function(event){if((new Event(event).key)==='esc'){this.close()}},_setCloseControls:function(){this.getElements('[name=close]').each(function(elem){elem.removeEvents();elem.addEvent('click',function(e){new Event(e).stop();this.close()}.bind(this))}.bind(this))},_setAsMoadal:function(){this.pElem=document.body;this.elem.setStyles({position:'absolute','z-index':1000});this.CheckPos=new CheckPos_class(window,this._posUpdate.bind(this,1));this.addEvent('open',this._posUpdate)},_posUpdate:function(soft){var el=this.elem.getCoordinates();var win=window.getSize();if(window.opera&&document.documentElement.clientHeight<document.body.clientHeight)win.size.y=document.documentElement.clientHeight;var top=(win.size.y>el.height&&this.options.floatingY?parseInt(win.scroll.y+(win.size.y-el.height)/2):el.top)+'px';var left=(win.size.x>el.width&&this.options.floatingX?parseInt((win.size.x-el.width)/2):el.left)+'px';if(soft){new Fx.Styles(this.elem,{duration:250}).start({top:top,left:left})}else{this.elem.setStyles({top:top,left:left})}},_onOpen:function(){var el=this.elem.getCoordinates();var win=window.getSize();if(window.opera&&document.documentElement.clientHeight<document.body.clientHeight)win.size.y=document.documentElement.clientHeight;var top=(win.size.y<el.height?win.scroll.y+20:parseInt(win.scroll.y+(win.size.y-el.height)/2))+'px';var left=(win.size.x<el.width?win.scroll.x+20:parseInt((win.size.x-el.width)/2))+'px';this.elem.setStyles({top:top,left:left});if(this.form)this.form.setFocus.bind(this.form).delay(10);if(this._overlay)this._overlay.show();if(this.CheckPos)this.CheckPos.start();if(this.options.closeOnCOS)$(document.body).addEvent('click',this._closePopup)},_onClose:function(){if(this.form)this.form.reset();if(this.msg)this.msg.innerHTML='';if(this._overlay)this._overlay.hide();if(this.CheckPos)this.CheckPos.stop();if(this.options.closeOnCOS)$(document.body).removeEvent('click',this._closePopup)},isOpened:function(){return this._isOpened}});Popup_class.implement(new Events);Popup_class.implement(new Options);var CheckPos_class=new Class({initialize:function(el,fn){this.el=el;this.change=fn;this.value=0},_check:function(){var xy=this.el.getSize();with(this.xy){var result=(size.x==xy.size.x&&size.y==xy.size.y&&scrollSize.x==xy.scrollSize.x&&scrollSize.y==xy.scrollSize.y&&scroll.x==xy.scroll.x&&scroll.y==xy.scroll.y)}this.xy=xy;!result?this.value=4:this.value|=!(this.value&1)?1:2;if(this.value==7){this.change();this.value=0}},start:function(){this.xy=this.el.getSize();this._check();this._checker=this._check.periodical(80,this)},stop:function(){$clear(this._checker)}});CheckPos_class.implement(new Events);var Overlay_class=new Class({_elem:null,initialize:function(props){props=$merge({styles:{'background-color':'#000000',opacity:0.7,width:'100%',position:'absolute','z-index':70,top:0,left:0,visibility:'hidden'}},props);this._elem=new Element('div',props).injectTop(document.body);this._updateHeight=function(){this._elem.setStyle('height',window.getScrollHeight())}.bind(this)},show:function(){this._updateHeight();this._elem.setStyle('visibility','visible')},hide:function(){this._elem.setStyle('height','0');this._elem.setStyle('visibility','hidden')}});var User_class=new Class({Class:'User_class',auth:0,S:{},gaUidName:'gauid',options:{popup:{tpl:'',parent:false,activeElements:[],hasOverlay:false},signin:{tpl:''},remind:{tpl:''},remind_success:{tpl:''},process:{tpl:''},message:{tpl:'${content}'}},initialize:function(){S.addEvent('loadS4user',this.onLoadS.bind(this));S.addEvent('loadS',function(S){this.onLoadS($defined(S.user)?S.user:null)}.bind(this));S.addEvent('noSID',this.autoSignIn.bind(this));this.addEvent('signIn',this.onSignInCompleted.bind(this));this.addEvent('signIn',this.setLoginCookie.bind(this));this.addEvent('signInFailed',this.onSignInFailed.bind(this))},isAuth:function(){return!!this.auth},isAuthInSocial:function(name){return this.S.accounts!==undefined&&this.S.accounts[name]!==undefined},hasSocialAccount:function(){var account,has_account=false;if(this.S.accounts!=='undefined'){for(account in this.S.accounts){if(this.S.accounts.hasOwnProperty(account)){has_account=true;break}}}return has_account},getProperty:function(name){return $defined(this.S[name])?this.S[name]:''},getEmail:function(){var email=this.getProperty('email');return email||Cookie.get("email")||''},getTitle:function(){return this.getProperty('title')},setPopupParent:function(id){if(!id){id='user-popup-parent'+$random(0,100000);document.write("<div id='"+id+"'></div>")}this.options.popup.parent=$(id)},getPopup:function(){if(!this.popup){with(this.options.popup){this.popup=new Popup_class(tpl,parent);if(this.options.popup.hasOverlay)this.popup.overlayON();for(var name in activeElements){if($defined(this[activeElements[name]]))this.popup.addEvent(name,this[activeElements[name]].bind(this))}}};return this.popup},SignIn:function(Msg){var popup=this.getPopup();popup.setContent(this.options.signin.tpl,this);popup.form.addEvent('submit',function(e){new Event(e).stop();var data={};data.login=$defined(popup.form.login)?popup.form.login.value:'';if(data.login==''){var phone_code=popup.form.getElement('[name="phone_code"]');var phone_number=popup.form.getElement('[name="phone_number"]');if(phone_code&&phone_number){data.login=phone_code.value+phone_number.value}}data.password=popup.form.password.value;if($defined(popup.form.remember)){data.remember=popup.form.remember.value};this.trySignIn(data)}.bind(this));if(Cookie.get('login')&&typeof popup.form.login!=='undefined'){popup.form.login.value=Cookie.get('login')};Msg=Msg?Msg.getContentTpl(this.options.message.tpl):'';popup.open().msg.setHTML(Msg)},checkSignIn:function(text){var Response=new Response_class(text);Response.doAction();if(Response.isError()){this.fireEvent('signInFailed',Response.Message)}else{this.fireEvent('signIn',this.S);App.trackGTMEvent({'eventCategory':'Interactions','eventAction':'signin','eventLabel':'User'})}},onSignInCompleted:function(e){if(this.popup){this.getPopup().close()}Cookie.set(this.gaUidName,this.getProperty('id'),{domain:'rozetka.com.ua',path:'/'})},onSignInFailed:function(e){Cookie.remove('login',{domain:'rozetka.com.ua',path:'/'});Cookie.remove(this.gaUidName,{domain:'rozetka.com.ua',path:'/'});if(this.getPopup().msg){this.getPopup().msg.setHTML(e.getContentTpl(this.options.message.tpl))}App.trackGTMEvent({'eventCategory':'Interactions','eventAction':'signfail','eventLabel':'User'})},trySignIn:function(data){this._sendAjax(data,'signin#SignIn',this.checkSignIn)},checkExists:function(login){this._sendAjax({login:login},'signup#checkExists',function(resp){var Response=new Response_class(resp);this.fireEvent('checkExists',Response)}.bind(this))},_sendAjax:function(data,ajax_action,on_complete_handler){var options={method:'post',onComplete:on_complete_handler.bind(this),headers:{ajaxAction:'https://my.rozetka.com.ua/'+ajax_action}};new Ajax('/cgi-bin/form.php',options).request(data)},Remind:function(Msg){var options={process:this.options.process.tpl,headers:{'ajaxAction':'https://my.rozetka.com.ua/remind-password/#remindPassword'},onComplete:function(resp){popup.form.processStop();var Response=new Response_class(resp);Response.doAction();if(!Response.isError()){popup.setContent(this.options.remind_success.tpl,this);App.trackGTMEvent({'eventCategory':'Interactions','eventAction':'remind','eventLabel':'User'})}popup.msg.setHTML(Response.Message.getContentTpl(this.options.message.tpl))}.bind(this)};var popup=this.getPopup();popup.setContent(this.options.remind.tpl,this);popup.form.addEvent('submit',function(e){new Event(e).stop();this.trySend(options)});if(Cookie.get("login")){popup.form.email.value=Cookie.get("login")};popup.open().msg.setHTML(Msg?Msg.getContent():'')},SignOut:function(){var options={data:{title:'OWOX goodbye:)'},onComplete:function(resp){(new Response_class(resp)).doAction();App.trackGTMEvent({'eventCategory':'Interactions','eventAction':'signout','eventLabel':'User'});Cookie.remove(User.gaUidName,{domain:'rozetka.com.ua',path:'/'})},headers:{'ajaxAction':'https://my.rozetka.com.ua/signout/#SignOut'}};new Ajax('/cgi-bin/form.php',options).request()},onLoadS:function(S){this.S=S||{};if(this.auth!==this.S.auth){this.auth=this.S.auth;this.fireEvent('signChange');if(this.auth){this.fireEvent('signIn',this.S);$(document).fireEvent('signIn',this.S)}else{this.fireEvent('signOut')}}},autoSignIn:function(){if((Cookie.get("p")||Cookie.get("ho_p"))&&Cookie.get("login")){S.renew()}},toggleSignIn:function(){!this.getPopup().isOpened()?this.SignIn():this.getPopup().close()},switchSignInPopup:function(tpl,popup){this.saved_signin_pcontent=this.options.signin.tpl;this.saved_signin_popup=this.popup;this.options.signin.tpl=tpl;this.popup=popup;with(this.options.popup){for(var name in activeElements){if($defined(this[activeElements[name]]))this.popup.addEvent(name,this[activeElements[name]].bind(this))}}},restoreSignInPopup:function(){this.options.signin.tpl=this.saved_signin_pcontent;this.popup=this.saved_signin_popup;this.saved_signin_pcontent=null;this.saved_signin_pparent=null},setLoginCookie:function(){Cookie.set('login',this.getProperty('login'),{duration:183,domain:'rozetka.com.ua',path:'/'})},getVisitorCity:function(){return this.getProperty('visitor_city')||Cookie.get('visitor_city')}});User_class.implement(new Options,new Events);var RozetkaUser_class=User_class.extend({need_oauth_update:true,default_auth_type:'popup',_auth_blocks:null,_auth_blocks_options:{blocks:{simple_auth:'<div name=\"simple_auth\" class=\"hidden\">\n\t<div class=\"auth-f-i\">\n\t\t<div class=\"auth-f-i-title\">\u041f\u0430\u0440\u043e\u043b\u044c<\/div>\n\t\t<input type=\"password\" class=\"input-text auth-input-text\" name=\"password\" _required=\"required\">\n\t\t<div class=\"auth-message hidden\" name=\"wrong_password_block\">\n\t\t\t<h5 class=\"auth-forgot-pass-tooltip-title\" name=\"password_hint\"><\/h5>\n\t\t\t<p class=\"auth-forgot-pass-tooltip-note\">\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0440\u0430\u0441\u043a\u043b\u0430\u0434\u043a\u0443 \u043a\u043b\u0430\u0432\u0438\u0430\u0442\u0443\u0440\u044b \u0438&nbsp;Caps Lock<\/p>\n\t\t\t<p class=\"auth-forgot-pass-tooltip-text\"><a class=\"xhr\" href=\"#\" name=\"send_temp_pass\">\u041f\u0440\u0438\u0448\u043b\u0438\u0442\u0435 \u043c\u043d\u0435 \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c<\/a><br>\n\t\t\t    \u043d\u0430&nbsp;\u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 \u0430\u0434\u0440\u0435\u0441 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0447\u0442\u044b<\/p>\n\t\t<\/div>\n\t\t<div class=\"auth-f-remind-pass\">\n\t\t\t<a href=\"https:\/\/my.rozetka.com.ua\/remind-password\/\" name=\"forgot_button\" class=\"novisited auth-f-remind-pass-link\">\u041d\u0430\u043f\u043e\u043c\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c<\/a>\n\t\t<\/div>\n\t\t<label class=\"checkbox auth-f-i-remember\">\n\t\t\t<input class=\"hidden checkbox-input\" type=\"checkbox\" name=\"remember\" checked=\"checked\" value=\"1\">\n\t\t\t<span class=\"checkbox-label sprite-side auth-f-i-remember-text\">\u0417\u0430\u043f\u043e\u043c\u043d\u0438\u0442\u044c \u043c\u0435\u043d\u044f<\/span>\n\t\t<\/label>\n\t<\/div>\n\t<div class=\"clearfix f-i auth-f-submit\">\n\t\t<div class=\"auth-f-submit-btn\">\n\t\t\t<span class=\"btn-link btn-link-blue\">\n\t\t\t\t<button type=\"submit\" class=\"btn-link-i\" name=\"auth_submit\">\u0412\u043e\u0439\u0442\u0438<\/button>\n\t\t\t<\/span>\n\t\t\t<a href=\"#\" class=\"novisited auth-f-cancel\" name=\"close\">\u041e\u0442\u043c\u0435\u043d\u0430<\/a>\n\t\t<\/div>\n\t<\/div>\n<\/div>'},selectors:{email:'[name="login"]'},blocks_type:'permanent'},social_offer_popup_options:{parent_elem_id:'social_popup',tpl:'<div class=\"social-bind social-bind-tiny\">\n\t<p class=\"social-bind-tiny-header\">\u0421\u0432\u044f\u0436\u0438\u0442\u0435 \u0430\u043a\u043a\u0430\u0443\u043d\u0442 \u0441 \u0441\u043e\u0446\u0441\u0435\u0442\u044f\u043c\u0438<\/p>\n\n\t<div class=\"social-bind-tiny-buttons-box\" name=\"content\"><\/div>\n\n\t<p class=\"social-bind-tiny-text\">\u041c\u044b&nbsp;\u043d\u0435&nbsp;\u043f\u0435\u0440\u0435\u0434\u0430\u0435\u043c \u043d\u0438\u043a\u0430\u043a\u0438\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441\u043e\u0446\u0441\u0435\u0442\u044f\u043c \u0438&nbsp;\u043d\u0435&nbsp;\u043f\u043e\u0441\u0442\u0438\u043c \u043d\u0438\u0447\u0435\u0433\u043e \u0443&nbsp;\u0432\u0430\u0441 \u043d\u0430&nbsp;\u0441\u0442\u0435\u043d\u0435<\/p>\n\n\t<a href=\"#\" class=\"social-bind-tiny-close novisited\" name=\"close\">\u0417\u0430\u043a\u0440\u044b\u0442\u044c<\/a>\n<\/div>',tpl_content:'<span class=\"btn-auth-fb-small\">\n\t<span class=\"btn-link sprite-side\" name=\"social_button_auth_panel\" type=\"facebook\"><\/span>\n<\/span>\n<span class=\"btn-auth-vk-small\">\n\t<span class=\"btn-link sprite-side\" name=\"social_button_auth_panel\" type=\"vkontakte\"><\/span>\n<\/span>',cookie_name:'social_popup',cookie_params:{domain:'rozetka.com.ua',path:'/',duration:'356'}},social_offer_popup:null,_saved_auth_blocks_options:null,initialize:function(){this.parent();this.auth_type=this.default_auth_type;if(S.checkup){this.addEvent('signIn',this.setAuthorizedCustomVar)}else{S.addEvent('loadS',function(){this.addEvent('signIn',this.setAuthorizedCustomVar)}.bind(this))}},SignIn:function(Msg){var popup=this.getPopup();popup.setContent(this.options.signin.tpl,this);if(Cookie.get('login')&&popup.form.login!==undefined){popup.form.login.value=Cookie.get('login')}popup.open();this._auth_blocks=new AuthorizationBlocks_class(popup.form,this._auth_blocks_options);popup.getElements('[name="close"]').each(function(elem){elem.addEvent('click',function(e){new Event(e).stop();popup.close()})});this._auth_blocks.needAuth(Msg);this.updateOAuth()},setLoginCookie:function(){Cookie.set('login',this.getProperty('login'),{duration:183,domain:'rozetka.com.ua',path:'/'})},_sendAjax:function(){try{this.popup.form.processStart(this.options.process.tpl);this.addEvent('signInFailed',function(e){this.popup.form.processStop(this.options.process.tpl)}.bind(this))}catch(e){}this.parent.apply(this,arguments)},switchSignInPopup:function(tpl,popup,auth_block_options){if(auth_block_options){this._saved_auth_blocks_options=this._auth_blocks_options;this._auth_blocks_options=auth_block_options}this.parent(tpl,popup)},restoreSignInPopup:function(){if(this._saved_auth_blocks_options){this._auth_blocks_options=this._saved_auth_blocks_options}this._saved_auth_blocks_options=null;this.parent()},onSignInFailed:function(e){Cookie.remove('login',{domain:'rozetka.com.ua',path:'/'});Cookie.remove(this.gaUidName,{domain:'rozetka.com.ua',path:'/'});App.trackGTMEvent({'eventCategory':'Interactions','eventAction':'signfail','eventLabel':'User','eventError':e.name})},authorize:function(data,onComplete){new Ajax('/cgi-bin/form.php',{data:data,method:'post',headers:{'ajaxAction':'https://my.rozetka.com.ua/signin/#SignIn'},onComplete:onComplete}).request()},setAuthorizedCustomVar:function(e){CustomVars.set('userId',this.S.id);this.setVisitorCustomVar();if(S.is_renew_sended){rozetkaEvents.trackEvent('authorization','success','permanent')}},setVisitorCustomVar:function(city){var visitor_city=city||this.getVisitorCity();if(visitor_city){Cookie.set('visitor_city',visitor_city,{duration:365,domain:'.rozetka.com.ua',path:'/'});CustomVars.set('VisitorCity',visitor_city)}},getVisitorCity:function(){return Cookie.get('visitor_city')||this.getProperty('visitor_city')},getVisitorCityRecord:function(){var record=Cookie.get('visitor_city_record');if(record){record=JSON.parse(record)}return record},isCityAskedBefore:function(){return Cookie.get('is_city_asked')},checkSignIn:function(text){if(this.getPopup().form){this.getPopup().form.processStop()}this.parent(text);this.fireEvent('currentlySignedIn')},SignOut:function(){var options={data:{title:'OWOX goodbye:)'},onComplete:function(resp){(new Response_class(resp)).doAction();OAuth2.setOptions({binding:false});CustomVars.remove('userId');App.trackGTMEvent({'eventCategory':'Interactions','eventAction':'signout','eventLabel':'User','eventLocation':'Head'});Cookie.remove(User.gaUidName,{domain:'rozetka.com.ua',path:'/'})},headers:{'ajaxAction':'https://my.rozetka.com.ua/signout/#SignOut'}};new Ajax('/cgi-bin/form.php',options).request()},changeAuthType:function(type){this.auth_type=type},restoreAuthType:function(){this.auth_type=this.default_auth_type},sendTemporaryPassword:function(email,onComplete){this._sendAjax({email:email},'remind-password#sendTemporaryPassword',onComplete)},updateOAuth:function(){if(this.need_oauth_update){OAuth2.update({});OAuth2.addEvent('login_start',function(e){if(this.popup){this.popup.form.processStart(this.options.process.tpl)}}.bind(this));OAuth2.addEvent('login_success',function(e){if(this.popup){this.popup.close()}}.bind(this));OAuth2.addEvent('login_complete',function(e){if(this.popup){this.popup.form.processStop()}}.bind(this));OAuth2.addEvent('login_failed',function(params){if(this.popup&&this.popup.msg&&params&&params.value){this.popup.msg.innerHTML=params.value}else if(this.popup&&this.popup.msg){this.popup.msg.innerHTML=''}}.bind(this))}},showSocialPopup:function(){if($(this.social_offer_popup_options.parent_elem_id)){if(!this.social_offer_popup){this.social_offer_popup=new Popup_class(this.social_offer_popup_options.tpl,this.social_offer_popup_options.parent_elem_id);this.social_offer_popup.setOptions({closeOnCOS:false,closeOnEsc:false,holdon:true,single:false});this.social_offer_popup.setContent(this.social_offer_popup_options.tpl_content);this.social_offer_popup.addEvent('close',this.onSocialPopupClose.bind(this))}if(location.href!='https://my.rozetka.com.ua/checkout/success/'&&this.social_offer_popup&&!this.social_offer_popup.isOpened()&&this.isAuth()&&!this.hasSocialAccount()&&!Cookie.get(this.social_offer_popup_options.cookie_name)){this.social_offer_popup.open();OAuth2.setOptions({binding:true});OAuth2.update();this.bindSocialErrorHandler();document.fireEvent('showHeaderSocialPopup')}else if(!this.isAuth()&&this.social_offer_popup&&this.social_offer_popup.isOpened()){this.social_offer_popup.close()}if(!this.has_event){OAuth2.addEvent('login_success',this._loginSuccessSocialPopup.bind(this));OAuth2.addEvent('social_unbind',this._socialUnbind.bind(this));this.has_event=true}}},_socialUnbind:function(){Cookie.remove(this.social_offer_popup_options.cookie_name,this.social_offer_popup_options.cookie_params);this.showSocialPopup()},_loginSuccessSocialPopup:function(){if(this.social_offer_popup&&this.social_offer_popup.isOpened()){document.fireEvent('loginSuccessSocialPopup',{extend_event:[{name:'eventContent',value:OAuth2.get('type')}]});this.social_offer_popup.close()}},bindSocialErrorHandler:function(){if(!this.handler_is_binded){OAuth2.addEvent('login_failed',this.showSocialBindError.bind(this));this.handler_is_binded=true}},showSocialBindError:function(params){if(params&&params.value){var popup=new Popup_class('<div class=\"popup-css popup-viewed-auth\">\n\t<a href=\"#\" class=\"popup-close-medium-delivery\" name=\"close\"><img width=\"18\" height=\"18\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"\u00d7\" class=\"popup-close-medium-icon sprite\"><\/a>\n\t<div name=\"content\"><\/div>\n<\/div>');popup.setContent('<div style=\"color:#f00;margin-top:.5em\">${value}<\/div>',params);popup.open()}},onSocialPopupClose:function(){Cookie.set(this.social_offer_popup_options.cookie_name,1,this.social_offer_popup_options.cookie_params)},getEmail:function(){return this.getProperty('email')||Cookie.get("email")||Cookie.get("login")||''},setNeedOAuthUpdate:function(value){this.need_oauth_update=!!value},reLogin:function(data){this._sendAjax(data,'signout/#reLogin',this.checkSignIn)}});var Cart_class=new Class({Class:'Cart_class',options:{xhrNodes:{},cartURL:'https://my.rozetka.com.ua/cart/'},is_updated:0,initialize:function(options){this.setOptions(options);if(S.checkup)this.onLoadS(S);S.addEvent('loadS4cart',this.onLoadS.bind(this));S.addEvent('loadS',function(S){this.onLoadS(S)}.bind(this))},init:function(id){if(!id){id='cart_block'+$random(0,100000);document.write("<div id='"+id+"'></div>")}this.elem=$(id);if(S.checkup)this.update()},onLoadS:function(S){this.S=$defined(S.cart)?S.cart:{purchases:{},total:0};this._prepareS(S);this.update()},_prepareS:function(S){this.S.quantity=0;this.goods={};var goods_id=null;with(this.S)for(var id in purchases){goods_id=purchases[id].goods.id;if(!$defined(this.goods[goods_id]))this.goods[goods_id]=[];this.goods[goods_id][this.goods[goods_id].length]=purchases[id];this.S.quantity+=purchases[id].quantity}},update:function(){if($defined(this.elem)){this.elem.setHTML(App.getHTML(this.options.tpl,this));for(var name in this.options.activeElements){var elem=this.elem.getElement('[name='+name+']');if(elem){elem.addClass('xhr');var cart=this;elem.addEvent('click',function(e){new Event(e).stop();cart.options.activeElements[this.name]()})}}}this.fireEvent('update');this.is_updated=1},doAction:function(action,catalog_item_or_id,goods_id,quantity,kit_id,unit_goods_ids){if(typeof catalog_item_or_id!='object'){var id_purchase=catalog_item_or_id;var data={};if(id_purchase)data.id=id_purchase;if(goods_id)data.goods_id=goods_id;if(quantity)data.quantity=quantity;if(kit_id)data.kit_id=kit_id;if(unit_goods_ids)data.unit_ids=unit_goods_ids}else{var catalog_item=catalog_item_or_id;data=catalog_item.getDataFromSource()}this._sendRequest(action,data)},_sendRequest:function(action,data){var request=new Ajax('/cgi-bin/form.php');var options={data:data,onComplete:this.onActionComplete.bindAsEventListener(request,action),headers:{ajaxAction:this.options.cartURL+'#'+action}};request.setOptions(options).request()},onActionComplete:function(event,action){var Response=new Response_class(this.response.text);var goods_id=this.options.data.goods_id?this.options.data.goods_id:Cart.getPurchase(this.options.data.id).goods.id;Response.doAction();Cart.fireEvent('actionCompleteForGoods'+goods_id);Cart.fireEvent('actionCompleteForPurchase'+this.options.data.id);App.trackGTMEvent({'eventCategory':'Interactions','eventAction':action,'eventLabel':'Cart','eventProductId':goods_id})},empty:function(){return $defined(this.S)?!this.S.quantity:null},getQuantity:function(id){return parseInt(id?($defined(this.goods[id])?this.goods[id][0].quantity:0):this.S.quantity)},getCost:function(id){return parseFloat(id?($defined(this.goods[id])?this.goods[id][0].cost:0):this.S.total)},inPurchases:function(id){return $defined(this.goods)&&$defined(this.goods[id])?this.goods[id].length:0},getPurchase:function(id){return this.S.purchases[id]?this.S.purchases[id]:null},addGoods:function(goods_id){this.doAction('add','',goods_id)},deleteGoods:function(goods_id){this.doAction('delete','',goods_id)},clear:function(){this.doAction('clear')},'delete':function(id){this.doAction('delete',id)},edit:function(id,quantity){this.doAction('edit',id,'',quantity)}});Cart_class.implement(new Options,new Events);var CartPopup_class=Popup_class.extend({options:{tpl:'<div id=\"cart-popup\" class=\"popup-css popup-cart\">\n\t<a href=\"#\" class=\"popup-close\" name=\"close\"><img width=\"37\" height=\"37\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"&times;\" class=\"popup-close-icon sprite\"><\/a>\n\t{if promotion}\n\t\t<header class=\"promo-cart-heading\">\n\t\t\t<h3 class=\"promo-cart-heading-title\">\u0412\u044b \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a \u0430\u043a\u0446\u0438\u0438 \"${promotion.title}\"<\/h3>\n\t\t\t<p class=\"promo-cart-heading-text\">${promotion.cart_popup_text}<\/p>\n\t\t<\/header>\n\t{\/if}\n\t<div name=\"content\"><\/div>\n<\/div>',content:{tpl:'{if !empty()}\n\t<div class=\"wrap-cart-not-empty\">\n\t\t{var added_purchases = getJustAddedPurchases()}\n\t\t{var other_purchases = getOtherPurchases()}\n\n\t\t\n\t\t{if added_purchases.length}\n\t\t\t<h2 class=\"cart-title\">\n\t\t\t    \u0412\u044b \u0434\u043e\u0431\u0430\u0432\u0438\u043b\u0438 \u0442\u043e\u0432\u0430\u0440 \u0432 \u043a\u043e\u0440\u0437\u0438\u043d\u0443\n            <\/h2>\n\n\t\t\t<div class=\"cart-sum-title\">\n                \u0421\u0443\u043c\u043c\u0430\n            <\/div>\n\n\t\t\t{for item in getBasePurchases(added_purchases)}\n\t\t\t\t\t\t{if item.kit && getUnitsPurchases(item.id).length>0}\n\t\t\t<div class=\"cart-kit\">\n\t\t\t\t<div class=\"clearfix cart-i cart-kit-i\" id=\"cart_item${item.id}\"><\/div>\n\t\t\t\t{eval}CartList.toQueueAdd(item.id){\/eval}\n\n\t\t\t\t{for unit in getUnitsPurchases(item.id)}\n\t\t\t\t\t<div class=\"clearfix cart-i cart-kit-i\" id=\"cart_item${unit.id}\"><\/div>\n\t\t\t\t\t{eval}CartList.toQueueAdd(unit.id){\/eval}\n\t\t\t\t{\/for}\n\t\t\t\t{var seller = getSellerByPurchaseId(item.id)}\n\t\t\t\t{if seller && seller.seller_id}\n\t\t\t\t\t<div class=\"clearfix cart-kit-merchant\" name=\"seller_block\" seller_id=\"${seller.seller_id}\" popup_layout=\"bottom\">\n\t\t\t\t\t\t{if seller.logo}\n\t\t\t\t\t\t\t<p class=\"cart-kit-merchant-text-for-logo\">\u041f\u0440\u043e\u0434\u0430\u0432\u0435\u0446<\/p>\n\t\t\t\t\t\t\t{if seller.has_docket && seller.has_docket != 0}\n\t\t\t\t\t\t\t\t<div class=\"cart-kit-merchant-logo\">\n\t\t\t\t\t\t\t\t\t<a href=\"#\" class=\"responsive-img\" name=\"show_seller_info\">${seller.logo}<\/a>\n\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t\t<div class=\"cart-kit-merchant-logo\">\n\t\t\t\t\t\t\t\t\t<span class=\"responsive-img\">${seller.logo}<\/span>\n\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t<p class=\"cart-kit-merchant-text-for-name\">\u041f\u0440\u043e\u0434\u0430\u0432\u0435\u0446<\/p>\n\t\t\t\t\t\t\t<div class=\"cart-kit-merchant-name-wrap\">\n\t\t\t\t\t\t\t\t{if seller.has_docket && seller.has_docket != 0}\n\t\t\t\t\t\t\t\t\t<a class=\"cart-kit-merchant-link sprite-side\" href=\"#\" name=\"show_seller_info\">\n\t\t\t\t\t\t\t\t\t\t<span class=\"dotted\">${seller.title}<\/span>\n\t\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t\t\t<span class=\"cart-kit-merchant-name sprite-side\">${seller.title}<\/span>\n\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t<div name=\"popup_parent\" class=\"pos-fix\"><\/div>\n\t\t\t\t\t<\/div>\n\t\t\t\t{\/if}\n\n\t\t\t\t<div class=\"clearfix cart-kit-total{if item.kit.is_show_full_discount} cart-kit-total-indent{\/if}\">\n\t\t\t\t\t<h3 class=\"cart-kit-total-title\">\u0421\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u044d\u0442\u043e\u0433\u043e \u043a\u043e\u043c\u043f\u043b\u0435\u043a\u0442\u0430<\/h3>\n\n\t\t\t\t\t{if item.kit.is_show_full_discount && (discount = getNotParentDiscounts(item.id, \u0027Goods.Kits\u0027).pop())}\n\t\t\t\t\t\t{var discount_value = item.kit.price_without_discount * item.quantity - item.kit.costKit}\n\t\t\t\t\t\t{if item.kit.percent_discount > 0 || discount_value > 0}\n\t\t\t\t\t\t\t<div class=\"cart-kit-uah-old\">\n\t\t\t\t\t\t\t\t<span name=\"old_sum\">${(discount.raw_data.cost_without_discount * item.quantity).toString().toPriceFormat()}<\/span>\n\t\t\t\t\t\t\t\t<span class=\"cart-kit-uah-old-sign\">${item.cost.primary.unit}<\/span>\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t{if item.kit.percent_discount > 0}\n\t\t\t\t\t\t\t<span class=\"cart-kit-discount-label\">&minus;&nbsp;${item.kit.percent_discount}<span class=\"cart-kit-discount-label-sign\">%<\/span><\/span>\n\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t{if discount_value > 0}\n\t\t\t\t\t\t\t\t<span class=\"cart-kit-discount-label\">\n\t\t\t\t\t\t\t\t\t&minus;&nbsp;<span name=\"absolute_discount\">${discount_value}<\/span>\n\t\t\t\t\t\t\t\t\t<span class=\"cart-kit-discount-label-sign\">${item.cost.primary.unit}<\/span>\n\t\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t{\/if}\n\t\t\t\t\t{\/if}\n\t\t\t\t\t<div class=\"cart-kit-uah\">\n\t\t\t\t\t\t<span name=\"sum\">${(item.kit.costKit).toString().toPriceFormat()}<\/span>\n\t\t\t\t\t\t<span class=\"cart-kit-uah-sign\">${item.cost.primary.unit}<\/span>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t{else}\n\t\t\t<div class=\"clearfix cart-i{if item.just_added} cart-added{\/if} active\" id=\"cart_item${item.id}\"><\/div>\n\t\t\t{eval}CartList.toQueueAdd(item.id){\/eval}\n\t\t{\/if}\n\t\t\n\t\t\t{\/for}\n\t\t{else}\n\t\t\t<h2 class=\"cart-title\">\n\t\t\t    \u041a\u043e\u0440\u0437\u0438\u043d\u0430\n            <\/h2>\n\n            <div class=\"cart-sum-title\">\n                \u0421\u0443\u043c\u043c\u0430\n            <\/div>\n\t\t{\/if}\n\n\t\t{if other_purchases.length}\n\t\t\t<div class=\"cart-other\">\n\t\t\t\t{if added_purchases.length}<h3 class=\"cart-other-title\">\u0414\u0440\u0443\u0433\u0438\u0435 \u0442\u043e\u0432\u0430\u0440\u044b \u0432 \u043a\u043e\u0440\u0437\u0438\u043d\u0435<\/h3>{\/if}\n\t\t\t\t{for item in getBasePurchases(other_purchases).reverse()}\n\t\t\t\t\t\t\t{if item.kit && getUnitsPurchases(item.id).length>0}\n\t\t\t<div class=\"cart-kit\">\n\t\t\t\t<div class=\"clearfix cart-i cart-kit-i\" id=\"cart_item${item.id}\"><\/div>\n\t\t\t\t{eval}CartList.toQueueAdd(item.id){\/eval}\n\n\t\t\t\t{for unit in getUnitsPurchases(item.id)}\n\t\t\t\t\t<div class=\"clearfix cart-i cart-kit-i\" id=\"cart_item${unit.id}\"><\/div>\n\t\t\t\t\t{eval}CartList.toQueueAdd(unit.id){\/eval}\n\t\t\t\t{\/for}\n\t\t\t\t{var seller = getSellerByPurchaseId(item.id)}\n\t\t\t\t{if seller && seller.seller_id}\n\t\t\t\t\t<div class=\"clearfix cart-kit-merchant\" name=\"seller_block\" seller_id=\"${seller.seller_id}\" popup_layout=\"bottom\">\n\t\t\t\t\t\t{if seller.logo}\n\t\t\t\t\t\t\t<p class=\"cart-kit-merchant-text-for-logo\">\u041f\u0440\u043e\u0434\u0430\u0432\u0435\u0446<\/p>\n\t\t\t\t\t\t\t{if seller.has_docket && seller.has_docket != 0}\n\t\t\t\t\t\t\t\t<div class=\"cart-kit-merchant-logo\">\n\t\t\t\t\t\t\t\t\t<a href=\"#\" class=\"responsive-img\" name=\"show_seller_info\">${seller.logo}<\/a>\n\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t\t<div class=\"cart-kit-merchant-logo\">\n\t\t\t\t\t\t\t\t\t<span class=\"responsive-img\">${seller.logo}<\/span>\n\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t<p class=\"cart-kit-merchant-text-for-name\">\u041f\u0440\u043e\u0434\u0430\u0432\u0435\u0446<\/p>\n\t\t\t\t\t\t\t<div class=\"cart-kit-merchant-name-wrap\">\n\t\t\t\t\t\t\t\t{if seller.has_docket && seller.has_docket != 0}\n\t\t\t\t\t\t\t\t\t<a class=\"cart-kit-merchant-link sprite-side\" href=\"#\" name=\"show_seller_info\">\n\t\t\t\t\t\t\t\t\t\t<span class=\"dotted\">${seller.title}<\/span>\n\t\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t\t\t<span class=\"cart-kit-merchant-name sprite-side\">${seller.title}<\/span>\n\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t<div name=\"popup_parent\" class=\"pos-fix\"><\/div>\n\t\t\t\t\t<\/div>\n\t\t\t\t{\/if}\n\n\t\t\t\t<div class=\"clearfix cart-kit-total{if item.kit.is_show_full_discount} cart-kit-total-indent{\/if}\">\n\t\t\t\t\t<h3 class=\"cart-kit-total-title\">\u0421\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u044d\u0442\u043e\u0433\u043e \u043a\u043e\u043c\u043f\u043b\u0435\u043a\u0442\u0430<\/h3>\n\n\t\t\t\t\t{if item.kit.is_show_full_discount && (discount = getNotParentDiscounts(item.id, \u0027Goods.Kits\u0027).pop())}\n\t\t\t\t\t\t{var discount_value = item.kit.price_without_discount * item.quantity - item.kit.costKit}\n\t\t\t\t\t\t{if item.kit.percent_discount > 0 || discount_value > 0}\n\t\t\t\t\t\t\t<div class=\"cart-kit-uah-old\">\n\t\t\t\t\t\t\t\t<span name=\"old_sum\">${(discount.raw_data.cost_without_discount * item.quantity).toString().toPriceFormat()}<\/span>\n\t\t\t\t\t\t\t\t<span class=\"cart-kit-uah-old-sign\">${item.cost.primary.unit}<\/span>\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t{if item.kit.percent_discount > 0}\n\t\t\t\t\t\t\t<span class=\"cart-kit-discount-label\">&minus;&nbsp;${item.kit.percent_discount}<span class=\"cart-kit-discount-label-sign\">%<\/span><\/span>\n\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t{if discount_value > 0}\n\t\t\t\t\t\t\t\t<span class=\"cart-kit-discount-label\">\n\t\t\t\t\t\t\t\t\t&minus;&nbsp;<span name=\"absolute_discount\">${discount_value}<\/span>\n\t\t\t\t\t\t\t\t\t<span class=\"cart-kit-discount-label-sign\">${item.cost.primary.unit}<\/span>\n\t\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t{\/if}\n\t\t\t\t\t{\/if}\n\t\t\t\t\t<div class=\"cart-kit-uah\">\n\t\t\t\t\t\t<span name=\"sum\">${(item.kit.costKit).toString().toPriceFormat()}<\/span>\n\t\t\t\t\t\t<span class=\"cart-kit-uah-sign\">${item.cost.primary.unit}<\/span>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t{else}\n\t\t\t<div class=\"clearfix cart-i{if item.just_added} cart-added{\/if} active\" id=\"cart_item${item.id}\"><\/div>\n\t\t\t{eval}CartList.toQueueAdd(item.id){\/eval}\n\t\t{\/if}\n\t\t\n\t\t\t\t{\/for}\n\t\t\t<\/div>\n\t\t{\/if}\n\t\t<div class=\"clearfix cart-total\">\n\t\t\t<span class=\"cart-return-link\">\n\t\t\t\t<span class=\"btn-link btn-link-gray\">\n\t\t\t\t\t<a href=\"#\" class=\"btn-link-i\" name=\"close\" onclick=\"document.fireEvent(\u0027clickContinueShopping\u0027);\">\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c \u043f\u043e\u043a\u0443\u043f\u043a\u0438<\/a>\n\t\t\t\t<\/span>\n\t\t\t<\/span>\n\n\t\t\t<div class=\"cart-total-label\">\n\t\t\t\t<div id=\"cart_payment_info\">\n\t\t\t\t\t<div class=\"cart-total-sum\" name=\"total\">\n\t\t\t\t\t\t<span class=\"cart-total-title\">\u0418\u0442\u043e\u0433\u043e:<\/span>\n\t\t\t\t\t\t<span class=\"cart-total-uah\"><span name=\"cost\">${S.cost_with_discount.primary.decimals}<\/span>&nbsp;<span class=\"cart-total-uah-sign\">${S.cost.primary.unit}<\/span><\/span>\n\t\t\t\t\t<\/div>\n\t\t\t\t\t<form id=\"drop-block\" method=\"GET\" action=\"https:\/\/my.rozetka.com.ua\/checkout\/\">\n\t\t\t\t\t\t<span class=\"cart-submit\">\n\t\t\t\t\t\t\t<span class=\"btn-link-green btn-link\">\n\t\t\t\t\t\t\t\t<button class=\"btn-link-i\" id=\"popup-checkout\" type=\"submit\">\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437<\/button>\n\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t<\/span>\n\t\t\t\t\t<\/form>\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t<\/div>\n\n\t\t{if getCountKits()}\n\t\t\t<div name=\"kits_items\" class=\"cart-kit-slider-wrap\">\n\t\t\t\t{if getCountKits()}\n\t<div id=\"anchor_kits_scroller\">\n\n\t{var max_count_item = 4}\n\n\t\t<div class=\"g-kit-slider\" name=\"kits_scroller_cart\" _action=\"kits_scroller_cart\">\n\t\t\t<div class=\"pos-fix\" name=\"screen\">\n\t\t\t\t<a class=\"sprite-side cart-g-kit-slider-al\" data-direction=\"left\" href=\"#\" name=\"kits_control\">&lt;<\/a>\n\t\t\t\t<a class=\"sprite-side cart-g-kit-slider-ar\" data-direction=\"right\" href=\"#\" name=\"kits_control\">&gt;<\/a>\n\t\t\t\t<div class=\"cart-g-kit-slider-inner\">\n\t\t\t\t\t<div class=\"clearfix g-kit-slider-sliding-box\" name=\"kits_container\">\n\t\t\t\t\t{var k_index = 1}\n\t\t\t\t\t{for kit in S.kits}\n\t\t\t\t\t\t<div name=\"kits_item\" style=\"float: left;\">\n\t\t\t\t\t\t\t<div class=\"cart-g-kit-slider-i g-kit-slide-item${kit.count_accessories} kit_${kit.id}\" style=\"height: inherit;\">\n\t\t\t\t\t\t\t<h3 class=\"cart-g-kit-slider-i-title\">\n\t\t\t\t\t\t\t\t{if kit.tag == \u0027action\u0027}\n\t\t\t\t\t\t\t\t\t\u0412\u043c\u0435\u0441\u0442\u0435 \u0434\u0435\u0448\u0435\u0432\u043b\u0435\n\t\t\t\t\t\t\t\t{elseif kit.tag == \u0027assembly\u0027}\n\t\t\t\t\t\t\t\t\t\u0420\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u043c \u043f\u043e\u043a\u0443\u043f\u0430\u0442\u044c \u0432\u043c\u0435\u0441\u0442\u0435\n\t\t\t\t\t\t\t\t{elseif kit.tag == \u0027often_buy\u0027}\n\t\t\t\t\t\t\t\t\t\u0427\u0430\u0441\u0442\u043e \u043f\u043e\u043a\u0443\u043f\u0430\u044e\u0442 \u0432\u043c\u0435\u0441\u0442\u0435\n\t\t\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t\t\t\u0420\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u043c \u043a\u0443\u043f\u0438\u0442\u044c \u043a\u043e\u043c\u043f\u043b\u0435\u043a\u0442 \u0441\u043e&nbsp;\u0441\u043a\u0438\u0434\u043a\u043e\u0439 \u043d\u0430&nbsp;\u0430\u043a\u0441\u0435\u0441\u0441\u0443\u0430\u0440\u044b\n\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t<\/h3>\n\n\t\t\t\t\t\t\t<div class=\"aligned-center\">\n\t\t\t\t\t\t\t\t{if kit.count_accessories == 1}\n\t\t\t\t\t\t\t\t\t{var i = 0}\n\n\t\t\t\t\t\t\t\t\t{var base_goods_id=kit.base_goods_id}\n\t\t\t\t\t\t\t\t\t{for purchase in goods[base_goods_id]}\n\t\t\t\t\t\t\t\t\t\t{var base_goods=purchase.goods}\n\n\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-i cart-g-kit-i cart-g-kit-i-${kit.count_accessories}\">\n\t\t\t\t\t\t\t\t\t\t\t{if kit.base_goods_discount_price && kit.base_goods_discount_price.percent_discount > 0 && !kit.is_show_full_discount}\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"unit-discount\"><b>&minus;&nbsp;${kit.base_goods_discount_price.percent_discount}<\/b>%<\/span>\n\t\t\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-i-img\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-i-img-inner\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"responsive-img g-i-img-link\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\thref=\"${base_goods.href}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonclick=\"document.fireEvent(\u0027goodsImageClick\u0027,{extend_event:[{name:\u0027goods_id\u0027,value:${base_goods.id}}, {name:\u0027eventLocation\u0027,value: \u0027kit\u0027}, {name: \u0027eventPosition\u0027, value: ${k_index}}]})\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img src=\"${base_goods.attachments.images[0].medium.url}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t width=\"${base_goods.attachments.images[0].medium.width}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t height=\"${base_goods.attachments.images[0].medium.height}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t alt=\"${base_goods.title|escape}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t class=\"centering-img\"\/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-i-inner ${base_goods.sell_status}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-title\">\u0412\u0430\u0448 \u0442\u043e\u0432\u0430\u0440<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-i-title\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\t\t\t\t\thref=\"${base_goods.href}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonclick=\"document.fireEvent(\u0027goodsTitleClick\u0027,{extend_event:[{name:\u0027goods_id\u0027,value:${base_goods.id}}, {name:\u0027eventLocation\u0027,value: \u0027kit\u0027}, {name: \u0027eventPosition\u0027, value: ${k_index}}]})\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"novisited\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t>${base_goods.title}<\/a>\n\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t{if kit.is_show_full_discount}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-price\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-price-uah g-kit-price-uah\">${base_goods.price}&thinsp;\u0433\u0440\u043d.<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t\t\t\t\t\t\t{if kit.base_goods_discount_price}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{if base_goods.price > kit.base_goods_discount_price.primary.raw}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-price-old g-price-old\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-price-old-inner\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-price-old-uah g-kit-price-uah\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t${base_goods.price.toString().toPriceFormat()}&thinsp;\u0433\u0440\u043d.\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-price g-price-cheaper\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-price-uah g-kit-price-uah\">${kit.base_goods_discount_price.primary.string}<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-price\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-price-uah g-kit-price-uah\">${kit.base_goods_discount_price.primary.string}<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t<\/div>\n\n\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-sign\">\n\t\t\t\t\t\t\t\t\t\t\t<img width=\"25\" height=\"25\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"plus sign\" class=\"g-kit-plus-sign-img sprite\">\n\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t{eval}i++{\/eval}\n\n\t\t\t\t\t\t\t\t\t{\/for}\n\n\t\t\t\t\t\t\t\t\t{for kit_accessory in kit.accessories}\n\t\t\t\t\t\t\t\t\t\t{if i < max_count_item}\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-i cart-g-kit-i cart-g-kit-i-${kit.count_accessories}{if kit_accessory.sell_status} ${kit_accessory.sell_status}{\/if}\">\n\t\t\t\t\t\t\t\t\t\t\t\t{if kit_accessory.goods_percent_discount > 0 && !kit.is_show_full_discount}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"unit-discount\"><b>&minus;&nbsp;${kit_accessory.goods_percent_discount}<\/b>%<\/span>\n\t\t\t\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-i-wrap clearfix\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-i-img\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-i-img-inner\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"responsive-img g-i-img-link\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thref=\"${kit_accessory.href}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonclick=\"document.fireEvent(\u0027goodsImageClick\u0027,{extend_event:[{name:\u0027goods_id\u0027,value:${kit_accessory.id}}, {name:\u0027eventLocation\u0027,value: \u0027kit\u0027}, {name: \u0027eventPosition\u0027, value: ${k_index}}]})\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img src=\"${kit_accessory.attachments.images[0].medium.url}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"${kit_accessory.attachments.images[0].medium.width}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\theight=\"${kit_accessory.attachments.images[0].medium.height}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talt=\"${kit_accessory.title|escape}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"centering-img\"\/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-i-inner{if kit_accessory.sell_status} ${kit_accessory.sell_status}{\/if}\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-i-title\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thref=\"${kit_accessory.href}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonclick=\"document.fireEvent(\u0027goodsTitleClick\u0027,{extend_event:[{name:\u0027goods_id\u0027,value:${kit_accessory.id}}, {name:\u0027eventLocation\u0027,value: \u0027kit\u0027}, {name: \u0027eventPosition\u0027, value: ${k_index}}]})\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"novisited\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>${kit_accessory.title}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{if !kit.is_show_full_discount}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{if kit_accessory.price > kit_accessory.goods_discount_price.primary.decimals}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-price-old g-price-old\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-price-old-inner\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-price-old-uah g-kit-price-uah\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t${kit_accessory.price.toString().toPriceFormat()}&thinsp;\u0433\u0440\u043d.\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-price g-price-cheaper\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-price-uah g-kit-price-uah\">${kit_accessory.goods_discount_price.primary.decimals}&thinsp;\u0433\u0440\u043d.<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-price\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-price-uah g-kit-price-uah\">${kit_accessory.goods_discount_price.primary.decimals}&thinsp;\u0433\u0440\u043d.<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-price\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-price-uah g-kit-price-uah\">${kit_accessory.price}&thinsp;\u0433\u0440\u043d.<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t{if kit_accessory.sell_status == \u0027limited\u0027}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-i-status g-kit-i-status{if kit_accessory.sell_status} ${kit_accessory.sell_status}{\/if}\">\u0417\u0430\u043a\u0430\u043d\u0447\u0438\u0432\u0430\u0435\u0442\u0441\u044f<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t{if i < kit.count_accessories && i < max_count_item -1}\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-sign\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<img width=\"25\" height=\"25\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"plus sign\" class=\"g-kit-plus-sign-img sprite\">\n\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t\t\t\t{eval}i++{\/eval}\n\t\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t\t{\/for}\n\t\t\t\t\t\t\t\t\t<div class=\"g-kit-sign\">\n\t\t\t\t\t\t\t\t\t\t<img width=\"25\" height=\"11\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"plus equal\" class=\"g-kit-equal-sign-img sprite\">\n\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t<div class=\"g-kit-total-price\" id=\"catalog_item${kit.base_goods_id}\" name=\"catalog_item\" _value=\"catalog_item${kit.base_goods_id}\" _number=\"${k_index}\">\n\t\t\t\t\t\t\t\t\t\t{if kit.is_show_full_discount && kit.cost_without_kit.primary.raw > kit.cost.primary.raw}\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-total-price-uah-old\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div>${kit.cost_without_kit.primary.decimals}&thinsp;${kit.cost_without_kit.primary.unit}<\/div>\n\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t{if kit.kit_percent_discount > 0}\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"unit-discount-total\"><b>&minus;&nbsp;${kit.kit_percent_discount}<\/b>%<\/span>\n\t\t\t\t\t\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"unit-discount-total\"><b>&minus;&nbsp;${Math.round(kit.cost_without_kit.primary.raw - kit.cost.primary.raw)}<\/b>&thinsp;\u0433\u0440\u043d.<\/span>\n\t\t\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-total-price-uah\" name=\"price\">\n\t\t\t\t\t\t\t\t\t\t\t${kit.cost.primary.decimals}<span class=\"g-kit-total-price-uah-sign\">&thinsp;${kit.cost.primary.unit}<\/span>\n\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"aligned-center\" name=\"buy_kit_from_cart\"><\/div>\n\t\t\t\t\t\t\t\t\t<\/div>\n\n\t\t\t\t\t\t\t\t{else}\n\n\t\t\t\t\t\t\t\t\t{var i = 0}\n\n\t\t\t\t\t\t\t\t\t{var base_goods_id=kit.base_goods_id}\n\t\t\t\t\t\t\t\t\t{for purchase in goods[base_goods_id]}\n\t\t\t\t\t\t\t\t\t\t{var base_goods=purchase.goods}\n\n\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-i cart-g-kit-i cart-g-kit-i-${kit.count_accessories}\">\n\t\t\t\t\t\t\t\t\t\t\t{if kit.base_goods_discount_price && kit.base_goods_discount_price.percent_discount > 0 && !kit.is_show_full_discount}\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"unit-discount\"><b>&minus;&nbsp;${kit.base_goods_discount_price.percent_discount}<\/b>%<\/span>\n\t\t\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-i-wrap clearfix\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-i-img\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"cart-g-kit-i-img-inner\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"responsive-img g-i-img-link\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thref=\"${base_goods.href}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonclick=\"document.fireEvent(\u0027goodsImageClick\u0027,{extend_event:[{name:\u0027goods_id\u0027,value:${base_goods.id}}, {name:\u0027eventLocation\u0027,value: \u0027kit\u0027}, {name: \u0027eventPosition\u0027, value: ${k_index}}]})\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img src=\"${base_goods.attachments.images[0].medium.url}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t width=\"${base_goods.attachments.images[0].medium.width}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t height=\"${base_goods.attachments.images[0].medium.height}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t alt=\"${base_goods.title|escape}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t class=\"centering-img\"\/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"cart-g-kit-i-inner{if base_goods.sell_status} ${base_goods.sell_status}{\/if}\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-price\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-price-uah g-kit-price-uah\">${base_goods.price}&thinsp;\u0433\u0440\u043d.<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-title\">\u0412\u0430\u0448 \u0442\u043e\u0432\u0430\u0440<\/div>\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-i-title\">\n\t\t\t\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\t\t\t\thref=\"${base_goods.href}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tonclick=\"document.fireEvent(\u0027goodsTitleClick\u0027,{extend_event:[{name:\u0027goods_id\u0027,value:${base_goods.id}}, {name:\u0027eventLocation\u0027,value: \u0027kit\u0027}, {name: \u0027eventPosition\u0027, value: ${k_index}}]})\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"novisited\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t${base_goods.title}\n\t\t\t\t\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-sign\">\n\t\t\t\t\t\t\t\t\t\t\t<img width=\"25\" height=\"25\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"plus sign\" class=\"g-kit-plus-sign-img sprite\">\n\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t{eval}i++{\/eval}\n\n\t\t\t\t\t\t\t\t\t{\/for}\n\n\t\t\t\t\t\t\t\t\t{for kit_accessory in kit.accessories}\n\t\t\t\t\t\t\t\t\t\t{if i < max_count_item}\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-i cart-g-kit-i cart-g-kit-i-${kit.count_accessories}{if kit_accessory.sell_status} ${kit_accessory.sell_status}{\/if}\">\n\t\t\t\t\t\t\t\t\t\t\t\t{if kit_accessory.goods_percent_discount > 0 && !kit.is_show_full_discount}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"unit-discount\"><b>&minus;&nbsp;${kit_accessory.goods_percent_discount}<\/b>%<\/span>\n\t\t\t\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-i-wrap clearfix\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-i-img\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"cart-g-kit-i-img-inner\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"responsive-img g-i-img-link\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thref=\"${kit_accessory.href}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonclick=\"document.fireEvent(\u0027goodsImageClick\u0027,{extend_event:[{name:\u0027goods_id\u0027,value:${kit_accessory.id}}, {name:\u0027eventLocation\u0027,value: \u0027kit\u0027}, {name: \u0027eventPosition\u0027, value: ${k_index}}]})\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img src=\"${kit_accessory.attachments.images[0].medium.url}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t width=\"${kit_accessory.attachments.images[0].medium.width}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t height=\"${kit_accessory.attachments.images[0].medium.height}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t alt=\"${kit_accessory.title|escape}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t class=\"centering-img\"\/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"cart-g-kit-i-inner{if kit_accessory.sell_status} ${kit_accessory.sell_status}{\/if}\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{if !kit.is_show_full_discount}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{if kit_accessory.price > kit_accessory.goods_discount_price.primary.decimals}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-price-old g-price-old\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-price-old-inner\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-price-old-uah g-kit-price-uah\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t${kit_accessory.price.toString().toPriceFormat()}&thinsp;\u0433\u0440\u043d.\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-price g-price-cheaper\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div name=\"price\" class=\"g-price-uah g-kit-price-uah\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t${kit_accessory.goods_discount_price.primary.decimals}&thinsp;\u0433\u0440\u043d.\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-price\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div name=\"price\" class=\"g-price-uah g-kit-price-uah\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t${kit_accessory.goods_discount_price.primary.decimals}&thinsp;\u0433\u0440\u043d.\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-price\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-price-uah g-kit-price-uah\">${kit_accessory.price}&thinsp;\u0433\u0440\u043d.<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-i-title\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\t\t\t\t\thref=\"${kit_accessory.href}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonclick=\"document.fireEvent(\u0027goodsTitleClick\u0027,{extend_event:[{name:\u0027goods_id\u0027,value:${kit_accessory.id}}, {name:\u0027eventLocation\u0027,value: \u0027kit\u0027}, {name: \u0027eventPosition\u0027, value: ${k_index}}]})\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"novisited\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t${kit_accessory.title}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t{if kit_accessory.sell_status == \u0027limited\u0027}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-i-status g-kit-i-status{if kit_accessory.sell_status} ${kit_accessory.sell_status}{\/if}\">\u0417\u0430\u043a\u0430\u043d\u0447\u0438\u0432\u0430\u0435\u0442\u0441\u044f<\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\n\t\t\t\t\t\t\t\t\t\t\t{if i < kit.count_accessories && i < max_count_item -1}\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-sign\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<img width=\"25\" height=\"25\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"plus sign\" class=\"g-kit-plus-sign-img sprite\">\n\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t{\/if}\n\n\t\t\t\t\t\t\t\t\t\t\t{eval}i++{\/eval}\n\t\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t\t{\/for}\n\n\t\t\t\t\t\t\t\t\t<div class=\"g-kit-total-price\" id=\"catalog_item${kit.base_goods_id}\" name=\"catalog_item\" _value=\"catalog_item${kit.base_goods_id}\" _number=\"${k_index}\">\n\t\t\t\t\t\t\t\t\t\t{if kit.is_show_full_discount && kit.cost_without_kit.primary.raw > kit.cost.primary.raw}\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-total-price-uah-old\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div>${kit.cost_without_kit.primary.decimals}&thinsp;${kit.cost_without_kit.primary.unit}<\/div>\n\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t\t{if kit.kit_percent_discount > 0}\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"unit-discount-total\"><b>&minus;&nbsp;${kit.kit_percent_discount}<\/b>%<\/span>\n\t\t\t\t\t\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"unit-discount-total\"><b>&minus;&nbsp;${Math.round(kit.cost_without_kit.primary.raw - kit.cost.primary.raw)}<\/b>&thinsp;\u0433\u0440\u043d.<\/span>\n\t\t\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t\t\t<div class=\"g-kit-total-price-uah\" name=\"price\">\n\t\t\t\t\t\t\t\t\t\t\t${kit.cost.primary.decimals}<span class=\"g-kit-total-price-uah-sign\">&thinsp;${kit.cost.primary.unit}<\/span>\n\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"aligned-center\" name=\"buy_kit_from_cart\"><\/div>\n\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t<\/div>\n\n\t\t\t\t\t\t\t<div name=\"kit_id\" style=\"display: none\">${kit.id}<\/div>\n\t\t\t\t\t\t\t<div name=\"kit_number\" style=\"display: none\">${k_index}<\/div>\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t{var k_index = k_index+1}\n\t\t\t\t\t\t${GTMEventsData.setGoodsDataOnce(kit.id,\u0027price_usd\u0027,kit.cost.USD.raw,\u0027kit\u0027)}\n\t\t\t\t\t{\/for}\n\t\t\t\t\t${setGoodsCatalogForCart(GoodsCatalog)}\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\t{if getCountKits() > 1}\n\n\t\t\t\t<nav class=\"paginator\" role=\"navigation\">\n\t\t\t\t\t<ul class=\"paginator-l\" name=\"pages\"><\/ul>\n\t\t\t\t<\/nav>\n\n\t\t\t{\/if}\n\n\t\t<\/div>\n\t<\/div>\n{\/if}\t\t\t<\/div>\n\t\t{else}\n\t\t\t<div name=\"accessories_items\">\n\t\t\t\t{if getCountAccessories()}\n<div class=\"cart-recommend\">\n\t<h1 class=\"cart-recommend-title\">\u0422\u0430\u043a\u0436\u0435 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u043c<\/h1>\n\t<div class=\"clearfix slider\" name=\"accessories_scroller_cart\" _action=\"accessories_scroller_cart\">\n\t\t<a class=\"sprite-side slider-al hidden\" data-direction=\"left\" href=\"#\" name=\"accessories_control\">&lt;<\/a>\n\t\t<a class=\"sprite-side slider-ar\" data-direction=\"right\" href=\"#\" name=\"accessories_control\">&gt;<\/a>\n\n\t\t<div class=\"cart-recommend-inner\">\n\t\t\t<div class=\"slider-sliding-box\" name=\"accessories-container\">\n\n\t\t\t\t{var index = 1}\n\t\t\t\t{for accessory in getAccessories()}\n\t\t\t\t<div class=\"slider-i-td\">\n\t\t\t\t\t<div name=\"accessories_item\" class=\"slider-i ${accessory.sell_status}\">\n\t\t\t\t\t\t<div class=\"g-buy\" id=\"catalog_item${accessory.id}\" name=\"catalog_item\" _value=\"catalog_item${accessory.id}\" _position=\"${index}\">\n\t\t\t\t\t\t\t<div name=\"buy_cart\"><\/div>\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t<figure class=\"cart-g-img\">\n\t\t\t\t\t\t\t<div class=\"g-img-inner g-img-inner-150\">\n\t\t\t\t\t\t\t\t<span class=\"inline pos-fix\">\n\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\thref=\"${accessory.href}\"\n\t\t\t\t\t\t\t\t\t\tclass=\"g-i-img-link\"\n\t\t\t\t\t\t\t\t\t\tonclick=\"document.fireEvent(\u0027goodsImageClick\u0027, {extend_event: [{name: \u0027goods_id\u0027, value: ${accessory.id}}, {name: \u0027eventLocation\u0027, value: \u0027recommended\u0027}, {name: \u0027eventPosition\u0027, value: ${index}}]})\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<img class=\"cart-recommend-i-img\" src=\"${accessory.attachments.url}\" width=\"${accessory.attachments.width}\" height=\"${accessory.attachments.height}\" alt=\"${accessory.title}\" title=\"${accessory.title}\" style=\"border: none; visibility: visible; zoom: 1; opacity: 1;\">\n\t\t\t\t\t\t\t\t\t\t<span class=\"g-id\"><\/span>\n\t\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t<\/figure>\n\t\t\t\t\t\t<div class=\"g-content\">\n\t\t\t\t\t\t\t<div class=\"g-title\">\n\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\thref=\"${accessory.href}\"\n\t\t\t\t\t\t\t\t\tclass=\"g-title-link novisited\"\n\t\t\t\t\t\t\t\t\tonclick=\"document.fireEvent(\u0027goodsTitleClick\u0027, {extend_event: [{name: \u0027goods_id\u0027, value: ${accessory.id}}, {name: \u0027eventLocation\u0027, value: \u0027recommended\u0027}, {name: \u0027eventPosition\u0027, value: ${index}}]})\"\n\t\t\t\t\t\t\t\t>${accessory.title}<\/a>\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t<div class=\"g-price\" name=\"prices_active_element_original\">\n\t\t\t\t\t\t\t\t<div class=\"g-price-uah\">\n\t\t\t\t\t\t\t\t\t${accessory.price}<span class=\"g-price-uah-sign\">&thinsp;\u0433\u0440\u043d.<\/span>\n\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t{if accessory.users_rating}\n\t\t\t\t\t\t\t\t<div class=\"g-rating\">\n\t\t\t\t\t\t\t\t\t{if accessory.comments > 0}\n\t\t\t\t\t\t\t\t\t\t<a class=\"g-rating-reviews-link\" href=\"${accessory.href}comments\/\">\n\t\t\t\t\t\t\t\t\t\t\t{if accessory.users_rating > 0}\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"sprite g-rating-stars\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"sprite g-rating-stars-i\" style=\"width:${accessory.users_rating*20}%\"><\/span>\n\t\t\t\t\t\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"g-rating-reviews\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t${accessory.comments} \u043e\u0442\u0437\u044b\u0432${accessory.comments|morphology:[\"\", \"\u0430\", \"\u043e\u0432\"]}\n\t\t\t\t\t\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"g-rating-reviews\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"g-rating-none sprite-side\">${accessory.comments} \u043e\u0442\u0437\u044b\u0432${accessory.comments|morphology:[\"\", \"\u0430\", \"\u043e\u0432\"]}<\/span>\n\t\t\t\t\t\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t\t{eval}index++{\/eval}\n\t\t\t\t{\/for}\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/div>\n<\/div>\n{\/if}\t\t\t<\/div>\n\t\t{\/if}\n\n\t<\/div>\n{else}\n\t<div class=\"wrap-cart-empty\">\n\t\t<div id=\"drop-block\" class=\"aligned-center\">\n\t\t\t{if location.hash == \u0027#clearcart\u0027}\n\t\t\t\t<h2 class=\"empty-cart-title inline sprite-side\">\u041a\u043e\u0440\u0437\u0438\u043d\u0430 \u043e\u0447\u0438\u0449\u0435\u043d\u0430<\/h2>\n\t\t\t{else}\n\t\t\t\t<h2 class=\"empty-cart-title inline sprite-side\">\u041a\u043e\u0440\u0437\u0438\u043d\u0430 \u043f\u0443\u0441\u0442\u0430<\/h2>\n\t\t\t{\/if}\n\t\t\t{if options.message.content}\n\t\t\t\t${options.message.content}\n\t\t\t{\/if}\n\t\t<\/div>\n\t\t<div name=\"promotions_items\">\n\t\t\t{if getCountPromotions()}\n\t<div class=\"cart-remark-title\">\n\t\t\u041d\u043e \u044d\u0442\u043e \u043d\u0438\u043a\u043e\u0433\u0434\u0430 \u043d\u0435 \u043f\u043e\u0437\u0434\u043d\u043e \u0438\u0441\u043f\u0440\u0430\u0432\u0438\u0442\u044c :)\n\t\t\t\t<a href=\"http:\/\/rozetka.com.ua\/news-articles-promotions\/promotions\/\"  class=\"novisited arrow-link cart-news-more-link\">\n\t\t\t<span class=\"arrow-link-inner\">\u0421\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0432\u0441\u0435 \u0430\u043a\u0446\u0438\u0438<\/span>&nbsp;&rarr;\n\t\t<\/a>\n\t<\/div>\n\t<div class=\"cart-promotions\">\n\t\t<div class=\"clearfix slider\" name=\"promotions_scroller_cart\" _action=\"promotions_scroller_cart\">\n\t\t\t<div name=\"screen\">\n\t\t\t\t<a class=\"sprite-side slider-al cart-promotions-al\" data-direction=\"left\" href=\"#\" name=\"promotions_control\">&lt;<\/a>\n\t\t\t\t<a class=\"sprite-side slider-ar cart-promotions-ar\" data-direction=\"right\" href=\"#\" name=\"promotions_control\">&gt;<\/a>\n\n\t\t\t\t<div class=\"cart-promotions-inner\">\n\t\t\t\t\t<div class=\"slider-sliding-box clearfix\" name=\"promotions-container\">\n\n\t\t\t\t\t\t{for promotion in getPromotions()}\n\t\t\t\t\t\t\t<div class=\"float-lt\" name=\"promotions_item\">\n\t\t\t\t\t\t\t\t<div class=\"cart-promotions-i\">\n\t\t\t\t\t\t\t\t\t<a href=\"${promotion.href}\" title=\"${promotion.title}\" class=\"cart-promotions-i-img novisited\">\n\t\t\t\t\t\t\t\t\t\t{if promotion.attachment}\n\t\t\t\t\t\t\t\t\t\t\t<img src=\"${promotion.attachment.url}\"\n\t\t\t\t\t\t\t\t\t\t\t\t width=\"${promotion.attachment.width}\"\n\t\t\t\t\t\t\t\t\t\t\t\t height=\"${promotion.attachment.height}\"\n\t\t\t\t\t\t\t\t\t\t\t\t title=\"${promotion.title}\"\n\t\t\t\t\t\t\t\t\t\t\t\/>\n\t\t\t\t\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t\t\t\t\t${promotion.title}\n\t\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t{\/for}\n\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\t<nav class=\"paginator\" role=\"navigation\">\n\t\t\t\t<ul class=\"paginator-l\" name=\"pages\"><\/ul>\n\t\t\t<\/nav>\n\t\t<\/div>\n\t<\/div>\n{\/if}\t\t<\/div>\n\t\t<div name=\"block_recent_goods\" location=\"cart\"><\/div>\n\t<\/div>\n{\/if}\n<div id=\"return\"><\/div>\n'},selectors:{cost:'[name=cost]',submit:'[name=submit]'},process:'<img src=\"https:\/\/i1.rozetka.com.ua\/design\/check-ajax.gif\" width=\"64\" height=\"64\" alt=\"\u041e\u0442\u043f\u0440\u0430\u0432\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445\" class=\"process\"\/>',level:900,overlay_level:101},_events:['CartRecountCost','CartProcessStart','CartProcessStop'],is_changed:null,is_updated:null,_is_locked:false,there_just_added:false,initialize:function(cart_obj){this.cart_obj=cart_obj;this.elem=new Element('div');this.tpl=this.options.tpl;this._setAsMoadal();this._popups.include(this);$(document).addEvent('CartActionComplete',function(params){if(/^.*add.*$/i.exec(params.action)){Object.each(Cart.S.purchases,function(purchase){if(purchase.goods.id==params.goods_id&&!purchase.kit_id&&!params.data.kit_id||purchase.kit_id==params.data.kit_id&&purchase.kit_id&&params.data.kit_id){purchase.just_added=true}})}});this.cart_obj.addEvent('update',function(){this.is_changed=false;if(this.isOpened()){this.is_updated=true;this.cart_obj.openCart()}}.bind(this));this.addEvent('open',function(){this.is_updated=false}.bind(this));this.attachToObserver(this._events)},onCartProcessStart:function(){if(this.isOpened()){this.content.processStart(this.options.process)}},onCartProcessStop:function(){if(this.isOpened()){this.content.processStop()}},onCartRecountCost:function(data){var cost=Math.round(data[0]),cost_element=null,submit_element=null;if(this.isOpened()){cost_element=this.content.getElement(this.options.selectors.cost);if(this.form){submit_element=this.content.getElement(this.options.selectors.submit);if(cost!=0){submit_element&&submit_element.removeProperty('disabled')}else{submit_element&&submit_element.setProperty('disabled','disabled')}}cost_element&&cost_element.setText(cost.toString().toPriceFormat())}},getPromotionsData:function(){var promotions=[];this.cart_obj.getPurchases().each(function(purchase){if(purchase.promotion){promotions[purchase.id]=purchase.promotion}});return promotions},setContent:function(tpl,data){var promo=this.getPromotionsData();this.promotion=promo.getLast();if(this.cart_obj.options.show_dark){this.overlayON({styles:{'z-index':this.options.overlay_level}})}this.parent(this.options.content.tpl,this.cart_obj);for(var name in this.cart_obj.options.activeElements){var elem=this.content.getElement('[name='+name+']');if(elem){elem.addClass('xhr');elem.addEvent('click',function(e){new Event(e).stop();this.cart_obj.options.activeElements[this.name]()}.bind(this))}}this.form=this.elem.getElement('form');this.form&&this.form.addEvent('submit',this.onSubmit.bind(this));this.there_just_added=this.cart_obj.getJustAddedPurchases().length?true:false},onSubmit:function(e){this.content.processStart(this.options.process);document.fireEvent('goToCheckoutFromCart');this.update(true)&&new Event(e).stop()},update:function(to_checkout){return this.is_changed|=this.cart_obj.sendChangedQuantity(this.cart_obj.changeQuantity(),to_checkout)},close:function(){this._isOpened&&rozetkaEvents.trackEvent(rozetkaEvents.getParam('cart_category'),'proceed/cart/close');this._isOpened&&document.fireEvent('closeCart');this.update();this.parent();this.cart_obj.fireEvent('closeCartPopup');this.is_updated=false;return this},setLocked:function(flag){this._is_locked=flag},isLocked:function(){return this._is_locked},_updateBody:function(){this.elem.setHTML(App.getHTML(this.tpl,this));this._setCloseControls();this.content=this.getElement('[name=content]');window.addEvent('keydown',function(e){if((new Event(e).key)==='esc'&&this._isOpened&&!this.isLocked()){this.close()}}.bind(this));if(!this._closePopup){this._closePopup=(function(e){if(!this.elem.hasChild(new Event(e).target)&&!this.isLocked())this.close()}).bind(this)}},_setAsMoadal:function(){this.pElem=document.body;this.elem.setStyles({position:'absolute','z-index':this.options.level});this.CheckPos=new CheckPos_class(window,this._posUpdate.bind(this,1));this.addEvent('open',this._posUpdate)},open:function(){this.update();this.parent()}});CartPopup_class.implement(new Events());var RozetkaCart_class=Cart_class.extend({Class:'RozetkaCart_class',_kitsScrollerClass:null,changed_purchases:{},options:{in_popup:true,show_seller:true,xhrNodes:{},cartURL:'https://my.rozetka.com.ua/cart/',checkoutURL:'https://my.rozetka.com.ua/checkout/',is_buy_from_catalog:false,is_buy_from_credit_popup:false,credit_id:null,message:'',show_dark:false,process_tpl:'<img src="https://i1.rozetka.com.ua/ajax.gif" width="64" height="64"/>',cart_payment_info_id:'cart_payment_info',popups:{goods:'<div class=\"header-popup header-popup-cart-full\">\n\t<div class=\"header-popup-cart-full-inner\">\n\t\t{var count_purchases = getQuantity()}\n\t\t<p class=\"header-popup-cart-full-info\">\u0412&nbsp;\u043a\u043e\u0440\u0437\u0438\u043d\u0435 ${count_purchases}&nbsp;\u0442\u043e\u0432\u0430\u0440${count_purchases|morphology:[\"\", \"\u0430\", \"\u043e\u0432\"]}<\/p>\n\t\t<p class=\"header-popup-cart-full-info\">\u043d\u0430&nbsp;c\u0443\u043c\u043c\u0443 ${S.cost_with_discount.primary.decimals} ${S.cost.primary.unit}<\/p>\n\t\t<form id=\"drop-block\" method=\"GET\" action=\"https:\/\/my.rozetka.com.ua\/checkout\/\">\n\t\t<span class=\"header-popup-cart-full-link\">\n\t\t\t<span class=\"btn-link btn-link-green\">\n\t\t\t\t<button\n\t\t\t\t\tclass=\"btn-link-i\"\n\t\t\t\t\tonclick=\"document.fireEvent(\u0027goToCheckoutFromCart\u0027, {extend_event: [{name:\u0027eventLocation\u0027, value:\u0027Head\u0027}]})\"\n\t\t\t\t>\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437<\/button>\n\t\t\t<\/span>\n\t\t<\/span>\n\t\t<\/form>\n\t<\/div>\n\t<a\n\t\thref=\"#\"\n\t\tclass=\"header-popup-cart-full-to-cart sprite-side novisited\"\n\t\tonclick=\"new Event(arguments[0]).stop(); Cart.openCart(); document.fireEvent(\u0027openCart\u0027);\"\n\t><span class=\"xhr\">\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432&nbsp;\u043a\u043e\u0440\u0437\u0438\u043d\u0443<\/span><\/a>\n<\/div>',no_goods:'<div id=\"empty_cart_popup_header\" class=\"header-popup header-popup-cart-empty sprite-side\">\n\t<h3 class=\"header-popup-info-title\">\u0412\u0430\u0448\u0430 \u043a\u043e\u0440\u0437\u0438\u043d\u0430 \u043f\u0443\u0441\u0442\u0430<\/h3>\n\t<p class=\"header-popup-info-title-under\">\u0414\u043e\u0431\u0430\u0432\u043b\u044f\u0439\u0442\u0435 \u043f\u043e\u043d\u0440\u0430\u0432\u0438\u0432\u0448\u0438\u0435\u0441\u044f \u0442\u043e\u0432\u0430\u0440\u044b \u0432&nbsp;\u043a\u043e\u0440\u0437\u0438\u043d\u0443<\/br>\n\t\t{if !auth}\u0418\u043b\u0438 <a href=\"#\" class=\"novisited\" onclick=\"new Event(arguments[0]).stop(); User.SignIn();\">\u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0443\u0439\u0442\u0435\u0441\u044c<\/a>, \u0435\u0441\u043b\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u043b\u0438 \u0440\u0430\u043d\u0435\u0435{\/if}\n\t<\/p>\n<\/div>'},scrollers:{kits:{is_optimized:true,container:'[name=kits_scroller_cart]',elemsContainer:'[name=kits_container]',elems:'[name=kits_item]',controls:'[name=kits_control]',circular:true,catalogItemSelector:'td[name=catalog_item]',paginator_elems:'[name="cart_kit_page"]',vector:'horizontal',inject_controls:false},accessories:{container:'[name=accessories_scroller_cart]',elemsContainer:'[name=accessories-container]',elems:'[name=accessories_item]',controls:'[name=accessories_control]',catalogItemSelector:'td[name=catalog_item]',vector:'horizontal',inject_controls:true},promotions:{container:'[name=promotions_scroller_cart]',elemsContainer:'[name=promotions-container]',elems:'[name=promotions_item]',controls:'[name=promotions_control]',catalogItemSelector:'td[name=catalog_item]',paginator_elems:'[name="cart_promotions_page"]',vector:'horizontal',inject_controls:false}},header_popup:'cart-popup',resize:{width:1024},selectors:{cost:'[name=cost]'},scroller_class:'RozetkaElementsScroller_class'},_header_popup:null,popup:null,request_queue:{},_promotions:[],initialize:function(options){this.parent(options);this.addEvent('closeCartPopup',this._restoreKits.bind(this));this.attachToObserver([])},processStart:function(){this.fireEvent('CartProcessStart')},processStop:function(){this.fireEvent('CartProcessStop')},init:function(id){this.parent(id);this._header_popup=$('cart-popup-block')},update:function(){var name=null,elem=null;this.parseRawData();this.initPromotionData();if($defined(this.elem)){this.elem.setHTML(App.getHTML(this.options.tpl,this));for(name in this.options.activeElements){elem=this.elem.getElement('[name='+name+']');elem&&elem.addEvent('click',this._handlerActiveElements.bind(this))}}this.fireEvent('update');this.is_updated=1;if($defined(this._header_popup)){if(this.getPurchases().length){this._header_popup.setHTML(App.getHTML(this.options.popups.goods,this))}else{this._header_popup.setHTML(App.getHTML(this.options.popups.no_goods,{auth:User.isAuth()}))}}this.fireEvent('UpdateCartContent',this)},_handlerActiveElements:function(e){var fn_name=this.options.activeElements[name];new Event(e).stop();this[fn_name](e)},parseRawData:function(){if(this.S.discounts){Object.each(this.S.discounts,function(discount){if(typeof discount.raw_data=='string'){if(discount.raw_data[0]=='{'){discount.raw_data=JSON.parse(discount.raw_data)}else{discount.raw_data={price_name:discount.raw_data}}}})}},initPromotionData:function(){var data=null,cart=this;if($defined(PricesPromotions)){data=Object.values(PricesPromotions.getPromotionsData());this.getPricesDiscounts().each(function(discount){var promotion=data.filter(function(promotion){return promotion.special_price==discount.raw_data.price_name}).pop();if(promotion){cart.getPurchase(discount.purchase_id).promotion=promotion}})}},onActionComplete:function(resp,action,data,onComplete){var Response=new Response_class(resp),goods_ids={},goods_id=data.goods_id,url='',last_purchase=null,item=null,cart_payment_info=null;if(cart_payment_info=$(this.options.cart_payment_info_id)){cart_payment_info.processStop()}if(!data.goods_id&&Cart.getPurchase(data.id)){goods_id=Cart.getPurchase(data.id).goods.id}if(goods_id){goods_ids[data.id]=goods_id}Object.keys(data.purchases).each(function(id){var goods_id=null;if(Cart.getPurchase(id)){goods_id=Cart.getPurchase(id).goods.id}if(goods_id){goods_ids[id]=goods_id}});Response.doAction();if(onComplete){onComplete(Response,data)}if(Response.isDone()&&goods_id&&data.is_buy_from_catalog){for(item in Response.S.cart.purchases){if(Response.S.cart.purchases[item].goods.id==goods_id){url=Response.S.cart.purchases[item].goods.href;break}}if(url){location.assign(url+'#cart')}}if(data.is_buy_from_credit_popup&&data.credit_id){location.href=Cart.options.checkoutURL}if(Response.Message){Cart.options.message=Response.Message}else{Cart.options.message=''}Cart.getPopup();Object.each(goods_ids,function(goods_id,id){Cart.fireEvent('actionCompleteForGoods'+goods_id);Cart.fireEvent('actionCompleteForPurchase'+id);$(document).fireEvent('CartActionComplete',{action:action,goods_id:goods_id,data:data})});if(!data.is_buy_from_catalog&&!data.is_buy_from_credit_popup){if(!data.in_background||(!data.to_checkout&&Cart.getPopup().isOpened())){Cart.openCart((!Cart.options.in_popup&&!Cart.getPopup().isOpened())?true:false)}}if(Cart._updateCartList){CartList.options.onActionComplete().bind(CartList)}if(Response.code==Response.CODE.VOID||Response.code==Response.CODE.ERROR){rozetkaEvents.trackEvent('Product page','goods/cart/notadd',rozetkaEvents.getGoodsData())}else{if(action=='add'){if(Cart.goods[goods_id][0].promotion&&Cart.goods[goods_id][0].promotion.type.indexOf('special_price')!=-1){for(item in Response.S.cart.purchases){if(Response.S.cart.purchases[item].goods.id==goods_id){last_purchase=Response.S.cart.purchases[item];break}}rozetkaEvents.trackEvent('Special clubs',Cart.goods[goods_id][0].promotion.name,'add/'+(rozetkaEvents.getParam('category')|'')+'/'+last_purchase.section_name)}}}},getPurchase:function(id){var result=null;if(this.S){result=this.parent(id)}return result},getSellerByPurchaseId:function(id){var purchase=this.getPurchase(id),seller=null;if(this.options.show_seller&&this.options.show_seller!='0'&&purchase&&purchase.seller_id&&this.S.sellers&&Object.getLength(this.S.sellers)){seller=Object.values(this.S.sellers).filter(function(elem){return parseInt(purchase.seller_id,10)===parseInt(elem.seller_id,10)}).pop()}return seller},getPurchases:function(){return Object.values(this.S.purchases)},getJustAddedPurchases:function(purchases){return(purchases||this.getPurchases()).filter(function(purchase){return purchase&&purchase.just_added})},getOtherPurchases:function(purchases){return(purchases||this.getPurchases()).filter(function(purchase){return purchase&&!purchase.just_added})},getBasePurchases:function(purchases){return(purchases||this.getPurchases()).filter(function(purchase){return purchase&&!purchase.unit_id})},getUnitsPurchases:function(parent_purchase_id,purchases){return(purchases||this.getPurchases()).filter(function(purchase){return purchase&&purchase.unit_id&&(!parent_purchase_id||purchase.parent_id==parent_purchase_id)})},getPopup:function(){if(!this.popup){this.popup=new CartPopup_class(this)}return this.popup},getConvertDataToGTMFormat:function(goods){return{id:goods.id,price_usd:goods.price_usd,title:goods.title,parent_id:goods.parent_id,top_parent_id:goods.top_parent_id,producer_id:goods.producer,tag:$defined(goods.tag)&&$defined(goods.tag.name)?goods.tag.name:null,merchant_id:goods.merchant_id,seller_id:goods.seller_id,}},openCart:function(is_open_popup){this.prepareKits();this.getAccessories().each(function(goods){GTMEventsData.setGoodsData(goods.id,this.getConvertDataToGTMFormat(goods))}.bind(this));this.getPurchases().each(function(puchase){GTMEventsData.setGoodsData(puchase.goods.id,this.getConvertDataToGTMFormat(puchase.goods))}.bind(this));!is_open_popup&&this.openPopup();this.recountCost();this.fireEvent('UpdateCartContent',this);document.fireEvent('updateSellerInfoHandlers')},openPopup:function(){var popup=this.getPopup();CartList.clearQueue();popup.setContent();popup.open();CartList.delayedAdd();this.initScrollers(popup.content);ItsForGift.init();popup._posUpdate();this.fireEvent('InsertRecentGoods');this.fireEvent('openCart',this)},initScrollers:function(container){this.setKits(container);this.setAccessories(container);this.setPromotions(container)},getCountAccessories:function(){return this.getAccessories().length},getAccessories:function(){var result=[];if(this.S&&this.S.accessories){result=Object.values(this.S.accessories)}return result},getCountPromotions:function(){return this.getPromotions().length},getPromotions:function(){return Object.values(this._promotions)},closeCart:function(){if(this.popup){this.popup.close()}},doAction:function(action,catalog_item_or_id,goods_id,quantity,kit_id,unit_goods_ids,unique_request_name,send_delay){var data={},options,on_complete_args,cart_payment_info=null;if(typeof catalog_item_or_id!='object'){if(catalog_item_or_id){data.id=catalog_item_or_id}if(goods_id){data.goods_id=goods_id}if(quantity){data.quantity=quantity}if(kit_id){data.kit_id=kit_id}if(unit_goods_ids){data.unit_ids=unit_goods_ids}}else{data=catalog_item_or_id.getDataFromSource()}if(this.options.is_buy_from_catalog){data.is_buy_from_catalog=this.options.is_buy_from_catalog}if(this.options.is_buy_from_credit_popup&&this.options.credit_id){data.is_buy_from_credit_popup=this.options.is_buy_from_credit_popup;data.credit_id=this.options.credit_id}on_complete_args=[action,data,$defined(catalog_item_or_id.getOnCompleteFn)&&catalog_item_or_id.getOnCompleteFn()];options={data:data,onComplete:this.onActionComplete.bindAsEventListener(this,on_complete_args),headers:{ajaxAction:this.options.cartURL+'#'+action}};var request=new Ajax('/cgi-bin/form.php',options);if(unique_request_name){if(this.request_queue[unique_request_name]&&this.request_queue[unique_request_name]['request']){this.request_queue[unique_request_name]['request'].cancel()}else{this.request_queue[unique_request_name]={};this.request_queue[unique_request_name]['num']=0}this.request_queue[unique_request_name]['request']=request;this.request_queue[unique_request_name]['num']=this.request_queue[unique_request_name]['num']+1}if(send_delay){if(cart_payment_info=$(this.options.cart_payment_info_id)){cart_payment_info.processStart(this.options.process_tpl)}this.submitRequest.delay(send_delay,this,[unique_request_name,this.request_queue[unique_request_name]['num']])}else{request.request()}},submitRequest:function(unique_request_name,num){if(this.request_queue[unique_request_name]&&this.request_queue[unique_request_name]['num']==num){this.request_queue[unique_request_name]['request'].request()}},addKitGoods:function(goods_id,kit_id,unit_goods_ids){this.doAction('add','',goods_id,'',kit_id,unit_goods_ids)},addKitGoodsFromCart:function(goods_id,kit_id,unit_goods_ids){this._old_kits=this.S.kits;this.doAction('addFromCart','',goods_id,'',kit_id,unit_goods_ids)},addKitGoodsFromPageCart:function(goods_id,kit_id,unit_goods_ids){this._updateCartList=true;this.addKitGoodsFromCart(goods_id,kit_id,unit_goods_ids)},'delete':function(id){this.parent(id);var purchase=this.getPurchase(id),goods_id=0;if(purchase){goods_id=purchase.goods.id;waitlistElem=this.getWaitlistElemByGoodsId(goods_id);if(waitlistElem){waitlistElem.setStyle('display','block')}}},'edit':function(id,goods_id,quantity,kit_id,unit_goods_ids){this.doAction('edit',id,goods_id,quantity,kit_id,unit_goods_ids)},getWaitlistElemByGoodsId:function(goods_id){var waitlist_elem=null;GoodsCatalog._catalog.each(function(item){if(item.id==goods_id){waitlist_elem=item.elem.waitlist_details_available}});return waitlist_elem},_prepareS:function(S){this._switchKits(S);this.parent()},_restoreKits:function(){if(this._restore_kits){this.S.kits=this._restore_kits;this._restore_kits=null}},_switchKits:function(S){if(this._old_kits){this.S.kits=this._old_kits;this._old_kits=null;this._restore_kits={};if($defined(S.kits)&&$type(S.kits)!='array'){this._restore_kits=this.groupedKits(S.kits)}}else{this.S.kits={};if($defined(S.kits)&&$type(S.kits)!='array'){this.S.kits=this.groupedKits(S.kits)}}},prepareKits:function(){this._switchKits(S.data);this.checkKits()},groupedKits:function(kits_by_base_goods){var kits=[],kit=null,kit_id=0,goods_id_in_kit=0,groupedKits={},disabled_purchase_ids=[],accessories={},free_purchases;CartList._catalog.each(function(item){item.is_active||disabled_purchase_ids.push(item.id)});free_purchases=Object.values(this.S.purchases).filter(function(purchase){return!purchase.kit&&$defined(kits_by_base_goods[purchase.goods.id])&&!disabled_purchase_ids.contains(purchase.id)&&!this.getPricesDiscounts(purchase.id).length}.bind(this));if(free_purchases.length){free_purchases.sort(function(a,b){var a_just=0,b_just=0;if(a.just_added){a_just=1}if(b.just_added){b_just=1}return(a_just-b_just)||a.price.primary.raw-b.price.primary.raw});kits=kits_by_base_goods[free_purchases.pop().goods.id]}if($defined(Object.values(kits_by_base_goods).pop().id)){kits=kits_by_base_goods}if(!Object.getLength(kits)){return null}for(kit in kits){kit_id=kits[kit]['kit_id'];goods_id_in_kit=kits[kit]['goods']['id'];if(!$defined(groupedKits[kit_id])){accessories={};accessories[goods_id_in_kit]=this._getAccessoriesForKit(kits[kit]);groupedKits[kit_id]={"id":kit_id,"base_goods_id":kits[kit]['base_goods_id'],"cost_without_kit":kits[kit]['cost_without_kit'],"cost":kits[kit]['cost'],"percent_discount":Math.round(100-kits[kit]['cost']/kits[kit]['cost_without_kit']*100),"is_show_full_discount":kits[kit]['is_show_full_discount'],"kit_percent_discount":kits[kit]['kit_percent_discount'],"accessories":accessories,"count_accessories":1,"base_goods_discount_price":kits[kit]['base_goods_discount_price'],"tag":kits[kit]['tag']}}else{groupedKits[kit_id]["accessories"][goods_id_in_kit]=this._getAccessoriesForKit(kits[kit]);groupedKits[kit_id]["count_accessories"]++}}return groupedKits},_getAccessoriesForKit:function(goods_by_kit){var accessories={"id":goods_by_kit['goods']['id'],"unit_id":goods_by_kit['unit_id'],"href":goods_by_kit['goods']['href'],"title":goods_by_kit['goods']['title'],"price":goods_by_kit['goods']['price'],"price_usd":goods_by_kit['goods']['price_usd'],"goods_discount_price":goods_by_kit['goods_discount_price'],"goods_percent_discount":goods_by_kit['goods_percent_discount'],"attachments":goods_by_kit['goods']["attachments"],"sell_status":goods_by_kit['goods']['sell_status']};rozetkaEvents.setGoodsData(goods_by_kit.goods);return accessories},setGoodsCatalogForCart:function(goodsCatalog){this._goodsCatalog=goodsCatalog},addKits:function(){var kit_id=null,units=null,kit_number=0;for(kit_id in this.S.kits){units=this.getUnits(kit_id);if($(this._goodsCatalog._id_preff+this.S.kits[kit_id]['base_goods_id'])){kit_number=$(this._goodsCatalog._id_preff+this.S.kits[kit_id]['base_goods_id']).getProperty('_number');if(kit_number!=null){this._goodsCatalog.addKit(this.S.kits[kit_id]['base_goods_id'],kit_id,units,kit_number)}else{this._goodsCatalog.addKit(this.S.kits[kit_id]['base_goods_id'],kit_id,units)}}}},getKitsForGoodsCatalog:function(){var result=[];Object.values(this.S.kits).each(function(kit){var data=Object.clone(kit);data['units']=this.getUnits(data['id']);result.push(data)}.bind(this));return result},checkKits:function(){Object.values(this.S.kits).each(function(kit){if(this.isPricesDiscountApplied(kit['base_goods_id'])){delete this.S.kits[kit['id']]}}.bind(this))},isPricesDiscountApplied:function(base_goods_id){var is_applied=false,purchase,discount;for(purchase in this.S.purchases){if(this.S.purchases[purchase].goods.id==base_goods_id){for(discount in this.S.discounts){if(this.S.discounts[discount].purchase_id==this.S.purchases[purchase].id&&this.S.discounts[discount].discount_module=="Goods.Prices"){is_applied=true}}}}return is_applied},getDiscounts:function(purchase_id,discount_module){return Object.values(this.S.discounts).filter(function(discount){return(!discount_module||discount.discount_module==discount_module)&&(!purchase_id||discount.purchase_id==purchase_id)})},getPricesDiscounts:function(purchase_id){return this.getDiscounts(purchase_id,'Goods.Prices')},getNotParentDiscounts:function(purchase_id,discount_module){return Cart.getDiscounts(purchase_id,discount_module).filter(function(discount){return!discount.parent_id})},getUnits:function(kit_id){var accessories=this.S.kits[kit_id]['accessories'],units={},accessory=null;for(accessory in accessories){units[accessories[accessory]['unit_id']]=accessories[accessory]['id']}return units},getCost:function(id){var cost=0;if(id&&$defined(this.goods[id])){cost=this.goods[id][0].cost_with_discount.primary.decimals}else{cost=this.S.cost_with_discount.primary.decimals}return parseFloat(cost.replace(/\s+/g,''))},getCountKits:function(){return Object.getLength(this.S.kits)},getTitleBaseGoodsByKit:function(){var title='',kit_id=null,base_goods_id=0,purchase=null;for(kit_id in this.S.kits){base_goods_id=this.S.kits[kit_id].base_goods_id;break}for(purchase in this.S.purchases){if(base_goods_id==this.S.purchases[purchase]['goods']['id']){title=this.S.purchases[purchase]['goods']['title']}}return title},isShowFullDiscount:function(purchase_id){var is_show_discount=false;if(this.S.purchases[purchase_id]['parent_id']!=''&&this.S.purchases[this.S.purchases[purchase_id]['parent_id']]['kit']['is_show_full_discount']){is_show_discount=true}return is_show_discount},loadPromotions:function(data){this._promotions=data},recountCost:function(purchase_active){this.sendChangedQuantity(this.changeQuantity(),0)},getCartListItem:function(id){return CartList._catalog.filter(function(item){return item.id==id}).pop()},setKits:function(container){var scroller_container=container.getElement(this.options.scrollers.kits.container);if(scroller_container){this.addKitsForGoodsCatalog(this.getKitsForGoodsCatalog());scroller_container&&this.setScroll(scroller_container,this.options.scrollers.kits)}},addKitsForGoodsCatalog:function(data){window['GoodsCatalog']&&data.forEach(function(kit){var kit_id=kit['id'],base_goods_id=kit['base_goods_id'],units=kit['units'],element=$(GoodsCatalog._id_preff+base_goods_id);if(element){GoodsCatalog.addKit(base_goods_id,kit_id,units,element.getProperty('_number'),'cart_kit')}}.bind(this))},setAccessories:function(container){var scroller_container=container.getElement(this.options.scrollers.accessories.container);if(scroller_container){this.addAccessories(this.getAccessories());scroller_container&&this.setScroll(scroller_container,this.options.scrollers.accessories)}},addAccessories:function(data){window['GoodsCatalog']&&data.each(function(accessory){GoodsCatalog.add(accessory['id'],'cart_accessories')}.bind(this))},setPromotions:function(container){var scroller_container=container.getElement(this.options.scrollers.promotions.container);scroller_container&&this.setScroll(scroller_container,this.options.scrollers.promotions)},setScroll:function(container,options){var scroller=App.getConstructorByClassName(this.options.scroller_class);scroller&&new scroller(container).setOptions(options).run()},sendChangedQuantity:function(changed_purchases,to_checkout){var result=false,catalog_items=null;if(changed_purchases){catalog_items={getDataFromSource:function(){return{purchases:changed_purchases,in_background:true,to_checkout:to_checkout?1:0}}};this.doAction('group_edit',catalog_items,null,null,null,null,'sendChangedQuantity',1500);result=true}return result},changeQuantity:function(){var changed_purchases={};CartList._catalog.each(function(catalog_item){var quantity,s_quantity;s_quantity=catalog_item.getProperty('quantity');if(!catalog_item.getProperty('parent_id')){quantity=catalog_item.getQuantity();if(!catalog_item.is_active){changed_purchases[catalog_item.id]=0}else if(s_quantity!=quantity){changed_purchases[catalog_item.id]=quantity}}});this.changed_purchases=changed_purchases;return Object.keys(changed_purchases).length?changed_purchases:null}});RozetkaCart_class.implement(new Events());var SourceGoodsStub_class=new Class({data:null,initialize:function(data){this.data=data},getId:function(){return this.data.goods_id},getData:function(){return this.data},getSourceId:function(){return $uid(this)},sourceChange:function(e){this.data=e}});var SourceGoods_class=SourceGoodsStub_class.extend({_events:{'changeServiceFields':'sourceChange'},source_element:null,'id':null,initialize:function(form_id){var parent_construct=this.parent.bind(this);this.source_element=$(form_id);this.source_element.removeProperty('id');this.id=form_id;parent_construct(this._getDataFromSource());for(var event_name in this._events){var callback=this[this._events[event_name]];document.addEvent(event_name+'_'+this.getSourceId(),callback.bind(this))}},getSourceElement:function(){return this.source_element},getId:function(){return this.data.goods_id},getSourceId:function(){return this.id},sourceChange:function(e){this.data=this._getDataFromSource()},_getDataFromSource:function(){var query_string=this.source_element.toQueryString();return App.parseGET(query_string)}});var SourceKit_class=SourceGoods_class.extend({getId:function(){return this.data.goods_id}});var SourceSolution_class=SourceGoods_class.extend({getId:function(){return this.data.goods_id}});var SourcePurchase_class=SourceGoods_class.extend({getId:function(){return this.data.id}});var Catalog_class=new Class({_class:null,_catalog:null,_queueAdd:null,_id_preff:'',checkup:false,is_updated:false,options:{},initialize:function(item_class,id_preff){this._catalog=[];this._queueAdd=[];this._class=item_class;if(id_preff)this._id_preff=id_preff},addEntity:function(entity_type,data_source){var constructor=App.getConstructorByClassName('Source'+entity_type+'_class');var source=new constructor(data_source);var id=source.getId();var i=this._catalog.push(new this._class(id,this._id_preff+id))-1;this._catalog[i].init(this,source);return this._catalog[i]},add:function(id){return this.addEntity('GoodsStub',{'goods_id':id})},addKit:function(id,kit_id,units_ids){return this.addEntity('GoodsStub',{'goods_id':id,'kit_id':kit_id,'unit_ids':units_ids})},update:function(){this._catalog=this._catalog.filter(function(item){return item.isValid()});this._catalog.each(function(item){item.update()});this.is_updated=1},clean:function(){this._catalog=[]},'delete':function(id){var i=0;var len=this._catalog.length;while(i<len){if(this._catalog[i].id===id){this._catalog.splice(i,1);len--}else{i++}}},toQueueAdd:function(id){this._queueAdd.push(id)},delayedAdd:function(){this.is_updated=1;while(this._queueAdd.length>0)this.add(this._queueAdd.shift())},updateBind:function(obj){this.is_updated=obj.is_updated;obj.addEvent('update',this.update.bind(this));return this}});Catalog_class.implement(new Options);var CatalogItem_class=new Class({options:{dynamicElements:{},activeElements:{},onActionStart:Class.empty,onActionComplete:Class.empty,additionalControllers:{}},initialize:function(id,elem){this.id=id;if($type(elem)=='string'){elem=$(elem).removeProperty('id')}this.elem=$(elem)},isValid:function(){return document.body['contains']?document.body.contains(this.elem):true},init:function(catalog,data_source){this.setSource(data_source);this.addEvent('delete',catalog['delete'].bind(catalog,this.id));this.setOptions(catalog.options);if(this.options.additionalControllers){this.createControllers()}if(catalog.is_updated){this.update()}},onActionComplete:function(e){this.process=0;this.fireEvent('onActionComplete')},setSource:function(source){this.source=source},getSource:function(){return this.source},getDataFromSource:function(){return this.source.getData()},'delete':function(){this.elem.remove();this.fireEvent('delete')},update:function(){this.collectionElements(this.options.dynamicElements,'setDynamic');this.collectionElements(this.options.activeElements,'setActive')},collectionElements:function(collection,fnName){for(var name in collection){this.elem[name]=this.elem.getElement('[name='+name+']');if($type(this.elem[name])==='element'){if(fnName==='setActive'){this.elem[name].removeEvents()}this[fnName](this.elem[name],collection[name])}}},setDynamic:function(elem,tpl){elem.setHTML(App.getHTML(tpl,this))},setActive:function(elem,param){elem.addEvent(param.event?param.event:'click',function(e){e=new Event(e);if(e.type==='click'){e.stop()}if(!this.process&&(!$defined(param.confirm_tpl)||confirm(App.getHTML(param.confirm_tpl,this)))){if(!param.without_request){this.process=1;this.fireEvent('onActionStart',{action:param.action,initiator:elem})}this[param.action](elem)}}.bind(this))},createControllers:function(){Object.each(this.options.additionalControllers,function(data,key){var class_name=data['class'];var constructor=App.getConstructorByClassName(class_name);this.options.additionalControllers[key]=new constructor(this.getSource().getSourceId(),data.options)}.bind(this))}});CatalogItem_class.implement(new Options(),new Events());var Goods_class=CatalogItem_class.extend({Class:'Goods_class',id:null,_flagAddToCart:false,_popupAddToCart:null,options:{open_popup:false,popup_tpl:'',popup_content_tpl:'',overlayON:false,popup_floatingY:true},initialize:function(id,elem){this.parent(id,elem);if(typeof Cart!='undefined'){Cart.addEvent('actionCompleteForGoods'+this.id,this.onActionComplete.bind(this))}if(typeof Comparison!='undefined'){Comparison.addEvent('actionCompleteForGoods'+this.id,this.onActionComplete.bind(this))}if(typeof Waitlist!='undefined'){Waitlist.addEvent('actionCompleteForGoods',this.onActionComplete.bind(this))}if(typeof Wishlists!='undefined'){Wishlists.addEvent('actionCompleteForGoods',this.onActionComplete.bind(this))}},addToComparison:function(){Comparison.addGoods(this.id)},addToWaitlist:function(){Waitlist.addGoods(this.id)},addToWishlist:function(){Wishlists.addGoods(this.id)},deleteFromComparison:function(){Comparison.deleteGoods(this.id)},addToCart:function(){this._flagAddToCart=true;Cart.doAction('add',this)},deleteFromCart:function(){Cart.deleteGoods(this.id)},inCart:function(){return Cart.inPurchases(this.id)},inWaitlist:function(){return Waitlist.inWaitlist(this.id)},inWishlist:function(){return Wishlists.inWishlist(this.id)},deleteFromWishlist:function(){Wishlists.deleteGoods(this.id)},deleteFromWaitlist:function(){Waitlist.deleteGoods(this.id)},inComparison:function(){return Comparison.goods[this.id]},isPossibilityToCompare:function(){return Comparison.isPossibilityToCompare(this.id)},onActionComplete:function(e){this.parent();if(this.options.open_popup&&this._flagAddToCart){this._popupAddToCart=new Popup_class(this.options.popup_tpl);this._popupAddToCart.setContent(this.options.popup_content_tpl,{newGoods:Cart.goods[this.id][0],cart:Cart});if(this.options.overlayON){this._popupAddToCart.overlayON()}this._popupAddToCart.setOptions({floatingY:this.options.popup_floatingY});this._popupAddToCart.open()}if(this._flagAddToCart){Cart.fireEvent('goodsAdded');document.fireEvent('goodsAdded')}this._flagAddToCart=false}});var RozetkaGoods_class=Goods_class.extend({_kitid:null,_kit_number:null,unit_goods_ids:{},options:{tpl_promotion_popup:'<div class=\"popup-css cat-promo-popup\">\n\t<a href=\"#\" class=\"popup-close\" name=\"close\">\n\t\t<img width=\"28\" height=\"28\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"&times;\" class=\"popup-close-small-icon sprite\">\n\t<\/a>\n\t<div name=\"content\"><\/div>\n<\/div>',tpl_promotion_content:'<h4 class=\"cat-promo-title\">${data.title}<\/h4>\n<div class=\"cat-promo-g-i-wrapper clearfix\">\n\t<div class=\"cat-promo-i clearfix{if (data.special_price && data.image_for_details) || data.image} cat-promo-mod{\/if}\">\n\t\t{if data.special_price && data.image_for_details}\n\t\t\t<div class=\"cat-promo-img\">${data.image_for_details}<\/div>\n\t\t{elseif data.image}\n\t\t\t<div class=\"cat-promo-img\">${data.image}<\/div>\n\t\t{\/if}\n\t\t<div class=\"cat-promo-desc\">${data.summary}<\/div>\n\t<\/div>\n<\/div>\n{if data.goods}\n\t<h4 class=\"cat-promo-title-small\">\u0412 \u0430\u043a\u0446\u0438\u0438 \u0443\u0447\u0430\u0441\u0442\u0432\u0443\u044e\u0442:<\/h4>\n\t{if data.href}\n\t\t<a href=\"${data.href}#promotion_goods\" rel=\"nofollow\" class=\"arrow-link cat-promo-link\">\n\t\t\t<span class=\"cat-promo-link-text arrow-link-inner\">\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0432\u0441\u0435<\/span>&nbsp;&rarr;\n\t\t<\/a>\n\t{\/if}\n\t<div class=\"cat-promo-g-i-wrapper clearfix\">\n\t\t{var i=1}\n\t\t{for good in data.goods}\n\t\t\t<div class=\"cat-promo-g-i\">\n\t\t\t\t<div class=\"cat-promo-g-i-img\">\n\t\t\t\t\t<a class=\"cat-promo-g-i-img-link\" href=\"${good.url}\">\n\t\t\t\t\t\t${good.image}\n\t\t\t\t\t<\/a>\n\t\t\t\t<\/div>\n\t\t\t\t<div class=\"cat-promo-g-i-description ${good.sell_status}\">\n\t\t\t\t\t<div class=\"g-title\"><a href=\"${good.url}\">${good.title}<\/a><\/div>\n\t\t\t\t\t{if good.price}\n\t\t\t\t\t\t<div class=\"g-price cat-promo-g-i-price\">\n\t\t\t\t\t\t\t<div class=\"g-price-uah\">${good.price.toString().toPriceFormat()}<span class=\"g-price-uah-sign\">&thinsp;${good.unit}<\/span><\/div>\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t{\/if}\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\t{var i=i+1}\n\t\t{\/for}\n\t<\/div>\n{\/if}\n\n{if data.href}\n\t<div class=\"cat-promo-more\">\n\t\t<a href=\"${data.href}\" class=\"arrow-link novisited\"><span class=\"arrow-link-inner\">\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0430\u043a\u0446\u0438\u0438<\/span>&nbsp;&rarr;<\/a>\n\t<\/div>\n{\/if}',tpl_variants_content:'{var eventLocationColor = \u0027OtherColorPopUp\u0027 + target}\n{var eventLocationSize = \u0027OtherSizePopUp\u0027 + target}\n\n<div class=\"{if data.variants.length > 6}pp-variants-popup-goods-wrap-large{\/if}\">\n\t<div class=\"pp-variants-popup-goods-inner clearfix{if data.variants.length > 6} pp-variants-popup-goods-inner-large{\/if}\">\n\t\t<div class=\"g-i-table\">\n\t\t{var i = 0}\n\t\t\t<div class=\"g-i-tr g-i-tr-tierce\">\n\t\t\t\t{for variant in data.variants}\n\t\t\t\t\t{var i = i + 1}\n\n\t\t\t\t\t{var is_color = (variant.variant_color || (variant.variant_image && variant.variant_block_type == \u0027color\u0027))}\n\n\t\t\t\t\t${rozetkaEvents.setGoodsData(variant.ga_goods_data)}\n\t\t\t\t\t\t<div class=\"g-i-td cat-promo-g-i ${variant.sell_status}\">\n\t\t\t\t\t\t\t{if is_color}\n\n\t\t\t\t\t\t\t<span class=\"g-i-tile-i-variants detail-color-g-i-tile-i-variants variants-no-border\">\n\t\t\t\t\t\t\t\t{if variant.id != id}\n\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\thref=\"${variant.href}\"\n\t\t\t\t\t\t\t\t\tonclick=\"document.fireEvent(\u0027variantImageClick\u0027, {extend_event: [{name: \u0027eventLocation\u0027, value: \u0027${eventLocationColor}\u0027}, {name: \u0027eventContent\u0027, value: \u0027${variant.variant_title}\u0027}, {name: \u0027goods_id\u0027, value: ${variant.id}}]})\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{if variant.variant_image}\n\t\t\t\t\t\t\t\t\t<span class=\"pop-up-variants-colors-l-i-link-ico inline\">${variant.variant_image}<\/span>\n\t\t\t\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t\t\t<span class=\"pop-up-variants-colors-l-i-link-ico inline\" style=\"background-color: ${variant.variant_color}\"><\/span>\n\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t\t\t{if variant.variant_image}\n\t\t\t\t\t\t\t\t\t<span class=\"pop-up-variants-colors-l-i-link-ico inline\">${variant.variant_image}<\/span>\n\t\t\t\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t\t\t<span class=\"pop-up-variants-colors-l-i-link-ico inline\" style=\"background-color: ${variant.variant_color}\"><\/span>\n\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t<div class=\"cat-promo-g-i-img {if variant.variant_color}cat-promo-g-i-img-variants{\/if}\">\n\t\t\t\t\t\t\t\t{if variant.id != id}\n\t\t\t\t\t\t\t\t\t<a class=\"cat-promo-g-i-img-link\"\n\t\t\t\t\t\t\t\t\t\t{if is_color}\n\t\t\t\t\t\t\t\t\t\t\tonclick=\"document.fireEvent(\u0027goodsImageClick\u0027, {extend_event: [{name: \u0027eventLocation\u0027, value: \u0027${eventLocationColor}\u0027}, {name: \u0027eventContent\u0027, value: \u0027${variant.variant_title}\u0027}, {name: \u0027goods_id\u0027, value: ${variant.id}}]})\"\n\t\t\t\t\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t\t\t\t\tonclick=\"document.fireEvent(\u0027goodsImageClick\u0027, {extend_event: [{name: \u0027eventLocation\u0027, value: \u0027${eventLocationSize}\u0027}, {name: \u0027eventContent\u0027, value: \u0027${variant.variant_title}\u0027},{name: \u0027goods_id\u0027, value: ${variant.id}}]})\"\n\t\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t\t\thref=\"${variant.href}\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t${variant.image}\n\t\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t\t\t<span class=\"cat-promo-g-i-img-link\">${variant.image}<\/span>\n\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t<div class=\"cat-promo-g-i-description\">\n\t\t\t\t\t\t\t\t{if variant.id != id}\n\t\t\t\t\t\t\t\t\t<div class=\"cat-promo-g-i-title g-title\">\n\t\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\t{if is_color}\n\t\t\t\t\t\t\t\t\t\t\tonclick=\"document.fireEvent(\u0027variantImageClick\u0027, {extend_event: [{name: \u0027eventLocation\u0027, value: \u0027${eventLocationColor}\u0027}, {name: \u0027eventContext\u0027, value: \u0027title\u0027}, {name: \u0027eventContent\u0027, value: \u0027${variant.variant_title}\u0027}, {name: \u0027goods_id\u0027, value: ${variant.id}}]})\"\n\t\t\t\t\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t\t\t\t\tonclick=\"document.fireEvent(\u0027goodsImageClick\u0027, {extend_event: [{name: \u0027eventLocation\u0027, value: \u0027${eventLocationSize}\u0027}, {name: \u0027eventContext\u0027, value: \u0027title\u0027}, {name: \u0027eventContent\u0027, value: \u0027${variant.variant_title}\u0027}, {name: \u0027goods_id\u0027, value: ${variant.id}}]})\"\n\t\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t\t\t\thref=\"${variant.href}\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t${variant.variant_title}\n\t\t\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t\t\t<div class=\"cat-promo-g-i-title g-title\">\n\t\t\t\t\t\t\t\t\t\t${variant.variant_title}\n\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t{\/if}\n\n\n\t\t\t\t\t\t\t\t{if variant.price}\n\t\t\t\t\t\t\t\t\t<div class=\"g-price cat-promo-g-i-price\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"g-price-uah\">${variant.price.toString().toPriceFormat()}<span class=\"g-price-uah-sign\">&thinsp;${variant.unit}<\/span><\/div>\n\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t<\/div>\n\n\t\t\t\t\t{if i == 3}\n\t\t\t\t\t\t<\/div><div class=\"g-i-tr g-i-tr-tierce\">\n\t\t\t\t\t\t{var i = 0}\n\t\t\t\t\t{\/if}\n\n\t\t\t\t{\/for}\n\t\t\t<\/div>\n\n\t\t\t<div class=\"g-i-tr g-i-tr-psevdo g-i-tr-tierce\">\n\t\t\t\t<div class=\"g-i-td\">&nbsp;<\/div>\n\t\t\t\t<div class=\"g-i-td\">&nbsp;<\/div>\n\t\t\t\t<div class=\"g-i-td\">&nbsp;<\/div>\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/div>\n<\/div>',tpl_variants_popup:'<div class=\"popup-css pp-variants-popup-goods\">\n\t<a href=\"#\" class=\"popup-close\" name=\"close\">\n\t\t<img width=\"18\" height=\"18\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"&times;\" class=\"popup-close-medium-icon sprite\">\n\t<\/a>\n\t<div name=\"content\"><\/div>\n<\/div>',variants_data:false,variants_target:'Catalog',tpl_series_content:'<div class=\"list\">\r\n\t<h4>\u041c\u043e\u0434\u0435\u043b\u0438 \u0441\u0435\u0440\u0438\u0438<\/h4>\r\n\t{var i=0}\r\n\t{for model in data}\r\n\t\t<div class=\"item ${model.sell_status} {if model.is_active} active{\/if}\">\r\n\t\t\t<div class=\"img-block\">\r\n\t\t\t\t<a href=\"${model.href}\">\r\n\t\t\t\t\t${model.image}\r\n\t\t\t\t<\/a>\r\n\t\t\t<\/div>\r\n\t\t\t<div class=\"detail\">\r\n\t\t\t\t<div class=\"title\"><a href=\"${model.href}\">${model.title}<\/a>{if model.markdown} <span class=\"markdown\">\u0423\u0446\u0435\u043d\u043a\u0430: ${model.markdown}<\/span>{\/if}<\/div>\r\n\t\t\t\t{if model.markdown_price}\r\n\t\t\t\t\t<div class=\"price price-old\">\r\n\t\t\t\t\t\t<span class=\"uah\">{if parseInt(model.markdown_price)>0}${model.markdown_price}{\/if}<\/span>\r\n\t\t\t\t\t<\/div>\r\n\t\t\t\t\t<div class=\"price\">\r\n\t\t\t\t\t\t<span class=\"uah\">{if parseInt(model.price)>0}${model.price}{\/if}<\/span>\r\n\t\t\t\t\t<\/div>\r\n\t\t\t\t{else}\r\n\t\t\t\t\t<div class=\"price\">\r\n\t\t\t\t\t\t<span class=\"uah\">{if parseInt(model.price)>0}${model.price}{\/if}<\/span>\r\n\t\t\t\t\t<\/div>\r\n\t\t\t\t{\/if}\r\n\t\t\t\t{javascript}\r\n\t\t\t\t\tSeriesComparison.add(${model.id});\r\n\t\t\t\t{\/javascript}\r\n\t\t\t<\/div>\r\n\t\t<\/div>\r\n\t{\/for}\r\n\t<a href=\"#\" name=\"compare-all-series\" class=\"lightblue arrow-link\"><span class=\"underline\">\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c, \u0447\u0435\u043c \u043e\u0442\u043b\u0438\u0447\u0430\u044e\u0442\u0441\u044f<\/span>&nbsp;&rarr;<\/a>\r\n<\/div>',tpl_series_popup:'<div class=\"popup-goods\">\r\n\t<div class=\"popup-css\">\r\n\t\t<a href=\"#\" class=\"popup-close\" name=\"close\"><img width=\"18\" height=\"18\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"&times;\" class=\"popup-close-medium-icon sprite\"><\/a>\r\n\t\t<div name=\"content\"><\/div>\r\n\t<\/div>\r\n<\/div>',series_data:false,dynamic_tpl:{},elements:{},process:'<img src=\"https:\/\/i1.rozetka.com.ua\/design\/check-ajax.gif\" width=\"64\" height=\"64\" alt=\"\u041e\u0442\u043f\u0440\u0430\u0432\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445\" class=\"process\"\/>'},initialize:function(id,elem){this.parent(id,elem)},init:function(catalog,data_source,type){this.type=type;var data=data_source.getData();if(data.kit_id){this._kitid=data.kit_id}if(data.unit_ids){this.unit_goods_ids=data.unit_ids}if(data.kit_number){this._kit_number=data.kit_number}this.parent(catalog,data_source)},setDynamic:function(elem,tpl){var name=elem.getProperty('name');this.dynamic_data={};if(name&&typeof this.options.elements[this.type].dynamic[name]=='object'){tpl=this.options.dynamic_tpl[this.options.elements[this.type].dynamic[name].tpl_name];if(this.options.elements[this.type].dynamic[name].additional_data){this.dynamic_data=this.options.elements[this.type].dynamic[name].additional_data}}this.parent(elem,tpl)},getActiveTabName:function(){var tab_to_gtm={characteristics:'specifications'},tab_name='',result='';if($defined(rozetkaTabs)){tab_name=rozetkaTabs.getTabNameForGTM();if(tab_name){result=tab_to_gtm[tab_name]}}return result},addToComparison:function(e){var gtmData=this.getGTMOptions(e),extend_event={extend_event:[{name:'goods_id',value:this.id}]};if(e.checked==false){Comparison.deleteGoods(this.id)}else{this.parent();if(gtmData['location']){extend_event.extend_event.push({name:'eventLocation',value:gtmData['location']})}this.addGTMPosition(extend_event,this.id,'position_number');document.fireEvent('clickAddToCompare',extend_event);rozetkaEvents.trackEvent(null,'goods/compare/add',rozetkaEvents.getGoodsData(this.id))}},togglePromotionPopup:function(){var parent,promotions,prices_promotion;if(this.popup&&this.popup.isOpened()){this.popup.close()}else{promotions=Promotions.getPromotionsData();prices_promotion=this.getCurrentPricesPromotion();this.popup=new Popup_class(this.options.tpl_promotion_popup);if(prices_promotion){this.popup.setContent(App.getHTML(this.options.tpl_promotion_content,{data:prices_promotion}),{})}else{this.popup.setContent(App.getHTML(this.options.tpl_promotion_content,{data:promotions[this.id]}),{})}this.popup.open();this.firePluginEvent('loadContentComplete')}this.onActionComplete();App.fireEvent('renewImages')},openQuickView:function(){QuickView.toggleQuickView(this.id);QuickView.addEvent('completeToggle',function(){this.onActionComplete()}.bind(this));document.fireEvent('QuickViewClick',{extend_event:[{name:'goods_id',value:this.id}]})},hasPromotion:function(){var promotions=Promotions.getPromotionsData(),info=Promotions.getAdditionalText(),to_return=false;if(!(promotions[this.id]&&promotions[this.id].is_private)&&(promotions[this.id]||info[this.id])){to_return=true}return to_return},getGTMOptions:function(elem){var action=elem.getProperty('_action'),gtmLocation,gtmBlock,result={};gtmBlock={'accessories-add':'scroller_accessory','related-add':'scroller_related_products','related-add-vertical':'vertical_scroll','recent-goods-add':'new_recent_goods','software-add':'scroller_software','similar-add':elem.getParentByName('similar_goods_block',15)};gtmLocation={'popup-add':'photo','accessories-add':'accessories','related-add':this.getCatalogLocation(),'recent-goods-add':'recent','software-add':'software','specifications':'specifications','portal-popular-add':'popular','lightbox':'photoPopUp','search':'searchResults','similar-add':'similar','recent':'recent','listing':'ProductListing'};result['block']=gtmBlock[action]||null;result['location']=gtmLocation[action]||null;return result},setOnCompleteFn:function(fn){this._on_complete_fn=fn},getOnCompleteFn:function(){var on_complete_fn=this._on_complete_fn;delete this._on_complete_fn;return on_complete_fn},addToCart:function(elem){var goods_id=this.id,gtmOptions=this.getGTMOptions(elem);this.setOnCompleteFn(function(Response,data){var event_data={extend_event:[]};event_data.extend_event.push({name:'goods_id',value:goods_id});if(gtmOptions['location']){event_data.extend_event.push({name:'eventLocation',value:gtmOptions['location']})}else if(this.getCatalogLocation()){event_data.extend_event.push({name:'eventLocation',value:this.getCatalogLocation()})}if(Response.isDone()){if(gtmOptions['block']){this.addGTMPosition(event_data,goods_id,'slider_pos_number',gtmOptions['block']);this.addGTMContent(event_data,goods_id)}if(this.elem.hasAttribute('data-position')){event_data.extend_event.push({name:'eventContext',value:this.elem.getAttribute('data-position')})}document.fireEvent('clickToPurchases',event_data)}else{document.fireEvent('not_added_to_cart',event_data)}}.bind(this));App.tryUrchinTracker('/added-to-cart/');this.parent();document.fireEvent('openCart')},addToCartFromCart:function(){var extend_event=[];this.fireEvent('onActionStart');extend_event.push({name:"goods_id",value:this.id});if(this.elem.hasAttribute('_position')!=null){extend_event.push({name:'eventPosition',value:this.elem.getAttribute('_position').toInt()})}document.fireEvent('clickAddToOrderInCart',{extend_event:extend_event});this._flagAddToCart=true;Cart.doAction('add',this)},addKitToCart:function(){var event_data={extend_event:[]},data=this.getSource().getData();if(this._kit_number!=null){event_data.extend_event.push({name:'eventPosition',value:this._kit_number})}event_data.extend_event.push({name:'kit_id',value:this._kitid},{name:'eventLocation',value:'kit'},{name:'eventContent',value:data['complex']?data['complex']:'complement'});event_data.goods_ids=[this.id,this.unit_goods_ids];document.fireEvent('clickKitToPurchases',event_data);Cart.addKitGoods(this.id,this._kitid,this.unit_goods_ids);document.fireEvent('openCart')},addToCartByCredit:function(){Cart.options.is_buy_from_credit_popup=true;Cart.options.credit_id=this.elem.getElement('input[name=credit_id]').value;Cart.addGoods(this.id)},addKitFromCart:function(){var event_data={extend_event:[]};if(this._kit_number!=null){event_data.extend_event.push({name:'eventPosition',value:this._kit_number});rozetkaEvents.trackEvent('Cart','kit/cart/add/'+this._kit_number,rozetkaEvents.getGoodsData())}event_data.extend_event.push({name:'eventLocation',value:'kitCart'},{name:'kit_id',value:this._kitid});event_data.goods_ids=[this.id,this.unit_goods_ids];document.fireEvent('clickKitToPurchases',event_data);Cart.addKitGoodsFromCart(this.id,this._kitid,this.unit_goods_ids)},addKitFromPageCart:function(){Cart.addKitGoodsFromPageCart(this.id,this._kitid,this.unit_goods_ids)},addToCartFromCatalog:function(){var goods_id=this.id;App.tryUrchinTracker('/added-to-cart/');Cart.options.is_buy_from_catalog=true;this.setOnCompleteFn(function(Response){var event_data={extend_event:[]},location=this.getCatalogLocation();event_data.extend_event.push({name:'goods_id',value:goods_id});if(location){event_data.extend_event.push({name:'eventLocation',value:location})}if(Response.isDone()){this.addGTMPosition(event_data,goods_id,'position_number');document.fireEvent('clickToPurchases',event_data)}else{document.fireEvent('not_added_to_cart',event_data)}}.bind(this));Cart.doAction('add',this)},addToCartFromProfileWishlist:function(){var goods_id=this.id;this.setOnCompleteFn(function(Response){var event_data={extend_event:[]};if(Response.isDone()){event_data.extend_event.push({name:'goods_id',value:goods_id});event_data.extend_event.push({name:'eventLocation',value:'wishlist'});document.fireEvent('clickToPurchases',event_data)}});Cart.doAction('add',this)},openCart:function(e){Cart.openCart();document.fireEvent('openCart');this.onActionComplete()},toggleVariants:function(){if($defined(this.popup)&&this.popup.isOpened()){this.popup.close()}else{var parent=this.elem.getElement('[name=variants-popup-parent]');this.popup=new Popup_class(this.options.tpl_variants_popup,parent);this.popup.setContent(App.getHTML(this.options.tpl_variants_content,{data:this.options.variants_data,target:this.options.variants_target,id:this.id}));this.popup.open();App.fireEvent('renewImages');this.firePluginEvent('loadGoodsByPopupColors');rozetkaEvents.trackEvent(rozetkaEvents.getParam('category'),'color/popup/open',rozetkaEvents.getGoodsData(this.id))}this.onActionComplete()},toggleSeries:function(){var parent,scripts;if($defined(this.popup)&&this.popup.isOpened()){this.popup.close()}else{parent=this.elem.getElement('[name=model-select-parent]');this.popup=new Popup_class(this.options.tpl_series_popup,parent);this.popup.setContent(App.getHTML(this.options.tpl_series_content,{data:this.options.series_data}),{});this.popup.open();if(!$defined(window.gecko)){scripts=this.popup.getElements('script');if(scripts.length){scripts.each(function(element){eval(element.innerHTML)})}}this.popup.getElement('a[name=compare-all-series]').addEvent('click',function(e){new Event(e).stop();SeriesComparison.openComparison()})}this.onActionComplete()},inCart:function(){var key,inCart=false;if($defined(Cart.goods[this.id])){for(key in Cart.goods[this.id]){if(Cart.goods[this.id][key].parent_id==""&&Cart.goods[this.id][key].kit==null){inCart=true}}}return inCart},inCartKit:function(){var inCart=false,source_data=this.getSource().getData(),source_goods_ids=[];if($defined(Cart.goods[this.id])&&source_data['unit_ids']){source_goods_ids=Object.values(source_data['unit_ids']);Object.values(Cart.goods[this.id]).filter(function(item){return(item.kit&&item.kit_id==this._kitid)}.bind(this)).forEach(function(purchase){var count_units=this.getUnitsPurchasesForKit(purchase.id).filter(function(unit_purchase){return(unit_purchase['goods']&&source_goods_ids.contains(unit_purchase['goods']['id'].toInt()))}).length;if(source_goods_ids.length==count_units){inCart=true}}.bind(this))}return inCart},getUnitsPurchasesForKit:function(parent_id){var result=[];Object.values(Cart.goods).each(function(item){Object.values(item).each(function(purchase){if(purchase.parent_id==parent_id){result.push(purchase)}})});return result},getCurrentPricesPromotion:function(){var promotions=null,curent_promotion=null,curentTime=new Date();if(typeof PricesPromotions!="undefined"){promotions=PricesPromotions.getPromotionsData();for(var promotion in promotions){if(S&&S.data.user&&promotions[promotion].special_price&&promotions[promotion].special_price==S.data.user.price_type&&promotions[promotion].end_date>curentTime.getTime()&&promotions[promotion].promo_goods&&promotions[promotion].promo_goods.indexOf(this.id)){curent_promotion=promotions[promotion];break}}}return curent_promotion},update:function(){var promotions=window['Promotions']?Promotions.getPromotionsData():null,CountdownTimer,prices_promotion=this.getCurrentPricesPromotion(),end_date;this.collectionElements(this.options.elements[this.type].dynamic,'setDynamic');this.collectionElements(this.options.elements[this.type].active,'setActive');if(prices_promotion&&!prices_promotion.is_termless){end_date=prices_promotion.end_date}else if(this.elem.promotions_detail&&this.hasPromotion()){if(promotions[this.id]&&!promotions[this.id].is_termless){end_date=promotions[this.id].end_date}}if($('promotion_countdown_timer')&&end_date){CountdownTimer=new CountdownTimer_class('promotion_countdown_timer',end_date,CountdownTimer_class.project_options);CountdownTimer.run()}if(this.elem.promotions_detail&&this.elem.promotions_detail.hasClass('hidden')&&((this.hasPromotion()&&promotions[this.id])||prices_promotion)){this.elem.promotions_detail.removeClass('hidden')}},addToWishlist:function(elem){var type=elem.getProperty('button_type')||'icon',location=this.getCatalogLocation(),extend=[];if(location){extend.push({name:'eventLocation',value:location})}if(this.elem.hasAttribute('data-position')){extend.push({name:'eventContext',value:this.elem.getAttribute('data-position')})}else{extend.push({name:'eventContext',value:type})}this.parent();document.fireEvent('openWishlistPopup',this.setGTMinfo('gtm_wishlist',elem,extend))},addToWaitlist:function(elem){var location=this.getCatalogLocation(),extend=[];if(location){extend.push({name:'eventLocation',value:location})}if(Waitlist.isChangePrice(this.id)){extend.push({name:'eventLabel',value:'followPrice'})}this.parent();document.fireEvent('addToWaitlist',this.setGTMinfo('gtm_waitlist',elem,extend))},setGTMinfo:function(key,elem,extend){var event_data=App.getStorage().get(key),new_event_data={extend_event:[]},eventLocation=elem.getProperty('_action');if(eventLocation){new_event_data.extend_event.push({name:'eventLocation',value:eventLocation})}new_event_data.extend_event.push({name:'goods_id',value:this.id});this.addGTMPosition(new_event_data,this.id,'position_number');if(extend){extend.each(function(item){new_event_data.extend_event.push(item)})}if(event_data!=null&&typeof event_data=='object'){event_data[this.id]=new_event_data}else{event_data={};event_data[this.id]=new_event_data}App.getStorage().set(key,event_data);return new_event_data},addGTMPosition:function(event_data,goods_id,prefix,block){var position;if(block){block=$(block);position=block?block.getElement('[name='+prefix+goods_id+']'):null}else{position=$E('[name='+prefix+goods_id+']')}if(position&&position.value){event_data.extend_event.push({name:'eventPosition',value:parseInt(position.value,10)})}if(block&&block.getProperty('orientation')){event_data.extend_event.push({name:'eventContext',value:block.getProperty('orientation')})}},addGTMContent:function(event_data,goods_id){var content=$$('[name=content_gtm'+goods_id+']')[0];if(content&&content.value){event_data.extend_event.push({name:'eventContent',value:content.value})}},getCatalogLocation:function(){return this.elem.hasAttribute('data-location')?this.elem.getAttribute('data-location'):null}});RozetkaGoods_class.implement(new PluginEvents_class());var Purchase_class=CatalogItem_class.extend({id:null,initialize:function(id,elem){this.parent(id,elem);Cart.addEvent('actionCompleteForPurchase'+this.id,this.onActionComplete.bind(this))},onActionComplete:function(e){this.parent(e);if(Cart.getPurchase(this.id)){Cart.fireEvent('purchaseUpdated',this);document.fireEvent('purchaseUpdated',this)}else{Cart.fireEvent('purchaseDeleted',this);document.fireEvent('purchaseDeleted',this)}},Delete:function(){Cart.doAction('delete',this)},Edit:function(initiator){var data=this.source.getData();if(initiator){data.quantity=initiator.value}this.source.sourceChange(data);Cart.doAction('edit',this)},getProperty:function(name){if((Cart.getPurchase(this.id))){return Cart.getPurchase(this.id)[name]}else{this.elem.addClass('hidden')}},getDataFromSource:function(){var data=this.source.getData();if(!data.id&&data.goods_id){data.id=data.goods_id}return data},setActive:function(elem,param){if(!$defined(param.event))param.event='click';switch(param.event){case'change_quantity':{var old_value=elem.value;elem.old_value=elem.value;elem.addEvent('keydown',function(){elem.old_value=elem.value});elem.addEvent('keyup',function(){if(/^(0|[1-9][0-9]{0,}|[1-9]*)$/.exec(elem.value)==null){elem.value=old_value}else if(elem.old_value!=elem.value&&elem.value!=''){if(elem.value!=0||!$defined(param.confirm_tpl)||confirm(App.getHTML(param.confirm_tpl,this))){this.fireEvent('onActionStart',{action:param.action,initiator:elem});this[param.action](elem)}else{elem.value=elem.old_value}}}.bind(this));break}default:{this.parent(elem,param)}}}});var RozetkaPurchase_class=CatalogItem_class.extend({options:{selectors:{popup_move:'[name=popup-move]',elem_minus:'[name=minus]'}},id:null,class_name:'RozetkaPurchase_class',is_profile:false,quantity_elem:null,sum_elem:null,old_sum_elem:null,is_active:true,purchase_type:'',_popup_move:null,initialize:function(id,elem){this.parent(id,elem);Cart.addEvent('actionCompleteForPurchase'+this.id,this.onActionComplete.bind(this));Cart.getPopup().addEvent('close',function(){if(Cart.getPurchase(this.id))Cart.getPurchase(this.id).just_added=false}.bind(this))},init:function(catalog,data_source){var _controller=this;this.parent(catalog,data_source);this.quantity_elem=this.elem.getElement('input[name=quantity]');this.sum_elem=this.getElement().getElement('[name="sum"]');this.old_sum_elem=this.getElement().getElement('[name="old_sum"]');this.absolute_discount_elem=this.getElement().getElement('[name="absolute_discount"]');if(Cart.changed_purchases[this.id]){this.quantity_elem.value=Cart.changed_purchases[this.id];this.RecountCost()}this.purchase_type=Cart.popup.there_just_added?(this.getProperty('just_added')?'last-goods':'another-goods'):'goods';this.elem.getElements('[name=goods-link]').addEvent('click',function(){var target=this.getElement('img')?'photo':'title';rozetkaEvents.trackEvent(rozetkaEvents.getParam('cart_category'),_controller.purchase_type+'/'+target+'/click',rozetkaEvents.getGoodsData(_controller.getProperty('goods').id))});this._popup_move=this.elem.getElement(this.options.selectors.popup_move);Wishlists.addEvent('showSelectorPopup',function(goods_id){if(this.getProperty('goods').id==goods_id){this._updateCart()}}.bind(this))},getElement:function(){return!this.getProperty('kit')?this.elem:this.elem.getParent()},enable:function(){this.is_active=true;var elem=!this.getProperty('kit')?this.elem:this.elem.getParent();elem.addClass('active');this.RecountCost()},RecountCost:function(){if(this.getQuantity()>=1){this._setActiveElementMinus();Cart.recountCost(this)}},recountOldSum:function(){var old_sum,kit_price_without_discount,discount;if(!this.getProperty("kit")){kit_price_without_discount=this.getProperty("price").primary.raw}else{if(this.getProperty("kit").price_without_discount){kit_price_without_discount=this.getProperty("kit").price_without_discount}else{discount=Cart.getNotParentDiscounts(this.id,'Goods.Kits').pop();if(discount){kit_price_without_discount=discount.raw_data.cost_without_discount}}}if(kit_price_without_discount){old_sum=Math.round(kit_price_without_discount*this.getQuantity());this.old_sum_elem.setText(old_sum.toString().toPriceFormat());if(this.absolute_discount_elem){this.absolute_discount_elem.setText(Math.round(old_sum-this.getSum()).toString().toPriceFormat())}}},getSum:function(){var sum,kit_price_with_discount;if(!this.getProperty("kit")){sum=this.getProperty("price_with_discount").primary.raw*this.getQuantity()}else{if(!this.getProperty("kit").price_with_discount||this.getProperty("kit").price_with_discount==this.getProperty("price_with_discount").primary.raw){kit_price_with_discount=this.getProperty("kit").costKit/this.getProperty("quantity")}else{kit_price_with_discount=this.getProperty("kit").price_with_discount}sum=kit_price_with_discount*this.getQuantity()}return sum},setSumText:function(text){this.sum_elem.setText(text);this.old_sum_elem&&this.recountOldSum()},QuantityPlus:function(target){var old_is_active=this.is_active;this.is_active&&this.quantity_elem.value++;this.enable();this._setActiveElementMinus();rozetkaEvents.trackEvent(rozetkaEvents.getParam('cart_category'),this.purchase_type+'/quantity/up/'+this.getQuantity()+(old_is_active?'':'-on'),rozetkaEvents.getGoodsData(this.getProperty('goods').id));this.fireQuantityChangedEvent()},_getMinusElement:function(){return this.elem.getElement(this.options.selectors.elem_minus)},_setActiveElementMinus:function(){var quantity=this.getQuantity(),css_class='active',elem=this._getMinusElement();if(quantity>1){!elem.hasClass(css_class)&&elem.addClass(css_class)}else{elem.hasClass(css_class)&&elem.removeClass(css_class)}},QuantityMinus:function(target,flag){var old_is_active=this.is_active;if(this.quantity_elem.value>1){this.quantity_elem.value--}this.enable();this._setActiveElementMinus();rozetkaEvents.trackEvent(rozetkaEvents.getParam('cart_category'),this.purchase_type+'/quantity/down/'+this.getQuantity()+(this.is_active?(old_is_active?'':'-on'):'-off'),rozetkaEvents.getGoodsData(this.getProperty('goods').id));this.fireQuantityChangedEvent()},fireQuantityChangedEvent:function(){var purchase=Cart.S.purchases[this.id],goods_id=purchase.goods.id,quantity=this.getQuantity(),event_data={extend_event:[]};if(purchase.kit_id){event_data.extend_event.push({name:'kit_id',value:purchase.kit_id});event_data.extend_event.push({name:'eventLocation',value:'kit'})}else{event_data.extend_event.push({name:'goods_id',value:goods_id});event_data.extend_event.push({name:'eventLocation',value:'cart'})}event_data.extend_event.push({name:'eventContext',value:quantity});document.fireEvent('changeQuantityPurchases',event_data)},Delete:function(){var purchase=Cart.getPurchase(this.id),event_data={extend_event:[]};if(purchase.kit_id){event_data.extend_event.push({name:'eventLabel',value:'kit'});event_data.extend_event.push({name:'kit_id',value:purchase.kit_id})}else{event_data.extend_event.push({name:'eventLabel',value:'product'});event_data.extend_event.push({name:'goods_id',value:purchase.goods.id});event_data.extend_event.push({name:'eventValue',handlerID:'getProductPrice'})}document.fireEvent('deleteFromPurchases',event_data);Cart.changeQuantity();Cart['delete'](this.id)},getProperty:function(name){return Cart.getPurchase(this.id)?Cart.getPurchase(this.id)[name]:null},getUnitsPurchases:function(){return Cart.getUnitsPurchases(this.id)},getSeller:function(){return Cart.getSellerByPurchaseId(this.id)},inWishlist:function(){return Wishlists.inWishlist(this.getProperty('goods').id)},update:function(){if(Cart.getPurchase(this.id)){this.elem.setHTML(App.getHTML(this.options.dynamicElements.content,this));this.collectionElements(this.options.activeElements,'setActive')}},isShowDiscount:function(){return Cart.isShowFullDiscount(this.id)},getQuantity:function(){return $defined(this.quantity_elem)?this.quantity_elem.value:0},setActive:function(elem,param){if(!$defined(param.event))param.event='click';switch(param.event){case'change_quantity':{this.onChangeQuantity(elem,param);break}default:{this.parent(elem,param)}}},onChangeQuantity:function(elem,param){var special_codes={delete_code:46,backspace_code:8,left_code:37,right_code:39},onNotValid=function(el){var fx=new Fx.Styles(el,{duration:400});fx.start({'background-color':'#ffa6a6'}).chain(function(){fx.start({'background-color':'#ffffff'})})},pressed_special_code=false,checkZero=function(){if((/^\d*$/).test(elem.value)&&parseInt(elem.value)==0){this.fireEvent('onActionStart');this.Delete()}}.bind(this);elem.addEvent('blur',function(){checkZero();this.RecountCost()}.bind(this));elem.addEvent('keydown',function(e){var event=new Event(e);pressed_special_code=false;if(event.code==27||event.key=='esc'){event.stop();elem.value=Cart.getPurchase(this.id).quantity;elem.blur()}else if(event.code==13||event.key=='enter'){checkZero();event.stop();this.RecountCost()}else if(event.code==107||event.code==187||event.key=='+'||event.code==38||event.key=='up'){event.stop();this.QuantityPlus()}else if(event.code==109||event.code==189||event.key=='-'||event.code==40||event.key=='down'){event.stop();this.QuantityMinus()}else if(Object.values(special_codes).contains(event.code)){pressed_special_code=true}}.bind(this));elem.addEvent('keypress',function(e){var event=new Event(e);if(!pressed_special_code){if(isNaN(event.key)||(document.getSelection().type!="Range"&&/^(\d){0,3}$/.exec(elem.value+event.key)==null)){event.stop();onNotValid(elem)}}})},beforeDelete:function(){document.fireEvent('beforeDeleteFromPurchases',{extend_event:[{name:'goods_id',value:this.getProperty('goods').id}]});CartList._catalog.each(function(elem){if(elem!==this&&elem._popup_move&&elem._popup_move.isVisible()){elem._popup_move.hide()}}.bind(this));this._popup_move.show();this.onActionComplete()},_hideCartOverlay:function(){if(Cart.getPopup()._overlay){Cart.getPopup()._overlay._elem.setStyle('z-index',Cart.getPopup().options.level+1)}},_showCartOverlay:function(){if(Cart.getPopup()._overlay){Cart.getPopup()._overlay._elem.setStyle('z-index',Cart.getPopup().options.overlay_level)}},_updateCart:function(){Cart.getPopup().setLocked(true);this._hideCartOverlay();Wishlists._is_cart_action=true},move:function(){document.fireEvent('clickOpenWishlist');var goods_id=this.getProperty('goods').id;this._updateCart();Cart.addEvent('update',function(){if(this.getPopup()&&this.getPopup().isOpened()){this.openCart()}});Wishlists.addEvent('popupsWishlistsClose',function(){this._showCartOverlay();if(Wishlists.inWishlist(goods_id)){this.fireEvent('onActionStart');this.Delete()}else{this.onActionComplete()}document.fireEvent('closeWishlistInCart');Cart.getPopup().setLocked(false);Wishlists._is_cart_action=false}.bind(this));Wishlists.addGoods(goods_id)},cancel:function(){this._popup_move.hide();document.fireEvent('clickCancelDeleteFromCart');this.onActionComplete()}});var Suggest_class=new Class({options:{source:null,tpl:'',styles:{},url:'/cgi-bin/form.php'},_is_opened:false,initialize:function(){this._currentValue='';this._history={};this._suggest=null;this.elem=new Element('div')},init:function(input){this.input=$(input).addEvent('focus',this.onFocus.bind(this)).addEvent('keydown',this.onKeyDown.bind(this)).addEvent('keyup',this.onKeyUp.bind(this));this.input.getParent().addEvent('click',function(e){new Event(e).stop()});$E('body').addEvent('click',this.onBlur.bind(this));this.elem.setStyles({position:'absolute','margin-top':this.input.getSize().size.y});if(this.options.styles){this.elem.setStyles(this.options.styles)};this.elem.injectBefore(this.input)},onFocus:function(e){this._currentValue=this.input.value;if(this._suggest)this._show()},onBlur:function(e){this._hide()},onKeyDown:function(e){e=new Event(e);if(e.key=='up'||e.key=='down'){e.stop();this._moveActive(e.key=='up'?-1:1)}else if(e.key=='enter'&&this._suggest&&this._suggest.key!==null){e.stop();this._enterActive(this._suggest.key)}else if(e.key=='esc'){this.input.value='';this._checkChanges(false)}},onKeyUp:function(e){if(this.input.value!==this._currentValue){this._currentValue=this.input.value;this._checkChanges.delay(333,this,[this.input.value])}},_moveActive:function(shift){with(this._suggest){this._setActive(key==null?(shift<0?elems.length-1:0):(0<=key+shift&&key+shift<=elems.length-1?key+shift:null))}},_setActive:function(k){this._suggest.key=k;with(this._suggest){if(active)active.removeClass('active');active=key!==null?elems[key].addClass('active'):null}},_enterActive:function(k){window.location=this._suggest.records[k].href},_show:function(){this.elem.setStyle('display','');this._is_opened=true},_hide:function(){this.elem.setStyle('display','none');this._is_opened=false},isOpened:function(){return this._is_opened},_checkChanges:function(value){if(!$type(value)&&this.input.value==''){this._hide()}else if(value==this.input.value){$defined(this._history[this.input.value])?this._suggestion(this.input.value):this._getSuggest(this.input.value)}},_suggestion:function(test){this._suggest=$extend({elems:[],key:null,active:null},this._history[test]);this.elem.setHTML(this._suggest.html);this._show();if(this._suggest.count){this._suggest.records.each(function(item,key){this._suggest.elems.include(this.elem.getElement('[name='+key+']').addEvent('mousemove',this._setActive.bind(this,key)).addEvent('click',this._enterActive.bind(this,key)))}.bind(this));var show_all=this.elem.getElement('[name=show-all]');if(show_all){show_all.form=this.input.form;show_all.addEvent('click',function(e){new Event(e).stop();show_all.form.submit()})}}},_getSuggest:function(test){var options={headers:{ajaxAction:this.options.source},data:{},onSuccess:this._setSuggest.bind(this),onComplete:this._suggestion.bind(this,test)};options.data[this.input.name]=test;options.data['suggest']=1;new Ajax(this.options.url,options).request()},_setSuggest:function(resp){var Response=new Response_class(resp);Response.doAction();if(!Response.isError()){this._history[Response.content.text]=$extend({html:App.getHTML(this.options.tpl,Response.content)},Response.content)}}});Suggest_class.implement(new Options);var RozetkaSuggest_class=Suggest_class.extend({initialize:function(){this.parent();this.attachToObserver([])},_setSuggest:function(resp){this.parent(resp);var Response=new Response_class(resp);this.pushToGA(Response.content.records);this.pushToGTM(Response.content.records)},pushToGA:function(goods_records){var goods_gtm_data=[];for(var i=0;i<goods_records.length;i++){goods_gtm_data.push({test:goods_records[i].test,eventProductName:goods_records[i].title,eventProductId:goods_records[i].id,eventProductPrice:goods_records[i].price_usd_clear,eventProductVendorName:goods_records[i].producer,eventCategoryName:goods_records[i].parent,eventList:goods_records[i].list,eventPosition:goods_records[i].position})}document.fireEvent('suggestShow',{extend_event:[{name:'suggestImpressions',value:goods_gtm_data}]})},pushToGTM:function(goods_records){var gtmdata=[];Object.values(goods_records).each(function(record){gtmdata.push({id:parseInt(record.id),parent_id:parseInt(record.parent_id),top_parent_id:parseInt(record.top_parent_id),producer_id:parseInt(record.producer_id),price_usd:parseInt(record.price_usd_clear),rank:record.rank,type:record.type,part:record.part})});this.fireEvent('LoadGTMData',gtmdata)}});RozetkaSuggest_class.implement(new Events());var SearchSuggest_class=RozetkaSuggest_class.extend({options:{source:'http://rozetka.com.ua/search/',catalog:'http://rozetka.com.ua/search/catalog/',tpl:'{if text}\r\n\t<div class=\"header-search-suggest\">\r\n\t\t{if count}\r\n\t\t\t<div class=\"header-search-suggest-g\">\r\n\t\t\t{var i=1}\r\n\t\t\t{for record in records}\r\n\t\t\t\t<div class=\"header-search-suggest-i sprite-side\" name=\"${record_index}\">\r\n\t\t\t\t\t<div class=\"header-search-suggest-i-img\">\r\n\t\t\t\t\t\t<a class=\"header-search-suggest-i-img-link\"\r\n\t\t\t\t\t\tonclick=\"document.fireEvent(\u0027goodsImageClick\u0027,{extend_event: [\r\n\t\t\t\t\t\t\t{name: \u0027goods_id\u0027, value: ${record.id}},\r\n\t\t\t\t\t\t\t{name: \u0027eventError\u0027, value: \u0027${text}\u0027},\r\n\t\t\t\t\t\t\t{name: \u0027eventLocation\u0027, value: \u0027SearchBar\u0027},\r\n\t\t\t\t\t\t\t{name: \u0027eventPosition\u0027, value: ${i}}\r\n\t\t\t\t\t\t]});\"\r\n\t\t\t\t\t\thref=\"${record.href}\">\r\n\t\t\t\t\t\t\t${record.image}\r\n\t\t\t\t\t\t<\/a>\r\n\t\t\t\t\t<\/div>\r\n\t\t\t\t\t<div class=\"header-search-suggest-i-detail\">\r\n\t\t\t\t\t\t<div class=\"header-search-suggest-i-title\">\r\n\t\t\t\t\t\t\t<a class=\"header-search-suggest-i-title-link\"\r\n\t\t\t\t\t\t\tonclick=\"document.fireEvent(\u0027goodsTitleClick\u0027,{extend_event: [\r\n\t\t\t\t\t\t\t{name: \u0027goods_id\u0027, value: ${record.id}},\r\n\t\t\t\t\t\t\t{name: \u0027eventLocation\u0027, value: \u0027SearchBar\u0027},\r\n\t\t\t\t\t\t\t{name: \u0027eventPosition\u0027, value: ${i}},\r\n\t\t\t\t\t\t\t{name: \u0027eventError\u0027, value: \u0027${text}\u0027}\r\n\t\t\t\t\t\t\t]});\"\r\n\t\t\t\t\t\t\thref=\"${record.href}\">${record.title}<\/a>\r\n\t\t\t\t\t\t<\/div>\r\n\t\t\t\t\t\t{if record.sell_status!=\"archive\"}\r\n\t\t\t\t\t\t\t<div class=\"header-search-suggest-uah{if record.status == \"unavailable\"} header-search-suggest-uah-outofstock{\/if}\">{if parseInt(record.price)>0}${record.price}{\/if}<\/div>\r\n\t\t\t\t\t\t{\/if}\r\n\t\t\t\t\t<\/div>\r\n\t\t\t\t<\/div>\r\n\t\t\t\t{var i=i+1}\r\n\t\t\t{\/for}\r\n\t\t\t<a class=\"arrow-linnk header-search-suggest-more-link\" name=\"show-all\" href=\"#show-all\">\r\n    \t\t<span class=\"arrow-link-inner\">\u0412\u0441\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043f\u043e\u0438\u0441\u043a\u0430<\/span>&nbsp;&rarr;\r\n\t\t\t<\/a>\r\n\t\t{else}\r\n\t\t\t<p class=\"header-search-suggest-nothing\">\r\n\t\t\t\t\u041f\u043e&nbsp;\u0432\u0430\u0448\u0435\u043c\u0443 \u0437\u0430\u043f\u0440\u043e\u0441\u0443 \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435&nbsp;\u043d\u0430\u0439\u0434\u0435\u043d\u043e. <nobr>\u0423\u0442\u043e\u0447\u043d\u0438\u0442\u0435 \u0441\u0432\u043e\u0439 \u0437\u0430\u043f\u0440\u043e\u0441<\/nobr>\r\n\t\t\t<\/p>\r\n\t\t{\/if}\r\n\t<\/div>\r\n{\/if}',url:'/cgi-bin/search-form.php',selectors:{button:'[name=search-button]',text:'input[name=text]',form:'form[name=search-form]',suggest_container:'[name=header-search-suggest-container]',category:{element:'input[name=section_id]',value:'[name=search-category-value]',link:'[name=search-category]'},list:{container:'[name=search-category-list]',item:'[name=search-category-list-item]'}},cssClasses:{classHidden:'hidden',classActive:'active'},attributes:{section_id:'section_id'},styles:{position:'absolute',width:'100%'}},_textWrap:null,_container:null,_button:null,input:null,_form:null,_list:null,_category_element:null,_category_value:null,_categories:[],initialize:function(container){if(container){this._container=container}this.parent()},init:function(){var suggest_container=null;this._form=this._container.getElement(this.options.selectors.form);this._category_element=this._container.getElement(this.options.selectors.category.element);this._category_value=this._container.getElement(this.options.selectors.category.value);this.input=this._form.getElement(this.options.selectors.text).addEvent('focus',this.onFocus.bind(this)).addEvent('keydown',this.onKeyDown.bind(this)).addEvent('keyup',this.onKeyUp.bind(this));this.input.value=App.htmlSpecialChars(this.input.value);this.input.getParent().addEvent('click',function(e){new Event(e).stop()});$E('body').addEvent('click',this.onBlur.bind(this));if(this.options.styles){this.elem.setStyles(this.options.styles)}suggest_container=this._form.getElement(this.options.selectors.suggest_container);if(suggest_container){this.elem.inject(suggest_container)}this._button=this._form.getElement(this.options.selectors.button);this._form.getElement(this.options.selectors.category.link).addEvent('click',this._showCategoryList.bind(this));this._list=this._container.getElement(this.options.selectors.list.container);this._categories=this._list.getElements(this.options.selectors.list.item);this._categories.each(function(element){element.addEvent('click',this._setActiveCategory.bind(this))}.bind(this))},_setActiveCategory:function(e){var item=e.target.getParent(),text=e.target.innerHTML,gtm_events=[];new Event(e).stop();this._categories.each(function(elem){if(elem.hasClass(this.options.cssClasses.classActive)){elem.removeClass(this.options.cssClasses.classActive)}}.bind(this));item.addClass(this.options.cssClasses.classActive);if(item.hasAttribute(this.options.attributes.section_id)){this._category_element.disabled=false;this._category_element.value=item.getAttribute(this.options.attributes.section_id);this._form.action=this.options.catalog;gtm_events.push({name:'eventProductCategoryId',value:this._category_element.value})}else{this._form.action=this.options.source;this._category_element.disabled=true}this._category_value.innerHTML=text;this._hideCategoryList();if(this.input.value!=this.input.getAttribute('hint')){this._getSuggest(this.input.value)}this._moveCursorToEnd(this.input);gtm_events.push({name:'eventPosition',value:this._categories.indexOf(item)+1});document.fireEvent('openCategorySeach',{extend_event:gtm_events})},_moveCursorToEnd:function(el){if(!el.focus){el.focus()}el.selectionStart=el.selectionEnd=el.value.length},_showCategoryList:function(e){new Event(e).stop();if(this._list.hasClass(this.options.cssClasses.classHidden)){this._hide();this._list.show()}else{this._list.hide()}document.fireEvent('showCategorySearch')},_hideCategoryList:function(){this._list.hide()},onFocus:function(e){this.parent();this._hideCategoryList();this._form.addClass(this.options.cssClasses.classActive)},onBlur:function(e){this.parent();this._hideCategoryList();if(this._form.hasClass(this.options.cssClasses.classActive)&&!this.input.value){this._form.removeClass(this.options.cssClasses.classActive)}},_getSuggest:function(test){var options={headers:{ajaxAction:this.options.source},data:{},onSuccess:this._setSuggest.bind(this),onComplete:this._suggestion.bind(this,test)};options.data[this.input.name]=test;if(!this._category_element.disabled){options.data[this._category_element.name]=this._category_element.value}options.data['suggest']=1;new Ajax(this.options.url,options).request()},_suggestion:function(test){this.parent(test.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&apos;'));var show_all=this.elem.getElement('[name=show-all]');if(show_all){show_all.form=this.input.form;show_all.addEvent('click',function(e){document.fireEvent('showAll',{extend_event:[{name:'eventContext',value:test}]})})}}});var Comparison_class=new Class({is_updated:0,goods:{},quantity:0,options:{list_head_active_class:'c-list-head-active',list_head_name:'list_head',list_body_name:'list_body',list_sections_min_count:2},initialize:function(options){this.setOptions(options);if(S.checkup)this.onLoadS(S);S.addEvent('loadS4comparison',this.onLoadS.bind(this));S.addEvent('loadS',function(S){this.onLoadS(S)}.bind(this));this.addEvent('update',this.onUpdate.bind(this))},init:function(id){if(!id){id='comparison'+$random(0,100000);document.write("<div id='"+id+"'></div>")}this.elem=$(id);if(S.checkup)this.update()},update:function(){if($defined(this.elem))this.elem.setHTML(App.getHTML(this.options.tpl,this));this.fireEvent('update');this.is_updated=1},onLoadS:function(S){this.S=$defined(S.comparison)?S.comparison:{sections:{}};this.goods={};this.quantity=0;for(var id in this.S.sections){this.S.sections[id].count=0;with(this.S.sections[id])for(var c_id in comparisons){this.goods[comparisons[c_id].goods.id]=comparisons[c_id];this.goods[comparisons[c_id].goods.id].section=this.S.sections[id];count++;this.quantity++}};this.update()},doAction:function(action,id,goods_id){var data={};if(id)data.id=id;if(goods_id)data.goods_id=goods_id;var request=new Ajax('/cgi-bin/form.php');var options={data:data,onComplete:this.onActionComplete.bindAsEventListener(request,action),headers:{ajaxAction:'http://rozetka.com.ua/comparison/#'+action}};request.setOptions(options).request()},onActionComplete:function(event,action){var Response=new Response_class(this.response.text);var goods_id=this.options.data.goods_id?this.options.data.goods_id:'';Response.doAction();Comparison.fireEvent('actionCompleteForGoods'+goods_id);App.trackGTMEvent({'eventCategory':'Interactions','eventAction':action,'eventLabel':'Comparison','eventProductId':goods_id})},isPossibilityToCompare:function(goods_id){var result=false;for(goods_id in this.goods){if(this.goods[goods_id].section.count>1){result=true;break}}return result},addGoods:function(goods_id){this.doAction('add','',goods_id)},deleteGoods:function(goods_id){this.doAction('delete','',goods_id)},clear:function(section_id){this.doAction('clear','',section_id)},empty:function(){return $defined(this.S)?!this.quantity:null},onUpdate:function(){var sections_count=Object.getLength(this.S.sections);var parent=this.elem;if(parent&&sections_count>=this.options.list_sections_min_count){var list_head=parent.getElement('[name="'+this.options.list_head_name+'"]');var list_body=parent.getElement('[name="'+this.options.list_body_name+'"]');list_head.addEvent('click',function(e){new Event(e).stop();list_head.toggleClass(this.options.list_head_active_class);list_body.toggleClass('hidden')}.bind(this));document.addEvent('click',function(event){if(!list_body.hasClass('hidden')){list_head.removeClass(this.options.list_head_active_class);list_body.addClass('hidden')}}.bind(this))}}});Comparison_class.implement(new Options,new Events);var RozetkaComparison_class=Comparison_class.extend({options:{process:'<img src=\"https:\/\/i1.rozetka.com.ua\/design\/check-ajax.gif\" width=\"64\" height=\"64\" alt=\"\u041e\u0442\u043f\u0440\u0430\u0432\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445\" class=\"process\"\/>',popups:{empty:'<div class=\"header-popup header-popup-comparison-empty sprite-side \">\n\t<h3 class=\"header-popup-info-title\">\u041d\u0435\u0442 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0432&nbsp;\u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u0438<\/h3>\n\t<p class=\"header-popup-info-title-under\">\u0414\u043e\u0431\u0430\u0432\u043b\u044f\u0439\u0442\u0435 \u0442\u043e\u0432\u0430\u0440\u044b \u043a&nbsp;\u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u044e \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a<\/br> \u0438&nbsp;\u0432\u044b\u0431\u0438\u0440\u0430\u0439\u0442\u0435 \u0441\u0430\u043c\u044b\u0439 \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u0432\u0430\u043c \u0442\u043e\u0432\u0430\u0440<\/p>\n<\/div>',no_empty:'<div class=\"header-popup-comparison-b\">\n\t<ul class=\"header-popup header-popup-comparison-full\">\n\t\t{var index=1}\n\t\t{for section in getSections()}\n\t\t<li class=\"header-popup-comparison-full-i\" name=\"comparison_section\">\n\t\t\t<a\n\t\t\t\t\tclass=\"header-popup-comparison-full-i-link novisited pos-fix\"\n\t\t\t\t\thref=\"${section.href}\"\n\t\t\t\t\tonclick=\"document.fireEvent(\u0027chooseCompare\u0027, {extend_event: [{name:\u0027eventContent\u0027, value:\u0027${section.title}\u0027},{name:\u0027eventPosition\u0027, value:${index}}]});\"\n\t\t\t\t\t>\n\t\t\t\t${section.title}<span class=\"header-popup-comparison-full-i-link-text\">&nbsp;(${section.count})<\/span>\n\t\t\t\t<span class=\"comparison-list-i-clear\" name=\"clear_goods\" data-section=\"${section_index}\">\n\t\t\t\t\t<img src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" width=\"15\" height=\"15\" alt=\"&times;\" class=\"list-compare-l-i-icon sprite\">\n\t\t\t\t<\/span>\n\t\t\t<\/a>\n\t\t<\/li>\n\t\t{var index=index+1}\n\t\t{\/for}\n\t<\/ul>\n<\/div>\n',container:'<div class=\"popup-css popup-comparison-full\">\n\t<a href=\"#\" class=\"popup-close\" name=\"close\"><img width=\"18\" height=\"18\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"&times;\" class=\"popup-close-medium-icon sprite\"><\/a>\n\t<div name=\"content\"><\/div>\n<\/div>',content:'<div class=\"popup-comparison-full-head\">\u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0441\u0440\u0430\u0432\u043d\u0438\u0442\u044c \u043d\u0435 \u0431\u043e\u043b\u0435\u0435 ${_limit} \u0442\u043e\u0432\u0430\u0440${_limit|morphology:[\u0027\u0027, \u0027\u0430\u0027, \u0027\u043e\u0432\u0027]} \u043e\u0434\u043d\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e<\/div>\n<div class=\"popup-comparison-full-text\">\u0427\u0442\u043e\u0431\u044b \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c \u0443\u0434\u0430\u043b\u044f\u0442\u044c \u0442\u043e\u0432\u0430\u0440\u044b, \u0443\u0434\u0430\u043b\u0438\u0442\u0435 \u043d\u0430\u0438\u043c\u0435\u043d\u0435\u0435 \u0438\u043d\u0442\u0435\u0440\u0435\u0441\u043d\u044b\u0435 \u0434\u043b\u044f \u0432\u0430\u0441 \u043c\u043e\u0434\u0435\u043b\u0438 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435 \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u044f<\/div>\n{var comparison_href = \"http:\/\/rozetka.com.ua\/comparison\/\"}\n{if section_id && S.sections && S.sections[section_id]}\n    {var comparison_href=S.sections[section_id][\u0027href\u0027]}\n{\/if}\n<a href=\"${comparison_href}\" class=\"popup-comparison-full-link\">\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043a \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u044e<\/a>\n\n\n'},header_button_content:'{if quantity}\n\t<a href=\"{if quantity == 1}${getFirstSectionHref()}{else}http:\/\/rozetka.com.ua\/comparison\/{\/if}\" class=\"sprite-side novisited hub-i-link hub-i-comparison-link-count\">\n\t\t<span class=\"underline-hover\">\u0421\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u0435<\/span>\n\t\t<span class=\"hub-i-count\">${quantity}<\/span>\n\t<\/a>\n{else}\n\t<a href=\"#\" class=\"sprite-side novisited hub-i-link hub-i-link-empty hub-i-comparison-link\" onclick=\"return false;\">\n\t\t<span class=\"underline-hover\">\u0421\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u0435<\/span>\n\t<\/a>\n{\/if}\n',header_button:'comparison',header_popup:'comparison-popup',selectors:{clear:'[name=clear_goods]',section:'[name=comparison_section]'},properties:{clear:'data-section'}},_header_button:null,_header_popup:null,_popup:null,_limit:20,initialize:function(options){this.parent(options);App.addOnDomReady(function(){this._header_button=$(this.options.header_button);this._header_popup=$(this.options.header_popup);this.update()}.bind(this));this.attachToObserver([])},getPopup:function(){if(this._popup==null){this._popup=new Popup_class(this.options.popups.container)}return this._popup},deleteGoods:function(goods_id){if($defined(this.elem)){this.elem.processStart(this.options.process)}this.doAction('delete','',goods_id)},onActionComplete:function(response,action_name){var Response=new Response_class(response),goods_id=this.options.data.goods_id||'',location=window.location.origin+window.location.pathname;Response.doAction();Comparison.fireEvent('actionCompleteForGoods'+goods_id);Comparison.fireEvent('onAddForceComplete');if($defined(Comparison.elem)){Comparison.elem.process=0;Comparison.elem.fireEvent('onActionComplete')}if(action_name=='clear'&&location=='http://rozetka.com.ua/comparison/'){window.location.reload(true)}},update:function(){this.parent();if($defined(this._header_button)){this._header_button.setHTML(App.getHTML(this.options.header_button_content,this))}if($defined(this._header_popup)){this._changeContent();this._header_popup.getElements(this.options.selectors.section).each(function(section){var elem=section.getElement(this.options.selectors.clear);elem&&elem.addEvent('click',this._handlerClickByClearButtonInHead.bind(this,elem,section))}.bind(this))}this.fireEvent('ComparisonUpdate')},_handlerClickByClearButtonInHead:function(elem,section,event){var section_id=parseInt(elem.getAttribute(this.options.properties.clear));new Event(event).stop();if(section_id){new Ajax('/cgi-bin/form.php').setOptions({data:{section_id:section_id},onComplete:this.onActionCompleteForClear.bind(this,section),onFailure:this.onActionCompleteForClear.bind(this,section),headers:{ajaxAction:'http://rozetka.com.ua/comparison/#clearComparisonBySection'}}).request();section.addClass('frozen')}},onActionCompleteForClear:function(section,response){var Response=new Response_class(response);Response.content=JSON.parse(Response.content);if(Response.isError()){section.removeClass('frozen')}else{document.fireEvent('clearComparisonBySection',Response.content)}Response.doAction()},addForce:function(section_id,goods_ids){this.doAction('addForce',section_id,goods_ids)},_changeContent:function(){var content=this.options.popups.empty;if(this.quantity){content=this.options.popups.no_empty}this._header_popup.setHTML(App.getHTML(content,this))},getSections:function(){return(this.S&&this.S.sections)||{}},addGoods:function(goods_id){var popup=null;if(this.section_id&&this.S.sections&&Object.keys(this.S.sections).contains(this.section_id.toString())&&this.S.sections[this.section_id].count>=this._limit){this.getPopup().setContent(this.options.popups.content,this);this.getPopup().open();document.fireEvent('more20productCompare',{extend_event:[{name:'goods_id',value:goods_id}]})}else{this.parent(goods_id)}},getFirstSectionHref:function(){var result="#",keys=Object.keys(this.S.sections),section={};if(keys.length){section=this.S.sections[keys.shift()];result=section['href']}return result},onUpdate:function(){}});var RozetkaPopupParentSetterInterface=new Class({_setPopupParent:function(id,tpl,container){this.addToDocument(tpl,container);this.options.parent=this._getPopupParentById(id,container);this.signChangeBind();if($(container)){$(container).removeProperty('id')}},addToDocument:function(elem,container){container=$(container);if(container){container.setHTML(container.innerHTML+elem)}else{document.write(elem)}},_getPopupParentById:function(id,container){if(!id){id='wishlists-popup-'+$random(0,100000);this.addToDocument("<div id='"+id+"'></div>",container)}return $(id)}});var RozetkaWaitlist_class=new Class({Class:'RozetkaWaitlist_class',actor:undefined,options:{id:'',parent:false,tpl:'',tpl_menu:'',tpl_init_catalog:'',tpl_init_details:'',tpl_init_details_available:'',tpl_form:'',tpl_form_price:'',tpl_process:'',tpl_message:'',tpl_init_profile:'',tpl_init_profile_available:'',tpl_completed:'',process:'<img src=\"https:\/\/i1.rozetka.com.ua\/design\/check-ajax.gif\" width=\"64\" height=\"64\" alt=\"\u041e\u0442\u043f\u0440\u0430\u0432\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445\" class=\"process\"\/>',_auth_blocks_options:{selectors:{email:'[name="login"]'},blocks_type:'waitlist'},_user_auth_event_name:'signChange'},change_price_goods_ids:[],initialize:function(options){if(S.checkup)this.onLoadS(S);S.addEvent('loadS',function(S){this.onLoadS(S)}.bind(this))},init:function(id){if(!id){id='waitlist-menu-'+$random(0,100000);document.write("<div id='"+id+"'></div>")}this.elem=$(id);if(S.checkup)this.update()},setCatalogPopupParent:function(id){this.options.parent=this._getPopupParentById(id);this.options.parent.setHTML(this.options.tpl_init_catalog);this.signChangeBind()},setProfilePopupParent:function(id,container){this._setPopupParent(id,this.options.tpl_init_profile,container)},setDetailsPopupParent:function(id,container){this._setPopupParent(id,this.options.tpl_init_details,container)},setProfileChangePricePopupParent:function(id,goods_id,container){if(goods_id){this.change_price_goods_ids.push(goods_id)}this._setPopupParent(id,this.options.tpl_init_profile_available,container)},setDetailsChangePricePopupParent:function(id,goods_id,container){if(goods_id){this.change_price_goods_ids.push(goods_id)}this._setPopupParent(id,this.options.tpl_init_details_available,container)},onLoadS:function(S){var S_waitlist;S_waitlist=$defined(S.waitlist)&&User.isAuth()?S.waitlist:{};this.goods=new Array();for(i=0;i<S_waitlist.length;i++){this.goods[i]=parseInt(S_waitlist[i]['goods_id'])}this.update()},update:function(){if($defined(this.elem)){this.elem.setHTML(App.getHTML(this.options.tpl_menu,this))};this.fireEvent('update')},getPopup:function(){if(!this.popup){with(this.options){this.popup=new Popup_class(tpl,parent)}}return this.popup},addGoods:function(goods_id){if(this.isChangePrice(goods_id)){this.options._auth_blocks_options.blocks_type='followPrice'}if(this.actor.isAuth()){this.ajaxRequest(goods_id,this.actor.getTitle(),this.actor.getEmail())}else{var popup=this.getPopup();if(this.isChangePrice(goods_id)){popup.setContent(this.options.tpl_form_price,this)}else{popup.setContent(this.options.tpl_form,this)}popup.form.addEvent('submit',function(e){new Event(e).stop();this.sendInformation(goods_id)}.bind(this));popup._setAsMoadal();popup.open();this.sendToGTM(goods_id,'openWaitlistPopup',true);this.fireEvent('actionCompleteForGoods')}},deleteGoods:function(goods_id){var options={};options.onComplete=function(response){var Response=new Response_class(response);if(Response.isDone()){if($defined(this.goods)){this.goods.remove(goods_id)}};App.showMessage(Response.Message);Response.doAction()}.bind(this);options.headers={'ajaxAction':'https://my.rozetka.com.ua/waitlist#delete'};options.data={'goods_id':goods_id};new Ajax('/cgi-bin/form.php',options).request();this.fireEvent('actionCompleteForGoods')},sendInformation:function(goods_id){var popup=this.getPopup();if(popup.form.checkFields()){this.goods_id=goods_id;popup.form.processStart(this.options.process);if($defined(popup.form.title.value)){this.ajaxRequest(goods_id,popup.form.title.value,popup.form.email.value)}else{var split_email=popup.form.email.value.split('@',1);this.ajaxRequest(goods_id,split_email[0],popup.form.email.value)}}},ajaxRequest:function(goods_id,title,email){var popup=this.getPopup();var options={};options.onComplete=function(resp){var popup=this.getPopup();popup._setAsMoadal();if(!email&&window['User']&&User.isAuth()){email=User.getEmail()}var Response=new Response_class(resp);Response.doAction();if(popup.form)popup.form.processStop();if(!Response.isError()){popup.setContent(App.getHTML(this.options.tpl_completed,{email:email,isChangePrice:this.isChangePrice(goods_id)}));popup.open();this.sendToGTM(goods_id,null,true)}else{if(Response.action&Response.ACTION.USER_AUTH){popup.close();this.signInBind(this.isChangePrice(goods_id))}else{if((popup.form)&&(popup.form.msg)){popup.form.msg.setHTML(Response.Message.getContentTpl(this.options.tpl_message))}}Response.doAction();if(email&&this.signin_popup){this.signin_popup.form.login.value=email}}this.fireEvent('actionCompleteForGoods')}.bind(this);options.onRequest=function(){}.bind(this);options.headers={'ajaxAction':'https://my.rozetka.com.ua/waitlist#Waitlist'};options.data={'goods_id':goods_id};if(title!==undefined)options.data['title']=title;if(email!==undefined)options.data['email']=email;options.data['isChangePrice']=(this.isChangePrice(goods_id))?'1':'';new Ajax('/cgi-bin/form.php',options).request()},count:function(){return this.goods.length},inWaitlist:function(id){if($defined(this.goods))for(var i=0;i<this.goods.length;i++){if(this.goods[i]==id){return true}}return false},isChangePrice:function(goods_id){return this.change_price_goods_ids.contains(goods_id)},onUserSignIn:function(){if(this.actor.auth){this.ajaxRequest(this.goods_id,this.actor.getTitle(),this.actor.getEmail())}},onUserSignChange:function(){var popup=this.getPopup();if(popup._isOpened)popup.close()},onUserPopupClose:function(e){this.signInRemove()},signChangeBind:function(){this.actor.addEvent('signChange',this.onUserSignChange.bind(this))},signInBind:function(is_change_price){this.handlerUserSignIn=this.onUserSignIn.bind(this);this.handlerUserPopupClose=this.onUserPopupClose.bind(this);this.actor.switchSignInPopup(App.getHTML(this.options.tpl_signin_popup_content,{isChangePrice:is_change_price}),this.getSignInPopup(),this.options._auth_blocks_options);this.actor.addEvent(this.options._user_auth_event_name,this.handlerUserSignIn);this.actor.getPopup().addEvent('close',this.handlerUserPopupClose);this.actor.changeAuthType('waitlist')},getSignInPopup:function(){if(!this.signin_popup){with(this.options){this.signin_popup=new Popup_class(tpl_signin_popup);this.signin_popup._setAsMoadal()}}return this.signin_popup},signInRemove:function(){this.actor.removeEvent(this.options._user_auth_event_name,this.handlerUserSignIn);this.actor.getPopup().removeEvent('close',this.handlerUserPopupClose);this.actor.restoreSignInPopup();this.actor.restoreAuthType()},_getGTMData:function(goods_id){var data=App.getStorage().get('gtm_waitlist'),event_data=null;if(data!=null&&$type(data)=='object'){event_data=data[goods_id]}if(!event_data){event_data={extend_event:[{name:"goods_id",value:goods_id}]}}return event_data},sendToGTM:function(goods_id,event,hold_goods_data){var event_data=this._getGTMData(goods_id);if(!event){event=this.isChangePrice(goods_id)?'followPrice':'addToWaitlist'}if(!hold_goods_data){App.getStorage().remove('gtm_waitlist')}document.fireEvent(event,event_data)}});RozetkaWaitlist_class.implement(new Options,new Events,new RozetkaPopupParentSetterInterface);var Wishlists_class=new Class({Class:'Wishlists_class',actor:undefined,wishlist:undefined,wishlists:undefined,show_after_loads_popup:false,options:{id:'',parent:false,tpl:'',tpl_init:'',tpl_form:'',tpl_process:'',tpl_message:'',tpl_selector_popup_content:'',tpl_signin_popup:'',tpl_signin_popup_content:'',tpl_success_popup_content:'',social_buttons_title:'',social_buttons_description:'',social_buttons_image:'',social_buttons_params:{}},initialize:function(options){if(S.checkup){this.onLoadS(S.data)}S.addEvent('loadS',function(S){this.onLoadS(S)}.bind(this))},init:function(id){if(S.checkup){this.update()}},setPopupParent:function(id){if(!id){id='wishlists-popup-'+$random(0,100000);document.write("<div id='"+id+"'></div>")}this.options.parent=$(id);document.write(this.options.tpl_init);this.signChangeBind()},setCatalogTilePopupParent:function(id){if(!id){id='waitlist-popup-'+$random(0,100000);document.write("<div id='"+id+"'></div>")}this.options.parent=$(id);if(this.options.parent){this.options.parent.setHTML(this.options.tpl_catalog_tile_init)}this.signChangeBind()},onLoadS:function(S){var S_wishlists;S_wishlists=$defined(S.wishlists)?S.wishlists:{};this.wishlists=S_wishlists;this.update();if(this.show_after_loads_popup){this.show_after_loads_popup=false;this.showSelectorPopup()}},update:function(){this.fireEvent('update')},getPopup:function(){if(!this.popup){with(this.options){this.popup=new Popup_class(tpl,parent)}}return this.popup},getSignInPopup:function(){if(!this.signin_popup){with(this.options){this.signin_popup=new Popup_class(tpl_signin_popup,parent);this.signin_popup._setAsMoadal()}}return this.signin_popup},addGoods:function(goods_id){this.goods_id=goods_id;if(this.actor.isAuth()){this.showSelectorPopup()}else{var popup=this.getPopup();popup.setContent(this.options.tpl_form,this);popup.form.addEvent('submit',function(e){new Event(e).stop();var popup=this.getPopup();if(popup.form.checkFields()){this.wishlist={"title":popup.form.wishlist_title.value};this.ajaxRequest(this.wishlist,goods_id,popup.form.email.value)}}.bind(this));popup._setAsMoadal();popup.open()}this.fireEvent('actionCompleteForGoods')},showSelectorPopup:function(){var popup=this.getPopup();popup.setContent(this.options.tpl_selector_popup_content,this);popup.form.addEvent('submit',function(e){new Event(e).stop();var wishlist={};if(!popup.form.getElementById('new_wishlist').checked&&popup.form.wishlist_id&&popup.form.wishlist_id.length){for(var i=0;i<popup.form.wishlist_id.length;i++){if(popup.form.wishlist_id[i].checked){wishlist=popup.form.wishlist_id[i].id=='new_wishlist'?{"title":popup.form.wishlist_title.value}:{"id":popup.form.wishlist_id[i].value};break}}}else{wishlist={"title":popup.form.wishlist_title.value}}if(!$defined(wishlist.id)&&!$defined(wishlist.title)){return}this.ajaxRequest(wishlist,this.goods_id,this.actor.getEmail())}.bind(this));popup._setAsMoadal();popup.open()},ajaxRequest:function(wishlist,goods_id,email){var options={};options.onComplete=function(resp){var popup=this.getPopup();popup._setAsMoadal();var Response=new Response_class(resp);if(popup.form){popup.form.processStop()}if(!Response.isError()){popup.setContent(this.options.tpl_success_popup_content);if(Response.Message){App.showMessage(Response.Message)}Response.doAction();App.trackGTMEvent({'eventCategory':'Interactions','eventAction':'add','eventLabel':'Wishlist','eventProductId':goods_id});var wishlist_id=$defined(wishlist.id)?wishlist.id:this.getWishlistIdByTitle(wishlist.title);this.createSocialButtons(wishlist_id)}else{if(Response.action&Response.ACTION.USER_AUTH){popup.close();this.signInBind()}else{if(popup.msg){popup.msg.setHTML(Response.Message.getContentTpl(this.options.tpl_message))}else{App.showMessage(Response.Message)}}Response.doAction()}this.fireEvent('actionCompleteForGoods')}.bind(this);options.onRequest=function(){}.bind(this);options.headers={'ajaxAction':'https://my.rozetka.com.ua/wishlists#Wishlists'};options.data={'goods_id':goods_id};if(email!==undefined){options.data['email']=email}if(wishlist.title!==undefined){options.data['wishlist_title']=wishlist.title}else if(wishlist.id!==undefined){options.data['wishlist_id']=wishlist.id}new Ajax('/cgi-bin/form.php',options).request()},count:function(){var count=0;if($defined(this.wishlists)){for(wishlist in this.wishlists){if($defined(this.wishlists[wishlist].title)){count++}}}return count},inWishlist:function(id){if($defined(this.wishlists)){for(j in this.wishlists){if($defined(this.wishlists[j].goods)){for(var i=0;i<this.wishlists[j].goods.length;i++){if(this.wishlists[j].goods[i]==id){return true}}}}}return false},onUserSignIn:function(){this.show_after_loads_popup=true},onUserSignChange:function(){var popup=this.getSignInPopup()},onUserPopupClose:function(e){this.signInRemove()},signChangeBind:function(){this.actor.addEvent('signChange',this.onUserSignChange.bind(this))},signInBind:function(){this.handlerUserSignIn=this.onUserSignIn.bind(this);this.handlerUserPopupClose=this.onUserPopupClose.bind(this);this.actor.addEvent('signIn',this.handlerUserSignIn);this.actor.switchSignInPopup(this.options.tpl_signin_popup_content,this.getSignInPopup());this.getSignInPopup().addEvent('close',this.handlerUserPopupClose)},signInRemove:function(){this.actor.removeEvent('signIn',this.handlerUserSignIn);this.getSignInPopup().removeEvent('close',this.handlerUserPopupClose);this.actor.restoreSignInPopup();this.onUserSignIn()},createSocialButtons:function(wishlist_id){var params=this.options.social_buttons_params;params.url=this.wishlists[wishlist_id].href;params.twitter_link=1;params.selector='wishlist_share_buttons';params.params={title:this.options.social_buttons_title.replace('{$title}',this.wishlists[wishlist_id].title),description:this.options.social_buttons_description,image:this.options.social_buttons_image.replace('{$image}',this.wishlists[wishlist_id].image)};$(document.body).fireEvent('createSocialButtons',params);$(document).fireEvent('createSocialButtons',params)},getWishlistIdByTitle:function(title){for(wishlist in this.wishlists){if(this.wishlists[wishlist].title==title.trim()){return wishlist}}}});Wishlists_class.implement(new Options,new Events);var RozetkaPopupParentSetterInterface=new Class({_setPopupParent:function(id,tpl,container){this.addToDocument(tpl,container);this.options.parent=this._getPopupParentById(id,container);this.signChangeBind();if($(container)){$(container).removeProperty('id')}},addToDocument:function(elem,container){container=$(container);if(container){container.setHTML(container.innerHTML+elem)}else{document.write(elem)}},_getPopupParentById:function(id,container){if(!id){id='wishlists-popup-'+$random(0,100000);this.addToDocument("<div id='"+id+"'></div>",container)}return $(id)}});var RozetkaWishlists_class=Wishlists_class.extend({_is_cart_action:false,_is_opened_auth_popap:false,options:{header_button_content:'{if getGoodsCount()}\n\t<a href=\"https:\/\/my.rozetka.com.ua\/profile\/wishlists\/\" class=\"sprite-side novisited hub-i-link hub-i-wishlist-link-count\">\n\t\t<span class=\"underline-hover\">\u0416\u0435\u043b\u0430\u043d\u0438\u044f<\/span>\n\t\t<span class=\"hub-i-count\">${getGoodsCount()}<\/span>\n\t<\/a>\n{else}\n\t<a href=\"#\" class=\"sprite-side novisited hub-i-link hub-i-link-empty hub-i-wishlist-link\" onclick=\"return false;\">\n\t\t<span class=\"underline-hover\">\u0416\u0435\u043b\u0430\u043d\u0438\u044f<\/span>\n\t<\/a>\n{\/if}',header_popup_content:'<div class=\"header-popup header-popup-wishlist-empty sprite-side\">\n\t<h3 class=\"header-popup-info-title\">C\u043f\u0438\u0441\u043e\u043a \u0436\u0435\u043b\u0430\u043d\u0438\u0439 \u043f\u0443\u0441\u0442<\/h3>\n\t<p class=\"header-popup-info-title-under\">\u0414\u043e\u0431\u0430\u0432\u043b\u044f\u0439\u0442\u0435 \u0442\u043e\u0432\u0430\u0440\u044b \u0432&nbsp;\u0441\u043f\u0438\u0441\u043e\u043a \u0436\u0435\u043b\u0430\u043d\u0438\u0439, \u0434\u0435\u043b\u0438\u0442\u0435\u0441\u044c<\/br> \u0441\u043f\u0438\u0441\u043a\u0430\u043c\u0438 \u0441&nbsp;\u0434\u0440\u0443\u0437\u044c\u044f\u043c\u0438 \u0438&nbsp;\u043e\u0431\u0441\u0443\u0436\u0434\u0430\u0439\u0442\u0435 \u0442\u043e\u0432\u0430\u0440\u044b \u0432\u043c\u0435\u0441\u0442\u0435<\/p>\n\t{if !actor.isAuth()}\n\t\t<p class=\"header-popup-info-text\">\u0415\u0441\u043b\u0438 \u0443&nbsp;\u0432\u0430\u0441 \u0443\u0436\u0435 \u0435\u0441\u0442\u044c \u0441\u043f\u0438\u0441\u043a\u0438 \u0436\u0435\u043b\u0430\u043d\u0438\u0439, <a class=\"header-popup-info-text-link\" href=\"#\" onclick=\"new Event(arguments[0]).stop(); User.SignIn();\">\u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0443\u0439\u0442\u0435\u0441\u044c<\/a><\/p>\n\t{\/if}\n<\/div>',header_button:'wishlist',header_popup:'wishlist-popup',_auth_blocks_options:{selectors:{email:'[name="login"]'},blocks_type:'wishlist'},process:'<img src="https://i1.rozetka.com.ua/design/check-ajax.gif" width="64" height="64" alt=" " class="process"/>'},_header_popup:null,_header_button:null,initialize:function(options){this.parent(options);OAuth2.addEvent('login_success',function(){this.update();var popup=this.getPopup();if(popup.isOpened()){this.showSelectorPopup()}}.bind(this))},setPopupParent:function(id,tpl,container){if(!tpl){tpl=this.options.tpl_init}this._setPopupParent(id,tpl,container)},update:function(){if(!$defined(this._header_popup)||!$defined(this._header_button)){this._header_button=$(this.options.header_button);this._header_popup=$(this.options.header_popup)}this.parent();if($defined(this._header_popup)){this.getGoodsCount()?this._header_popup.setHTML(''):this._header_popup.setHTML(App.getHTML(this.options.header_popup_content,this))}if($defined(this._header_button)){this._header_button.setHTML(App.getHTML(this.options.header_button_content,this))}},getGoodsCount:function(){var result=0;if($defined(this.wishlists)){Object.values(this.wishlists).each(function(wishlist){result+=wishlist.goods.length})}return result},onLoadS:function(S){if(this.show_after_loads_popup){this.fireEvent('showSelectorPopup',this.goods_id)}this.parent(S)},ajaxRequest:function(wishlist,goods_id,email){var options={};options.onComplete=function(resp){var popup=this.getPopup();popup._setAsMoadal();var Response=new Response_class(resp);if(popup.form)popup.form.processStop();if(!Response.isError()){popup.setContent(App.getHTML(this.options.tpl_success_popup_content,Response.result));if(Response.Message){App.showMessage(Response.Message)}this.sendToGTM(goods_id);rozetkaEvents.trackEvent(null,'goods/wishlist/add',rozetkaEvents.getGoodsData(goods_id));Response.doAction();var wishlist_id=$defined(wishlist.id)?wishlist.id:this.getWishlistIdByTitle(App.htmlSpecialChars(wishlist.title));this.createSocialButtons(wishlist_id)}else{if(Response.action&Response.ACTION.USER_AUTH){this._is_opened_auth_popap=true;popup.close();this.signInBind()}else{if((popup.msg)){popup.msg.setHTML(Response.Message.getContentTpl(this.options.tpl_message))}else{App.showMessage(Response.Message)}}Response.doAction();if(email&&this.signin_popup){this.signin_popup.form.login.value=email}}this.fireEvent('actionCompleteForGoods')}.bind(this);options.onRequest=function(){}.bind(this);options.headers={'ajaxAction':'https://my.rozetka.com.ua/wishlists#addGoods'};options.data={'goods_id':goods_id};if(email!==undefined)options.data['email']=email;if(wishlist.title!==undefined){options.data['wishlist_title']=wishlist.title}else if(wishlist.id!==undefined)options.data['wishlist_id']=wishlist.id;new Ajax('/cgi-bin/form.php',options).request()},signInBind:function(){this.handlerUserSignIn=this.onUserSignIn.bind(this);this.handlerUserPopupClose=this.onUserPopupClose.bind(this);this.actor.addEvent('signIn',this.handlerUserSignIn);this.actor.switchSignInPopup(this.options.tpl_signin_popup_content,this.getSignInPopup(),this.options._auth_blocks_options);this.getSignInPopup().addEvent('close',this.handlerUserPopupClose);this.actor.changeAuthType('wishlist')},signInRemove:function(){this.parent();if(this._is_cart_action){this._is_opened_auth_popap=false;this._addGoodsFromCartEnd()}this.actor.restoreAuthType()},sendToGTM:function(goods_id){var data=App.getStorage().get('gtm_wishlist'),event_data={};if(data!=null&&$type(data)=='object'){event_data=data[goods_id]}App.getStorage().remove('gtm_wishlist');if(!this._is_cart_action){document.fireEvent('clickToWishlist',event_data)}},_addGoodsFromCartEnd:function(){if(this._is_cart_action&&!this._is_opened_auth_popap){this.fireEvent('popupsWishlistsClose')}},getSignInPopup:function(){var is_single=!this._is_cart_action;return this.parent().setOptions({single:is_single})},getPopup:function(){var is_single=!this._is_cart_action;return this.parent().setOptions({single:is_single})},showSelectorPopup:function(){var popup=this.getPopup();popup.setContent(this.options.tpl_selector_popup_content,this);popup.form.addEvent('submit',function(e){new Event(e).stop();var wishlist={};if(popup.form.getElementById('new_wishlist')&&!popup.form.getElementById('new_wishlist').checked&&popup.form.wishlist_id&&popup.form.wishlist_id.length){for(var i=0;i<popup.form.wishlist_id.length;i++){if(popup.form.wishlist_id[i].checked){wishlist=popup.form.wishlist_id[i].id=='new_wishlist'?{"title":popup.form.wishlist_title.value}:{"id":popup.form.wishlist_id[i].value};break}}}else if(!popup.form.checkFields()){return}else{wishlist={"title":popup.form.wishlist_title.value}}if(!$defined(wishlist.id)&&!$defined(wishlist.title)){return}if(popup.form.getElement('#new_wishlist')&&popup.form.getElement('#new_wishlist').checked&&!popup.form.checkFields()){return}if(this._is_cart_action){document.fireEvent('clickToWishlistInCart',{extend_event:[{name:"goods_id",value:this.goods_id}]})}popup.form.processStart(this.options.process);this.ajaxRequest(wishlist,this.goods_id,this.actor.getEmail())}.bind(this));popup._setAsMoadal();popup.open()},addGoods:function(goods_id){this.parent(goods_id);this.getPopup().addEvent('close',this._addGoodsFromCartEnd.bind(this))},move:function(record_id,wishlist_id){var popup=this.getPopup();popup.setContent(this.options.tpl_move_content,{wishlists:this.wishlists,goods_data:[{record_id:record_id}],wishlist_id:wishlist_id});popup.open()}});RozetkaWishlists_class.implement(new RozetkaPopupParentSetterInterface);var Comments_class=new Class({Class:'Comments_class',goods_id:'',url:'',rating_value_el:null,rating:null,container:null,options:{rating_values:[',   ',' ',' ',' ',' ',' '],rating_color:['#000000','#cc0000','#990000','#999999','#148514','#56b318'],form_id:'new_comment',ajaxAction:'addComment',comment_id:'comments',comment:{tpl:'<div name=\"app-message\"><\/div> {var is_unapproved = (status == \"unapproved\")} {var is_activated = (status == \"auto_activated\")} {if show} <div class=\"pp-comments-i pp-comments-i-new\"> <div name=\"comment_vote\" class=\"{if is_unapproved} fish{\/if}\"> {if defined(\"questions\") && questions.ComboBox} <aside class=\"detail-review-aside\"> {for item in questions.ComboBox} <div class=\"detail-review-aside-i {if !item.value}disabled{\/if}\"> <div class=\"detail-review-aside-i-title\">${item.title}<\/div> <div class=\"detail-review-custom-rating\"> <div class=\"detail-review-custom-rating-i\"> <div class=\"detail-review-custom-rate-line\">&nbsp;<\/div> <div class=\"detail-review-custom-rate-by-user\"> <div class=\"detail-review-custom-rate-by-user-points\"> {for value in item.values} <div class=\"detail-review-custom-rate-by-user-points-i\"> <span class=\"detail-review-custom-rate-by-user-point{if value.name == item.value} active{\/if}\">&nbsp;<\/span> <\/div> {\/for} <\/div> <\/div> <div class=\"detail-review-custom-rating-i-rate-text\"> {for value in item.values} {if value.title} <div class=\"detail-review-custom-rating-i-rate-title\" style=\"{if value_index == (item.values.length - 1)}text-align:right;{elseif value_index != 0}text-align:center;{\/if}\"> ${value.title} <\/div> {\/if} {\/for} <\/div> <\/div> <\/div> <\/div> {\/for} <\/aside> {\/if} <div class=\"require\" name=\"msg\"><\/div> {if defined(\"questions\") && questions.Integer} <div class=\"pp-co-rating\"> {for item in questions.Integer} <span>${item.title}<\/span> <span class=\"sprite g-rating-stars\"> <span class=\"sprite g-rating-stars-i\" style=\"width:${item.value*20}%\"><\/span> <\/span> {\/for} <\/div> {elseif mark > 0} <div class=\"g-rating\"> <span class=\"sprite g-rating-stars\"> <span class=\"sprite g-rating-stars-i\" style=\"width:${mark*20}%\"><\/span> <\/span> <\/div> {\/if} <header class=\"pp-comments-i-header\"> {if name} <div class=\"pp-comments-author\"> <div class=\"pp-comments-author-name\"> {if from_buyer}<img src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" class=\"sprite pp-comments-author-name-cart-icon\" title=\"\u0423\u0436\u0435 \u043a\u0443\u043f\u0438\u043b \u0442\u043e\u0432\u0430\u0440\">{\/if} ${name} <\/div> <time class=\"pp-comments-author-date\">\u0441\u0435\u0433\u043e\u0434\u043d\u044f<\/time> {if is_activated}                 <a href=\"https:\/\/my.rozetka.com.ua\/#tab=comments;id=${id}\" id=\"${id}\" name=\"single_comment\" class=\"pp-comments-author-link\">                     <img src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" width=\"18\" height=\"18\" alt=\"_\" title=\"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439\" class=\"sprite pp-comments-author-link-icon\">                 <\/a> {\/if} <\/div> {\/if} <\/header> <p class=\"pp-comments-i-text\">${text}<\/p> {if dignity}<p class=\"pp-comments-i-text\"><b>\u0414\u043e\u0441\u0442\u043e\u0438\u043d\u0441\u0442\u0432\u0430:<\/b> ${dignity}<\/p>{\/if} {if shortcomings}<p class=\"pp-comments-i-text\"><b>\u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043a\u0438:<\/b> ${shortcomings}<\/p>{\/if} <\/div> <\/div> {\/if}'},message:{tpl:'{if code==2} <div class=\"pp-comments-message-wrap\"> <div class=\"pos-fix sprite-side message code${code}\"> <a href=\"#\" class=\"message-close-link\" onclick=\"clearUserMessages(event);\"> <img src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" width=\"24\" height=\"24\" class=\"sprite message-close-link-img\"> <\/a> ${content} <\/div> <\/div> {else} <div class=\"pos-fix sprite-side message code${code}\"> <a href=\"#\" class=\"message-close-link\" onclick=\"clearUserMessages(event);\"> <img src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" width=\"24\" height=\"24\" class=\"sprite message-close-link-img\"> <\/a> ${content} <\/div> {\/if}'},selectors:{show_add_new_comment:'button[name=show_add_new_comment]',container:'div[name=comments_container]',new_comment_msg:'div[name=new_comment_msg]'},new_comment_el:'li',insert_new_comment:true},initialize:function(url){if($defined(url)){this.init(url)}},init:function(url){this.url=url;this.form=$(this.options.form_id);if(this.form){this.form.removeEvents();this.form.msg=$E(this.options.selectors.new_comment_msg);this.textarea=this.form.getElement('textarea');this.rating=this.form.getElement('div[name=rating]');if(this.rating){this.rating.input=this.form.getElement('input[name=mark]');this.rating_value_el=this.rating.getElement('div[name=rating_value]')}this.container=$E(this.options.selectors.container);this.comments=$(this.options.comment_id);this.bindEvents(this.container);this.form.addEvent('submit',this.onSubmit.bind(this))}this.setActiveRating()},setActiveRating:function(){if(this.rating){this.rating.points=this.rating.getElement('div[name=points]').getElements('div');this.rating.mark=0;this.rating.points.each(function(elem){elem.removeEvents();elem.addEvent('mouseover',function(e){this.fireRating(e)}.bind(this));elem.addEvent('mouseout',function(e){this.blowRating(e)}.bind(this));elem.addEvent('click',function(e){this.setRating(e)}.bind(this))}.bind(this))}},fireRating:function(e){var event=new Event(e);rating=event.target.getProperty('name');this.firePoints(rating)},firePoints:function(rating){this.blowPoints(rating);if(this.rating_value_el&&$defined(this.options.rating_values[rating])){this.rating_value_el.setHTML(this.options.rating_values[rating]);if($defined(this.options.rating_color[rating])){this.rating_value_el.setStyle('color',this.options.rating_color[rating])}}},setRating:function(e){var event=new Event(e);rating=event.target.getProperty('name');if(this.rating.mark!=rating){this.rating.mark=rating}else{this.rating.mark=0}this.firePoints(this.rating.mark);this.rating.input.setProperty('value',this.rating.mark)},blowPoints:function(rating){this.rating.points.each(function(elem,key){if(key<rating){elem.addClass('active')}else{elem.removeClass('active')}})},blowRating:function(e){this.firePoints(this.rating.mark)},onSubmit:function(e){new Event(e).stop();var options={};options.headers={'ajaxAction':this.getAjaxAction()};options.onComplete=this.checkResp.bind(this);this.form.trySend(options)},getAjaxAction:function(){return this.url+'#'+this.options.ajaxAction},checkResp:function(resp){Response=new Response_class(resp);Response.doAction();this.form.processStop();if(!Response.isError()){App.tryUrchinTracker('/review-added/');if(this.rating&&this.rating.mark>0){App.tryUrchinTracker('/rating-added/')}this.resetForm();if(Response.Message){this.form.msg.show();this.form.msg.setHTML(Response.Message.getContentTpl(this.options.message.tpl))}if(Response.content&&Response.content.comment&&this.options.insert_new_comment){this.InsertNewComment(Response.content.comment)}}else{this.form.msg.show();this.form.msg.setHTML(Response.Message.getContentTpl(this.options.message.tpl))}this.toggleNewCommentForm()},InsertNewComment:function(data){var elem=new Element(this.options.new_comment_el).setHTML(App.getHTML(this.options.comment.tpl,data)).injectTop(this.comments);if(elem.getTop()<window.getSize().scroll.y){new Fx.Scroll(window,{duration:500,offset:{'x':0,'y':-150},transition:Fx.Transitions.Quad.easeInOut}).toElement(elem)}},resetForm:function(){this.form.reset();if(this.rating){this.firePoints(0);this.rating.mark=0}},toggleNewCommentForm:function(e){if(this.form.isVisible()){this.hideForm()}else{this.showForm()}window.fireEvent('scroll',window)},showForm:function(){this.form.show();this.container.getElement(this.options.selectors.show_add_new_comment).addClass('write-review-disable')},hideForm:function(){this.form.hide();this.container.getElement(this.options.selectors.show_add_new_comment).removeClass('write-review-disable')},bindEvents:function(element){if(this.options.selectors.show_add_new_comment){element.getElements(this.options.selectors.show_add_new_comment).each(function(elem){elem.addEvent('click',function(e){new Event(e).stop();this.toggleNewCommentForm(e)}.bind(this))}.bind(this))}}});Comments_class.implement(new Options);var RozetkaDropDownMenu=new Class({_actionElementsCount:0,_current_element:{},options:{actionZone:'[name=action-zone]',parent_name:'[name=main-menu-popup-parent]',action_elements:'a[name=active-elem]',drop_elements:'div[name=drop-elem]',styles:{},action_zone_elem:null,delay:500},_dropElements:[],getActionElements:function(){return(this.getParent())?this.getParent().getElements(this.options.action_elements):[]},getDropElements:function(){return(this.getParent())?this.getParent().getElements(this.options.drop_elements):[]},getDropElement:function(el){return(el.getParent())?el.getParent().getElement(this.options.drop_elements):null},getParent:function(){return typeof(this.options.parent_name)=='object'?this.options.parent_name:$E(this.options.parent_name)},setActive:function(el){el.getParent().addClass('hover')},removeActive:function(el){el.getParent().removeClass('hover')},show:function(el){this.setActive(el);this.fastHideOpenedElements(el);if(this.options.action_zone_elem){this.options.action_zone_elem.fireEvent('showed')}},fastHideOpenedElements:function(el){this.getOpenedElements(el).each(function(elem){this.fastHide(elem)}.bind(this))},hide:function(el){if(!el.lock){this.fastHide(el)}},fastHide:function(el){this.removeActive(el)},getOpenedElements:function(el){var els=[];this.getDropElements().each(function(elem){if(elem!=el){els.push(elem)}});return els},run:function(){var resizeTimeout;this._actionElementsCount=this.getActionElements().length;this.getDropElements().each(function(el){this._parent=this.getParent();el.setStyles(this.options.styles);el.lock=false;this._dropElements.push(el);el.addEvents({mouseenter:function(){el.lock=true}.bind(this),mouseleave:function(){el.lock=false;this.hide.delay(500,this,[el])}.bind(this),show:function(){el.lock=true;this.show(el)}.bind(this),hide:function(){el.lock=false;this.hide.delay(500,this,[el])}.bind(this)})}.bind(this));this.getActionElements().each(function(el,index){var dropElement=this.getDropElement(el);if(dropElement){el.addEvents({mouseenter:function(e){el.lock=false;this.fireEventDelay=function(el){if(!el.lock){dropElement.fireEvent('show')}};this.fireEventDelay.delay(this.options.delay,this,[el])}.bind(this),mouseleave:function(){el.lock=true;dropElement.fireEvent('hide')}})}}.bind(this));this._setDropElementsIndent();$(window).addEvent("resize",function(e){clearTimeout(resizeTimeout);resizeTimeout=setTimeout(function(){this._setDropElementsIndent()}.bind(this),200)}.bind(this))},_getActionElementWidth:function(){return Math.ceil(this.getParent().getCoordinates().width/this._actionElementsCount)},_getDropElementIndent:function(index,width){return-(index*width)},_setDropElementsIndent:function(){var count=this._actionElementsCount,indentDirection="left";this.getDropElements().each(function(el,index){if(index>=(count/2)){indentDirection="right";index=count-index-1}el.setStyle(indentDirection,this._getDropElementIndent(index,this._getActionElementWidth()))}.bind(this))}});RozetkaDropDownMenu.implement(new Options);var RozetkaMenuDelayChecker_class=new Class({options:{log_locations_count:3,tolerance:10,delay:300},mouse_locations:[],last_delay_location:{},initialize:function(options){this.setOptions(options);document.addEvent('mousemove',this._onMouseMove.bind(this))},getActivationDelay:function(parent_menu,drop_menu,use_drop_menu_point){var elem_size={x:0,y:0},result=0,name=parent_menu.getAttribute('menu_name'),location=this.mouse_locations[this.mouse_locations.length-1],previous=this.mouse_locations[0],menu_size,coordinates;if(drop_menu){elem_size=drop_menu.getSize().size}if(use_drop_menu_point&&elem_size.x&&location.y>(drop_menu.getPosition().y+elem_size.y)&&drop_menu.getPosition().x){coordinates=this._getBlockCoordinates(drop_menu)}else{menu_size=parent_menu.getSize().size;coordinates=this._getBlockCoordinates(parent_menu);coordinates.top.x+=menu_size.x;coordinates.top.y-=this.options.tolerance;coordinates.bottom.y+=this.options.tolerance;if(elem_size.y>menu_size.y){coordinates.bottom.y+=elem_size.y-menu_size.y}}if(location&&!this._isMenuFirstTimeActivated(previous,location,parent_menu)&&!this._isMouseNotMoved(name,location)&&this._relativity(location,previous,coordinates.bottom)>=0&&this._relativity(location,coordinates.bottom,coordinates.top)>=0&&this._relativity(location,coordinates.top,previous)>=0){this.last_delay_location[name]=location;result=this.options.delay}else{this.last_delay_location[name]=null}return result},_relativity:function(loc,a,b){return loc.x*(b.y-a.y)+loc.y*(a.x-b.x)+a.y*b.x-a.x*b.y},_isMenuFirstTimeActivated:function(prev,loc,menu){var block_coordinates=this._getBlockCoordinates(menu);return(prev.x<block_coordinates.top.x+parseInt(menu.getStyle('padding-left'))||prev.x>block_coordinates.bottom.x+parseInt(menu.getStyle('padding-right'))||prev.y<block_coordinates.top.y+parseInt(menu.getStyle('padding-top'))||prev.y>block_coordinates.bottom.y+parseInt(menu.getStyle('padding-bottom')))&&(loc.x>=block_coordinates.top.x&&loc.x<=block_coordinates.bottom.x&&loc.y>=block_coordinates.top.y&&loc.y<=block_coordinates.bottom.y)},_isMouseNotMoved:function(name,location){return this.last_delay_location[name]&&location.x==this.last_delay_location[name].x&&location.y==this.last_delay_location[name].y},_getBlockCoordinates:function(elem){var offset=elem.getPosition(),size=elem.getSize().size;return{top:{x:offset.x,y:offset.y},bottom:{x:offset.x+size.x,y:offset.y+size.y}}},_onMouseMove:function(e){this.mouse_locations.push({x:e.pageX,y:e.pageY});if(this.mouse_locations.length>this.options.log_locations_count){this.mouse_locations.shift()}}});RozetkaMenuDelayChecker_class.implement(new Options());var RozetkaMenuClass=new Class({menu:null,menuItems:[],active_elem:null,hide_timeout:null,check_timeout:null,menu_timeout:null,last_level_show_timeout:null,options:{selectors:{menuItems:'[name="m-main-i"]',drop_menu:'[name="drop-elem"]',scroller:'[name=scroller]'},submenu:null,cssClasses:{hover:"hover"},use_drop_menu_lower_right_point:false,menu:'main',scroller:{level1:{vector:'vertical',elemsContainer:'[name=drop-elem]',elems:'[name=m-main-i-l]'},level2:{vector:'vertical',elemsContainer:'[name=drop-elem]',controls:'[name=controls1]',screen:'[name=screen1]',elems:'[name=m-main-i-l1]'}}},submenus:[],parent:null,checker:null,hide_delay:null,last_level_show_delay:null,_scrollers:[],menu_data:null,sended:false,initialize:function(menu_elem,options,parent_menu,menu_data){this.submenus=[];this.last_delay=null;this.active_elem=null;this.menu_timeout=null;this.check_timeout=null;this.menu_data=menu_data;this.menu=$(menu_elem);this.parent=parent_menu;this.setOptions(options);this.hide_delay=this.options.hide_delay;this.last_level_show_delay=this.options.last_level_show_delay;if(!parent_menu){this.checker=new RozetkaMenuDelayChecker_class();this.attachToObserver([])}if(this.menu){this.menuItems=this.menu.getElements(this.options.selectors.menuItems);this._initEvents()}},_initEvents:function(){this.menuItems.each(function(el,key){var submenu=el.getElement(this.options.selectors.drop_menu),scroll_wrapper=null;if(submenu&&this.options.submenu&&this.options.submenu.options){this.submenus.push(new RozetkaMenuClass(submenu,this.options.submenu.options,this))}if(!App.isDesktop()&&this._hasSubmenu(el)){el.addEvent('click',this._doTouch.bind(this,el))}else{el.addEvent('mouseenter',this._addActiveState.bind(this,el))}}.bind(this));this.menu.addEvent('mouseleave',this._onMouseLeaveMenu.bind(this));this.menu.addEvent('mouseenter',function(){clearTimeout(this.menu_timeout)}.bind(this))},_initScrollerElements:function(scroller){var wrapper=scroller._getElementsContainerParent();wrapper.addEvent('scroll',function(){scroller._getElements().each(function(element){var scroll=wrapper['scrollTop'];element.getElements(this.options.selectors.scroller).each(function(node){node.setStyle('margin-top',scroll)})}.bind(this))}.bind(this))},getScroller:function(scroller_conatiner){return new RozetkaFatMenuScroller_class(scroller_conatiner).setOptions(this.getScrollerOptions()).run()},getScrollerOptions:function(){return this.parent?this.options.scroller.level2:this.options.scroller.level1},_doTouch:function(el,e){if(this.active_elem!=el){new Event(e).stop();this._addActiveState(el)}},_hasSubmenu:function(el){return(el.getElement(this.options.selectors.drop_menu))},_onMouseLeaveMenu:function(){clearTimeout(this.menu_timeout);clearTimeout(this.check_timeout);var delay,key;if(this.active_elem){delay=this.getActivationDelay();key=Object.keyOf(this.menuItems,this.active_elem);if(!delay&&this.submenus.length&&this.submenus[key]){delay=this.submenus[key].last_delay}}if(this.last_level_show_delay&&!delay&&!this.last_level_show_timeout){delay=this.options.last_level_show_delay;this.last_level_show_timeout=setTimeout(function(){this.last_level_show_delay=null}.bind(this),this.last_level_show_delay)}if(delay){this.menu_timeout=setTimeout(this._onMouseLeaveMenu.bind(this),delay)}else{this.last_delay=null;clearTimeout(this.hide_timeout);this.hide_delay=this.options.hide_delay;this.hide_timeout=null;this.deactivate(this.active_elem);this.fireEvent('fatMenuLeave');if(this.options.parent_hover_class){this.menu.getParent().removeClass(this.options.parent_hover_class)}}},_addActiveState:function(el){clearTimeout(this.check_timeout);this._checkActivation(el)},_checkActivation:function(el){this._getData();var delay=this.getActivationDelay();if(this.options.can_hide===false&&this.hide_delay){delay=this.hide_delay;if(!this.hide_timeout){this.hide_timeout=setTimeout(function(){this.hide_delay=null}.bind(this),this.hide_delay)}}if(delay||!this.menu_data){this.check_timeout=setTimeout(function(){this._checkActivation(el)}.bind(this),delay)}else{this.activate(el)}},getActivationDelay:function(){if(this.active_elem){this.last_delay=this.getDelayChecker().getActivationDelay(this.menu,this._getDropMenu(),this.options.use_drop_menu_lower_right_point)}return this.last_delay},_getDropMenu:function(){return this.active_elem?this.active_elem.getElement(this.options.selectors.drop_menu):null},getDelayChecker:function(){return this.parent?this.parent.getDelayChecker():this.checker},activate:function(el){var index=this.menuItems.indexOf(el);if(this.active_elem){this.deactivate(this.active_elem)}this.show(el);this.last_delay=null;this.active_elem=el;this._sendMiniPromoShowGTMEvent();if(this.options.parent_hover_class&&!this.menu.getParent().hasClass(this.options.parent_hover_class)){this.menu.getParent().addClass(this.options.parent_hover_class);this.fireEvent('fatMenuSubMenuFirstOpened')}if(this.options.last_level_show_delay){clearTimeout(this.last_level_show_timeout);this.last_level_show_timeout=null;this.last_level_show_delay=this.options.last_level_show_delay}el&&this.setupScroller(el)},setupScroller:function(el){var container=el.getElement(this.options.selectors.scroller),top_height=this.getTopHeight(),scroller=this.getScrollerByElement(el),elements_container=null;if(!scroller){if(container){elements_container=el.getElement(this.getScrollerOptions()['elemsContainer']);if(elements_container&&elements_container['offsetHeight']>top_height){container.setStyle('height',top_height);scroller=this.getScroller(container);this._scrollers.push({element:el,scroller:scroller});this._initScrollerElements(scroller)}if(elements_container&&App.isDesktop()){elements_container.getParent().setStyles('overflow-y: hidden')}}}else{scroller.scroller._checkControlsStatus()}},getScrollerByElement:function(elem){return this._scrollers.filter(function(obj){return obj.element==elem}).pop()},getTopHeight:function(){var result=0;this.menu.getChildren().each(function(el){result+=el['offsetHeight']});if(this.parent){result=this.parent.getTopHeight()}return result},_sendMiniPromoShowGTMEvent:function(){var drop_menu=this._getDropMenu(),mini_promo;if(this.options.selectors.mini_promo&&drop_menu){mini_promo=drop_menu.getElement(this.options.selectors.mini_promo);if(mini_promo){document.fireEvent('fatmenuMiniPromoShow',{extend_event:[{name:'eventContent',value:mini_promo.getElement('img').getProperty('alt')}]})}}},deactivate:function(el){this.active_elem=null;this.last_delay=null;this.hide(el)},show:function(el){var id=el.getProperty('menu_id'),mini_promo_elem;if(!this.parent&&!this.submenus[id]){el.getElement('[name="second_level"]').setHTML(App.getHTML(this.options.tpl,{node:this.menu_data[id]}));this.submenus[id]=new RozetkaMenuClass(el.getElement(this.options.selectors.drop_menu),this.options.submenu.options,this,this.menu_data[id]);this.menu_data[id].children&&Object.each(this.menu_data[id].children,function(elem){if(elem.banners.length){mini_promo_elem=el.getElement('#fatmenu_mini_promo'+elem.id);mini_promo_elem.setHTML(App.getHTML('<a class=\"mini-promo-link\" href=\"${url}\" name=\"fatmenu_minipromo\">\n\t<img class=\"mini-promo-icon\" src=\"${src}\" width=\"${width}\" height=\"${height}\" alt=\"${alt|escape}\" \/>\n<\/a>',elem.banners.getRandom()));mini_promo_elem.removeProperty('id')}})}if(el){el.addClass(this.options.cssClasses.hover)}this.menu.addClass(this.options.cssClasses.hover)},hide:function(el){if(el){el.removeClass(this.options.cssClasses.hover)}this.menu.removeClass(this.options.cssClasses.hover)},_getData:function(){if(!this.menu_data&&!this.sended){new Ajax(this.options.menu_url+this._getAction(),{method:'get',onComplete:function(resp){try{this.menu_data=JSON.parse(resp)}catch(e){App.log(e)}}.bind(this)}).request();this.sended=true}},_getAction:function(){var action=this.options.action,protocol=window.location.protocol;if(!this.options.use_redis){action+=(protocol==='https:'?'1':'0')+'/'}return action}});RozetkaMenuClass.implement(new Options(),new Events());var RozetkaFatmenu_class=new Class({options:{selectors:{menu:'m-main',button:'fat_menu_btn'},can_hide:true,main_menu_options:{menu_url:'',tpl:'{if node.banner}\n\t<span class=\"m-main-second-banner\">\n\t\t${node.banner.image}\n\t<\/span>\n{\/if}\n<div class=\"m-main-scroll\" name=\"scroller\" style=\"height: 100%;\">\n\t<div name=\"screen\" style=\"height: 100%;\">\n\t\t<div class=\"m-main-scroll-wrap\" style=\"overflow-y: auto; overflow-x: hidden;\">\n\t\t\t<ul class=\"m-main-subl\" name=\"drop-elem\">\n\t\t\t\t{for second_node in node.children}\n\t\t\t\t\t<li class=\"m-main-l-i m-main-second-l\" name=\"m-main-i-l\">\n\t\t\t\t\t\t{if second_node.href}\n\t\t\t\t\t\t\t<a href=\"${second_node.href}\" name=\"fat_menu_link\" class=\"novisited sprite-side m-main-link{if second_node.columns.length} m-main-link-arrow{\/if}\" level=\"level2\" is_new=\"{if second_node.tag == \u0027new\u0027}new{\/if}\">${second_node.title}{if second_node.tag == \u0027new\u0027}<span class=\"new\">NEW<\/span>{\/if}<\/a>\n\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t<span class=\"sprite-side m-main-link {if second_node.columns.length}m-main-link-arrow{\/if}\">${second_node.title}<\/span>\n\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t{if second_node.columns}\n\t\t\t\t\t\t\t<div name=\"scroller\" class=\"m-main-third\">\n\t\t\t\t\t\t\t\t<div name=\"screen1\" style=\"height: 100%\">\n\t\t\t\t\t\t\t\t\t<div class=\"m-main-scroll-wrap\" style=\"overflow-y: auto; overflow-x: hidden;\">\n\t\t\t\t\t\t\t\t\t\t<div name=\"drop-elem\" class=\"clearfix\">\n\t\t\t\t\t\t\t\t\t\t\t<div name=\"m-main-i-l1\" class=\"clearfix\">\n\t\t\t\t\t\t\t\t\t\t\t\t{for column in second_node.columns}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ul class=\"m-menu-third-l{if second_node.columns.length == 1} one-column{\/if}\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{for third_node in column.children}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li class=\"m-menu-third-l-i\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"${third_node.href}\" name=\"fat_menu_link\" class=\"m-menu-third-i-link sprite-side{if third_node.tag == \u0027new\u0027} m-menu-link-inner-new{\/if}\" level=\"level3\" is_new=\"{if third_node.tag == \u0027new\u0027}new{\/if}\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{if third_node.tag == \u0027new\u0027}<span class=\"m-menu-link-inner-text\" is_new=\"new\" level=\"level3\">{\/if}${third_node.title}{if third_node.tag == \u0027new\u0027}<\/span>{\/if}{if third_node.tag == \u0027new\u0027}<span class=\"new\">NEW<\/span>{\/if}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\/for}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t\t\t\t\t\t\t\t{\/for}\n\t\t\t\t\t\t\t\t\t\t\t\t{if second_node.banners.length}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"m-menu-third-mini-promo\" id=\"fatmenu_mini_promo${second_node.id}\"><\/div>\n\t\t\t\t\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t<a href=\"#\" class=\"sprite-side m-main-scroll-arrow m-main-scroll-arrow-top hidden\" data-direction=\"left\" name=\"controls1\"><\/a>\n\t\t\t\t\t\t\t\t<a href=\"#\" class=\"sprite-side m-main-scroll-arrow m-main-scroll-arrow-bottom hidden\" data-direction=\"right\" name=\"controls1\"><\/a>\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t{\/if}\n\t\t\t\t\t<\/li>\n\t\t\t\t{\/for}\n\t\t\t<\/ul>\n\t\t\t{if node.banner}\n\t\t\t\t{if node.banner.href}\n\t\t\t\t\t<a class=\"m-main-second-banner-link\" href=\"${node.banner.href}\" name=\"fatmenu_big_banner\"><\/a>\n\t\t\t\t{\/if}\n\t\t\t{\/if}\n\t\t<\/div>\n\t\t<a href=\"#\" class=\"sprite-side m-main-scroll-arrow m-main-scroll-arrow-top hidden\" data-direction=\"left\" name=\"controls\"><\/a>\n\t\t<a href=\"#\" class=\"sprite-side m-main-scroll-arrow m-main-scroll-arrow-bottom hidden\" data-direction=\"right\" name=\"controls\"><\/a>\n\t<\/div>\n<\/div>',action:'',use_redis:false,hide_delay:500,parent_hover_class:'m-main-hover',last_level_show_delay:600,submenu:{options:{selectors:{menuItems:'[name="m-main-i-l"]',mini_promo:'[name="fatmenu_minipromo"]'},use_drop_menu_lower_right_point:true,menu:'sub',last_level_show_delay:650}}},_show_by_mouseenter:true,_mouseenter_show_timeout:300,_mouseenter_show_timeout_handler:null},initialize:function(options){this.setOptions(options);this.options.main_menu_options.can_hide=this.options.can_hide;this.main_menu=new RozetkaMenuClass(this.options.selectors.menu,this.options.main_menu_options);this.button=$(this.options.selectors.button);if(this.button){if(this.options._show_by_mouseenter){this.button.addEvent('mouseenter',function(e){this.button_mouseenter=true;if(!this.options._mouseenter_show_timeout_handler&&this._isMainMenuHidden()){this.options._mouseenter_show_timeout_handler=this._onButtonClick.delay(this.options._mouseenter_show_timeout,this,e)}this.main_menu._getData()}.bind(this));this.button.addEvent('mouseleave',function(){this.button_mouseenter=false;this._clearMouseEnterTimeout()}.bind(this));this.button.getParent().addEvent('mouseleave',function(){if(!this._isMainMenuHidden()){this._onButtonClickDelay.delay(this.options.main_menu_options.hide_delay,this)}}.bind(this));this.main_menu.addEvent('fatMenuLeave',function(){if(!this.button_mouseenter&&!this._isMainMenuHidden()){this._onButtonClick()}}.bind(this))}else{this.button.addEvent('click',this._onButtonClick.bind(this))}}this.options.can_hide&&document.addEvent('click',function(e){var target=new Event(e).target,mouseenter_condition=true;if(this.options._show_by_mouseenter&&(this.button.id!=target.id||this.button.contains(target))){mouseenter_condition=false}if(!this._isMainMenuHidden()&&!this.main_menu.menu.contains(target)&&mouseenter_condition){this._onButtonClick()}}.bind(this))},_onButtonClickDelay:function(){if(!this._isMainMenuHover()){this._onButtonClick()}},_isMainMenuHidden:function(){return this.main_menu.menu.hasClass('hidden')},_isMainMenuHover:function(){return this.main_menu.menu.hasClass('hover')},_clearMouseEnterTimeout:function(){if(this.options._mouseenter_show_timeout_handler){clearTimeout(this.options._mouseenter_show_timeout_handler);this.options._mouseenter_show_timeout_handler=null}},_onButtonClick:function(e){if(e){new Event(e).stop()}this.main_menu._getData();if(this.options._show_by_mouseenter){this._clearMouseEnterTimeout()}if(this.options.can_hide){this.toggleMenu()}},toggleMenu:function(){this.main_menu.menu.toggleClass('hidden');this.button.toggleClass('pressed')}});RozetkaFatmenu_class.implement(new Options());var RozetkaStretchBanner=new Class({_banners:[],_actual_banner:null,options:{selectors:{main_block:'stretch_banner',banner_place:'head_banner',close_block:'head_banner_close_block',close_btn:'head_banner_close'},tpl:'{if is_object}\n<div class=\"banner-object\" style=\"background:${color}\">\n<object\n\tclassid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\"\n\tcodebase=\"http:\/\/download.macromedia.com\/pub\/shockwave\/cabs\/flash\/swflash.cab#version=5,0,0,0\"\n\twidth=\"${width}\"\n\theight=\"${height}\"\n\talign=\"top\">\n\t<param name=\"movie\" value=\"${src}?url=${url}\">\n\t<param name=\"quality\" value=\"high\">\n\t<param name=\"bgcolor\" value=\"#FFFFFF\">\n\t<param name=\"wmode\" value=\"transparent\">\n\t<embed\n\t\tsrc=\"${src}?url=${url}\"\n\t\tmenu=\"false\"\n\t\tquality=\"high\"\n\t\twidth=\"${width}\"\n\t\theight=\"${height}\"\n\t\tname=\"intro\"\n\t\talign=\"top\"\n\t\twmode=\"transparent\"\n\t\ttype=\"application\/x-shockwave-flash\"\n\t\tpluginspage=\"http:\/\/www.macromedia.com\/go\/getflashplayer\"\n\t\tbgcolor=\"#FFFFFF\">\n\t<\/embed>\n<\/object>\n<\/div>\n{elseif url==\u0027\u0027}\n<div style=\"background:${color}\"><img src=\"${src}\" width=\"${width}\" height=\"${height}\" alt=\"${alt|escape}\" \/><\/div>\n{else}\n<a href=\"${url}\" target=\"${url_target}\" style=\"background:${color}\"><img src=\"${src}\" width=\"${width}\" height=\"${height}\" alt=\"${alt|escape}\" \/><\/a>\n{\/if}',class_name:'',cookie_name:'banners',cookie_options:{duration:10,path:'/'}},initialize:function(banners,options){this.setOptions(options);this._banners=banners||[]},append:function(){if(this.hasBanner()&&this._checkCookie()){if(this.getActualBanner().color!='#FFF'&&this.getActualBanner().color!='#fff'){$(this.options.selectors.main_block).setStyle('border-bottom',0)}this._addCloseEvent();this.head_banner=this.getContainer('banner_place');this.head_banner.addClass(this.options.class_name);this.head_banner.setHTML(App.getHTML(this.options.tpl,this.getActualBanner()));this._setGTMEvents()}},getContainer:function(id){return $(this.options.selectors[id])},removeContainer:function(){this._removeBlock(this.options.selectors.main_block)},getActualBanner:function(){if(this._banners.length&&!this._actual_banner){this._actual_banner=this._banners.getRandom()}return this._actual_banner},_setGTMEvents:function(){GTMData_Banners.setEventDataImpression(this.getActualBanner().alt,'stretch',this.head_banner,'Stretch');GTMData_Banners.setEventData(this.getActualBanner().alt,'stretch',this.head_banner,'Stretch')},hasBanner:function(){return!!this.getActualBanner()},_addCloseEvent:function(){if(this.getActualBanner().can_be_closed!="0"){$$('[name='+this.options.selectors.close_block+']').forEach(function(el){el.show()});$(this.options.selectors.close_btn).addEvent('click',function(){if(!this.banners_time){this.banners_time={}}this.banners_time[this.getActualBanner().identifier]=new Date().getTime().toInt()+60*60*1000;Cookie.set(this.options.cookie_name,JSON.stringify(this.banners_time),this.options.cookie_options);this._removeBlock(this.options.selectors.main_block)}.bind(this))}},_checkCookie:function(){var result=true,now=new Date().getTime();this.banners_time=JSON.parse(Cookie.get(this.options.cookie_name));if(typeof this.banners_time=='object'&&this.banners_time[this.getActualBanner().identifier]&&this.banners_time[this.getActualBanner().identifier]>now){result=false}return result},_removeBlock:function(id){return $(id)&&$(id).remove()}});RozetkaStretchBanner.implement(new Options());var ToggleBlocks_class=new Class({Class:'ToggleBlocks_class',options:{event:'click',stop_events:true,stop_propagation_events:false,effects:{show:[],hide:[]}},container:null,blocks:null,initialize:function(container){this.blocks=[];this.container=container},setBlock:function(element,handler,name,active){var index=this.blocks.length,block={active:active,handler:$$(this.initElements(handler,this.container)),element:$$(this.initElements(element,this.container)),name:name||this.Class+index};if(!block.element.length&&element&&$type(element.show)=="function"&&$type(element.hide)=="function"){block.element.push(element)}this.blocks.push(block);this._initEvents(this.blocks[index]);active?this._showBlock(this.blocks[index]):this._hideBlock(this.blocks[index]);return this},addBlock:function(element,name){var blocks=this.getBlocks(name);if(blocks.length){blocks.each(function(block){block.element.push(element);block.active?this._showBlock(block):this._hideBlock(block)},this)}else{this.setBlock(element,null,name)}return this},addHandler:function(handler,action,name){this.getBlocks(name).each(function(block){if(!block.handler.push){block.handler=$$(block.handler)}block.handler.push(handler);this._initEvents({name:block.name,handler:handler,action:action})},this);return this},display:function(name,e){var show_blocks,active_blocks;e&&this.options.stop_events&&new Event(e).stop();e&&this.options.stop_propagation_events&&new Event(e).stopPropagation();show_blocks=this.getBlocks(name);if(this._isDisplayAllowed(show_blocks,e)){active_blocks=this.getActiveBlocks();active_blocks.diff(show_blocks).each(this._hideBlock,this);show_blocks.diff(active_blocks).each(this._showBlock,this)}return this},getBlocks:function(name){return name===undefined?[this.blocks.getLast()]:this.blocks.filter(this._condition.bindAsEventListener(this,name))},getActiveBlocks:function(){return this.getBlocks(true).filter(function(block){return block.active})},_initEvents:function(block){block.handler&&block.handler.addEvent(block.action||this.options.event,function(e){this.display(block.name,e)}.bind(this))},_condition:function(block,key){var key_condition=false;if(key===true){key_condition=true}else if(typeof key=='number'||typeof key=='string'){key_condition=key==block.name}else if(typeof key=='object'){key_condition=block.handler.contains(key)}return key_condition},_isDisplayAllowed:function(show_blocks,e){return!!show_blocks.length},_showBlock:function(block){block.active=true;block.handler&&block.handler.addClass('active');block.element&&block.element.show();this._effectsApply(this.options.effects.show,block)},_hideBlock:function(block){block.active=false;block.handler&&block.handler.removeClass('active');block.element&&block.element.hide();this._effectsApply(this.options.effects.hide,block)},_effectsApply:function(effects,block){if(effects&&block){effects.each(function(effect){effect(block)})}}});ToggleBlocks_class.implement(new Options(),new InitElements());var ActiveBlocks_class=ToggleBlocks_class.extend({Class:'ActiveBlocks_class',addOnFn:function(onShow,onHide,name){this.getBlocks(name).each(function(block){if(onShow){block.onShow=onShow}if(onHide){block.onHide=onHide}},this);return this},addDisplayAllowedFn:function(displayAllowedFn,name){this.getBlocks(name).each(function(block){if(displayAllowedFn){block.displayAllowedFn=displayAllowedFn}},this);return this},_isDisplayAllowed:function(show_blocks,e){return this.parent(show_blocks)&&show_blocks.every(function(block){return!block.displayAllowedFn||block.displayAllowedFn(block,e)})},_showBlock:function(block){block.onShow&&block.onShow(block);this.parent(block);this.fireEvent('Show',block)},_hideBlock:function(block){block.onHide&&block.onHide(block);this.parent(block);this.fireEvent('Hide',block)}});ActiveBlocks_class.implement(new Events());var DynamicBlocks_class=ActiveBlocks_class.extend({Class:'DynamicBlocks_class',disableBlock:function(name){this.getBlocks(name).each(function(block){block.disabled=true;if(block.active){var first_enable=this.getBlocks(true).shift();first_enable&&this._showBlock(first_enable)}this._hideBlock(block);block.handler&&block.handler.hide()},this)},enableBlock:function(name){this.getBlocks(name,true).each(function(block){block.disabled=false;block.handler&&block.handler.show()},this)},getBlocks:function(name,with_disabled){return with_disabled?this.parent(name):this.parent(name).filter(function(block){return!block.disabled})},getBlockNames:function(){var block_names=[];this.getBlocks(true,true).each(function(block){block_names.push(block.name)});return block_names}});var AuthorizationBlocks_class=new Class({_class:'AuthorizationBlocks_class',options:{blocks:{simple_auth:'<div name=\"simple_auth\" class=\"hidden\">\n\t<div class=\"clearfix auth-f-i\">\n\t\t<div class=\"f-i-title-vert\">\u041f\u0430\u0440\u043e\u043b\u044c<\/div>\n\t\t<input type=\"password\" class=\"input-text auth-input-text\" _required=\"required\" name=\"password\" tabindex=\"2\">\n\t\t<div class=\"auth-message hidden\" name=\"wrong_password_block\">\n\t\t\t<h5 class=\"auth-forgot-pass-tooltip-title\" name=\"password_hint\"><\/h5>\n\t\t\t<p class=\"auth-forgot-pass-tooltip-note\">\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0440\u0430\u0441\u043a\u043b\u0430\u0434\u043a\u0443 \u043a\u043b\u0430\u0432\u0438\u0430\u0442\u0443\u0440\u044b \u0438&nbsp;Caps Lock<\/p>\n\t\t\t<p class=\"auth-forgot-pass-tooltip-text\"><a class=\"xhr\" href=\"#\" name=\"send_temp_pass\">\u041f\u0440\u0438\u0448\u043b\u0438\u0442\u0435 \u043c\u043d\u0435 \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c<\/a><br>\n\t\t\t\t\u043d\u0430&nbsp;\u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 \u0430\u0434\u0440\u0435\u0441 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0447\u0442\u044b<\/p>\n\t\t<\/div>\n\t<\/div>\n\t<div class=\"clearfix f-i auth-f-submit\">\n\t\t<div class=\"auth-f-submit-btn\">\n\t\t\t<span class=\"btn-link btn-link-blue\">\n\t\t\t\t<button class=\"btn-link-i\" id=\"signin\" name=\"auth_submit\" tabindex=\"3\">\u0412\u043e\u0439\u0442\u0438<\/button>\n\t\t\t<\/span>\n\t\t\t<a href=\"https:\/\/my.rozetka.com.ua\/remind-password\/\" class=\"xhr novisited auth-forgot-pass-link\" name=\"forgot_button\" tabindex=\"4\">\u042f \u0437\u0430\u0431\u044b\u043b \u043f\u0430\u0440\u043e\u043b\u044c<\/a>\n\t\t<\/div>\n\t<\/div>\n<\/div>',get_temp_pass:'<div name=\"get_temp_pass\" class=\"hidden\">\n\t<div class=\"clearix f-i\">\n\t\t<div class=\"auth-remember-pass-submit\">\n\t\t\t<span class=\"btn-link btn-link-gray\">\n\t\t\t\t<input class=\"btn-link-i\" type=\"submit\" name=\"send_temp_pass_button\" value=\"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c\" tabindex=\"2\">\n\t\t\t<\/span>\n\t\t<\/div>\n\t\t<div class=\"auth-remember-pass\">\n\t\t\t<a href=\"https:\/\/my.rozetka.com.ua\/checkout\/#signin\" class=\"xhr novisited auth-remember-pass-link\" name=\"remembered_button\" tabindex=\"3\">\u042f \u0432\u0441\u043f\u043e\u043c\u043d\u0438\u043b \u0441\u0432\u043e\u0439 \u043f\u0430\u0440\u043e\u043b\u044c<\/a>\n\t\t<\/div>\n\t<\/div>\n<\/div>',temp_pass_sent:'<div class=\"clearfix f-i hidden\" name=\"temp_pass_sent\">\n\t<div class=\"auth-f-i\">\n\t\t<div class=\"clearfix f-i-title-vert\">\n\t\t\t\u0412\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c\n\t\t<\/div>\n\t\t<input class=\"input-text auth-input-text\" type=\"password\" _required=\"required\" name=\"password\" tabindex=\"2\">\n\t\t<div class=\"auth-message hidden\" name=\"wrong_temp_pass_block\">\n\t\t\t<h5 class=\"auth-forgot-pass-tooltip-title\" name=\"temp_pass_hint\"><\/h5>\n\t\t<\/div>\n\t<\/div>\n\t<div class=\"clearfix f-i auth-f-submit\">\n\t\t<div class=\"auth-f-submit-btn\">\n\t\t\t<span class=\"btn-link btn-link-blue\">\n\t\t\t\t<input class=\"btn-link-i\" type=\"submit\" name=\"temp_submit\" value=\"\u0412\u043e\u0439\u0442\u0438\" tabindex=\"4\">\n\t\t\t<\/span>\n\t\t\t<a href=\"https:\/\/my.rozetka.com.ua\/checkout\/#signin\" class=\"xhr novisited auth-remember-pass-link\" name=\"pass_sent_remembered_button\" tabindex=\"3\">\u042f \u0432\u0441\u043f\u043e\u043c\u043d\u0438\u043b \u0441\u0432\u043e\u0439 \u043f\u0430\u0440\u043e\u043b\u044c<\/a>\n\t\t<\/div>\n\t<\/div>\n<\/div>'},tpl:{email_hint:'<div class=\"auth-message\">\n\t<p class=\"auth-message-text\" name=\"email_hint\">{if msg}${msg}{else}\u041d\u0430 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 \u0430\u0434\u0440\u0435\u0441 \u044d\u043b. \u043f\u043e\u0447\u0442\u044b \u0432\u044b\u0441\u043b\u0430\u043d \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0435\u0433\u043e{\/if}<\/p>\n<\/div>',message:'<div class=\"pos-fix sprite-side message code${code}\">\n\t<a href=\"\" class=\"message-close-link\" onclick=\"clearUserMessages(event);\">\n\t\t<img src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" width=\"24\" height=\"24\" class=\"sprite message-close-link-img\">\n\t<\/a>\n\t${content}\n<\/div>'},selectors:{msg:'[name="app-message"]',blocks_container:'div[name="auth_blocks"]',email:'input[name="email"]',remember:'input[name="remember"]',send_form_btn_block:'',hint_blocks:{email_hint_block:'[name="email_hint_block"]',wrong_password_block:'[name="wrong_password_block"]',wrong_temp_pass_block:'[name="wrong_temp_pass_block"]'},password_hint:'[name="password_hint"]',temp_pass_hint:'[name="temp_pass_hint"]',simple_auth:'[name="simple_auth"]',get_temp_pass:'[name="get_temp_pass"]',temp_pass_sent:'[name="temp_pass_sent"]',blocks:{auth:'[name="simple_auth"]',get_temp_pass:'[name="get_temp_pass"]',temp_pass_sent:'[name="temp_pass_sent"]'},handlers:{temp_submit:'[name="temp_submit"]',auth:'[name="auth_submit"]',forgot:'[name="forgot_button"]',send_temp_pass:'[name="send_temp_pass"]',get_temp_pass:'[name="send_temp_pass_button"]',remembered_button:'[name="remembered_button"]',pass_sent_remembered_btn:'[name="pass_sent_remembered_button"]'}},process_tpl:'<img src="https://i1.rozetka.com.ua/design/check-ajax.gif" width="64" height="64" alt=" " class="process"/>',track_email_change:false,blocks_type:null},form:null,elems:null,active_blocks:null,_user:null,_get_temp_pass_email_onkeyup:null,initialize:function(form,options){this.setOptions(options);this.form=form;this._insertBlocks();this._user=window['User'];this.elems=this.initElements(this.options.selectors,this.form);if(!this.form.msg){this.form.msg=this.elems.msg}this._initActiveBlocks();this._addEvents()},needAuth:function(msg){this.tmp_email=this.elems.email.getValue();this.elems.send_form_btn_block&&this.elems.send_form_btn_block.hide();if(msg){document.fireEvent('authBlocksEmailExists');if(!msg.field){msg.field='login'}}if(this.options.blocks_type){document.fireEvent('authBlocksOpened',{extend_event:[{name:'eventContext',value:this.options.blocks_type}]})}this.showFieldError(msg);this.active_blocks.display('simple_auth')},showEmailHint:function(msg){this.elems.hint_blocks.email_hint_block.setHTML(App.getHTML(this.options.tpl.email_hint,{msg:msg}));this.elems.hint_blocks.email_hint_block.show()},showFieldError:function(msg){if(msg&&msg.content&&msg.field){if(msg.field=='password'){this.showPasswordHint(msg.content);document.fireEvent('authBlocksWrongPassword')}else if(msg.field=='login'){this.showEmailHint(msg.content)}}},showPasswordHint:function(msg){var active_block=this.active_blocks.getActiveBlocks().pop(),password_field=this._getPasswordField(),block,hint;if(msg){if(active_block.name=='simple_auth'){block=this.elems.hint_blocks.wrong_password_block;hint=this.elems.password_hint}else if(active_block.name=='pass_sent'){block=this.elems.hint_blocks.wrong_temp_pass_block;hint=this.elems.temp_pass_hint}hint.setHTML(msg);block.show()}password_field.value='';password_field.focus();password_field.highlightError()},_getPasswordField:function(){var field,active_blocks=this.active_blocks.getActiveBlocks();if(active_blocks.length){field=active_blocks.pop().element.getElement('[name="password"]')[0]}return field},getPassword:function(){var password;if(this._getPasswordField()){password=this._getPasswordField().getValue()}return password},_hideHints:function(){var active_block=this.active_blocks.getActiveBlocks().pop();if(active_block&&active_block.name=='simple_auth'){this.elems.hint_blocks.email_hint_block.hide();this.elems.hint_blocks.wrong_password_block.hide()}else if(active_block&&active_block.name=='pass_sent'){this.elems.hint_blocks.wrong_temp_pass_block.hide()}},checkErrorField:function(e){return e.field=='password'||e.field=='login'},hideAllBlocks:function(){this.active_blocks&&this.active_blocks.getActiveBlocks().each(function(block){this.active_blocks._hideBlock(block)}.bind(this));Object.each(this.elems.hint_blocks,function(elem){elem.hide()});this.elems.send_form_btn_block&&this.elems.send_form_btn_block.show()},_insertBlocks:function(){var container=this.form.getElement(this.options.selectors.blocks_container);container.innerHTML='';Object.each(this.options.blocks,function(tpl){container.innerHTML+=App.getHTML(tpl,{})}.bind(this))},_initActiveBlocks:function(){this._get_temp_pass_email_onkeyup=function(e){e=new Event(e).stop();if(e.code==13&&this.elems.email.isValid()){this._sendTemporaryPassword()}}.bind(this);this.active_blocks=new ActiveBlocks_class(this.form).setBlock(this.elems.blocks.auth,this.elems.handlers.remembered_button,'simple_auth',false).addHandler(this.elems.handlers.pass_sent_remembered_btn).addOnFn(null,function(){this.elems.hint_blocks.email_hint_block.hide();this.elems.hint_blocks.wrong_password_block.hide();this._getPasswordField().highlightReset()}.bind(this)).setBlock(this.elems.blocks.get_temp_pass,this.elems.handlers.forgot,'forgot',false).addOnFn(function(){document.fireEvent('authBlocksForgotPassword');this.elems.email.addEvent('keyup',this._get_temp_pass_email_onkeyup)}.bind(this),function(){this.elems.hint_blocks.email_hint_block.hide();this.elems.email.removeEvent('keyup',this._get_temp_pass_email_onkeyup)}.bind(this)).setBlock(this.elems.blocks.temp_pass_sent,null,'pass_sent',false).addOnFn(function(){this.showEmailHint();this.elems.email.setProperty('disabled','disabled')}.bind(this),function(){this.elems.hint_blocks.email_hint_block.hide();this.elems.email.removeProperty('disabled')}.bind(this))},_sendTemporaryPassword:function(){this._hideErrorMessage();this.form.processStart(this.options.process_tpl);this._user.sendTemporaryPassword(this.elems.email.getValue(),this._onSendTempPass.bind(this))},_addEvents:function(){var sendTempPass,rememberButtonClick;sendTempPass=function(e){new Event(e).stop();if(this.elems.email.checkFields()){this._sendTemporaryPassword()}}.bind(this);rememberButtonClick=function(){document.fireEvent('authBlocksRememberedPassword')};this._addSubmitEvents();if(this.options.track_email_change){this.elems.email.addEvent('keyup',this._onEmailFieldChange.bind(this))}this.elems.handlers.get_temp_pass.addEvent('click',sendTempPass);this.elems.handlers.send_temp_pass.addEvent('click',sendTempPass);this.elems.handlers.remembered_button.addEvent('click',rememberButtonClick);this.elems.handlers.pass_sent_remembered_btn.addEvent('click',rememberButtonClick)},_onSendTempPass:function(resp){this.form.processStop();var response=new Response_class(resp);if(response.isDone()){document.fireEvent('authBlocksGetTempPass');this.active_blocks.display('pass_sent')}else if(this.checkErrorField(response.Message)){this._hideHints();this.showFieldError(response.Message)}else if(!this._showErrorMessage(response.Message)){App.showMessage(response.Message)}},_onEmailFieldChange:function(){var active_block=this.active_blocks.getActiveBlocks().pop();if(active_block&&active_block.name=='simple_auth'&&this.elems.email.isValid()&&this.elems.email.getValue()!=this.tmp_email){this.hideAllBlocks()}},_addSubmitEvents:function(){this._on_sign_in=this._onSignIn.bind(this);this._on_sign_in_failed=this._onSignInFailed.bind(this);this._user.addEvent('signIn',this._on_sign_in);this.elems.handlers.auth.addEvent('click',this._onSubmit.bind(this));this.elems.handlers.temp_submit.addEvent('click',this._onSubmit.bind(this))},_onSignIn:function(S){this.form.processStop();this._user.removeEvent('signIn',this._on_sign_in);this._user.removeEvent('signInFailed',this._on_sign_in_failed);this.hideAllBlocks();if(this.options.blocks_type){document.fireEvent('authBlocksSignIn',{extend_event:[{name:'eventLabel',value:this.options.blocks_type}]})}this.fireEvent('authBlocksUserSignIn',S)},_onSignInFailed:function(msg){this.form.processStop();this._user.removeEvent('signInFailed',this._on_sign_in_failed);if(this.checkErrorField(msg)){this.showFieldError(msg)}else if(!this._showErrorMessage(msg)){App.showMessage(msg)}},_onSubmit:function(e){var active_block=this.active_blocks.getActiveBlocks().pop(),remember=false;new Event(e).stop();if(this.form.checkFields()&&active_block.name!='forgot'){this._hideHints();this.form.processStart(this.options.process_tpl);this._hideErrorMessage();this._user.addEvent('signInFailed',this._on_sign_in_failed);if(this.elems.remember&&this.elems.remember.getValue()){remember=this.elems.remember.getValue()}this._user.trySignIn({login:this.elems.email.getValue(),password:this.getPassword(),remember:remember})}},_showErrorMessage:function(msg){var result=false;if(this.form.msg){this.form.msg.setHTML(msg.getContentTpl(this.options.tpl.message));this.form.msg.show();result=true}return result},_hideErrorMessage:function(){if(this.form.msg){this.form.msg.hide()}}});AuthorizationBlocks_class.implement(new Options(),new InitElements(),new Events());location.parseHash=function(hash){hash=hash||this.hash;if(!hash)return null;return App.parseGET(hash,'#',';')};location.getHashParam=function(name){var params=this.parseHash();if(params&&$defined(params[name]))return params[name];return null};location.createHash=function(obj){var hash=[];for(name in obj){hash.push(name+'='+obj[name])}return'#'+hash.join(';')};var Partners_class=new Class({Class:'Partners_class',elem_header:null,elem_footer:null,elem_footer_note:null,elem_contacts:null,elem_contacts_note:null,elem_contacts_managers_block:null,ga_name:'google_analytics',partner_id:null,records:null,options:{id:'',footer_phone_id:'',footer_phone_note_id:'',contacts_phone_id:'',contacts_phone_note_id:'',contacts_managers_block_id:''},initialize:function(records){this.records=records;this.partner_id=this._getPartnerId();if(this.partner_id){this._savePartnerToCookie(this.partner_id)}},init:function(id){this.elem_header=(this.options.id)?$(this.options.id):null;if(this.elem_header){this._updatePhones(this.elem_header)}},initFooter:function(id){this.elem_footer=(this.options.footer_phone_id)?$(this.options.footer_phone_id):null;this.elem_footer_note=(this.options.footer_phone_note_id)?$(this.options.footer_phone_note_id):null;if(this.elem_footer){this._updatePhones(this.elem_footer);if(this.partner_id&&this.records[this.partner_id]&&this.elem_footer_note&&this.records[this.partner_id].need_to_hide_phone){this.elem_footer_note.setHTML("")}}},initContacts:function(id){this.elem_contacts=(this.options.contacts_phone_id)?$(this.options.contacts_phone_id):null;this.elem_contacts_note=(this.options.contacts_phone_note_id)?$(this.options.contacts_phone_note_id):null;this.elem_contacts_managers_block=(this.options.contacts_managers_block_id)?$(this.options.contacts_managers_block_id):null;if(this.elem_contacts){this._updatePhones(this.elem_contacts);if(this.partner_id&&this.records[this.partner_id]){if(this.elem_contacts_note&&this.records[this.partner_id].need_to_hide_phone){this.elem_contacts_note.setHTML("")}if(this.elem_contacts_managers_block&&this.records[this.partner_id].need_to_hide_phones_in_contact){this.elem_contacts_managers_block.setHTML("")}}}},_updatePhones:function(elem){if(this.partner_id&&this.records[this.partner_id]&&elem){if(this.records[this.partner_id].need_to_hide_phone){elem.setHTML("")}else if(this.records[this.partner_id].phone){elem.setHTML(this.records[this.partner_id].phone)}}},_getPartnerId:function(){var partner_id=false;var pr;if(partner_id=this._getPartnerIdByUrl(document.location.href)){}else if(partner_id=Cookie.get('partner_id')){}else if(pr=Cookie.get('pr')){partner_id=this._getPartnerIdByReferrer(pr)}return partner_id},_savePartnerToCookie:function(partner_id){Cookie.set('partner_id',partner_id,{duration:45,domain:'rozetka.com.ua',path:'/'});Cookie.remove('pr',{domain:'rozetka.com.ua',path:'/'})},_getPartnerIdByReferrer:function(host){var result;for(var id in this.records){if(this.records[id].patterns){result=this.records[id].patterns.some(function(item){return this._checkHostByPattern(item,host)},this);if(result){result=id;break}}}return result},_getPartnerIdByUrl:function(url){var params=App.parseGET(App.parseURL(url).search);var partner_id=null;var gclid=$defined(params.gclid)?params.gclid:null;var utm_source=$defined(params.utm_source)?params.utm_source:null;if(gclid||utm_source){for(var id in this.records){if(gclid&&this.records[id].name&&this.records[id].name==this.ga_name){return id}if(utm_source&&this.records[id].name&&this.records[id].name==utm_source){partner_id=id}}}return partner_id},_checkHostByPattern:function(pattern,host){pattern=pattern.replace(/\./g,'\\\.').replace(/\*/g,'.+');pattern='^'+pattern+'$';return host.test(pattern)},isAddCode:function(){return this.partner_id&&this.records[this.partner_id]&&this.records[this.partner_id].is_add_id}});Partners_class.implement(new Options,new Events);var RozetkaPartners_class=Partners_class.extend({Class:'RozetkaPartners_class',_storage:null,initialize:function(records){this._storage=App.getStorage();this.parent(records);document.addEventListener("initCrossDomainStorageComplete",this._initStorageService.bind(this),false)},_savePartnerToCookie:function(partner_id){this._storage.set('partner_id',partner_id);this.parent(partner_id)},_initStorageService:function(){if(!this.partner_id&&this._storage.exist('partner_id')){this.partner_id=parseInt(this._storage.get('partner_id'));this._savePartnerToCookie(this.partner_id)}}});var RozetkaCopyText_class=new Class({Class:'RozetkaCopyText_class',copy_el:null,copy_el_id:null,copy_el_class:null,min_length:null,initialize:function(name,id,template,min_length){if($type(name)=='string'){var item=$$('div.'+name)[0];if(item){item.addEvents({'mousedown':this.removeTextToCopy.bind(this),'mouseup':this.addTextToCopy.bind(this)})}}else if($type(name)=='array'){for(i=0;i<name.length;++i){var item=$$('div.'+name[i])[0];if(item){item.addEvents({'mousedown':this.removeTextToCopy.bind(this),'mouseup':this.addTextToCopy.bind(this)})}}}this.min_length=min_length?min_length:30;this.copy_el_id=id?id:'copyinfo';this.copy_el=new Element('span',{'id':this.copy_el_id});this.copy_template=template?template:'<br>: <a href="'+location.href+'">'+location.href+'</a>';this.copy_el.innerHTML=this.copy_template},removeTextToCopy:function(){if($(this.copy_el_id)){$(this.copy_el_id).remove()}},addTextToCopy:function(){if(window.getSelection){sel=window.getSelection();selText=sel.toString();if(!selText||selText.length<this.min_length){return}newSel=sel.getRangeAt(0);selText=newSel.cloneRange();selText.collapse(false);selText.insertNode(this.copy_el);newSel.setEndAfter(this.copy_el);sel.removeAllRanges();sel.addRange(newSel)}else if(document.selection){sel=document.selection;newSel=sel.createRange();selText=newSel.text;if(!selText||selText.length<this.min_length){return}selText=newSel.duplicate();selText.collapse(false);selText.pasteHTML($(this.copy_el).outerHTML);newSel.setEndPoint("EndToEnd",selText);newSel.select()}}});RozetkaCopyText_class.implement(new Options,new Events);var RozetkaSocialButtons_class=new Class({Class:'RozetkaSocialButtons_class',_elem:null,_ul:null,url:null,encoded_url:null,options:{params:{title:null,image:null,description:null},css_properties:{ul_class:'social-share-l',li_class:'social-share-i'},counter:false,counter_css:'counter'},initialize:function(id,url,twitter_link){this.url=url;this.encoded_url=encodeURIComponent(this.url);this._elem=$(id);var social_links={vkontakte:{href:'http://vkontakte.ru/share.php?url=',title:'',css_class:'sprite-side social-icon-link social-icon-link-middle-vk',counter:{url:'https://vk.com/share.php?act=count&index=1&format=json&url=',callback:'SoccialButtonCallbackFunction.vkontakte',name:'vk'},hash:{title:'title',description:'description',image:'image'}},facebook:{href:'http://www.facebook.com/sharer.php?u=',title:'Facebook',css_class:'sprite-side social-icon-link social-icon-link-middle-fb',counter:{url:'http://api.facebook.com/restserver.php?method=links.getStats&format=json&urls=',callback:'SoccialButtonCallbackFunction.facebook',name:'fb'},hash:{title:'t'}},google:{href:'https://plus.google.com/share?url=',title:'Google',css_class:'sprite-side social-icon-link social-icon-link-middle-gp',counter:{url:'http://share.yandex.ru/gpp.xml?url=',callback:'SoccialButtonCallbackFunction.google',name:'gp'}},twitter:{href:'http://twitter.com/share?url=',title:'Twitter',css_class:'sprite-side social-icon-link social-icon-link-middle-tw',counter:{url:'http://urls.api.twitter.com/1/urls/count.json?url=',callback:'SoccialButtonCallbackFunction.twitter',name:'tw'},hash:{title:'text'}},email:{href:'mailto:?body=',title:' ',css_class:'sprite-side social-icon-link social-icon-link-middle-email',hash:{title:'subject'}}};if(twitter_link){social_links.twitter.href='http://twitter.com/home?status=';social_links.twitter.simple_link=1}this.setOptions({social_links:social_links})},run:function(){this._ul=new Element('ul',{'class':this.options.css_properties.ul_class});for(var link in this.options.social_links){if(this.options.social_links[link]){this.createElements(link)}}this._ul.inject(this._elem)},getScriptSrc:function(options){var url=options['url']+this.url;if(options['callback']){url+=('&callback='+options['callback'])}return url},createElements:function(link){var options=this.options;this.createParams(link);var li=new Element('li',{'class':this.options.css_properties.li_class});var a=new Element('a',{href:options.social_links[link]['href'],title:options.social_links[link]['title'],'class':options.social_links[link]['css_class'],target:'_blank'});a.inject(li);if(options['counter']&&$defined(options.social_links[link]['counter'])&&$defined(SoccialButtonCallbackFunction)){var counter=new Element('div',{name:'counter_'+options.social_links[link]['counter']['name'],'class':this.options.counter_css});counter.inject(li);a.addEvent('click',function(e){SoccialButtonCallbackFunction.showCounter(counter,counter.innerHTML,1)}.bind(this));if(options.social_links[link]['counter']['name']=='vk'&&window.VK==undefined){SoccialButtonCallbackFunction.vkontakte()}if(options.social_links[link]['counter']['name']=='gp'&&window.services==undefined){SoccialButtonCallbackFunction.google()}Asset.javascript(this.getScriptSrc(options.social_links[link]['counter']),{'onload':function(){this.getParent().removeChild(this)}})}li.inject(this._ul);var url=this.options.social_links[link]['encode']?this.encoded_url:this.url;this.addToGoogleAnalitycs(a,options.social_links[link]['title'],url)},createParams:function(link){if(this.options.social_links[link]['encode']){this.options.social_links[link]['href']+=this.encoded_url}else{this.options.social_links[link]['href']+=this.url}if(this.options.social_links[link]['hash']){if(this.options.social_links[link]['simple_link']){this.options.social_links[link]['href']+=' '+encodeURIComponent(this.options.params.title)}else{this.createHash(link)}}},createHash:function(link){for(var hash in this.options.social_links[link]['hash']){if(this.options.params[hash]){this.options.social_links[link]['href']+='&'+this.options.social_links[link]['hash'][hash]+'='+encodeURIComponent(this.options.params[hash])}}},addToGoogleAnalitycs:function(el,title,url){el.addEvent('click',function(e){document.fireEvent("socialButtonShareClick",{extend_event:[]});App.trackSocial(title,'share',url)})}});RozetkaSocialButtons_class.implement(new Options);var RozetkaSocialButtonsCallbackFunctions_class=new Class({options:{selectors:{vkontakte:'[name=counter_vk]',facebook:'[name=counter_fb]',twitter:'[name=counter_tw]',google:'[name=counter_gp]'},short_char:'k'},showCounter:function(elem,count,inc){var str_value=count.toString(),result="0";if(str_value.indexOf(this.options.short_char)==-1){count=count.toInt()||0;result=inc?(count+inc).toString():str_value;if(result.length>3){result=result.substr(0,result.length-3)+this.options.short_char}}else{result=count}if(parseInt(result)){elem.innerHTML=result}},facebook:function(data){if(data.length){$$(this.options.selectors.facebook).each(function(elem){this.showCounter(elem,data[0]['total_count'])}.bind(this))}},twitter:function(data){$$(this.options.selectors.twitter).each(function(elem){this.showCounter(elem,data['count'])}.bind(this))},google:function(data){window.services={gplus:{cb:null}};window.services.gplus.cb=function(count){$$(this.options.selectors.google).each(function(elem){this.showCounter(elem,count)}.bind(this))}.bind(this)},vkontakte:function(data){window.VK={};window.VK.Share={};window.VK.Share.count=function(index,count){$$(this.options.selectors.vkontakte).each(function(elem){this.showCounter(elem,count)}.bind(this))}.bind(this)}});RozetkaScroller_class=new Class({options:{cloneProperties:['class','name','style'],elemsContainer:'[name=elems-container]',elems:'[name=scroll-element]',controls:'[name=controls]',screen:'[name=screen]',visibleElementsLength:4,step:3,widthScrollElement:135,width_differense:30,circular:false,catalogItemSelector:'[name=catalog_item]',paginator_elems:null,fx_opacity_duration:300,catalogItemField:'_value',enable_change_size:false,vector:'horizontal',cssClasses:{active:"active",hidden:"hidden"},gtm_event_data:{add_review_scroll:[{name:'eventLabel',value:'product'}],kits_scroller:[{name:'eventLabel',value:'kit'},{name:'eventLocation',value:'ProductPage'}],similar_scroller:[{name:'eventLabel',value:'goods'},{name:'eventLocation',value:'similar'}],section_scroller_accessories:[{name:'eventLabel',value:'goods'},{name:'eventLocation',value:'accessories'}],section_scroller_software:[{name:'eventLabel',value:'goods'},{name:'eventLocation',value:'software'}],section_scroller_related:[{name:'eventLabel',value:'goods'},{name:'eventLocation',value:'related'}],kits_scroller_cart:[{name:'eventLabel',value:'goods'},{name:'eventLocation',value:'kitCart'},{name:'eventContent',value:'set'}],brandshop_bosch_scroller:[],recent_goods_sroller:[{name:'eventLabel',value:'goods'},{name:'eventLocation',value:'recent'}],accessories_scroller_cart:[{name:'eventLabel',value:'goods'},{name:'eventLocation',value:'recommended'},{name:'eventContent',value:'cart'}]}},_elems:null,_paginator:[],_paginator_active_elem_index:0,_can_change_paginator:true,_sliderBlockContainer:null,_elemsContainer:null,_controls:null,_screen:null,_fx:null,parentElem:null,_count_click:{},initialize:function(parentElem){this.parentElem=parentElem;this._count_click.recent_goods_sroller=0},_setHeightElements:function(){var max_height_kit_slider=0,elements=this.parentElem.getElements(this.options.elems),controls=this.parentElem.getElements(this.options.controls);elements.each(function(elem){if(elem.getSize().size.y>max_height_kit_slider){max_height_kit_slider=elem.getSize().size.y}});elements.each(function(element){element.setStyle('height',max_height_kit_slider)});controls.each(function(elem){elem.setStyle('height',max_height_kit_slider)})},_getElements:function(){if(this._elems==null){this._elems=this.parentElem.getElements(this.options.elems)}return this._elems},_getControls:function(){if(this._controls==null){this._controls=this.parentElem.getElements(this.options.controls)}return this._controls},_getElementsContainerParent:function(){if(this._sliderBlockContainer==null){this._sliderBlockContainer=this._getContainerElement().getParent()}return this._sliderBlockContainer},_scrollToLeft:function(scroll_x_axis){if(this.options.vector=='vertical'){this._getElementsContainerParent().scrollTo(0,scroll_x_axis)}else{this._getElementsContainerParent().scrollTo(scroll_x_axis,0)}},_smoothScrollToLeft:function(scroll_x_axis){if(this.options.vector=='vertical'){this._getFx().scrollTo(0,scroll_x_axis)}else{this._getFx().scrollTo(scroll_x_axis,0)}},_getContainerElement:function(){if(this._elemsContainer==null){this._elemsContainer=this.parentElem.getElement(this.options.elemsContainer)}return this._elemsContainer},_getScreen:function(){if(this._screen==null){this._screen=this.parentElem.getElement(this.options.screen)}return this._screen},_controlsClickHandler:function(e){var event=new Event(e).stop(),vector=this._getVectorControl(event.target);if(vector!=undefined&&this._isPossibleScrollByVector(vector)){this._tryScrollingByVector(vector)}},_getVectorControl:function(control){var direction;if(control.dataset){direction=control.dataset.direction}else{direction=control.getAttribute("data-direction")}return direction},_isPossibleScrollByVector:function(vector){var result=false,scroll=this._getContainerScrollLeft();if(this._getElements()&&this._getElements().length&&this._getElements().length>=this.options.visibleElementsLength){switch(vector){case'left':result=this.options.circular||scroll>0;break;case'right':result=this.options.circular||scroll<this._getLimits().right;break}}return result},_getLimits:function(){var parent_container=this._getElementsContainerParent(),result=0;if(this.options.vector=='vertical'){result=parent_container['scrollHeight']-parent_container['clientHeight']-1}else{result=parent_container['scrollWidth']-parent_container['clientWidth']-1}return{left:0,right:result}},_getFx:function(){return this._fx},_setFx:function(fx){this._fx=fx},_tryScrollingByVector:function(vector){if(this.options.circular){this._prepareNextCircularMotion(vector)}var scroll=this._getScrollByStep(vector,this.options.step!='auto'?this.options.step:this._getElementsContainerParent().offsetWidth/this.options.widthScrollElement-1.5);this._smoothScrollToLeft(scroll);if(this._paginator.length){this._changePaginatorIndexByVector(vector)}this._prepareGTMEventData(this.parentElem.getProperty('_action'),scroll)},_prepareGTMEventData:function(action,scroll){var event_data={extend_event:[]};if(this.options.gtm_event_data.hasOwnProperty(action)){event_data.extend_event.extend(this.options.gtm_event_data[action]);this._fireEventScrollerUse(event_data);if(action=='kits_scroller_cart'){this._trackEventRewind(rozetkaEvents.getParam('cart_category'),scroll)}}},_fireEventScrollerUse:function(event_data){document.fireEvent('scrollerUse',event_data)},_getScrollByStep:function(vector,step){var scroll_after,limits=this._getLimits(),scroll_before=this._getContainerScrollLeft();switch(vector){case'left':scroll_after=scroll_before-(step*this.options.widthScrollElement);scroll_after=scroll_after<limits.left?limits.left:scroll_after;break;case'right':scroll_after=scroll_before+(step*this.options.widthScrollElement);scroll_after=scroll_after>limits.right?limits.right:scroll_after;break}return scroll_after},_trackEventRewind:function(action,scrollAfter){if(this._getContainerElement()){var elements=this._getContainerElement().getElements('[name=kits_item]'),position=Math.floor(Math.abs(scrollAfter)/parseInt(elements[0].getStyle('width'),10)),current_element=elements[position],kit_id=current_element.getElements('[name=kit_id]')[0],kit_number_before=elements[position].getElements('[name=kit_number]')[0];rozetkaEvents.trackEvent(action,'kit/carousel/rewind/'+kit_number_before.getText(),kit_id.getText())}},_prepareNextCircularMotion:function(vector){var scroll=this._getContainerScrollLeft(),visible_width,i;if(this._getElements().length>1){visible_width=this.options.visibleElementsLength*this.options.widthScrollElement;if(scroll==0&&vector=='left'){for(i=0;i<this.options.visibleElementsLength;++i){this._getContainerElement().getLast().injectTop(this._getContainerElement())}this._scrollToLeft(visible_width)}else if(scroll==this._getElements().length*this.options.widthScrollElement-visible_width&&vector=='right'){for(i=0;i<this.options.visibleElementsLength;++i){this._getContainerElement().getFirst().injectInside(this._getContainerElement())}this._scrollToLeft(this._getElements().length*this.options.widthScrollElement-visible_width*2)}}},_checkControlsStatus:function(){var scroll=this._getContainerScrollLeft(),limits=this._getLimits();this._getControls().each(function(control){var vector=this._getVectorControl(control);if(this.checkFillData()){switch(vector){case'left':if(!this.options.circular&&scroll==0){this._hideControl(control,vector)}else{this._showControl(control,vector)}break;case'right':if(!this.options.circular&&scroll>=limits.right){this._hideControl(control,vector)}else{this._showControl(control,vector)}break}}else{this._hideControl(control,vector)}}.bind(this))},checkFillData:function(){var container_element_size=this._getContainerElement()[this._getChangePropertyName()],parent_container_element_size=this._getBlockSize();return container_element_size>parent_container_element_size},_hideControl:function(control,vector){control.addClass(this.options.cssClasses.hidden)},_showControl:function(control,vector){control.removeClass(this.options.cssClasses.hidden)},run:function(){if(this.options.widthScrollElement=='auto'){this.changeWidthScrollElement();$(window).addEvent('resize',this.changeWidthScrollElement.bind(this))}if(this.options.visibleElementsLength=='auto'){this._computeVisibleElementsLength();$(window).addEvent('resize',this._computeVisibleElementsLength.bind(this))}this._getContainerElement().setStyle(this._getChangeStylePropertyName(),this.options.widthScrollElement*this._getElements().length+'px');this._initPaginator();if(this.options.circular){this._setCircular()}this._setFx(new Fx.Scroll(this._getElementsContainerParent(),{onComplete:function(){if(this._paginator.length){this._can_change_paginator=true}}.bind(this)}));this._checkControlsStatus();this._getElementsContainerParent().addEvent('scroll',this._checkControlsStatus.bind(this));if(this._getControls()&&this._getElements()&&this._getContainerElement()){this._getControls().each(function(el){el.addEvents({'click':this._controlsClickHandler.bindWithEvent(this,el)})}.bind(this))}if(this.options.enable_change_size){this._setHeightElements()}},_computeVisibleElementsLength:function(){this.options.visibleElementsLength=Math.ceil(this._getBlockSize()/this.options.widthScrollElement);this._checkControlsStatus()},_initPaginator:function(){var page_elems=null;if(this.options.paginator_elems){page_elems=this.parentElem.getElements(this.options.paginator_elems);this._paginator=[];if(page_elems){page_elems.each(function(elem){this._paginator.push({control:elem});elem.addEvent('click',this._onPaginatorElemClick.bind(this))}.bind(this))}}},_onPaginatorElemClick:function(e){new Event(e).stop();var target=e.target||e.srcElement,previous_key,current_key,previous,current;if(!target.getParent().hasClass('active')&&this._can_change_paginator){previous=this._getActivePaginatorControl();current=this._paginator.filter(function(elem){return elem.control==target}).pop();this._paginator_active_elem_index=Object.keyOf(this._paginator,current);this._replaceActivePaginatorControl(previous,current);this._moveByIndexes(Object.keyOf(this._paginator,previous),this._paginator_active_elem_index)}},_moveByIndexes:function(from_index,to_index){var diff=Math.abs(from_index-to_index)*this.options.visibleElementsLength,vector=diff>0?'left':'right',scroll=this._getScrollByStep(vector,diff);this._can_change_paginator=false;if(diff==this.options.visibleElementsLength){this._smoothScrollToLeft(scroll)}else{this._changeElemsByOpacity(scroll,vector)}},_changeElemsByOpacity:function(scroll,vector){new Fx.Style(this._getContainerElement(),'opacity',{duration:this.options.fx_opacity_duration,onComplete:function(){this._scrollToLeft(scroll);new Fx.Style(this._getContainerElement(),'opacity',{duration:this.options.fx_opacity_duration,onComplete:function(){if(this.options.circular){this._prepareNextCircularMotion(vector)}this._checkControlsStatus();this._can_change_paginator=true}.bind(this)}).start(1)}.bind(this)}).start(0)},_changePaginatorIndexByVector:function(vector){var prev,elem_count=this._paginator.length;if(vector=='right'){this._paginator_active_elem_index++}else if(vector=='left'){this._paginator_active_elem_index--}if(this._paginator_active_elem_index==elem_count){this._paginator_active_elem_index=0}else if(this._paginator_active_elem_index<0){this._paginator_active_elem_index=elem_count-1}prev=this._getActivePaginatorControl();this._replaceActivePaginatorControl(prev,this._paginator[this._paginator_active_elem_index])},_getActivePaginatorControl:function(){return this._paginator.filter(function(elem){return elem.control.getParent().hasClass('active')}).pop()},_replaceActivePaginatorControl:function(from,to){from.control.getParent().removeClass('active');to.control.getParent().addClass('active')},_getContainerScrollLeft:function(){var block=this._getElementsContainerParent();return block?block[this._getScrollPropertyName()]:0},_setCircular:function(){var container=this._getContainerElement(),elements=this._getElements(),scroll_count=Math.ceil(elements.length/this.options.visibleElementsLength),rest=elements.length%this.options.visibleElementsLength,clones_for_start=0,clones_for_end=0,width=0,i=0;if(scroll_count==2){clones_for_start=this._getElementsForClone(true,true);clones_for_end=this._getElementsForClone(false,true);clones_for_start.each(function(clone){this._injectCloneElement(false,clone)}.bind(this));clones_for_end.each(function(clone){this._injectCloneElement(true,clone)}.bind(this));this._elems=null;width=this._getElements().length*this.options.widthScrollElement;container.setStyle('width',width+'px')}else if(scroll_count==3&&rest!=0){clone_for_start=this._getElementsForClone(true);clone_for_end=this._getElementsForClone();clone_for_start.each(this._injectCloneElement.bind(this,false));clone_for_end.each(this._injectCloneElement.bind(this,true));width=elements.length*this.options.widthScrollElement;container.setStyle('width',width+'px');this._elems=null}else if(scroll_count>=3){for(i=0;i<this.options.visibleElementsLength;++i){this._getContainerElement().getLast().injectTop(container)}}},_getElementsForClone:function(from_end,all_elements){var cloned_elements=[],elements=this._getElements(),i=0,start,count,rest;if(all_elements){if(from_end){start=elements.length-1}else{start=0}if(from_end){count=0}else{count=elements.length}}else{rest=elements.length%this.options.visibleElementsLength;if(from_end){start=elements.length-1}else{start=0}count=rest}if(from_end){for(i=start;i>=count;--i){cloned_elements.push(this._clone(elements[i]))}}else{for(i=start;i<count;++i){cloned_elements.push(this._clone(elements[i]))}}return cloned_elements},_clone:function(element){var clone=new Element('div');clone.setHTML(element.innerHTML);this.options.cloneProperties.each(function(property){clone.setProperty(property,element.getProperty(property))});return clone},_injectCloneElement:function(to_end,clone){var catalogItem=clone.getElement(this.options.catalogItemSelector);if(catalogItem){catalogItem.setProperty('id',catalogItem.getProperty(this.options.catalogItemField))}if(to_end){clone.injectInside(this._getContainerElement())}else{clone.injectTop(this._getContainerElement())}if(!window.gecko||window.ff4AndGreater){this._executeElementScripts(clone)}},_executeElementScripts:function(element){var scripts=element.getElements('script');if(scripts.length){scripts.each(function(script){eval(script.innerHTML)})}},changeWidthScrollElement:function(){var count_left=Math.ceil(this._getContainerScrollLeft()/this.options.widthScrollElement),width=this.options.widthScrollElement=this._getElementsContainerParent().offsetWidth-this.options.width_differense,children=this._getElements(),count=children.length;children.each(function(elem){elem.setStyle('width',width+'px')});this._getContainerElement().setStyle('width',count*width+'px');if(!isNaN(count_left)){this._scrollToLeft(count_left*width)}},scrollTo:function(index){var elements=this._getElements();if(elements.length>index){this.scrollToElement(elements[index])}},isVisibleElement:function(element){var result=false,element_scroll=this.getScrollElement(element),scroll_shift=this._getContainerScrollLeft();if(element_scroll['start']>=scroll_shift&&element_scroll['end']<=(scroll_shift+this._getBlockSize())){result=true}return result},getElementByIndex:function(index){return this._getElements()[index]},_getBlockSize:function(){var block=this._getElementsContainerParent();return block?block[this._getChangePropertyName()]+1:0},getScrollElement:function(element){var elements=this._getElements(),property=this._getChangePropertyName(),flag=true,result={start:0,end:elements[0][property]};elements.each(function(el){if(flag){if(el!=element){result['start']+=el[this._getChangePropertyName()]}else{result['end']=result['start']+el[this._getChangePropertyName()];flag=false}}}.bind(this));return result},scrollToElement:function(element){this._getFx().toElement(element)},_getChangeStylePropertyName:function(){return this.options.vector=='vertical'?'height':'width'},_getChangePropertyName:function(){return this.options.vector=='vertical'?'offsetHeight':'offsetWidth'},_getScrollPropertyName:function(){return this.options.vector=='vertical'?'scrollTop':'scrollLeft'}});RozetkaScroller_class.implement(new Options());var RozetkaSegments_Class=new Class({url:'',tpl:'',count:0,segments:null,slider:null,activeKey:null,tabLabel:null,scrollTab:null,slideElemId:null,unit_id:null,disallow_low_priority_records:'',flag:null,options:{parent:'scroll_container',ajaxAction:'getSegmentGoodsAJAX',slideElemId:'scroll',tabLabel:'tab_name',tabTitle:'',show_site_parameter:false,scroll_elem_width:175,goods_type:'scroll'},initialize:function(url,tpl,tabTitle,show_site_parameter,disallow_low_priority_records){this.segments=[];this.url=url;this.tpl=tpl;if(tabTitle){this.options.tabTitle=tabTitle}if(show_site_parameter){this.options.show_site_parameter=show_site_parameter}if(disallow_low_priority_records){this.disallow_low_priority_records=disallow_low_priority_records}},init:function(){this.slideElemId='scroll';if(this.unit_id){this.slideElemId+=this.unit_id}this.scrollTab='scroll_tab';if(this.unit_id){this.scrollTab+=this.unit_id}this.tabLabel=$(this.options.tabLabel);if(this.unit_id){this.tabLabel=$(this.options.tabLabel+this.unit_id)}this.slider=$(this.slideElemId);this.flag=false;if(this.tabLabel&&this.tabLabel.innerHTML==''){this.flag=true}},setUnit:function(id){this.unit_id=id},getSegmentData:function(){var url=this.url,pos=url.indexOf('index.html');if(pos!=-1){url=this.url.substring(0,pos)}else{pos=url.indexOf('.html');if(pos!=-1){url=this.url.substring(0,pos)+'/'}}url=url+'action='+this.options.ajaxAction;if(this.unit_id){url+=(';unit_id='+this.unit_id)}url+=(';disallow_low_priority_records='+this.disallow_low_priority_records+'/');new Ajax(url,{method:'get',onComplete:function(e){this.getResponse(e)}.bind(this)}).request()},getResponse:function(e){var response=new Response_class(e),parent=null,last_elem=null,last=false,is_opened=false;if($defined(response.content)){parent=$(this.options.parent);if(parent){parent.show();this.is_opened=true}last_elem=response.content.getLast();response.content.each(function(data,key){if(last_elem.title==data.title){last=true}if(this.options.tabTitle){data.title=this.options.tabTitle}data.show_site_parameter=this.options.show_site_parameter;data.scroll_elem_width=this.options.scroll_elem_width;this.segments[key]=new RozetkaSegment_Class(data,this,this.tpl,key,this.tabLabel,last,this.flag);if(this.activeKey===null){this.setActiveSegmentByKey(key)}}.bind(this))}else{if(this.tabLabel){this.tabLabel.setHTML('')}}App.fireEvent('renewImages');$(document.body).fireEvent('bindToolTipEvents');this.is_opened&&document.fireEvent('updateContent')},setActiveSegmentByKey:function(key){this.segments[key].setActive();this.activeKey=key}});RozetkaSegments_Class.implement(new Options());var RozetkaSegment_Class=new Class({a:{},segments:{},data:{},tpl:'',slideElem:null,scroller:null,tabElem:null,key:null,tabLabel:null,flag:null,initialize:function(data,segments,tpl,key,tabLabel,last,flag){this.segments=segments;this.data=data;this.tpl=tpl;this.key=key;if(tabLabel){this.tabLabel=tabLabel}this.createSlideElem(last);this.drawGoods();if($defined($(this.segments.scrollTab))){this.tabElem.addEvent('click',function(e){new Event(e).stop();this.setActive()}.bind(this))}else{this.setActive()}this.flag=flag},setActive:function(){this.segments.segments.each(function(segment){segment.setLocked()});if(this.flag&&this.tabLabel){this.tabLabel.setHTML(this.data.title)}this.slideElem.setStyle('display','block');if($defined(this.tabElem)){this.tabElem.addClass('active')}this.scroller._checkControlsStatus();this.firePluginEvent('onLoadContentCarousel')},setLocked:function(){this.slideElem.setStyle('display','none');if($defined(this.tabElem)){this.tabElem.removeClass('active')}},createSlideElem:function(last){this.slideElem=new Element('div',{styles:{display:'none'}});this.slideElem.setProperty('name','segment_'+this.key);this.slideElem.setHTML(App.getHTML(this.tpl,this.data));this.slideElem.injectInside(this.segments.slideElemId);if($defined($(this.segments.scrollTab))){this.createSlideTab(last)}this.data.goods.records.each(function(el){if(el.id){GoodsCatalog.add(el.id,this.segments.options.goods_type)}}.bind(this))},createSlideTab:function(last){var spanElem=new Element('span');this.tabElem=new Element('a',{'href':'#'});if(last){this.tabElem.addClass('last')}spanElem.setHTML(this.data.title);spanElem.injectInside(this.tabElem);this.tabElem.injectInside(this.segments.scrollTab)},drawGoods:function(){this.scroller=new RozetkaScroller_class(this.segments.slider.getElement('[name=segment_'+this.key+']'));this.scroller.setOptions({widthScrollElement:this.data.scroll_elem_width,visibleElementsLength:Math.floor(this.segments.slider.offsetWidth/this.data.scroll_elem_width),step:4});this.scroller.run()}});RozetkaSegment_Class.implement(new PluginEvents_class());var RozetkaSectionScroller_class=RozetkaScroller_class.extend({options:{countAddedItems:5,'tpl':{'template':'<div class=\"clearfix slider g-tile-fix-height\" name=\"section_scroller\" _action=\"${action}\">\n\t<a class=\"sprite-side slider-al\" data-direction=\"left\" href=\"#\" name=\"controls\">&lt;<\/a>\n\t<a class=\"sprite-side slider-ar\" data-direction=\"right\" href=\"#\" name=\"controls\">&gt;<\/a>\n\n\t<div class=\"slider-inner\">\n\t\t<div class=\"clearfix slider-sliding-box\" name=\"elems-container\" style=\"width:${width}px\">\n\n\t\t<\/div>\n\t<\/div>\n<\/div>','tpl_items':'{if data}\n\t{for item in data}\n\t\t${rozetkaEvents.setGoodsData(item.ga_goods_data)}\n\t\t${GTMEventsData.setGoodsData(item.id,item.ga_goods_data)}\n\t\t<div class=\"slider-i-td\" name=\"scroll-element\">\n\t\t\t<div class=\"slider-i ${item.sell_status}\" tool_tip=\"1\" id=\"catalog_item${item.id}\">\n\t\t\t\t<input type=\"hidden\" name=\"scroll_item_id\" value=\"${item.id}\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"slider_pos_number${item.id}\" value=\"${parseInt(item_index)+1}\" \/>\n\t\t\t\t<figure class=\"g-img\">\n\t\t\t\t\t<div class=\"g-img-inner g-img-inner-150 pos-fix\">\n\t\t\t\t\t\t{if item.tag}\n\t\t\t\t\t\t\t<span class=\"g-tag g-tag-portal\">\n\t\t\t\t\t\t\t\t<img alt=\"${item.tag.title}\" class=\"sprite g-tag-icon-small-${item.tag.name}\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" \/>\n\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t<a class=\"g-i-img-link\" onclick=\"document.fireEvent(\u0027goodsImageClick\u0027,{extend_event:[{name:\u0027goods_id\u0027,value:${item.id}}{if !item.is_section},{name:\u0027eventLocation\u0027,value:\u0027${location}\u0027}{\/if}]});\"\n\t\t\t\t\t\t   href=\"${item.href}\">\n\t\t\t\t\t\t\t<img class=\"centering-img\" src=\"${item.image.url}\" width=\"${item.image.width}\" height=\"${item.image.height}\" alt=\"${item.title}\" title=\"${item.title}\" \/>\n\t\t\t\t\t\t<\/a>\n\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/figure>\n\t\t\t\t<div class=\"clearfix\">\n\t\t\t\t\t<div class=\"g-id\" style=\"display: none;\">${item.id}<\/div>\n\t\t\t\t<\/div>\n\t\t\t\t<div class=\"clearfix\">\n\t\t\t\t\t<div class=\"g-title\">\n\t\t\t\t\t\t<a class=\"g-title-link\" onclick=\"document.fireEvent(\u0027goodsTitleClick\u0027,{extend_event:[{name:\u0027goods_id\u0027,value:${item.id}}{if !item.is_section},{name:\u0027eventLocation\u0027,value:\u0027accessories\u0027}{\/if}]});\"\n\t\t\t\t\t\t   href=\"${item.href}\"\n\t\t\t\t\t\t\t\t>${item.title}<\/a>\n\t\t\t\t\t<\/div>\n\n\t\t\t\t\t{if item.sell_status != \u0027available\u0027}\n\t\t\t\t\t\t<div class=\"g-i-status-wrap\">\n\t\t\t\t\t\t\t<div class=\"g-i-status ${item.sell_status}\">\n\t\t\t\t\t\t\t\t{if item.sell_status == \u0027limited\u0027}\n\t\t\t\t\t\t\t\t\t\u0417\u0430\u043a\u0430\u043d\u0447\u0438\u0432\u0430\u0435\u0442\u0441\u044f\n\t\t\t\t\t\t\t\t{elseif item.sell_status == \u0027out_of_stock\u0027}\n\t\t\t\t\t\t\t\t\t\u0417\u0430\u043a\u043e\u043d\u0447\u0438\u043b\u0441\u044f\n\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t{if  item.sell_status == \u0027out_of_stock\u0027}\n\t\t\t\t\t\t\t\t<div class=\"viewed-lable-out_of_stock\">\n\t\t\t\t\t\t\t\t\t<img src=\"https:\/\/i.rozetka.com.ua\/design\/sprite\/sales-small.png\" alt=\"\u041f\u0440\u043e\u0434\u0430\u043d\u043e\">\n\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t{\/if}\n\t\t\t\t\t{if item.old_price && item.old_price > item.price}\n\t\t\t\t\t<div class=\"g-price-old\">\n\t\t\t\t\t\t<div class=\"g-price-old-inner\">\n\t\t\t\t\t\t\t<div class=\"g-price-old-uah\">\n\t\t\t\t\t\t\t\t${item.old_price.toString().toPriceFormat()}<span class=\"g-price-uah-sign\">&thinsp;\u0433\u0440\u043d.<\/span>\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t<\/div>\n\t\t\t\t\t{\/if}\n\t\t\t\t\t{if item.price}\n\t\t\t\t\t\t<div class=\"g-price float-lt\">\n\t\t\t\t\t\t\t<div class=\"g-price-uah\">\n\t\t\t\t\t\t\t\t${item.price.toString().toPriceFormat()}<span class=\"g-price-uah-sign\">&thinsp;\u0433\u0440\u043d.<\/span>\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t{if item.sell_status != \u0027out_of_stock\u0027}\n\t\t\t\t\t\t\t<div class=\"g-buy\" name=\"{if item.is_section}buy_portal_carousel{else}buy_details_${location}{\/if}\" id=\"${item.id}\"><\/div>\n\t\t\t\t\t\t{\/if}\n\t\t\t\t\t{\/if}\n\t\t\t\t<\/div>\n\n\t\t\t\t<div class=\"g-rating\">\n\t\t\t\t{if item.count_comments > 0}\n\t\t\t\t\t<a class=\"novisited g-rating-reviews-link\" href=\"${item.href}comments\/\">\n\t\t\t\t\t\t{if item.users_rating > 0}\n\t\t\t\t\t\t\t<span class=\"sprite g-rating-stars\">\n\t\t\t\t\t\t\t\t<span class=\"sprite g-rating-stars-i\" style=\"width:${item.users_rating*20}%\"><\/span>\n\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t\t<span class=\"g-rating-reviews\">\n\t\t\t\t\t\t\t\t${item.count_comments} \u043e\u0442\u0437\u044b\u0432${item.count_comments|morphology:[\"\", \"\u0430\", \"\u043e\u0432\"]}\n\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t<span class=\"g-rating-reviews\">\n\t\t\t\t\t\t\t\t<span class=\"g-rating-none sprite-side\">${item.count_comments} \u043e\u0442\u0437\u044b\u0432${item.count_comments|morphology:[\"\", \"\u0430\", \"\u043e\u0432\"]}<\/span>\n\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t{\/if}\n\t\t\t\t\t<\/a>\n\t\t\t\t{\/if}\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t<\/div>\n\t{\/for}\n{\/if}'},cssClasses:{active:"active",hidden:"hidden"},goods_type:'scroll'},_location:'',_action:'',controlElem:null,_data:null,_first_position:null,_second_position:null,_scrollers_obj:null,initialize:function(parentElem,scrollers_obj){this._scrollers_obj=scrollers_obj;this.controlElem=parentElem;this._action=scrollers_obj.section_scroll_action;this._location=scrollers_obj.location},setData:function(data){this.data=data;this._first_position=0;this._second_position=this.data.count<this.options.countAddedItems?this.data.count:this.options.countAddedItems},updateData:function(data){this.data=data;this._second_position=this.data.count<this._second_position+this.options.countAddedItems?this.data.count:this._second_position+this.options.countAddedItems;this._getContainerElement().setStyle('width',(this.data.total_count*this.options.widthScrollElement)+'px')},_getElements:function(){this._elems=this.parentElem.getElements(this.options.elems);return this._elems},_controlsClickHandler:function(event){var event=new Event(event).stop();var vector=this._getVectorControl(event.target);if(vector!=undefined){if(vector=='right'&&this._second_position>(this.data.count-this._first_position)){this._scrollers_obj.tryUploadData()}this._updateScrollerItems();if(!this._isPossibleScrollByVector(vector)){this._scrollers_obj.processStart();this._scrollers_obj.addEvent('finishUploadData',function(e){this._onFinishUploadData(vector)}.bind(this))}else{this._tryScrollingByVector(vector)}}},_onFinishUploadData:function(vector){this._updateScrollerItems();this._tryScrollingByVector(vector)},_hideControl:function(control,vector){if(vector!='right'||!this._scrollers_obj.isUploadInProgress()||this.options.circular){this.parent(control,vector)}},_isPossibleScrollByVector:function(vector){var result=false,count_elems_by_left;if(vector=='right'&&this._scrollers_obj.isUploadInProgress()){count_elems_by_left=Math.ceil(this._getContainerScrollLeft()/this.options.widthScrollElement);if((this.data.count-count_elems_by_left-2*this.options.visibleElementsLength)>0){result=true}}else{result=this.parent(vector)}return result},getSectionScrollerTemplateRootElement:function(){return this.controlElem.getElementsBySelector('[name=section_scroller]')[0]},run:function(){var data=this._getItemsByPosition();this.controlElem.setHTML(App.getHTML(this.options.tpl.template,{width:this.data.total_count*this.options.widthScrollElement,location:this._location,action:this._action}));this.parentElem=this.getSectionScrollerTemplateRootElement();this._injectElems(data);if(this.options.visibleElementsLength=='auto'){window.addEvent('resize',function(){this._loadNextElements();this._loadDataFromScrollers()}.bind(this))}RozetkaScroller_class.prototype.run.call(this);this._getContainerElement().setStyle('width',this.data.total_count*this.options.widthScrollElement);this._getElementsContainerParent().addEvent('scroll',this._loadNextElements.bind(this));this._setActiveForBuyButton();$(document.body).fireEvent('bindToolTipEvents');this._getElementsContainerParent().addEvent('scroll',this._loadDataFromScrollers.bind(this))},_loadNextElements:function(){var last_visible_element_x_axis=this._getContainerScrollLeft()+this.options.visibleElementsLength*this.options.widthScrollElement;if(last_visible_element_x_axis>=this._first_position*this.options.widthScrollElement-this.options.widthScrollElement){this._second_position=Math.ceil(last_visible_element_x_axis/this.options.widthScrollElement)+this.options.countAddedItems;this._second_position=this._second_position>this.data.count?this.data.count:this._second_position;this._updateScrollerItems();this._loadDataFromScrollers()}this._checkControlsStatus()},_loadDataFromScrollers:function(){if(this._getContainerScrollLeft()>=(this.data.count-this.options.visibleElementsLength*2)*this.options.widthScrollElement&&this._scrollers_obj.isUploadAvailable()){this._scrollers_obj.processStart();this._scrollers_obj.addEvent('finishUploadData',this._loadNextElements.bind(this));this._scrollers_obj.tryUploadData()}},_checkControlsStatus:function(){var scroll=this._getContainerScrollLeft(),limits=this._getLimits();this._getControls().each(function(control){switch(this._getVectorControl(control)){case'left':if(!this.options.circular&&scroll==0){this._hideControl(control,'left')}else{this._showControl(control,'left')}break;case'right':if(!this.options.circular&&this._first_position>=this.data.count&&scroll>=limits.right){this._hideControl(control,'right')}else{this._showControl(control,'right')}break}}.bind(this))},_injectElems:function(data){if(!data){data=this._getItemsByPosition()}var content=App.getHTML(this.options.tpl.tpl_items,{data:data,location:this._location,action:this._action});new Element('span').setHTML(content).getChildren().inject(this._getContainerElement())},_getItemsByPosition:function(){var goods={};for(this._first_position;this._first_position<this._second_position;this._first_position++){goods[this._first_position]=this.data.goods[this._first_position];goods[this._first_position]['index']=this._first_position}this._second_position=this.data.count<this._second_position+this.options.countAddedItems?this.data.count:this._second_position+this.options.countAddedItems;return goods},_setActiveForBuyButton:function(){this._getContainerElement().getElements('[name=scroll_item_id]').each(function(elem){GoodsCatalog.add(elem.getValue(),this.options.goods_type);elem.remove()}.bind(this))},_updateScrollerItems:function(){var content=App.getHTML(this.options.tpl.tpl_items,{data:this._getItemsByPosition(),location:this._location,action:this._action});this._injectElems();var contents=this._getContainerElement();new Element('span').setHTML(content).getChildren().inject(contents);this._setActiveForBuyButton();this.firePluginEvent('onLoadContentCarousel');$(document.body).fireEvent('bindToolTipEvents')},_checkMinimumLoaded:function(){if(this.data.total_count>=this.data.count&&this.data.count<this.options.countAddedItems){this._loadDataFromScrollers()}}});RozetkaSectionScroller_class.implement(new Events(),new Options(),new PluginEvents_class());var RozetkaCollectionScrollers_class=new Class({options:{menu_item_selector:'[name=menu_item]',control_scrollers:'[name=scrollers]',elemsContainer:'[name=elems-container]',count_start_items:8,limit:100,enable_preload:true,tabAll:{'isView':true,name:''},'tpl':{'template':'<nav>\n\t<ul class=\"clearfix m-tabs\" name=\"tips\">\n\t\t{if count > 1}\n\t\t\t{if sections}\n\t\t\t\t{for section in sections}\n\t\t\t\t\t{eval}count--{\/eval}\n\t\t\t\t\t<li class=\"m-tabs-i\">\n\t\t\t\t\t\t<a href=\"#\" id=\"${section.name}\" name=\"menu_item\" class=\"novisited m-tabs-link\">${section.title}<\/a>\n\t\t\t\t\t<\/li>\n\t\t\t\t{\/for}\n\t\t\t{\/if}\n\t\t{\/if}\n\t\t{if tab_all.isView}\n\t\t\t{if !tab_all.href}\n\t\t\t\t<li class=\"m-tabs-i\">\n\t\t\t\t\t<a href=\"#\" id=\"all\" name=\"menu_item\" class=\"novisited m-tabs-link active\">${tab_all.name}<\/a>\n\t\t\t\t<\/li>\n\t\t\t\t{else}\n\t\t\t\t<li class=\"m-tabs-i m-tabs-i-more\">\n\t\t\t\t\t<a href=\"${tab_all.href}\" class=\"arrow-link detail-accessories-more-link novisited\"\n\t\t\t\t\t\t{if tab_all.data_tab}\n\t\t\t\t\t\t\tname=\"tabs_switcher\"\n\t\t\t\t\t\t\tdata-tab=\"${tab_all.data_tab}\"\n\t\t\t\t\t\t{\/if}\n\t\t\t\t\t   onclick=\"document.fireEvent(\u0027clickAllBlock\u0027,{extend_event:[{name:\u0027eventLocation\u0027,value:\u0027accessories\u0027}]});\">\n\t\t\t\t\t\t<span class=\"arrow-link-inner\">${tab_all.name}<\/span>&nbsp;&rarr;\n\t\t\t\t\t<\/a>\n\t\t\t\t<\/li>\n\t\t\t{\/if}\n\t\t{\/if}\n\t<\/ul>\n<\/nav>\n<div name=\"scrollers\"><\/div>\n',process_tpl:'<img src=\"https:\/\/i1.rozetka.com.ua\/design\/check-ajax.gif\" width=\"64\" height=\"64\" alt=\"\u041e\u0442\u043f\u0440\u0430\u0432\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445\" class=\"process\"\/>'},cssClasses:{active:"active",hidden:"hidden"},section_field:'section'},scroller_options:null,section_scroll_action:'',location:'',_upload_data_status:null,_status_values:{NOT_STARTED:0,REQUEST_IN_PROGRESS:1,REQUEST_COMPLETED:2,COMPLETED:3,WILL_NOT_DO:4},controlElem:null,control_scrollers:null,_tabs:{},_data:null,_data_for_sections:null,_menu_items:{},_current_tab:'',_url:null,_unit_id:null,load_start:null,initialize:function(data,elem,url,relation_name,count_start_items,enable_preload){this._tabs={};this._menu_items={};this.setOptions({});this._data=data;this._url=url;this.relation_name=relation_name;this.controlElem=elem;if(count_start_items){this.options.count_start_items=count_start_items}if(typeof enable_preload!=="undefined"){this.options.enable_preload=enable_preload}this.load_start=this.options.count_start_items;if(!this.options.enable_preload||this._data.count<this.options.count_start_items){this._upload_data_status=this._status_values.WILL_NOT_DO}else{this._upload_data_status=this._status_values.NOT_STARTED}},run:function(){this._setContent();this._activeSwitcher();this.control_scrollers=this.controlElem.getElementsBySelector(this.options.control_scrollers)[0];if(this.control_scrollers){if(this._data['field']){this.options.section_field=this._data['field']}var data=this.getChangedData();this._createScrollerBySection(this.control_scrollers,'all',data);this._current_tab='all'}},getChangedData:function(){var result=Object.clone(this._data);if(result['sections']&&!result['total_count']){result['total_count']=0;Object.values(result['sections']).each(function(section){result['total_count']+=(section['count']||0)})}return result},setUnit:function(id){this._unit_id=id},processStart:function(){this.control_scrollers.processStart(this.options.tpl.process_tpl)},isUploadAvailable:function(){var result=false;if(this._upload_data_status===this._status_values.NOT_STARTED){result=true}return result},isUploadInProgress:function(){var result=false;if(this._upload_data_status===this._status_values.REQUEST_IN_PROGRESS||this._upload_data_status===this._status_values.REQUEST_COMPLETED){result=true}return result},isFullData:function(){var result=false;if(this._upload_data_status===this._status_values.COMPLETED||this._upload_data_status===this._status_values.WILL_NOT_DO){result=true}return result},tryUploadData:function(){if(this.isUploadAvailable()){this.processStart();this._upload_data_status=this._status_values.REQUEST_IN_PROGRESS;var action=this._url+'action=getRelationsRecordsJSON';action=this._unit_id?action+';unit_id='+this._unit_id:action;action=action+';start='+this.load_start+';limit='+this.options.limit;action=action+';relation_name='+this.relation_name+'/';var ajax=new Ajax(action,{method:'get',headers:{ajaxAction:action}}).request();ajax.addEvent('onComplete',function(e){this._onUploadData(e)}.bind(this))}},_onUploadData:function(e){this._upload_data_status=this._status_values.REQUEST_COMPLETED;var response=new Response_class(e);if(response.content.count){this.load_start+=response.content.count}this._mergeResponceData(response.content);this._groupGoodsBySections();for(var section_name in this._tabs){if(section_name=='all'){this._tabs[section_name].updateData(this._data)}else{this._tabs[section_name].updateData(this._data_for_sections[section_name])}}if(!response.content.count||response.content.count<this.options.limit){this._upload_data_status=this._status_values.COMPLETED}else{this._upload_data_status=this._status_values.NOT_STARTED}this.control_scrollers.processStop();this.fireEvent('finishUploadData')},_mergeResponceData:function(data){this._data.count+=data.count;if(data.goods){this._data.goods=this._data.goods.concat(data.goods)}},_setContent:function(){this.controlElem.setHTML(App.getHTML(this.options.tpl.template,{sections:this._data.sections,count:this._data.count_sections,tab_all:this.options.tabAll}))},_createScrollerBySection:function(elem,section_name,data){this._tabs[section_name]=new RozetkaSectionScroller_class(elem,this);if(this.scroller_options){this._tabs[section_name].setOptions(this.scroller_options)}this._tabs[section_name].setData(data);this._tabs[section_name].run()},_groupGoodsBySections:function(){var sections={};Object.keys(this._data.sections).each(function(key){var goods4sections=[];Object.values(this._data.goods).each(function(goods){if(goods[this.options.section_field]==key||(Array.isArray(goods[this.options.section_field])&&goods[this.options.section_field].contains(key))){goods4sections.push(goods)}}.bind(this));sections[key]={goods:goods4sections,count:goods4sections.length,total_count:this._data.sections[key]['count']||0}}.bind(this));Object.values(sections).each(function(section){if(!section['total_count']){section['total_count']=section['count']}});this._data_for_sections=sections},_activeSwitcher:function(){this.controlElem.getElements(this.options.menu_item_selector).each(function(elem){var id=elem.getProperty('id');this._menu_items[id]={elem:elem}}.bind(this));for(id in this._menu_items){var item=this._menu_items[id];item.elem.removeEvents('click');item.elem.addEvent('click',this._onSectionClick.bindWithEvent(this,item))}},_onSectionClick:function(e,menu_item){new Event(e).stop();if(!this._data_for_sections){this._groupGoodsBySections()}var id=menu_item.elem.getProperty('id');if(id!=this._current_tab){this._switchContentBySection(id);this._setActiveItem(id)}},_switchContentBySection:function(id){if(this.control_scrollers){this.control_scrollers.getFirst().remove();if(!this._tabs[id]){this._createScrollerBySection(this.control_scrollers,id,this._data_for_sections[id])}else{this.control_scrollers.adopt(this._tabs[id].parentElem)}if(!this.isFullData()){this.processStart();this.tryUploadData()}else{this.firePluginEvent('tabAccessoriesContentDownload');this._tabs[id]._checkControlsStatus()}document.fireEvent('clickCategoryAccessories',{extend_event:[{name:'eventContext',value:id}]});this.addEventOnce('finishUploadData',function(e){this.control_scrollers.processStop();this._tabs[id]._updateScrollerItems();this._tabs[id]._checkControlsStatus();this._tabs[id]._checkMinimumLoaded();this.firePluginEvent('tabAccessoriesContentDownload')}.bind(this))}},_setActiveItem:function(active_id){for(id in this._menu_items){var item=this._menu_items[id];if(active_id==id){item.elem.addClass('active')}else{item.elem.removeClass('active')}}this._current_tab=active_id}});RozetkaCollectionScrollers_class.implement(new Options(),new Events(),new PluginEvents_class());var RozetkaLoadableScroll_class=RozetkaScroller_class.extend({options:{action:'getAccessoriesRecordsJSON',base_href:null,additional_params:{},section_name:null,countAddedItems:5,'tpl':{'template':'<div class=\"clearfix slider g-tile-fix-height\" name=\"section_scroller\" _action=\"${action}\">\n\t<a class=\"sprite-side slider-al\" data-direction=\"left\" href=\"#\" name=\"controls\">&lt;<\/a>\n\t<a class=\"sprite-side slider-ar\" data-direction=\"right\" href=\"#\" name=\"controls\">&gt;<\/a>\n\n\t<div class=\"slider-inner\">\n\t\t<div class=\"clearfix slider-sliding-box\" name=\"elems-container\" style=\"width:${width}px\">\n\n\t\t<\/div>\n\t<\/div>\n<\/div>','tpl_items':'{if data}\n\t{for item in data}\n\t\t${rozetkaEvents.setGoodsData(item.ga_goods_data)}\n\t\t${GTMEventsData.setGoodsData(item.id,item.ga_goods_data)}\n\t\t<div class=\"slider-i-td\" name=\"scroll-element\">\n\t\t\t<div class=\"slider-i ${item.sell_status}\" tool_tip=\"1\" id=\"catalog_item${item.id}\">\n\t\t\t\t<input type=\"hidden\" name=\"scroll_item_id\" value=\"${item.id}\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"slider_pos_number${item.id}\" value=\"${parseInt(item_index)+1}\" \/>\n\t\t\t\t<figure class=\"g-img\">\n\t\t\t\t\t<div class=\"g-img-inner g-img-inner-150 pos-fix\">\n\t\t\t\t\t\t{if item.tag}\n\t\t\t\t\t\t\t<span class=\"g-tag g-tag-portal\">\n\t\t\t\t\t\t\t\t<img alt=\"${item.tag.title}\" class=\"sprite g-tag-icon-small-${item.tag.name}\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" \/>\n\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t<a class=\"g-i-img-link\" onclick=\"document.fireEvent(\u0027goodsImageClick\u0027,{extend_event:[{name:\u0027goods_id\u0027,value:${item.id}}{if !item.is_section},{name:\u0027eventLocation\u0027,value:\u0027${location}\u0027}{\/if}]});\"\n\t\t\t\t\t\t   href=\"${item.href}\">\n\t\t\t\t\t\t\t<img class=\"centering-img\" src=\"${item.image.url}\" width=\"${item.image.width}\" height=\"${item.image.height}\" alt=\"${item.title}\" title=\"${item.title}\" \/>\n\t\t\t\t\t\t<\/a>\n\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/figure>\n\t\t\t\t<div class=\"clearfix\">\n\t\t\t\t\t<div class=\"g-id\" style=\"display: none;\">${item.id}<\/div>\n\t\t\t\t<\/div>\n\t\t\t\t<div class=\"clearfix\">\n\t\t\t\t\t<div class=\"g-title\">\n\t\t\t\t\t\t<a class=\"g-title-link\" onclick=\"document.fireEvent(\u0027goodsTitleClick\u0027,{extend_event:[{name:\u0027goods_id\u0027,value:${item.id}}{if !item.is_section},{name:\u0027eventLocation\u0027,value:\u0027accessories\u0027}{\/if}]});\"\n\t\t\t\t\t\t   href=\"${item.href}\"\n\t\t\t\t\t\t\t\t>${item.title}<\/a>\n\t\t\t\t\t<\/div>\n\n\t\t\t\t\t{if item.sell_status != \u0027available\u0027}\n\t\t\t\t\t\t<div class=\"g-i-status-wrap\">\n\t\t\t\t\t\t\t<div class=\"g-i-status ${item.sell_status}\">\n\t\t\t\t\t\t\t\t{if item.sell_status == \u0027limited\u0027}\n\t\t\t\t\t\t\t\t\t\u0417\u0430\u043a\u0430\u043d\u0447\u0438\u0432\u0430\u0435\u0442\u0441\u044f\n\t\t\t\t\t\t\t\t{elseif item.sell_status == \u0027out_of_stock\u0027}\n\t\t\t\t\t\t\t\t\t\u0417\u0430\u043a\u043e\u043d\u0447\u0438\u043b\u0441\u044f\n\t\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t{if  item.sell_status == \u0027out_of_stock\u0027}\n\t\t\t\t\t\t\t\t<div class=\"viewed-lable-out_of_stock\">\n\t\t\t\t\t\t\t\t\t<img src=\"https:\/\/i.rozetka.com.ua\/design\/sprite\/sales-small.png\" alt=\"\u041f\u0440\u043e\u0434\u0430\u043d\u043e\">\n\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t{\/if}\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t{\/if}\n\t\t\t\t\t{if item.old_price && item.old_price > item.price}\n\t\t\t\t\t<div class=\"g-price-old\">\n\t\t\t\t\t\t<div class=\"g-price-old-inner\">\n\t\t\t\t\t\t\t<div class=\"g-price-old-uah\">\n\t\t\t\t\t\t\t\t${item.old_price.toString().toPriceFormat()}<span class=\"g-price-uah-sign\">&thinsp;\u0433\u0440\u043d.<\/span>\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t<\/div>\n\t\t\t\t\t{\/if}\n\t\t\t\t\t{if item.price}\n\t\t\t\t\t\t<div class=\"g-price float-lt\">\n\t\t\t\t\t\t\t<div class=\"g-price-uah\">\n\t\t\t\t\t\t\t\t${item.price.toString().toPriceFormat()}<span class=\"g-price-uah-sign\">&thinsp;\u0433\u0440\u043d.<\/span>\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t{if item.sell_status != \u0027out_of_stock\u0027}\n\t\t\t\t\t\t\t<div class=\"g-buy\" name=\"{if item.is_section}buy_portal_carousel{else}buy_details_${location}{\/if}\" id=\"${item.id}\"><\/div>\n\t\t\t\t\t\t{\/if}\n\t\t\t\t\t{\/if}\n\t\t\t\t<\/div>\n\n\t\t\t\t<div class=\"g-rating\">\n\t\t\t\t{if item.count_comments > 0}\n\t\t\t\t\t<a class=\"novisited g-rating-reviews-link\" href=\"${item.href}comments\/\">\n\t\t\t\t\t\t{if item.users_rating > 0}\n\t\t\t\t\t\t\t<span class=\"sprite g-rating-stars\">\n\t\t\t\t\t\t\t\t<span class=\"sprite g-rating-stars-i\" style=\"width:${item.users_rating*20}%\"><\/span>\n\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t\t<span class=\"g-rating-reviews\">\n\t\t\t\t\t\t\t\t${item.count_comments} \u043e\u0442\u0437\u044b\u0432${item.count_comments|morphology:[\"\", \"\u0430\", \"\u043e\u0432\"]}\n\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t<span class=\"g-rating-reviews\">\n\t\t\t\t\t\t\t\t<span class=\"g-rating-none sprite-side\">${item.count_comments} \u043e\u0442\u0437\u044b\u0432${item.count_comments|morphology:[\"\", \"\u0430\", \"\u043e\u0432\"]}<\/span>\n\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t{\/if}\n\t\t\t\t\t<\/a>\n\t\t\t\t{\/if}\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t<\/div>\n\t{\/for}\n{\/if}','process_tpl':'<img src=\"https:\/\/i1.rozetka.com.ua\/ajax.gif\" width=\"64\" height=\"64\" alt=\"\u041e\u0442\u043f\u0440\u0430\u0432\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445\" class=\"process\"\/>'},cssClasses:{active:"active",hidden:"hidden"},analytics:{location:'',action:''},goods_type:'scroll'},controlElem:null,_first_position:null,_second_position:null,_total_chunks:null,_current_chunk_index:null,_items_per_chunk:null,_total_items_in_section:null,_data:{goods:[]},UploadDataStatuses:{NOT_STARTED:0,REQUEST_IN_PROGRESS:1,CHUNK_REQUEST_COMPLETED:2,COMPLETED:3},_upload_data_status:null,_processStart:function(){this.parentElem.processStart(this.options.tpl.process_tpl)},_processStop:function(){this.parentElem.processStop()},tryUploadData:function(to_chunk){var params;if(this.isUploadAvailable()){this._upload_data_status=this.UploadDataStatuses.REQUEST_IN_PROGRESS;params={action:this.options.action,cat:this.options.section_name,offset:this._data.goods.length,length:(to_chunk-this._current_chunk_index)*this._items_per_chunk};if(this.options.additional_params){params=Object.merge(params,this.options.additional_params)}if(params.offset+params.length>this._total_items_in_section){params.length=this._total_items_in_section-params.offset}this._getDataFromServer(App.buildUrl(this.options.base_href,params),to_chunk,{method:'get',onComplete:function(text){this._processStop();this.updateData(JSON.parse(text));this._checkControlsStatus();this.fireEvent('finishUploadData');this._checkControlsStatus()}.bind(this)})}},_getDataFromServer:function(url,to_chunk,options){this._current_query_options=options;this._current_query_url=url;this._current_to_chunk=to_chunk;if(this._previous_to_chunk==undefined){this._previous_to_chunk=1}if(!this._load_chunk_interval){this._load_chunk_interval=setInterval(function(){if(this._current_query_options&&this._current_query_url!=this._previous_query_url&&this._current_to_chunk>this._previous_to_chunk){if(this._previous_ajax_instance&&this._previous_ajax_instance.running){this._previous_ajax_instance.cancel()}this._previous_ajax_instance=new Ajax(this._current_query_url,this._current_query_options);this._previous_ajax_instance.request();this._previous_query_url=this._current_query_url;this._previous_to_chunk=this._current_to_chunk;this._current_query_options=null}else{clearInterval(this._load_chunk_interval);this._load_chunk_interval=null}}.bind(this),1000)}},isUploadAvailable:function(){return this._upload_data_status!=this.UploadDataStatuses.COMPLETED},isUploadInProgress:function(){return this._upload_data_status==this.UploadDataStatuses.REQUEST_IN_PROGRESS},initialize:function(parentElem){this.controlElem=parentElem;this._upload_data_status=this.UploadDataStatuses.NOT_STARTED},setData:function(data){this._data=data;this._first_position=0;this._second_position=this._data.goods.length<this.options.countAddedItems?this._data.goods.length:this.options.countAddedItems;this._items_per_chunk=this._data.goods.length;this._current_chunk_index=1;this._total_items_in_section=this._data.total_count||this._items_per_chunk;this._upload_data_status=this._total_items_in_section==this._items_per_chunk?this.UploadDataStatuses.COMPLETED:this.UploadDataStatuses.NOT_STARTED;this._total_chunks=Math.ceil(this._total_items_in_section/this._items_per_chunk)||1},updateData:function(data){if(data.goods&&data.goods.length){this._data.goods=this._data.goods.concat(data.goods)}this._current_chunk_index=Math.ceil(this._data.goods.length/this._items_per_chunk);if(this._current_chunk_index>=this._total_chunks){this._upload_data_status=this.UploadDataStatuses.COMPLETED}else{this._upload_data_status=this.UploadDataStatuses.CHUNK_REQUEST_COMPLETED}this._second_position=this._data.goods.length<this._second_position+this.options.countAddedItems?this._data.goods.length:this._second_position+this.options.countAddedItems;if(this._total_items_in_section==null){this._getContainerElement().setStyle('width',this._data.goods.length*this.options.widthScrollElement+'px')}},_getElements:function(){this._elems=this.parentElem.getElements(this.options.elems);return this._elems},_controlsClickHandler:function(event){var event=new Event(event).stop();var vector=this._getVectorControl(event.target);if(vector!=undefined){this._updateScrollerItems();if(this._isPossibleScrollByVector(vector)){this._tryScrollingByVector(vector)}}},_onFinishUploadData:function(vector){this._updateScrollerItems();this._tryScrollingByVector(vector)},_hideControl:function(control,vector){if(vector!='right'||!this.isUploadInProgress()||this.options.circular){this.parent(control,vector)}},getSectionScrollerTemplateRootElement:function(){return this.controlElem.getElementsBySelector('[name=section_scroller]')[0]},run:function(){var data=this._getItemsByPosition(),container_element_width;this.controlElem.setHTML(App.getHTML(this.options.tpl.template,{width:this._data.goods.length*this.options.widthScrollElement,location:this.options.analytics.location,action:this.options.analytics.action}));this.parentElem=this.getSectionScrollerTemplateRootElement();this._injectElems(data);if(this.options.visibleElementsLength=='auto'){window.addEvent('resize',function(){this._loadNextElements();this._loadDataFromServer()}.bind(this))}RozetkaScroller_class.prototype.run.call(this);this._getContainerElement().setStyle('width',this._total_items_in_section*this.options.widthScrollElement+'px');this._getElementsContainerParent().addEvent('scroll',this._loadNextElements.bind(this));this._setActiveForBuyButton();$(document.body).fireEvent('bindToolTipEvents');this._getElementsContainerParent().addEvent('scroll',this._loadDataFromServer.bind(this))},_loadNextElements:function(){var last_visible_element_x_axis=this._getContainerScrollLeft()+this.options.visibleElementsLength*this.options.widthScrollElement;if(last_visible_element_x_axis>=this._first_position*this.options.widthScrollElement-this.options.widthScrollElement){this._second_position=Math.ceil(last_visible_element_x_axis/this.options.widthScrollElement)+this.options.countAddedItems;this._second_position=this._second_position>this._data.goods.length?this._data.goods.length:this._second_position;this._updateScrollerItems()}},_getNextChunkIndexToLoad:function(){var chunk_width=this._items_per_chunk*this.options.widthScrollElement,visible_elements_width=this._getElementsContainerParent().offsetWidth,current_chunk=Math.ceil((this._getContainerScrollLeft()+visible_elements_width)/chunk_width);return current_chunk<this._total_chunks?current_chunk+1:this._total_chunks},_loadDataFromServer:function(){if(this._getContainerScrollLeft()>=(this._data.goods.length-this.options.visibleElementsLength*2)*this.options.widthScrollElement&&this.isUploadAvailable()&&this._getNextChunkIndexToLoad()>this._current_chunk_index){this._processStart();this.addEvent('finishUploadData',this._loadNextElements.bind(this));this.tryUploadData(this._getNextChunkIndexToLoad())}else{this._processStop()}},_checkControlsStatus:function(){var scroll=this._getContainerScrollLeft();var limits=this._getLimits();this._getControls().each(function(control){switch(this._getVectorControl(control)){case'left':if(!this.options.circular&&scroll==0){this._hideControl(control,'left')}else{this._showControl(control,'left')}break;case'right':if(!this.options.circular&&this._first_position>=this._data.goods.length&&scroll>=limits.right){this._hideControl(control,'right')}else{this._showControl(control,'right')}break}}.bind(this))},_injectElems:function(data){if(!data){data=this._getItemsByPosition()}var content=App.getHTML(this.options.tpl.tpl_items,{data:data,location:this.options.analytics.location,action:this.options.analytics.action});new Element('span').setHTML(content).getChildren().inject(this._getContainerElement())},_getItemsByPosition:function(){var goods={};for(this._first_position;this._first_position<this._second_position;this._first_position++){goods[this._first_position]=this._data.goods[this._first_position];goods[this._first_position]['index']=this._first_position}this._second_position=this._data.goods.length<this._second_position+this.options.countAddedItems?this._data.goods.length:this._second_position+this.options.countAddedItems;return goods},_setActiveForBuyButton:function(){this._getContainerElement().getElements('[name=scroll_item_id]').each(function(elem){GoodsCatalog.add(elem.getValue(),this.options.goods_type);elem.remove()}.bind(this))},_updateScrollerItems:function(){this._injectElems();this._setActiveForBuyButton();this.firePluginEvent('onLoadContentCarousel');$(document.body).fireEvent('bindToolTipEvents')}});RozetkaLoadableScroll_class.implement(new Events(),new Options(),new PluginEvents_class());var RozetkaElementsScroller_class=RozetkaScroller_class.extend({Class:'RozetkaElementsScroller_class',options:{is_optimized:false,paginator:{selectors:{container:'[name=pages]'}},spacing:0,inject_controls:true,_refresh_timeout_time:100},_refresh_timeout_point:null,_wrapper_size:0,_page_container:null,initialize:function(parentElem){this.parent(parentElem);this.attachToObserver(['ChangeBlockOffer'])},onChangeBlockOffer:function(){this.refresh()},_getFx:function(){if(!this._fx){this._fx=new Fx.Scroll(this._getElementsContainerParent())}return this._fx},run:function(){var wrapper=this._getElementsContainerParent();wrapper.addEvent('scroll',this._checkControlsStatus.bind(this));window.addEvent('resize',this.refresh.bind(this));this._setContainerElementsSize();this._checkControlsStatus();if(this._getControls()&&this._getElements()&&this._getContainerElement()){this._getControls().each(function(el){el.addEvent('click',this._controlsClickHandler.bind(this))}.bind(this))}this._initPaginator();this._wrapper_size=wrapper[this._getChangePropertyName()];this.options.is_optimized&&this.optimizeElements();return this},refresh:function(){if(this._refresh_timeout_point){clearTimeout(this._refresh_timeout_point)}this._refresh_timeout_point=setTimeout(function(){this._setContainerElementsSize();this._scroller&&this._scroller.update();this._checkControlsStatus();this._scrollToLeft(this.getFirstVisibleElement());this.options.is_optimized&&this.optimizeElements()}.bind(this),this.options._refresh_timeout_time)},optimizeElements:function(){var elements=this._getElements(),property=this._getChangeStylePropertyName(),max=0;property=(property=='width')?'height':'width';elements.each(function(element){element.style.removeProperty(property);max=Math.max(max,parseInt(element.getStyle(property)))});elements.each(function(element){element.setStyle(property,max)})},_initPaginator:function(){var container=this.parentElem.getElement(this.options.paginator.selectors.container);if(this.checkFillData()&&container){this._paginator=new RozetkaPaginatorForScroller_class(container,this).setOptions(this.options.paginator).init()}},_setContainerElementsSize:function(){var property=this._getChangePropertyName(),style=this._getChangeStylePropertyName(),size=this._getElementsContainerParent()[property],elements=this._getElements(),width=0;if(this.options.circular&&this._wrapper_size!=size){elements.each(function(elem){elem.setStyle(style,size)})}elements.each(function(elem){width+=elem[property]});this._getContainerElement().setStyle(style,width);this._wrapper_size=size},_checkControlsStatus:function(){var scroll=this._getContainerScrollLeft(),limits=this._getLimits();this._getControls().each(function(control){switch(this._getVectorControl(control)){case'left':if((scroll!=0||this.options.circular)&&this.checkFillData()){this._showControl(control,'left')}else{this._hideControl(control,'left')}break;case'right':if((scroll<(limits.right)||this.options.circular)&&this.checkFillData()){this._showControl(control,'right')}else{this._hideControl(control,'right')}break}}.bind(this))},_getBlockSize:function(){var block=this._getElementsContainerParent();return block?block[this._getChangePropertyName()]+1:0},_isPossibleScrollByVector:function(vector){var result=false,scroll=this._getContainerScrollLeft();switch(vector){case'left':result=(scroll>0)||this.options.circular;break;case'right':result=(scroll<this._getLimits().right)||this.options.circular;break}return result},_tryScrollingByVector:function(vector){var shift=this.getShiftByVector(vector),scroll=this._getContainerScrollLeft();if(this.options.circular&&((scroll==0&&!shift&&vector=='left')||(scroll>=this._getLimits().right&&vector!='left'))){shift=this._getCircularShiftByVector(vector)}else{this._smoothScrollToLeft(shift)}this._prepareGTMEventData(this.parentElem.getProperty('_action'),scroll)},_getCircularShiftByVector:function(vector){var elements=this._getElements(),element=null;if(vector=='left'){element=elements[elements.length-1]}else{element=elements[0]}this.scrollToElement(element)},getShiftByVector:function(vector){return vector=='left'?this.getShiftLeft():this.getShiftElement(this.getScrollElementRight())},getShiftElement:function(element){var flag=true,result=0;this._getElements().each(function(elem){if(flag){if(elem!=element){result+=elem[this._getChangePropertyName()];result+=this.options.spacing}else{flag=false}}}.bind(this));return result},getShiftLeft:function(){var elements=this._getElements(),decrement=false,element=this.getFirstVisibleElement(),index=elements.indexOf(element),result=0;if(!this.options.inject_controls||decrement){index--}element=elements[index];if(index>0){elements.slice(0,index+1).each(function(elem){result+=elem[this._getChangePropertyName()]}.bind(this))}result-=this._getBlockSize();return result>0?result:0},getScrollElementRight:function(){var elements=this._getElements(),elements_length=elements.length,increment=false,result=this.getLastVisibleElement(),index=elements.indexOf(result);if(!this.options.inject_controls||increment){index++}if(index<elements_length&&index>=0){result=elements[index]}return result},getVisibleElements:function(){return this._getElements().filter(function(el){return this.isVisibleElement(el)}.bind(this))},getFirstVisibleElement:function(){return this.getVisibleElements()[0]},getLastVisibleElement:function(){var elements=this.getVisibleElements();return elements[elements.length-1]},scrollToElement:function(element){var shift=this.getShiftElement(element);this.isEnableAnimation(shift)?this._smoothScrollToLeft(shift):this._changeElemsByOpacity(shift)},isEnableAnimation:function(shift){return(Math.abs(this._getContainerScrollLeft()-shift)<=this._getBlockSize())?true:false},_changeElemsByOpacity:function(scroll){new Fx.Style(this._getContainerElement(),'opacity',{duration:this.options.fx_opacity_duration,onComplete:function(){this._scrollToLeft(scroll);new Fx.Style(this._getContainerElement(),'opacity',{duration:this.options.fx_opacity_duration,onComplete:function(){this._checkControlsStatus()}.bind(this)}).start(1)}.bind(this)}).start(0)}});RozetkaElementsScroller_class.implement(new Events());var RozetkaPaginatorForScroller_class=new Class({Class:'RozetkaPaginatorForScroller_class',options:{tpl:{pages:'<li class=\"paginator-i\">\n\t<a class=\"paginator-link\" href=\"#\" name=\"page\">&nbsp;<\/a>\n<\/li>'},selectors:{container:'[name=pages]',elem:'[name=page]'},cssClasses:{active:'active'}},_container:null,_scroller:null,_wrapper_size:0,_pages:[],_active_page:null,initialize:function(container,scroller){this._container=container;this._scroller=scroller},init:function(){this._scroller._getElementsContainerParent().addEvent('scroll',this._scrollHandler.bind(this));this.update();return this},_scrollHandler:function(){var elements=this._scroller.getVisibleElements(),element=null,index=0;while(!element&&elements.length>index){this._pages.forEach(function(entity){if(entity.elements[0]==elements[index]){element=entity.page;return false}}.bind(this));index++}element&&this.activationPage(element)},_resizeHandler:function(){var wrapper=this._scroller._getElementsContainerParent(),property=this._scroller._getChangePropertyName();if(this._wrapper_size!=wrapper[property]){this.update();this._wrapper_size=wrapper[property]}},update:function(){var property=this._scroller._getChangePropertyName(),width=this._scroller._getElementsContainerParent()[property];this._pages=[];this._container.innerHTML='';if(this._scroller.options.inject_controls){this._createPagesForInjectControlls(width,property)}else{this._createPagesForNotInjectControlls(width,property)}if(this._pages){this._scrollHandler()}},_createPagesForNotInjectControlls:function(container_width,property){var stack=[],sum=0;this._scroller._getElements().each(function(elem){if((sum+elem[property])<=container_width){sum+=elem[property];stack.push(elem)}else{sum=elem[property];this._createPage(stack);stack=[elem]}}.bind(this));stack.length&&this._createPage(stack)},_createPagesForInjectControlls:function(container_width,property){var elements=this._scroller._getElements(),parent=elements[0],stack=[],sum=0;elements.each(function(elem){if((sum+elem[property])<container_width){sum+=elem[property];stack.push(elem)}else{sum=elem[property]+parent[property];this._createPage(stack);stack=[parent,elem]}parent=elem}.bind(this));stack.length&&this._createPage(stack)},_createPage:function(stack){var element=new Element('div'),page=null,target=null;element.setHTML(App.getHTML(this.options.tpl.pages,this));page=element.getFirst();page.inject(this._container);target=page.getElement(this.options.selectors.elem);if(target){this._pages.push({elements:stack,page:target});target.addEvent('click',this._clickPageHandler.bind(this))}},_clickPageHandler:function(event){var target=event.target,page=this._pages.filter(function(elem){return elem.page==target})[0];new Event(event).stop();this._scroller.scrollToElement(page.elements[0])},activationPage:function(element){this._pages.forEach(function(entity){if(entity.page.hasClass(this.options.cssClasses.active)){entity.page.removeClass(this.options.cssClasses.active)}}.bind(this));element.addClass(this.options.cssClasses.active)}});RozetkaPaginatorForScroller_class.implement(new Options(),new Events());var RozetkaFatMenuScroller_class=RozetkaElementsScroller_class.extend({Class:'RozetkaFatMenuScroller_class',options:{interval:75,shift:25},_interval:null,run:function(){var wrapper=this._getElementsContainerParent();wrapper.addEvent('scroll',this._checkControlsStatus.bind(this));this._checkControlsStatus();if(this._getControls()&&this._getElements()&&this._getContainerElement()){this._getControls().each(function(el){el.addEvents({mousedown:this._runScroll.bind(this),mouseup:this._stopScroll.bind(this),mouseout:this._stopScroll.bind(this),click:function(e){new Event(e).stop()}});el.addEventListener('touchstart',this._runScroll.bind(this));el.addEventListener('touchend',this._stopScroll.bind(this))}.bind(this))}wrapper.addEvent('mousewheel',this._mouseWheel.bind(this));this._wrapper_size=wrapper[this._getChangePropertyName()];return this},_mouseWheel:function(wheel_event){var event=new Event(wheel_event),vector=event.wheel>0?'left':'right';event.stop();this._scrollTimeByVector(vector)},_runScroll:function(event){event.preventDefault();var vector=this._getVectorControl(event.target);this._interval=setInterval(this._scrollTimeByVector.bind(this,vector),this.options.interval);this._scrollTimeByVector(vector)},_stopScroll:function(){if(this._interval){clearInterval(this._interval);this._interval=null}},_scrollTimeByVector:function(vector){var scroll=this._getContainerScrollLeft(),limits=this._getLimits(),is_right=(vector=='right'&&scroll<limits.right),is_left=(vector=='left'&&scroll!=0),change=(vector=='right')?this.options.shift:-this.options.shift;if(is_left||is_right){this._scrollToLeft(this._getContainerScrollLeft()+change);this._checkControlsStatus()}else{this._stopScroll()}}});var RozetkaCurrencies_class=new Class({Class:'RozetkaCurrencies_class',_conteiner:null,_cat_id:0,_currencies:'',_cache_time:0,_time_zone:null,options:{tpl:'{if UAH}\n\t{if USD}\n\t\t1 ${USD.unit} = ${USD.rate} ${UAH.unit}\t\n\t\t\n\t\t{if UAHC}\n\t\t<br \/>\t1 ${USD.unit} = ${(USD.rate\/UAHC.rate).toFixed(2)} ${UAHC.unit}\t\n\t\t{\/if}\n\t{\/if}\n{\/if}',uah_price_tpl:'${price}&nbsp;<span>${unit}<\/span>'},initialize:function(id,json,cache_time,time_zone){this._time_zone=time_zone;this._cache_time=cache_time;this._conteiner=$(id);this._cat_id=this._conteiner.getProperty('name');this._currencies=json[this._cat_id];this.update()},update:function(){if(this.isUpdateAllow()){this.updateCurrencies()}},isUpdateAllow:function(){var time=document.lastModified;var arr_time=time.match(/^(\d{2})\/(\d{2})\/(\d{4})\s(\d{2}):(\d{2}):(\d{2})$/);if(arr_time){date=new Date(arr_time[3],arr_time[1]-1,arr_time[2],arr_time[4],arr_time[5],arr_time[6])}else{arr_time=time.match(/^[a-z]{3},\s(.+)\sGMT$/i);if(arr_time&&arr_time[1]){date=new Date(arr_time[1]);var timezone=this._time_zone}}if(date){time=date.getTime()/1000;if(timezone){time=Number(time)+Number(timezone)}if(time>this._cache_time){$result=false}else{$result=true}}else{$result=false}return $result},updateCurrencies:function(){this._conteiner.setHTML(App.getHTML(this.options.tpl,this._currencies))},updatePrices:function(){var price_elements=$$('[class=price]');price_elements.each(function(elem){var uah_elem=elem.getElement('[class=uah]');var usd_elem=elem.getElement('[class=usd]');if(usd_elem&&uah_elem){var usd_price_str=usd_elem.getText();usd_price=usd_price_str.match(/\d+/g).join('');uah_price=(usd_price*this._currencies.USD.rate).toFixed(0);var data={price:uah_price,unit:this._currencies.UAH.unit};uah_elem.setHTML(App.getHTML(this.options.uah_price_tpl,data))}}.bind(this))}});var RozetkaToolTips_class=new Class({Class:'RozetkaToolTips_class',elements_with_tips:null,tip_popup:null,tip_block_name:null,hover_elem:null,options:{tpl:'<div class=\"goods-popup-hover\">\r\n\t<div class=\"popup-css\">\r\n\t\t<div name=\"content\" class=\"goods-popup-hover-content\">\r\n\t\t\t\u043f\u043e\u043f\u0430\u043f \u0445\u043e\u0432\u0435\u0440\u0430 \u043d\u0430 \u0442\u043e\u0432\u0430\u0440\r\n\t\t<\/div>\r\n\t\t<div class=\"pistil\"><\/div>\r\n\t<\/div>\r\n<\/div>',block_with_tips_selector:'[tool_tip=1]',popup_content_selector:'div[name=tip_content]',left_width_to_arrow:40,right_width_to_arrow:95,heigth_to_arrow:50,top_right_class:'pistil-top-right',top_left_class:'pistil-top-left',left_class:'pistil-left',right_class:'pistil-right',more_link_name:'tooltip-more'},initialize:function(name){this.tip_block_name=name;this._createPopup();this._addEventsForToolTips();$(document.body).addEvent('bindToolTipEvents',this._addEventsForToolTips.bind(this))},_createPopup:function(){this.tip_popup=new Element('div');this.tip_popup.setStyles({display:'none',position:'absolute',top:0,'z-index':3});this.tip_popup.setHTML(this.options.tpl);$(document.body).adopt(this.tip_popup)},_addEventsForToolTips:function(){this.elements_with_tips=$(document.body).getElements('div[name='+this.tip_block_name+']');this.elements_with_tips.each(function(elem_parent){elem_parent.getElements(this.options.block_with_tips_selector).each(function(elem){if(elem.getElement(this.options.popup_content_selector)){elem.addEvents({'mouseenter':this._showTip.bindWithEvent(this,elem),'mouseleave':this._hideTip.bindWithEvent(this)})}}.bind(this))}.bind(this));this.tip_popup.addEvents({'mouseover':this.toolTipPopupActions.bindWithEvent(this,'show'),'mouseleave':this.toolTipPopupActions.bindWithEvent(this,'hide')})},_hideTip:function(){this.tip_popup.setStyle('display','none')},_showTip:function(event,elem){this.hover_elem=elem;if(this._setContent()){this.tip_popup.setStyle('display','');var position=this.toolTipPosition();this.tip_popup.setStyles({top:position.top,left:position.left});this.tip_popup.removeClass(this.tip_popup.className);this.tip_popup.addClass(position.class_name);App.fireEvent('renewImages')}},_setContent:function(){var content=this.tip_popup.getElement('[name=content]');var text=this.hover_elem.getElement(this.options.popup_content_selector);content.setHTML(text.innerHTML);return!this.isEmptyContent(text)},isEmptyContent:function(container){var result=true;container.getChildren().each(function(elem){if(elem.getProperty('name')!=this.options.more_link_name&&/\S/.test(elem.getText())){result=false;return 0}}.bind(this));return result},toolTipPopupActions:function(event,action){new Event(event).stop();if(action=='show'){this.tip_popup.setStyle('display','')}else if(action=='hide'){this.tip_popup.setStyle('display','none')}},toolTipPosition:function(){var block_coords=this.getToolTipBlock().getCoordinates();var elem_coords=this.hover_elem.getCoordinates();var tip_popup_coords=this.tip_popup.getCoordinates();var document_size=$(document.body).getSize();var left=0;var top=0;var class_name='left';if(block_coords.width>block_coords.height){if(elem_coords.left+tip_popup_coords.width+35>block_coords.right){left=elem_coords.right-tip_popup_coords.width;class_name=this.options.top_right_class}else{left=elem_coords.left-this.options.left_width_to_arrow;class_name=this.options.top_left_class}top=elem_coords.bottom+29}else{if(elem_coords.left>document_size.size.x-elem_coords.left){left=elem_coords.left-tip_popup_coords.width;class_name=this.options.right_class}else{left=elem_coords.right;class_name=this.options.left_class}top=elem_coords.top+elem_coords.height/2-this.options.heigth_to_arrow}return{left:left,top:top,class_name:class_name}},getToolTipBlock:function(){var elem=this.hover_elem;while(elem.getProperty('name')!=this.tip_block_name){elem=elem.getParent()}return elem}});RozetkaToolTips_class.implement(new Options);var UTAForms_class=UTAAbstract_class.extend({Class:'UTAForms_class',options:{properties:{title:'data-title'},glue:': '},_activated_time:0,_first_send_time:0,_count_user_error:0,_count_server_error:0,initEvents:function(){this.parent();window.addEvent('beforeunload',this.onBeforeUnloadHandler.bind(this));this._object.form.getFormElements().each(function(elem){elem.addEvent('focus',this.onActivatedNextFormField.bind(this));elem.addEvent('focus',this.onActivatedFormHandler.bind(this))}.bind(this));this._object.addEvent('sendCommentForm',this.onFirstSendForm.bind(this));this._object.addEvent('failSendForm',this.onFailureSendForm.bind(this));this._object.addEvent('completeSendForm',this.onCompleteSendForm.bind(this));this._object.form.addEvent('onFieldsCheckFailed',this.onFailureCheckFields.bind(this));this._object.form.addEvent('onAfterComplete',this.onAfterCompleteHandler.bind(this))},onAfterCompleteHandler:function(){var result={timingVar:'send',timingLabel:'successful'};result['timingValue']=this.getTime();result['eventAttemptCount']=this._count_user_error+1;this.trackEvent(result)},onFailureCheckFields:function(elems){var result={timingVar:'send',timingLabel:'unsuccessful'},fields=[];result['timingValue']=this.getTime();elems.each(function(elem){if(elem.hasAttribute(this.options.properties.title)){fields.push(elem.getAttribute(this.options.properties.title))}}.bind(this));result['eventField']=fields.join('|');this._count_user_error++;result['eventAttemptCount']=this._count_user_error;this.trackEvent(result)},onCompleteSendForm:function(){var result={timingVar:'response',timingLabel:'successful'};result['timingValue']=this.getTime();this.trackEvent(result);this.reset()},onFailureSendForm:function(resp){var result={timingVar:'response',timingLabel:'unsuccessful'};result['timingValue']=this.getTime();this._count_server_error++;result['eventAttemptCount']=this._count_server_error;if(resp.status&&resp.statusText){result['eventError']=resp.status+this.options.glue+resp.statusText}this.trackEvent(result)},onFirstSendForm:function(){var result={timingVar:'send',timingLabel:'first'};if(!this._first_send_time){result['timingValue']=this._first_send_time=this.getTime();this.trackEvent(result)}},onActivatedNextFormField:function(e){var result={timingVar:'activation',timingLabel:'field'};if(this._activated_time){result['timingValue']=this.getTime()-this._activated_time;if(e.target&&e.target.hasAttribute(this.options.properties.title)){result['eventField']=e.target.getAttribute(this.options.properties.title)}this.trackEvent(result)}},onActivatedFormHandler:function(e){var result={timingVar:'activation',timingLabel:'first'};if(!this._activated_time){this._activated_time=this.getTime();result['timingValue']=this._activated_time;if(e.target&&e.target.hasAttribute(this.options.properties.title)){result['eventField']=e.target.getAttribute(this.options.properties.title)}this.trackEvent(result)}},onBeforeUnloadHandler:function(){var result={timingVar:'leave',timingValue:this.getTime(),timingLabel:'noAttempts',eventAttemptCount:this._count_user_error+this._count_server_error,eventNonInteraction:1};if(this._count_user_error||this._count_server_error){result['timingLabel']='withAttempts'}if(this._activated_time){this.reset();this.trackEvent(result)}},reset:function(){this.parent();this._activated_time=0;this._first_send_time=0;this._count_user_error=0;this._count_server_error=0}});var RozetkaImagePopup_class=new Class({Class:'RozetkaImagePopup_class',elem:null,image:null,popup:null,data:null,options:{tpl:'<div class=\"lightbox-popup\">\n\t<div class=\"popup-css\">\n\t\t<a href=\"#\" class=\"popup-close\" name=\"close\"><img width=\"18\" height=\"18\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"&times;\" class=\"popup-close-medium-icon sprite\"><\/a>\n\t\t<div name=\"content\"><\/div>\n\t<\/div>\n<\/div>\n',content_tpl:'<div class=\"center container\">\n\t<h2 name=\"title\"><\/h2>\n\t<table class=\"large-image\">\n\t\t<tr>\n\t\t\t<td name=\"image\" class=\"show-foto {if data.big_image}popup-big-image{\/if}\">\n\t\t\t\t${data.image}\n\t\t\t\t{if data.big_image}\n\t\t\t\t<br>\n\t\t\t\t<a href=\"${data.big_image.href}\" target=\"blank\">${data.text_for_big_image}<\/a> <i>(${data.big_image.w} &times; ${data.big_image.h})<\/i>\n\t\t\t\t{\/if}\n\t\t\t<\/td>\n\t\t<\/tr>\n\t<\/table>\n<\/div>',text_for_big_image:'   ',max_width:1024},initialize:function(elem,image,overlay,big_image){this.elem=elem;this.image=image;this.popup=new Popup_class(this.options.tpl);if(overlay){this.popup.overlayON();this.popup._overlay._elem.setStyle('z-index','100')}switch($type(this.elem)){case'array':this.elem.each(function(el){el.addEvent('click',this.onClick.bindWithEvent(this))}.bind(this));break;case'element':this.elem.addEvent('click',this.onClick.bindWithEvent(this));break}this.popup.setContent(this.options.content_tpl,this.buildData(big_image))},buildData:function(big_image){this.data={data:{image:this.image,text_for_big_image:this.options.text_for_big_image}};if(big_image&&big_image.w>this.options.max_width){this.data.data.big_image=big_image}return this.data},onClick:function(event){new Event(event).stop();this.popup.open()}});RozetkaImagePopup_class.implement(new Options);var EmailSubscribe_class=new Class({Class:'EmailSubscribe_class',parentElem:null,_popup:null,_changeable_elem:null,options:{'ajax_actions':{'subscribe':'subscribe','unsubscribe':'unsubscribe'},'unsubscribe':{'hash':'template','popup':{'enabled':false,'overlay':{'enabled':true,'z_index':100},'tpl':'<div class=\"unsubscribe-popup\">\n\t<a href=\"#\" class=\"popup-close popup-close-medium\" name=\"close\" onclick=\"document.fireEvent(\u0027closeUnsubscribe\u0027);\">\n\t\t<img width=\"20\" height=\"20\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"&times;\" class=\"sprite popup-close-medium-icon\">\n\t<\/a>\n\t<div name=\"content\"><\/div>\n<\/div>','content':'<h2 class=\"unsubscribe-title\">\u041e\u0442\u043f\u0438\u0441\u043a\u0430 \u043e\u0442&nbsp;\u0440\u0430\u0441\u0441\u044b\u043b\u043a\u0438<\/h2>\n\n<form class=\"popup-request-form\" action=\"\" method=\"post\" name=\"submit-by-ajax\">\n\t<textarea class=\"input-textarea unsubscribe-input-textarea noinvalid\" name=\"reason\" placeholder=\"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u043f\u0440\u0438\u0447\u0438\u043d\u0443 \u043e\u0442\u043f\u0438\u0441\u043a\u0438, \u0447\u0442\u043e\u0431\u044b \u043c\u044b \u0441\u043c\u043e\u0433\u043b\u0438 \u0443\u043b\u0443\u0447\u0448\u0438\u0442\u044c \u0440\u0430\u0441\u0441\u044b\u043b\u043a\u0443\" required=\"required\"><\/textarea>\n\t<p class=\"unsubscribe-note\">\u0412\u044b&nbsp;\u0442\u043e\u0447\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u043e\u0442\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f \u043e\u0442&nbsp;\u0440\u0430\u0441\u0441\u044b\u043b\u043a\u0438 &laquo;${title}&raquo;<\/p>\n\n\t<span class=\"btn-link btn-link-gray unsubscribe-submit\">\n\t\t<button class=\"btn-link-i\" type=\"submit\"\n\t\t\tonclick=\"document.fireEvent(\u0027unsubscribe\u0027, {extend_event: [{name: \u0027eventContext\u0027, value: \u0027${title}\u0027}]});\";\n\t\t>\u0414\u0430, \u043e\u0442\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f<\/button>\n\t<\/span>\n\t<span class=\"btn-link btn-link-gray unsubscribe-submit\">\n\t\t<button class=\"btn-link-i\"\n\t\t        name=\"close\"\n\t\t\t\tonclick=\"document.fireEvent(\u0027cancelUnsubscribe\u0027);\"\n\t\t>\u041d\u0435\u0442, \u044f&nbsp;\u043f\u0435\u0440\u0435\u0434\u0443\u043c\u0430\u043b<\/button>\n\t<\/span>\n<\/form>'}},'elems':'[name=subscribe-element]','message':{'tpl':'<div class=\"pos-fix sprite-side message code${code}\">\n\t<a href=\"\" class=\"message-close-link\" onclick=\"clearUserMessages(event);\">\n\t\t<img src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" width=\"24\" height=\"24\" class=\"sprite message-close-link-img\">\n\t<\/a>\n\t${content}\n<\/div>','container':'[name=app-message]','close':'[name=close-msg]'}},initialize:function(parentElem){this.parentElem=$(parentElem);this.msgContainer=$$(this.options.message.container);if(this.options.unsubscribe.popup.enabled){this._popup=new Popup_class(this.options.unsubscribe.popup.tpl);if(this.options.unsubscribe.popup.overlay.enabled){this._popup.overlayON({styles:{'z-index':this.options.unsubscribe.popup.overlay.z_index}})}}this.parentElem.addEvent('subscriptionStatusReceived',this.onSubscriptionStatusReceived.bind(this))},onSubscriptionStatusReceived:function(status){if(this._changeable_elem){if(status===this.options.ajax_actions.subscribe){this._enableElement(this._changeable_elem)}else if(status===this.options.ajax_actions.unsubscribe){this._disableElement(this._changeable_elem)}}this._changeable_elem=null},_isEnabledElement:function(target){return target.getProperty('name')=="checked"},_enableElement:function(target){target.getElement('input').checked=true;target.setProperty("name","checked")},_disableElement:function(target){target.getElement('input').checked=false;target.setProperty("name","unchecked")},_itemClickHandler:function(e,elem){var event=new Event(e);event.stop();this._changeable_elem=elem.getElement('label');if(this._isEnabledElement(this._changeable_elem)){this.unsubscribe(this._changeable_elem)}else{this.subscribe(this._changeable_elem)}},subscribe:function(target){var ajax_action=this.options.ajax_actions.subscribe;this.sendAJAX(target,ajax_action)},unsubscribe:function(target){var ajax_action=this.options.ajax_actions.unsubscribe;if(!this._showPopupForElement(target,ajax_action)){this.sendAJAX(target,ajax_action)}},_showPopupForElement:function(target,ajax_action){var done=false,popup_data,data;if(this._popup){popup_data={title:this._getElementTitle(target)};this._popup.setContent(this.options.unsubscribe.popup.content,popup_data);this._popup.getElement('form[name=submit-by-ajax]').addEvent('submit',function(e){new Event(e).stop();var form=e.target;if(form.checkFields()){data=App.parseGET(form.toQueryString());this.sendAJAX(target,ajax_action,data);this._popup.close()}}.bind(this));this._popup.open();done=true}return done},_getElementTitle:function(target){return target.textContent},_getElements:function(){if(this._elems==null){this._elems=this.parentElem.getElements(this.options.elems)}return this._elems},_closeMsg:function(e){var event=new Event(e).stop();this.msgContainer.empty()},run:function(){if(this._getElements()){this._getElements().each(function(el){el.addEvents({'click':this._itemClickHandler.bindWithEvent(this,el)})}.bind(this))}App.addOnDomReady(function(){this.checkUnsubscribeHash()}.bind(this))},checkUnsubscribeHash:function(){var template_id=location.getHashParam(this.options.unsubscribe.hash);if(template_id!==null){this._changeable_elem=this.parentElem.getElementById(template_id);location.hash='';if(this._changeable_elem&&this._isEnabledElement(this._changeable_elem)){this.unsubscribe(this._changeable_elem)}}},sendAJAX:function(elem,ajax_action,data){var request_data,locate,ajaxAction,ajax;this.parentElem.processStart('<img src="https://i1.rozetka.com.ua/ajax.gif" width="64" height="64"/>');request_data={id:($(elem).getProperty('id'))};if(data){request_data=$merge(data,request_data)}locate=location.href.replace(location.hash,'');ajaxAction=locate+(locate[locate.length-1]=='#'?'':'#')+ajax_action;ajax=new Ajax('/cgi-bin/form.php',{data:request_data,method:'post',headers:{ajaxAction:ajaxAction},onComplete:this.onComplete.bind(this)}).request()},onComplete:function(resp){var response=new Response_class(resp),close;if($defined(this.msgContainer)){this.msgContainer.setHTML(response.Message.getContentTpl(this.options.message.tpl,this));close=$$(this.options.message.close);close.addEvents({'click':this._closeMsg.bindWithEvent(this)})}if(response.isDone()&&response.result){this.parentElem.fireEvent('subscriptionStatusReceived',response.result);App.trackEvent('EmailSubscribe',response.result)}this.parentElem.processStop('<img src="https://i1.rozetka.com.ua/ajax.gif" width="64" height="64"/>')}});EmailSubscribe_class.implement(new Options());var RzCoupon_class=new Class({Class:'Coupon_class',_parent_element:'coupon',_error_message_element:'',coupon_active:false,open_block:null,form_block:null,options:{form_block:'[name=send_coupon]',open_block:'[name=open_block]',coupon_element:'coupon_element',submit_element:'submit_element',cancel_element:'[name=cancel_coupon]',info:'[name="coupon_info"]',ajaxApplyAction:'applyCoupon',ajaxCancelAction:'cancelCoupon',url:'https://my.rozetka.com.ua/checkout/',dinamic_elements:{coupon:{tpl:'{if !$defined(coupon)}\n\t<div class=\"check-promo-code-add\">\n\t\t<a href=\"#\" class=\"xhr no-visited check-promo-code-link\" name=\"open_block\">\u0412\u0432\u0435\u0441\u0442\u0438 \u043f\u0440\u043e\u043c\u043e\u043a\u043e\u0434<\/a>\n\t\t<a href=\"#\" class=\"info\" name=\"coupon_info\">\n\t\t\t<img class=\"sprite info-icon\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" width=\"14\" height=\"15\" alt=\"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435\" \/>\n\t\t<\/a>\n\t<\/div>\n\t<div name=\"send_coupon\" class=\"aligned-center hidden\">\n\t\t<form method=\"post\" action=\"https:\/\/my.rozetka.com.ua\/cgi-bin\/form.php?r=https:\/\/my.rozetka.com.ua\/&amp;action=applyCoupon\" class=\"check-promo-code-f\">\n\t\t\t<div class=\"clearfix bill-i\">\n\t\t\t\t<input\n\t\t\t\t\tid=\"coupon_element\"\n\t\t\t\t\tclass=\"input-text check-promo-code-input-text\"\n\t\t\t\t\tname=\"coupon_code\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\trequired=\"required\"\n\t\t\t\t\tpattern=\"\\d{4}.*[A-Za-z\u0410-\u042f\u0430-\u044f\\d]{4}.*[A-Za-z\u0410-\u042f\u0430-\u044f\\d]{4}.*\\d{4}\"\n\t\t\t\t>\n\t\t\t<\/div>\n\t\t\t<spav class=\"btn-link btn-link-gray check-promo-code-submit\">\n\t\t\t\t<input class=\"btn-link-i\" id=\"submit_element\" type=\"submit\" value=\"\u041f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c\">\n\t\t\t<\/spav>\n\t\t<\/form>\n\t<\/div>\n\n{else}\n\t<div class=\"check-promo-code-success\">\n\t\t<h4 class=\"check-promo-code-success-title\">\u0412\u044b \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u043b\u0438 \u043f\u0440\u043e\u043c\u043e\u043a\u043e\u0434:<\/h4>\n\t\t<p class=\"check-promo-code-campaign\"><nobr>${coupon.title}<\/nobr><\/p>\n\t\t{if coupon.coupon_active_discount!=\"goods_prices_value\"}\n\t\t\t<p class=\"check-promo-code-success-text\">\n\t\t\t\t\u0421\u043a\u0438\u0434\u043a\u0430 \u0441\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 ${coupon.campaign_title}\n\t\t\t<\/p>\n\t\t{\/if}\n\t\t<a href=\"#\" class=\"xhr novisited check-promo-code-cancel\" name=\"cancel_coupon\">\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0440\u043e\u043c\u043e\u043a\u043e\u0434<\/a>\n\t<\/div>\n{\/if}'}},jst:{popup:'<div class=\"popup-info\">\r\n\t<div class=\"popup-css\">\r\n\t\t<a href=\"#\" class=\"popup-close\" name=\"close\"><img width=\"18\" height=\"18\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"&times;\" class=\"popup-close-medium-icon sprite\"><\/a>\r\n\t\t<div name=\"msg\"><\/div>\r\n\t\t<div name=\"content\"><\/div>\r\n\t<\/div>\r\n<\/div>',info:""}},initialize:function(is_active_coupon){this.coupon_active=is_active_coupon},init:function(){this.hideSubmitBlock();this.abilityToApplyCoupon();this.abilityToCancelCoupon()},hideSubmitBlock:function(){this.open_block=$E(this.options.open_block,this._parent_element);this.form_block=$E(this.options.form_block,this._parent_element);this.info=$E(this.options.info,this._parent_element);this.initInfoPopup(this.info,this.options.jst.info);if(this.open_block&&this.form_block){this.form_block.hide();this.open_block.addEvent('click',function(e){new Event(e).stop();this.form_block.toggle(function(){rozetkaEvents.trackEvent('Coupons','show')})}.bind(this))}},abilityToApplyCoupon:function(){if($defined($(this.options.submit_element))&&$defined($(this.options.coupon_element))){$(this.options.submit_element).addEvent('click',function(e){new Event(e).stop();if(!this.form_block.checkFields()){return false}var data,ajax;data={'coupon_code':$(this.options.coupon_element).getValue()};ajax=new Ajax('/cgi-bin/form.php',{data:data,method:'post',headers:{ajaxAction:this.getAjaxApplyAction()},onComplete:this.onActionApplyComplete.bind(this)}).request();App.fireEvent('CouponActionStart');rozetkaEvents.trackEvent('Coupons','try-apply')}.bind(this))}},abilityToCancelCoupon:function(){if($defined($$(this.options.cancel_element))){$$(this.options.cancel_element).addEvent('click',function(e){new Event(e).stop();this.cancelCoupon()}.bind(this))}},cancelCoupon:function(){var data,ajax;data={'cancel_coupon':true};ajax=new Ajax('/cgi-bin/form.php',{data:data,method:'post',headers:{ajaxAction:this.getAjaxCancelAction()},onComplete:this.onActionCancelComplete.bind(this)}).request();App.fireEvent('CouponActionStart')},getAjaxApplyAction:function(){return this.options.url+'#'+this.options.ajaxApplyAction},getAjaxCancelAction:function(){return this.options.url+'#'+this.options.ajaxCancelAction},setErrorMessage:function(resp){if(!this._error_message_element){this._error_message_element=new Element('div')}this._error_message_element.addClass('message_error');this._error_message_element.setHTML(resp.Message.content);this._error_message_element.injectTop(this.form_block)},initInfoPopup:function(elem,tpl){if(elem){var info_popup=new Popup_class(this.options.jst.popup);info_popup.setContent(App.getHTML(tpl));elem.addEvent('click',function(e){new Event(e).stop();App.addOnDomReady(function(){info_popup.open()})})}},onActionApplyComplete:function(e){var Response=new Response_class(e),event_data={extend_event:[]},coupon_applied=true,params_for_coupon_complete;Response.doAction();if(Response.isError()){this.setErrorMessage(Response);rozetkaEvents.trackEvent('Coupons','fail');event_data.extend_event.push({name:'eventError',value:Response.Message.content});coupon_applied=false}else{if(this._error_message_element){this._error_message_element.setHTML('')}if($defined(Response.content.order)){$(this._parent_element).setHTML(App.getHTML(this.options.dinamic_elements.coupon.tpl,Response.content.order));this.coupon_active=true;this.abilityToCancelCoupon();rozetkaEvents.trackEvent('Coupons','success',Response.content.order.coupon.campaign_title)}}params_for_coupon_complete={resp:e,coupon_applied:coupon_applied};App.fireEvent('CouponActionComplete',params_for_coupon_complete);$(document).fireEvent('couponApplyAttempt',event_data)},onActionCancelComplete:function(e){var Response=new Response_class(e);Response.doAction();if(Response.isDone()){if($defined(Response.content.order)){$(this._parent_element).setHTML(App.getHTML(this.options.dinamic_elements.coupon.tpl,Response.content.order));this.hideSubmitBlock();this.coupon_active=false;this.abilityToApplyCoupon();rozetkaEvents.trackEvent('Coupons','cancel')}}App.fireEvent('CouponActionComplete',{resp:e})}});RzCoupon_class.implement(new Options);var RozetkaElementsPerformance_class=new Class({place:'Catalog',setTrackEvent:function(parent_elem,href,action,gtm_data){var parent_element=$(parent_elem);if(parent_element){var elements=parent_element.getElements('a[href='+href+']');elements.extend(parent_element.getElements('a[href^='+href+'#]'));this._setClickEvent(elements,action,gtm_data)}},setTrackEventForFilter:function(parent_elem,href,action,gtm_data){var parent_element=$(parent_elem),previous;if(parent_element){var elements=parent_element.getElements('a[href='+href+']');var extend_elements=[];for(var index=0;index<elements.length;index++){if(previous=elements[index].getPrevious()){extend_elements.include(previous)}}elements.extend(extend_elements);this._setClickEvent(elements,action,gtm_data)}},setTrackEventForTrackBar:function(parent_elem,inputs,action,gtm_data){var parent_element=$(parent_elem);if(parent_element){var elements=parent_element.getElements('button[id='+inputs.button+']');this._setClickEvent(elements,action,gtm_data)}},_setClickEvent:function(elems,action,data){elems.each(function(elem){elem.addEvent('click',function(){var event_data={extend_event:[]},event_value;Object.each(data,function(value,key){event_value=value;if(typeof value=='object'&&(value.min||value.max)){if(value.min&&$(value.min)){event_value=$(value.min).value}if(value.max&&$(value.max)){event_value+='-'+$(value.max).value}}event_data.extend_event.push({name:key,value:event_value})});if(action!="sort | "){document.fireEvent("applyFilter",event_data)}else{document.fireEvent("sortClick",event_data)}})})},_setEvent:function(e,params){if(_gaq){if(params.data){var label='not';var input_min=$(params.data.min);if(input_min&&input_min.value.toInt()>0){label='min'}var input_max=$(params.data.max);if(input_max&&input_max.value.toInt()>0){label=(label=='not')?'max':'min-max'}params.label=label}_gaq.push(['_trackEvent','Elements Performance',params.action,params.label])}},setPlace:function(place){this.place=place}});ApiSocial_class=new Class({_facebook_api_loaded:false,_vk_api_loaded:false,_facebook_app_id:'205429962821175',_facebook_sdk_src:'http://connect.facebook.net/ru_RU/sdk.js',_facebook_graph_version:'v1.0',_vk_app_id:'',initialize:function(){var settings_version=''+'v2.0';if(settings_version){this._facebook_graph_version=settings_version}if(this._facebook_graph_version==='v1.0'){this._facebook_sdk_src='http://connect.facebook.net/ru_RU/all.js'}},isLoaded:function(network){var result=false;if(this['_'+network+'_api_loaded'])result=true;return result},initFBApi:function(){FB.init({appId:this._facebook_app_id,xfbml:true,version:this._facebook_graph_version})},initVKApi:function(){VK.init({apiId:this._vk_app_id,onlyWidgets:true})},loadFBApi:function(){if(!this.isLoaded('facebook')){var script=Asset.javascript(this._facebook_sdk_src,{'onload':this.callbackFBLoad.bind(this)});if(window.ie7||window.ie8){script.onreadystatechange=function(){if(script.readyState=='loaded')this.callbackFBLoad()}.bind(this)}}},callbackFBLoad:function(targetUrl){this._facebook_api_loaded=true;this.initFBApi();FB.Event.subscribe('edge.create',function(targetUrl){App.trackSocial('facebook','like')});FB.Event.subscribe('edge.remove',function(targetUrl){App.trackSocial('facebook','unlike')})},loadVKApi:function(elem,title,description,image_url,text_button){if(!this.isLoaded('vk')){var script=Asset.javascript('http://userapi.com/js/api/openapi.js?47',{'onload':this.callbackVKLoad.bind(this)});if((window.ie7||window.ie8)&&!document.getElementsByClassName){script.onreadystatechange=function(){if(script.readyState=='loaded')this.callbackVKLoad()}.bind(this)}}},callbackVKLoad:function(targetUrl){this._vk_api_loaded=true;this.initVKApi();VK.Widgets.Like("vk_like",{type:"button",pageUrl:social_href});VK.Observer.subscribe('widgets.like.liked',function(targetUrl){App.trackSocial('vk','like')});VK.Observer.subscribe('widgets.like.unliked',function(targetUrl){App.trackSocial('vk','unlike')})},initTwitterCallback:function(){if(window.twttr){window.twttr.events.bind('tweet',function(event){if(event){var targetUrl;if(event.target&&event.target.nodeName=='IFRAME'){targetUrl=this._extractParamFromUri(event.target.src,'url')}_gaq.push(['_trackSocial','twitter','tweet',targetUrl])}}.bind(this))}},_extractParamFromUri:function(uri,paramName){if(!uri){return}var uri=uri.split('#')[0];var parts=uri.split('?');if(parts.length==1){return}var query=decodeURI(parts[1]);paramName+='=';var params=query.split('&');for(var i=0,param;param=params[i];++i){if(param.indexOf(paramName)===0){return unescape(param.split('=')[1])}}}});RozetkaApiSocial_class=ApiSocial_class.extend({Class:'RozetkaApiSocial_class',current_url:null,_vk_api_url:'http://userapi.com/js/api/openapi.js?47',_facebook_app_id:'205429962821175',_vk_app_id:'2743724',setCurrentURL:function(current_url){this.current_url=current_url},vkSubscribe:function(event_name,callback){if(this.isLoaded('vk')){VK.Observer.subscribe(event_name,callback.bind(this))}},vkOnJoinGroup:function(){this.vkSubscribe('widgets.groups.joined',this._trackVKLike.bind(this))},loadVKApi:function(callback){if(!this.isLoaded('vk')){var script=Asset.javascript(this._vk_api_url,{'onload':function(){this._callbackVKLoad(callback)}.bind(this)});if(window.ie7||window.ie8){script.onreadystatechange=function(){if(this.readyState=='loaded'){this._callbackVKLoad(callback)}}.bind(this)}}},_callbackVKLoad:function(callback){this._vk_api_loaded=true;this.initVKApi();callback&&callback()},_trackVKLike:function(){App.trackSocial('','like')},loadVKShareButton:function(elem,title,description,image_url,text_button){this._vk_elem=elem;this._vk_title=title;this._vk_description=description;this._vk_image_url=image_url;this._vk_text=(text_button)?text_button:' ';if(!this.isLoaded('vk')){var script=Asset.javascript('http://vkontakte.ru/js/api/share.js?9',{'onload':this.callbackVKLoadShareButton.bind(this)});if(window.ie7||window.ie8){script.onreadystatechange=function(){if(this.readyState=='loaded')this.callbackVKLoadShareButton()}.bind(this)}}else{this.callbackVKLoadShareButton()}},callbackVKLoadShareButton:function(){if(window.VK!=undefined){var button_options={title:'  '+this._vk_title,description:this._vk_description,image:this._vk_image_url};if(this.current_url){button_options['url']=this.current_url}$(this._vk_elem).innerHTML=VK.Share.button(button_options,{type:"round",text:this._vk_text});$(this._vk_elem).addEvent('click',this._trackVKLike.bind(this))}}});var state={PENDING:'pending',READY:'ready'};function limitInfoCallback(response){if(response['state']=="success"){showMessage("      ")}else{showMessage("      . ,  ")}var submitButton=document.getElementById("phone-submit");submitButton.dataset.state=state.READY;function showMessage(text){var phoneWrapper=document.getElementById("limit-info-wrapper"),messageWrapper=document.getElementById('part_pay_sms_send_message');phoneWrapper&&phoneWrapper.hide();messageWrapper&&messageWrapper.show();if(messageWrapper&&messageWrapper.getElement('a')){messageWrapper.getElement('a').addEvent("click",function(){phoneWrapper.show();messageWrapper.hide();return false})}}}function partPayCheckReady(){var source=1;var countryCode="+38";var phoneMask=countryCode+"";var form=document.getElementById("phone-number-form");var phoneInput=document.getElementById("phone-input");var minStartingPosition=phoneMask.search(/\(/)+1;setCaretPosition(phoneInput,minStartingPosition);form.onsubmit=function(e){e.preventDefault()};var submitButton=document.getElementById("phone-submit");submitButton.dataset.state=state.READY;submitButton.onclick=function(){if(submitButton.dataset.state===state.READY){submitPhone(submitButton)}};phoneInput.onkeydown=function(event){phoneInput.highlightReset();var key=event.which||event.keyCode;var allowed_keys=[8,46,107,32,109,189];if((key>=48&&key<=57)||(key>=96&&key<=105)||allowed_keys.indexOf(key)!=-1||(event.shiftKey&&key==187)||(event.ctrlKey&&key==86)){return true}else if(key==13){submitPhone()}if((key==37)||(key==39)){return}event.preventDefault()};function getFormattedPhone(unformattedPhone){var formattedPhone=phoneMask;unformattedPhone.split("").forEach(function(item){formattedPhone=replaceCharAt(formattedPhone,formattedPhone.search(/_/),item)});return formattedPhone}function getUnformattedPhone(formattedPhone){var re=new RegExp("(\\"+countryCode+"|[_ ()])","g");return formattedPhone.replace(re,"")}function submitPhone(){phoneInput.highlightReset();if(phoneIsValid()){var phone=phoneInput.value.replace(/[\D]/g,"");var src='https://paypartslimit.privatbank.ua/pp-limit/limit?phone='+phone+'&source='+source+'&callback=limitInfoCallback';var scriptElement=document.createElement('SCRIPT');scriptElement.src=src;document.body.appendChild(scriptElement);submitButton.dataset.state=state.PENDING}else{phoneInput.highlightError()}}function phoneIsValid(){var re=new RegExp("^\\"+countryCode+"\\d{10}$");var phone='+'+phoneInput.value.replace(/[\D]/g,"");return re.test(phone)}function getCaretPosition(ctrl){var caretPos=0;if(document.selection){ctrl.focus();var Sel=document.selection.createRange();Sel.moveStart('character',-ctrl.value.length);caretPos=Sel.text.length}else if(ctrl.selectionStart||ctrl.selectionStart=='0')caretPos=ctrl.selectionStart;return(caretPos)}function setCaretPosition(ctrl,pos){if(ctrl.setSelectionRange){ctrl.focus();ctrl.setSelectionRange(pos,pos)}else if(ctrl.createTextRange){var range=ctrl.createTextRange();range.collapse(true);range.moveEnd('character',pos);range.moveStart('character',pos);range.select()}}function findLastIndexOfRegex(source,regex,startpos){regex=(regex.global)?regex:new RegExp(regex.source,"g"+(regex.ignoreCase?"i":"")+(regex.multiLine?"m":""));if(typeof(startpos)=="undefined"){startpos=source.length}else if(startpos<0){startpos=0}var stringToWorkWith=source.substr(0,startpos+1);var lastIndexOf=-1;var nextStop=0;var result;while((result=regex.exec(stringToWorkWith))!=null){lastIndexOf=result.index;regex.lastIndex=++nextStop}return lastIndexOf}function replaceCharAt(source,index,character){return source.substr(0,index)+character+source.substr(index+character.length)}}var ElementSelect_class=new Class({Class:'ElementSelect_class',options:{selectors:{block:'[name=select_block]',link:'[name=drop_link]',drop_block:'[name=drop_block]',drop_element:'[name=drop_element]',input:'input[type=hidden]'},cssClasses:{hidden:'hidden',checked:'active'},properties:{question:{title:'data-question-title',value:'data-question-value'},value:'data-value',active:'data-active'},entity:'ElementSelectEntity_class',phrases:' '},_elements:[],initialize:function(){this.attachToObserver(['LoadTabContent','ResetForm'])},init:function(container){var constructor=App.getConstructorByClassName(this.options.entity);constructor&&container.getElements(this.options.selectors.block).each(function(block){this._elements.push(new constructor(block,this).setOptions(this.options).init())}.bind(this));return this},_reset:function(container){container.getElements(this.options.selectors.block).each(function(block){this._elements.forEach(function(element){element._container==block&&element.reset()})}.bind(this))},closeOtherSelect:function(select){this._elements.each(function(element){if(element!=select){element.close()}})},onLoadTabContent:function(data){this.init(data[0])},onResetForm:function(data){this._reset(data[0])}});ElementSelect_class.implement(new Options(),new Events());var ElementSelectEntity_class=new Class({Class:'ElementSelectEntity',options:{selectors:{block:'[name=select_block]',link:'[name=drop_link]',drop_block:'[name=drop_block]',drop_element:'[name=drop_element]',input:'input[type=hidden]'},cssClasses:{hidden:'hidden',checked:'active'},properties:{question:{title:'data-question-title',value:'data-question-value'},value:'data-value',active:'data-active'},phrases:' '},_container:null,_controller:null,_drop_block:null,_link:null,_input:null,_drop_elements:[],elements:[],initialize:function(container,controller){this._container=container;this._controller=controller},init:function(){this._link=this._container.getElement(this.options.selectors.link);this._drop_block=this._container.getElement(this.options.selectors.drop_block);this._input=this._container.getElement(this.options.selectors.input);this._link.addEvent('click',this._handlerLink.bind(this));this._drop_elements=this._container.getElements(this.options.selectors.drop_element);this._drop_elements.forEach(function(element){if(!~this.elements.indexOf(element)){element.addEvent('click',this._handlerDropElement.bind(this));this.elements.push(element)}}.bind(this));$(document.body).addEvent('click',this._hideDropBlock.bind(this));return this},_handlerDropElement:function(e){var target=e.target,value=target.getProperty(this.options.properties.value);new Event(e).stop();if(value){this._link.setHTML(target.innerHTML);this._input.value=value;this._input.disabled=false;this._clearDropElementsCss();target.addClass(this.options.cssClasses.checked);this.analytic(target);this._fireDropElementEvent(target)}this.close()},_clearDropElementsCss:function(){this._drop_elements.each(function(element){element.hasClass(this.options.cssClasses.checked)&&element.removeClass(this.options.cssClasses.checked)}.bind(this))},_fireEventByName:function(event_name){var event={type:event_name};event['target']=this._input;this._input.fireEvent('focus',event)},_hideDropBlock:function(e){this.close()},close:function(){this.isVisible()&&this._drop_block.addClass(this.options.cssClasses.hidden)},_handlerLink:function(e){new Event(e).stop();this._controller&&this._controller.closeOtherSelect(this);if(this.isVisible()){this._drop_block.addClass(this.options.cssClasses.hidden)}else{this._drop_block.removeClass(this.options.cssClasses.hidden)}this._fireEventByName('focus')},reset:function(){this._link.setHTML(this.options.phrases);if(!this._input.disabled){this._input.value=null;this._input.disabled=true}this._clearDropElementsCss()},isVisible:function(){return!this._drop_block.hasClass('hidden')},_fireDropElementEvent:function(target){document.fireEvent('dropSelectElement',{target:target})},analytic:function(element){var events=[];if(element&&element.hasAttribute(this.options.properties.question.title)&&element.hasAttribute(this.options.properties.question.value)){events.push({name:'eventContext',value:element.getAttribute(this.options.properties.question.title)});events.push({name:'eventContent',value:element.getAttribute(this.options.properties.question.value)})}document.fireEvent('dropDownList',{extend_event:events})}});ElementSelectEntity_class.implement(new Options(),new Events());var ElementSelectSortEntity_class=ElementSelectEntity_class.extend({Class:'ElementSelectSortEntity_class',init:function(){this.parent();this._drop_block.addEvent('click',function(event){new Event(event).stop()});return this},_handlerDropElement:function(e){this.parent(e);window.location.href=e.target.href;this.fireEvent('sortEntityChanged')},setActiveElemByValue:function(value){var elem=null;this._drop_elements.each(function(el){if(el.getProperty(this.options.properties.value)==value){elem=el}}.bind(this));if(elem){this._link.setHTML(elem.innerHTML);this._input.value=value;this._input.disabled=false;this._clearDropElementsCss();elem.addClass(this.options.cssClasses.checked)}}});var CustomVars_class=new Class({Class:'CustomVars_class',Implements:[Options],_vars:{},options:{vars:{}},set:function(name,value){if($defined(this.options.vars[name])){var options=this.options.vars[name];App.setCustomVar(options.slot,name,value||options.default_value,options.opt_scope)}},remove:function(name){if($defined(this.options.vars[name])){App.deleteCustomVar(parseInt(this.options.vars[name].slot))}}});var RozetkaCustomVars_class=CustomVars_class.extend({Class:'RozetkaCustomVars_class',options:{vars:{Users:{slot:1,default_value:'customer',opt_scope:1},goods_sell_status:{slot:2,default_value:null,opt_scope:3},SSC_product:{slot:3,default_value:null,opt_scope:3},userId:{slot:4,default_value:null,opt_scope:1},rival_bot:{slot:5,default_value:1,opt_scope:3},VisitorCity:{slot:5,default_value:null,opt_scope:1}}}});var TrackUserOfMadeOrder_class=new Class({Class:'TrackUserOfMadeOrder_class',options:{index:1,name:'Users',value:'Customer',opt_scope:1},initialize:function(){App.addOnDomReady(function(){this.checkAlreadyMadeOrder()}.bind(this));$(document).addEvent('signIn',this.checkAlreadyMadeOrder.bind(this))},checkAlreadyMadeOrder:function(){if(Cookie.get("made_order")&&!Cookie.get("just_made_order")){App.setCustomVar(this.options.index,this.options.name,this.options.value,this.options.opt_scope);Cookie.remove('made_order',{domain:'.rozetka.com.ua',path:'/'})}},onOrderSuccess:function(){Cookie.set('made_order',1,{duration:365,domain:'.rozetka.com.ua',path:'/'});Cookie.set('just_made_order',1,{domain:'.rozetka.com.ua',path:'/'})}});TrackUserOfMadeOrder_class.implement(new Options);var CreditPopup_class=new Class({Class:'CreditPopup_class',is_popup_been_open:false,data:null,data_objects:{},tabs:{},available_payments:{},options:{selectors:{open_blocks:{credit:'a[name=credit_info]',part_pay:'a[name=part_pay_info]'},blocks:{credit:'[name=credit_block]',part_pay:'[name=part_pay_block]'},tabs:{credit:{tab_href:'[id=credit_tab_href]',tab_content:'[id=credit_tab_content]'},part_pay:{tab_href:'[id=part_pay_tab_href]',tab_content:'[id=part_pay_tab_content]'}},buy:{button:'button[name=topurchasesbycredit]',credit_id:'[name=credit_id]'},check_limit:{button:'[id=phone-submit]'}},popup:{header_tpl:'<div class=\"popup-css popup-credit\">\n\t<a href=\"#\" class=\"popup-close\" name=\"close\">\n\t\t<img width=\"28\" height=\"29\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"&times;\" class=\"popup-close-medium-icon sprite\">\n\t<\/a>\n\t<div name=\"msg\"><\/div>\n\t<div name=\"content\" class=\"popup-credit-content\"><\/div>\n<\/div>',info_tpl:'<div id=\"credit_popup_container\">\n\t{if $defined(credit.records) && $defined(part_pay.records)}\n\t\t<ul class=\"clearfix m-tabs m-tabs-underlined credit-m-tabs\">\n\t\t\t<li class=\"m-tabs-i credit-m-tabs-i\">\n\t\t\t\t<a href=\"#\" class=\"novisited m-tabs-link credit-m-tabs-i-link\" id=\"credit_tab_href\">\n\t\t\t\t\t<span class=\"sprite-side credit-m-tabs-i-link-text credit-tab-link\">\n\t\t\t\t\t\t{if credit.getFromData(\u0027title\u0027)}\n\t\t\t\t\t\t\t${credit.getFromData(\u0027title\u0027)}\n\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t\u041f\u043e\u043a\u0443\u043f\u043a\u0430 \u0442\u043e\u0432\u0430\u0440\u0430 \u0432 \u043a\u0440\u0435\u0434\u0438\u0442\n\t\t\t\t\t\t{\/if}\n\t\t\t\t\t<\/span>\n\t\t\t\t<\/a>\n\t\t\t<\/li>\n\n\t\t\t<li class=\"m-tabs-i credit-m-tabs-i\">\n\t\t\t\t<a href=\"#\" class=\"novisited m-tabs-link credit-m-tabs-i-link\" id=\"part_pay_tab_href\">\n\t\t\t\t\t<span class=\"sprite-side credit-m-tabs-i-link-text credit-part-tab-link\">\n\t\t\t\t\t\t{if part_pay.getFromData(\u0027title\u0027)}\n\t\t\t\t\t\t\t${part_pay.getFromData(\u0027title\u0027)}\n\t\t\t\t\t\t{else}\n\t\t\t\t\t\t\t\u041e\u043f\u043b\u0430\u0442\u0430 \u0442\u043e\u0432\u0430\u0440\u0430 \u0447\u0430\u0441\u0442\u044f\u043c\u0438\n\t\t\t\t\t\t{\/if}\n\t\t\t\t\t<\/span>\n\t\t\t\t<\/a>\n\t\t\t<\/li>\n\t\t<\/ul>\n\t{\/if}\n\n\t{if $defined(credit.records)}\n\t\t<div id=\"credit_tab_content\" class=\"hidden\">\n\t\t\t{var data_record = credit}\n\t\t\t<div class=\"credit-tab\">\n\t{if data_record.getFromData(\u0027top_text\u0027)}\n\t\t<h3 class=\"credit-tab-header\">${data_record.getFromData(\u0027top_text\u0027)}<\/h3>\n\t{\/if}\n\n\t<div class=\"credit-tab-info\">\n\t\t<span class=\"credit-tab-info-text\">\u041a\u0440\u0435\u0434\u0438\u0442 \u043e\u0444\u043e\u0440\u043c\u043b\u044f\u0435\u0442\u0441\u044f \u043d\u0430&nbsp;\u0431\u0435\u0437\u043d\u0430\u043b\u0438\u0447\u043d\u0443\u044e \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u0442\u043e\u0432\u0430\u0440{if !goods_id}\u043e\u0432{else}\u0430{\/if}&nbsp;&mdash;<\/span>\n\t\t<span class=\"bold ccredit-tab-info-price\">${data_record.getFirstRecord().getPrimaryDecimals(\u0027amount_of_loan\u0027)}\n\t\t\t<span class=\"normal credit-tab-info-price-unit\">${data_record.getFirstRecord().getPrimaryUnit(\u0027amount_of_loan\u0027)}<\/span>\n\t\t<\/span>\n\t<\/div>\n\n\t<ul class=\"credit-tab-tariff\">\n\t\t{for item in data_record.getRecords()}\n\t\t\t<li class=\"credit-tariff\">\n\t\t\t\t<div class=\"clearfix credit-tariff-row\">\n\t\t\t\t\t<div class=\"credit-tariff-b\">\n\t\t\t\t\t\t${data_record.getTitleBlock(item)}\n\t\t\t\t\t<\/div>\n\n\t\t\t\t\t<div class=\"credit-tariff-b\">\n\t\t\t\t\t\t${data_record.getDescriptionBlock(item)}\n\t\t\t\t\t<\/div>\n\n\t\t\t\t\t<div class=\"credit-tariff-b\">\n\t\t\t\t\t\t${data_record.getCostPerMonthBlock(item)}\n\n\t\t\t\t\t\t{if goods_id}\n\t\t\t\t\t\t\t<div class=\"credit-tariff-btn\" id=\"catalog_item${goods_id}\" name=\"catalog_item\">\n\t\t\t\t\t\t\t\t<form method=\"POST\" action=\"https:\/\/my.rozetka.com.ua\/cgi-bin\/form.php?r=https:\/\/my.rozetka.com.ua\/cart\/&action=buy\">\n\t\t\t\t\t\t\t\t\t<span class=\"btn-link btn-link-green\">\n\t\t\t\t\t\t\t\t\t\t<input type=\"hidden\" value=\"${goods_id}\" name=\"goods_id\">\n\t\t\t\t\t\t\t\t\t\t<input type=\"hidden\" value=\"${item.getPrimary().id}\" name=\"credit_id\">\n\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\tclass=\"btn-link-i\"\n\t\t\t\t\t\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\t\t\t\t\t\tname=\"topurchasesbycredit\"\n\t\t\t\t\t\t\t\t\t\t\tp_type=\"${item.getType()}\"\n\t\t\t\t\t\t\t\t\t\t\tp_count=\"${item.getNumberOfPayments(item.getPrimary().id)}\"\n\t\t\t\t\t\t\t\t\t\t\tm_count=\"${item.getNumberOfMonth(item.getPrimary().id)}\"\n\t\t\t\t\t\t\t\t\t\t\tcredit_id=\"${item.id}\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\u041a\u0443\u043f\u0438\u0442\u044c\n\t\t\t\t\t\t\t\t\t\t<\/button>\n\t\t\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t\t\t<\/form>\n\t\t\t\t\t\t\t<\/div>\n\n\t\t\t\t\t\t\t<script type=\"text\/javascript\">\n\t\t\t\t\t\t\t\tGoodsCatalog.add(${goods_id}, \u0027credit_popup\u0027);\n\t\t\t\t\t\t\t<\/script>\n\t\t\t\t\t\t{\/if}\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\n\t\t\t\t{if item.getPaymentNoticeText()}\n                    <div class=\"credit-tariff-notice\" name=\"payment_type_notice\">\n                        <span class=\"credit-tariff-notice-text\">\n                            ${item.getPaymentNoticeText()}\n                        <\/span>\n                    <\/div>\n                {\/if}\n\n\t\t\t\t{if data_record.type == \"part_pay\"}\n\t\t\t\t\t<div class=\"credit-tariff-row\">\n\t\t\t\t\t\t<div class=\"credit-available-amount\">\n\t<div id=\"limit-info-wrapper\">\n\t\t<div class=\"credit-available-amount-title\">\n        \t\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430, \u0447\u0442\u043e\u0431\u044b \u0443\u0437\u043d\u0430\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0443\u044e \u0441\u0443\u043c\u043c\u0443 \u0434\u043b\u044f \u043e\u043f\u043b\u0430\u0442\u044b \u0447\u0430\u0441\u0442\u044f\u043c\u0438\n\t\t<\/div>\n\t\t<form class=\"credit-available-amount-f\" id=\"phone-number-form\" role=\"form\">\n\t\t\t<div id=\"phone-wrapper\">\n\t\t\t\t<input type=\"tel\" class=\"input-text credit-available-amount-input credit-available-amount-placeholder\"\n\t\t\t\t\t   name=\"phone\" id=\"phone-input\" placeholder=\"+380\" value=\"+380\" maxlength=\"18\"\n\t\t\t\t\t   onfocus=\"this.removeClass(\u0027credit-available-amount-placeholder\u0027)\"\n\t\t\t\t>\n\t\t\t\t<span class=\"btn-link btn-link-gray credit-available-amount-btn\">\n\t\t\t\t\t<button type=\"submit\" class=\"btn-link-i\" id=\"phone-submit\">\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c<\/button>\n\t\t\t\t<\/span>\n\t\t\t<\/div>\n\t\t<\/form>\n\t<\/div>\n\t<div class=\"inline message code2 hidden\" id=\"part_pay_sms_send_message\">\n    \t<a class=\"message-close-link\">\n    \t\t<img src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" width=\"24\" height=\"24\" class=\"sprite message-close-link-img\">\n    \t<\/a>\n    \t\u0412\u0430\u043c \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e SMS \u0441 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0439 \u0441\u0443\u043c\u043c\u043e\u0439 \u043f\u043e \u0441\u0447\u0435\u0442\u0443\n    <\/div>\n<\/div>\n\n<script type=\"text\/javascript\">\n\tpartPayCheckReady();\n<\/script>\n\t\t\t\t\t<\/div>\n\t\t\t\t{\/if}\n\t\t\t<\/li>\n\t\t{\/for}\n\t<\/ul>\n\n\t{if data_record.getFromData(\u0027bottom_text\u0027)}\n\t\t<div class=\"credit-tab-instruction\">${data_record.getFromData(\u0027bottom_text\u0027)}<\/div>\n\t{\/if}\n\n<\/div>\n\n\n\n\n\n\n\n\n\n\t\t<\/div>\n\t{\/if}\n\t{if $defined(part_pay.records)}\n\t\t<div id=\"part_pay_tab_content\" class=\"hidden\">\n\t\t\t{var data_record = part_pay}\n\t\t\t<div class=\"credit-tab\">\n\t{if data_record.getFromData(\u0027top_text\u0027)}\n\t\t<h3 class=\"credit-tab-header\">${data_record.getFromData(\u0027top_text\u0027)}<\/h3>\n\t{\/if}\n\n\t<div class=\"credit-tab-info\">\n\t\t<span class=\"credit-tab-info-text\">\u041a\u0440\u0435\u0434\u0438\u0442 \u043e\u0444\u043e\u0440\u043c\u043b\u044f\u0435\u0442\u0441\u044f \u043d\u0430&nbsp;\u0431\u0435\u0437\u043d\u0430\u043b\u0438\u0447\u043d\u0443\u044e \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u0442\u043e\u0432\u0430\u0440{if !goods_id}\u043e\u0432{else}\u0430{\/if}&nbsp;&mdash;<\/span>\n\t\t<span class=\"bold ccredit-tab-info-price\">${data_record.getFirstRecord().getPrimaryDecimals(\u0027amount_of_loan\u0027)}\n\t\t\t<span class=\"normal credit-tab-info-price-unit\">${data_record.getFirstRecord().getPrimaryUnit(\u0027amount_of_loan\u0027)}<\/span>\n\t\t<\/span>\n\t<\/div>\n\n\t<ul class=\"credit-tab-tariff\">\n\t\t{for item in data_record.getRecords()}\n\t\t\t<li class=\"credit-tariff\">\n\t\t\t\t<div class=\"clearfix credit-tariff-row\">\n\t\t\t\t\t<div class=\"credit-tariff-b\">\n\t\t\t\t\t\t${data_record.getTitleBlock(item)}\n\t\t\t\t\t<\/div>\n\n\t\t\t\t\t<div class=\"credit-tariff-b\">\n\t\t\t\t\t\t${data_record.getDescriptionBlock(item)}\n\t\t\t\t\t<\/div>\n\n\t\t\t\t\t<div class=\"credit-tariff-b\">\n\t\t\t\t\t\t${data_record.getCostPerMonthBlock(item)}\n\n\t\t\t\t\t\t{if goods_id}\n\t\t\t\t\t\t\t<div class=\"credit-tariff-btn\" id=\"catalog_item${goods_id}\" name=\"catalog_item\">\n\t\t\t\t\t\t\t\t<form method=\"POST\" action=\"https:\/\/my.rozetka.com.ua\/cgi-bin\/form.php?r=https:\/\/my.rozetka.com.ua\/cart\/&action=buy\">\n\t\t\t\t\t\t\t\t\t<span class=\"btn-link btn-link-green\">\n\t\t\t\t\t\t\t\t\t\t<input type=\"hidden\" value=\"${goods_id}\" name=\"goods_id\">\n\t\t\t\t\t\t\t\t\t\t<input type=\"hidden\" value=\"${item.getPrimary().id}\" name=\"credit_id\">\n\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\tclass=\"btn-link-i\"\n\t\t\t\t\t\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\t\t\t\t\t\tname=\"topurchasesbycredit\"\n\t\t\t\t\t\t\t\t\t\t\tp_type=\"${item.getType()}\"\n\t\t\t\t\t\t\t\t\t\t\tp_count=\"${item.getNumberOfPayments(item.getPrimary().id)}\"\n\t\t\t\t\t\t\t\t\t\t\tm_count=\"${item.getNumberOfMonth(item.getPrimary().id)}\"\n\t\t\t\t\t\t\t\t\t\t\tcredit_id=\"${item.id}\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\u041a\u0443\u043f\u0438\u0442\u044c\n\t\t\t\t\t\t\t\t\t\t<\/button>\n\t\t\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t\t\t<\/form>\n\t\t\t\t\t\t\t<\/div>\n\n\t\t\t\t\t\t\t<script type=\"text\/javascript\">\n\t\t\t\t\t\t\t\tGoodsCatalog.add(${goods_id}, \u0027credit_popup\u0027);\n\t\t\t\t\t\t\t<\/script>\n\t\t\t\t\t\t{\/if}\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\n\t\t\t\t{if item.getPaymentNoticeText()}\n                    <div class=\"credit-tariff-notice\" name=\"payment_type_notice\">\n                        <span class=\"credit-tariff-notice-text\">\n                            ${item.getPaymentNoticeText()}\n                        <\/span>\n                    <\/div>\n                {\/if}\n\n\t\t\t\t{if data_record.type == \"part_pay\"}\n\t\t\t\t\t<div class=\"credit-tariff-row\">\n\t\t\t\t\t\t<div class=\"credit-available-amount\">\n\t<div id=\"limit-info-wrapper\">\n\t\t<div class=\"credit-available-amount-title\">\n        \t\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430, \u0447\u0442\u043e\u0431\u044b \u0443\u0437\u043d\u0430\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0443\u044e \u0441\u0443\u043c\u043c\u0443 \u0434\u043b\u044f \u043e\u043f\u043b\u0430\u0442\u044b \u0447\u0430\u0441\u0442\u044f\u043c\u0438\n\t\t<\/div>\n\t\t<form class=\"credit-available-amount-f\" id=\"phone-number-form\" role=\"form\">\n\t\t\t<div id=\"phone-wrapper\">\n\t\t\t\t<input type=\"tel\" class=\"input-text credit-available-amount-input credit-available-amount-placeholder\"\n\t\t\t\t\t   name=\"phone\" id=\"phone-input\" placeholder=\"+380\" value=\"+380\" maxlength=\"18\"\n\t\t\t\t\t   onfocus=\"this.removeClass(\u0027credit-available-amount-placeholder\u0027)\"\n\t\t\t\t>\n\t\t\t\t<span class=\"btn-link btn-link-gray credit-available-amount-btn\">\n\t\t\t\t\t<button type=\"submit\" class=\"btn-link-i\" id=\"phone-submit\">\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c<\/button>\n\t\t\t\t<\/span>\n\t\t\t<\/div>\n\t\t<\/form>\n\t<\/div>\n\t<div class=\"inline message code2 hidden\" id=\"part_pay_sms_send_message\">\n    \t<a class=\"message-close-link\">\n    \t\t<img src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" width=\"24\" height=\"24\" class=\"sprite message-close-link-img\">\n    \t<\/a>\n    \t\u0412\u0430\u043c \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e SMS \u0441 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0439 \u0441\u0443\u043c\u043c\u043e\u0439 \u043f\u043e \u0441\u0447\u0435\u0442\u0443\n    <\/div>\n<\/div>\n\n<script type=\"text\/javascript\">\n\tpartPayCheckReady();\n<\/script>\n\t\t\t\t\t<\/div>\n\t\t\t\t{\/if}\n\t\t\t<\/li>\n\t\t{\/for}\n\t<\/ul>\n\n\t{if data_record.getFromData(\u0027bottom_text\u0027)}\n\t\t<div class=\"credit-tab-instruction\">${data_record.getFromData(\u0027bottom_text\u0027)}<\/div>\n\t{\/if}\n\n<\/div>\n\n\n\n\n\n\n\n\n\n\t\t<\/div>\n\t{\/if}\n<\/div>\n\n\n'},templates:{credit:'\n<div id=\"title\">\n\t{if item.title}\n\t\t<h3 class=\"credit-tariff-title\">\n\t\t\t${item.title}\n\t\t<\/h3>\n\t{\/if}\n\t{var caption = item.getPrimary().caption}\n\t{if caption}\n\t\t<div class=\"credit-tariff-caption\">\n\t\t\t${caption}\n\t\t<\/div>\n\t{\/if}\n\t{if item.image}\n\t\t<div class=\"responsive-img credit-tariff-img\">\n\t\t\t${item.image}\n\t\t<\/div>\n\t{\/if}\n<\/div>\n<div id=\"bottom_description_single\">\n\t<div class=\"credit-tariff-term-info\">\n\t\t\u043d\u0430 ${item.getNumberOfMonth()}&nbsp;\u043c\u0435\u0441\u044f\u0446${item.getNumberOfMonth()|morphology:[\"\",\"\u0430\",\"\u0435\u0432\"]}&nbsp;\u0440\u0430\u0432\u043d\u044b\u043c\u0438 \u0447\u0430\u0441\u0442\u044f\u043c\u0438\n\t<\/div>\n<\/div>\n<div id=\"count_payment_block\">\n\t<span class=\"credit-tariff-payment-count\" name=\"count_payment_block\" pm_id=\"${item.id}\"><\/span>\n<\/div>\n<div id=\"connective_payments_month_block\">\n\t<span class=\"credit-tariff-merge-word\">\u043d\u0430<\/span>\n<\/div>\n{var count_month = item.getAllMonthVariant().length}\n<div id=\"count_month_block\">\n\t<div class=\"inline credit-tariff-month-selector\" name=\"count_month_block\" pm_id=\"${item.id}\" {if validation_attribute.name}${validation_attribute.name}=\"${validation_attribute.value}\"{\/if}>\n\t\t<div class=\"month-select\" name=\"select_block\" {if validation_attribute.name}${validation_attribute.name}=\"${validation_attribute.value}\"{\/if}>\n\t\t\t<a href=\"#\" class=\"sprite-side month-select-link\" name=\"drop_link\" pm_id=\"${item.id}\">0<\/a>\n\t\t\t<div class=\"popup-dropdown month-select-popup hidden {if count_month > 10}select-has-scrollbar{\/if}\" name=\"drop_block\">\n\t\t\t\t<ul class=\"month-select-l\">\n\t\t\t\t\t{for period in item.getAllMonthVariant()}\n\t\t\t\t\t\t<li class=\"month-select-l-i\" name=\"drop_element\" pm_id=\"${item.id}\" {if validation_attribute.name}${validation_attribute.name}=\"${validation_attribute.value}\"{\/if} data-value=\"${period}\">\n\t\t\t\t\t\t\t${period}\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t{\/for}\n\t\t\t\t<\/ul>\n\t\t\t<\/div>\n\t\t\t<input type=\"hidden\" data-title=\"\" disabled=\"disabled\">\n\t\t<\/div>\n\t<\/div>\n\t<div class=\"credit-tariff-month-declension\" name=\"count_month_text_block\" pm_id=\"${item.id}\"><\/div>\n<\/div>\n<div id=\"slider_content\">\n\t<div class=\"flex credit-tariff-month-slider\" name=\"slider\" pm_id=\"${item.id}\">\n\t\t<div class=\"credit-tariff-month-slider-btn\" name=\"knob\">\n\t\t\t<img src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" width=\"33\" height=\"33\" class=\"sprite credit-tariff-month-slider-btn-img\">\n\t\t<\/div>\n\t<\/div>\n<\/div>\n<div id=\"bottom_description_multi\">\n\t<div class=\"aligned-left credit-tariff-slider-scale\"\n\t\t name=\"bottom_description_multi\" pm_id=\"${item.id}\"><\/div>\n<\/div>\n<div id=\"cost_per_month_block\">\n\t<div class=\"credit-tariff-price\">\n\t\t<span class=\"credit-tariff-price-uah\" name=\"cost_per_month_decimal\" pm_id=\"${item.id}\">\n\t\t\t${item.getPrimaryDecimals(\"monthly_payment\")}\n\t\t<\/span>\n\t\t<span class=\"credit-tariff-price-unit\" name=\"cost_per_month_unit\" pm_id=\"${item.id}\">\n\t\t\t${item.getPrimaryUnit(\"monthly_payment\")}\n\t\t<\/span>\n\t\t<span class=\"credit-tariff-price-label\">\n\t\t\t\u0432 \u043c\u0435\u0441\u044f\u0446\n\t\t<\/span>\n\t\t<span class=\"credit-tariff-price-label-short\">\n\t\t\t\/\u043c\u0435\u0441\n\t\t<\/span>\n\t<\/div>\n<\/div>\n\n',part_pay:'\n<div id=\"title\">\n\t{if item.title}\n\t\t<h3 class=\"credit-tariff-title\">\n\t\t\t${item.title}\n\t\t<\/h3>\n\t{\/if}\n\t{var caption = item.getPrimary().caption}\n\t{if caption}\n\t\t<div class=\"credit-tariff-caption\">\n\t\t\t${caption}\n\t\t<\/div>\n\t{\/if}\n\t{if item.image}\n\t\t<div class=\"responsive-img credit-tariff-img\">\n\t\t\t${item.image}\n\t\t<\/div>\n\t{\/if}\n<\/div>\n<div id=\"bottom_description_single\">\n\t<div class=\"credit-tariff-term-info\">\n\t\t\u043d\u0430 ${item.getNumberOfMonth()}&nbsp;\u043c\u0435\u0441\u044f\u0446${item.getNumberOfMonth()|morphology:[\"\",\"\u0430\",\"\u0435\u0432\"]}&nbsp;\u0440\u0430\u0432\u043d\u044b\u043c\u0438 \u0447\u0430\u0441\u0442\u044f\u043c\u0438\n\t<\/div>\n<\/div>\n<div id=\"count_payment_block\">\n\t<span class=\"credit-tariff-payment-count\" name=\"count_payment_block\" pm_id=\"${item.id}\"><\/span>\n<\/div>\n<div id=\"connective_payments_month_block\">\n\t<span class=\"credit-tariff-merge-word\">\u043d\u0430<\/span>\n<\/div>\n{var count_month = item.getAllMonthVariant().length}\n<div id=\"count_month_block\">\n\t<div class=\"inline credit-tariff-month-selector\" name=\"count_month_block\" pm_id=\"${item.id}\" {if validation_attribute.name}${validation_attribute.name}=\"${validation_attribute.value}\"{\/if}>\n\t\t<div class=\"month-select\" name=\"select_block\" {if validation_attribute.name}${validation_attribute.name}=\"${validation_attribute.value}\"{\/if}>\n\t\t\t<a href=\"#\" class=\"sprite-side month-select-link\" name=\"drop_link\" pm_id=\"${item.id}\">0<\/a>\n\t\t\t<div class=\"popup-dropdown month-select-popup hidden {if count_month > 10}select-has-scrollbar{\/if}\" name=\"drop_block\">\n\t\t\t\t<ul class=\"month-select-l\">\n\t\t\t\t\t{for period in item.getAllMonthVariant()}\n\t\t\t\t\t\t<li class=\"month-select-l-i\" name=\"drop_element\" pm_id=\"${item.id}\" {if validation_attribute.name}${validation_attribute.name}=\"${validation_attribute.value}\"{\/if} data-value=\"${period}\">\n\t\t\t\t\t\t\t${period}\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t{\/for}\n\t\t\t\t<\/ul>\n\t\t\t<\/div>\n\t\t\t<input type=\"hidden\" data-title=\"\" disabled=\"disabled\">\n\t\t<\/div>\n\t<\/div>\n\t<div class=\"credit-tariff-month-declension\" name=\"count_month_text_block\" pm_id=\"${item.id}\"><\/div>\n<\/div>\n<div id=\"slider_content\">\n\t<div class=\"flex credit-tariff-month-slider\" name=\"slider\" pm_id=\"${item.id}\">\n\t\t<div class=\"credit-tariff-month-slider-btn\" name=\"knob\">\n\t\t\t<img src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" width=\"33\" height=\"33\" class=\"sprite credit-tariff-month-slider-btn-img\">\n\t\t<\/div>\n\t<\/div>\n<\/div>\n<div id=\"bottom_description_multi\">\n\t<div class=\"aligned-left credit-tariff-slider-scale\"\n\t\t name=\"bottom_description_multi\" pm_id=\"${item.id}\"><\/div>\n<\/div>\n<div id=\"cost_per_month_block\">\n\t<div class=\"credit-tariff-price\">\n\t\t<span class=\"credit-tariff-price-uah\" name=\"cost_per_month_decimal\" pm_id=\"${item.id}\">\n\t\t\t${item.getPrimaryDecimals(\"monthly_payment\")}\n\t\t<\/span>\n\t\t<span class=\"credit-tariff-price-unit\" name=\"cost_per_month_unit\" pm_id=\"${item.id}\">\n\t\t\t${item.getPrimaryUnit(\"monthly_payment\")}\n\t\t<\/span>\n\t\t<span class=\"credit-tariff-price-label\">\n\t\t\t\u0432 \u043c\u0435\u0441\u044f\u0446\n\t\t<\/span>\n\t\t<span class=\"credit-tariff-price-label-short\">\n\t\t\t\/\u043c\u0435\u0441\n\t\t<\/span>\n\t<\/div>\n<\/div>\n\n'},data_keys:['credit','part_pay'],popup_container:'credit_popup_container'},initialize:function(data,goods_id){this.attachToObserver(['CreditDataSliderStepChange','LoadTabCompleted']);if(!$defined(goods_id)){goods_id=0}if($defined(data)){this.data=data;this.data.goods_id=goods_id}if(Delivery.first_load){this.init()}document.addEvent('deliveryBlockLoaded',function(){this.init()}.bind(this))},init:function(){if(this._setAvailablePayments(Delivery.getAvailablePaymentsIds())){this.setActiveElements();this._setPopupContent()}this.is_popup_been_open=false},onLoadTabCompleted:function(){this.popup&&this.popup.close()},onCreditDataSliderStepChange:function(data){if(data&&data[0]&&data[0].record){var button=this.popup.content.getElements(this.options.selectors.buy.button).filter(function(elem){return elem.getAttribute('credit_id')==data[0].record.id}).pop(),selected_item=data[0].record.getSelectedChild(),parent_elem;if(button){parent_elem=button.parentNode.getElement(this.options.selectors.buy.credit_id);parent_elem.value=selected_item.id;button.setAttribute('m_count',data[0].record.getNumberOfMonth(selected_item.id));button.setAttribute('p_count',data[0].record.getNumberOfPayments(selected_item.id))}}},setActiveElements:function(){Object.values(this.options.selectors.blocks).each(function(block){if($E(block)){$E(block).getParent().show()}});Object.keys(this.options.selectors.open_blocks).each(function(key){var block=$E(this.options.selectors.open_blocks[key]);block&&block.removeEvents()&&block.addEvent('click',function(e){new Event(e).stop();this.openPopupWithInfoCredit(key)}.bind(this))}.bind(this))},_hasContent:function(name){return!!this.data[name]},initTabs:function(){this.tabs=new ActiveBlocks_class($(this.options.popup_container));Object.keys(this.options.selectors.tabs).each(function(tab_name){if(this._hasContent(tab_name)){var tab_data=this.options.selectors.tabs[tab_name];this.tabs.setBlock(this.popup.getElement(tab_data.tab_content),this.popup.getElement(tab_data.tab_href),tab_name).addOnFn(function(){this.popup.getElement(tab_data.tab_content).addClass('active')}.bind(this),function(){this.popup.getElement(tab_data.tab_content).removeClass('active')}.bind(this))}}.bind(this));this.tabs.addEvent('Show',function(block){this.fireEvent('LoadCreditDataContent',this.popup.content)}.bind(this))},activateTab:function(tab_name){this.tabs.display(tab_name);this.popup.CheckPos.change();var event_data={extend_event:[{name:'eventLabel',value:tab_name}]};event_data.extend_event.push({name:'goods_id',value:this.data.goods_id});document.fireEvent('clickToPurchasesCredit',event_data)},openPopupWithInfoCredit:function(key){if($defined(this.data)){if(!this.popup){this.popup=new Popup_class(this.options.popup.header_tpl);this._setPopupContent()}this.popup.open();if(!this.is_popup_been_open){this.initTabs();this.is_popup_been_open=true}this.activateTab(key)}},_getPopupData:function(){var result={goods_id:this.data.goods_id};this.options.data_keys.each(function(element){if(this.data[element]){this.data_objects[element]=this._getCreditDataObject(element);result[element]=this.data_objects[element]}else{result[element]={}}}.bind(this));return result},_getCreditDataObject:function(type){return new CreditData_class(this.data[type],type,{template:this.options.templates[type]})},_setPopupContent:function(){if(this.popup&&!this.popup.content){this.data.lengthCredits=this._getLength(this.data,'credit');this.popup.setContent(this.options.popup.info_tpl,this._getPopupData());this.popup.addEventOnce('open',function(){var scripts=this.popup.content.getElements('script'),buttons=this.popup.getElements(this.options.selectors.buy.button),check_limit_button=this.popup.getElement(this.options.selectors.check_limit.button),credit_tab_href=this.popup.getElement(this.options.selectors.tabs.credit.tab_href),part_pay_tab_href=this.popup.getElement(this.options.selectors.tabs.part_pay.tab_href);if(scripts.length){scripts.each(this._execute)}buttons.each(function(button){button.addEvent('click',this.fireByButtonEvent.bind(this))}.bind(this));check_limit_button&&check_limit_button.addEvent('click',this.fireCheckLimitEvent.bind(this));credit_tab_href&&credit_tab_href.addEvent('click',this.fireSwitchTabsEvent.bind(this,'tabCredit'));part_pay_tab_href&&part_pay_tab_href.addEvent('click',this.fireSwitchTabsEvent.bind(this,'tabPart_pay'))}.bind(this))}},fireSwitchTabsEvent:function(tab_name){var event_data={extend_event:[{name:'eventLabel',value:tab_name}]};document.fireEvent('clickToSwitchCreditPopupTabs',event_data)},fireCheckLimitEvent:function(){var selected_payment=this.data_objects.part_pay.getFirstRecord().getSelectedChild();document.fireEvent('sendPartPayCheckLimit',{extend_event:[{name:'eventContext',value:selected_payment.number_of_payments+'/'+selected_payment.number_of_month},{name:'goods_id',value:this.data.goods_id}]})},fireByButtonEvent:function(e){var target=e.target||e.srcElement,credit_id=target.getProperty('credit_id'),number_of_month=target.getProperty('m_count'),number_of_payments=target.getProperty('p_count'),payment_type=target.getProperty('p_type'),event_data={extend_event:[{name:'goods_id',value:this.data.goods_id}]},credit_record=this.data_objects[payment_type].searchRecord(credit_id);if(credit_record&&credit_record.getType()=='credit'){event_data.extend_event.push({name:'eventContext',value:credit_record.title})}else{event_data.extend_event.push({name:'eventContext',value:number_of_payments+'/'+number_of_month})}document.fireEvent('clickToPurchasesFromCreditPopup',event_data)},_execute:function(script){eval(script.innerHTML)},_getLength:function(data,name){var count=0;var each_data=(name&&data[name])?data[name]:data;for(var item in each_data)count++;return count},_setAvailablePayments:function(available){this.available_payments={};available=Object.values(available);if(this.data){this.options.data_keys.each(function(payment_type){if(this.data[payment_type]){Object.values(this.data[payment_type].records).each(function(elem){if(available.contains(elem.id)||!available.length){if(!this.available_payments[payment_type]){this.available_payments[payment_type]=[]}this.available_payments[payment_type].push(elem)}}.bind(this))}}.bind(this))}return!!Object.keys(this.available_payments.length)}});CreditPopup_class.implement(new Options,new Events);var RozetkaCreditSlider_class=new Class({_factor:100,_last_step:0,_pos:-1,slider:null,options:{values:[],default:0},getData:function(){return{range:false,snap:true,steps:(this.options.values.length-1)*this._factor,offset:0,wheel:true,mode:'horizontal'}},initialize:function(sliderObject,knobObject,options){this.setOptions(options);this.slider=new Slider(sliderObject,knobObject,this.getData());this.addEventToSlider();return this},setDefaultPosition:function(){this.setStep(this.options.default);if(this.slider.previousChange==this.slider.step){this.fireEvent('changeStep',this.options.default.toInt())}},setStep:function(step){this.slider.set(Math.round(step.toInt()*this._factor))},getStep:function(){return this._last_step},addEventToSlider:function(){this.slider.addEvent('onComplete',function(step){this.slider.set(Math.round(step.toInt()/this._factor)*this._factor)}.bind(this));this.slider.addEvent('onChange',function(step){if(typeof step!='undefined'){step=Math.round(step.toInt()/this._factor);if(this._last_step!=step){this._last_step=step;this.fireEvent('changeStep',step)}}}.bind(this));this.slider.addEvent('onTick',function(pos){if(pos||pos==0){this.slider.knob.setStyle('left',pos);if(this._pos!=pos){this._pos=pos;var step=this.slider.toStep(pos);this.slider.set(Math.round(step.toInt()/this._factor)*this._factor)}}}.bind(this))},isBroken:function(){return!this.slider.element.isVisible()},dropEvents:function(){this.slider.element.removeEvents();this.slider.knob.removeEvents()}});RozetkaCreditSlider_class.implement(new Events,new Options);var CreditRecord_class=new Class({Class:'CreditRecord_class',title:null,id:null,name:null,order:null,image:null,children:{},ordered_children:[],data_object:null,descriptions:{},selected_by_user:null,initialize:function(data,data_object){this.title=data.title;this.id=data.id;this.name=data.id;this.order=data.order;this.image=data.image;this.children=data.children;this.data_object=data_object;this.descriptions=data.descriptions;this._orderChildren()},getType:function(){return this.data_object.type},getSelectedChild:function(){var result,slider_step,active_children=this.getChildren();if(active_children.length==1){result=active_children.getLast()}else if(!this.isDisable()&&this.data_object.sliders[this.id]){slider_step=this.data_object.sliders[this.id].getStep();result=active_children[slider_step]}return result},isDisable:function(){return!this.getChildren().length},enable:function(id){if(this.getChildById(id)){this.getChildById(id).is_disable=false}},disable:function(id){if(this.getChildById(id)){this.getChildById(id).is_disable=true}},getCountVariants:function(){return this.getChildren().length},getChildrenIds:function(all){return this.getChildren(all).map(function(child){return child.id.toInt()})},getChildren:function(all){return all?this.ordered_children:this.ordered_children.filter(function(child){return!child.is_disable})},getOrder:function(){return this.order||0},_orderChildren:function(){this.ordered_children=Object.values(this.children).sort(function(a,b){return(a.number_of_month-b.number_of_month)})},getPrimary:function(all){var result=this.selected_by_user,children;if(!result||result.is_disable){children=this.getChildren(all).clone().sort(function(a,b){return(a.order-b.order)||(a.id-b.id)});result=children.shift()}return result},setUserChoice:function(id){if(this.getChildById(id)){this.selected_by_user=this.getChildById(id)}},_correctId:function(id){if(!id&&this.getCountVariants()){id=this.getChildrenIds().getLast()}else if(!id){id=this.id}return id},_getProperty:function(path,id){var result;id=this._correctId(id);result=this.children[id];path.each(function(key){if(result){result=result[key]}}.bind(this));return result},getPrimaryDecimals:function(type,id){return this._getProperty((type+'.primary.decimals').split('.'),id)},getPrimaryUnit:function(type,id){return this._getProperty((type+'.primary.unit').split('.'),id)},getNumberOfMonth:function(id){return this._getProperty(['number_of_month'],id)},getNumberOfPayments:function(id){return this._getProperty(['number_of_payments'],id)},getAllMonthVariant:function(){return this.getChildren().map(function(child){return child.number_of_month.toInt()})},getChildById:function(id){return this.children[id]},getPaymentNoticeText:function(){return this.descriptions['payment_notice_text']}});var CreditData_class=new Class({Class:'CreditData_class',data:null,type:null,sliders:{},options:{records_data_key:'grouped_records',validation_attribute:{name:null,value:null},template:'',containers:{title:'[id=title]',count_payment_block:'[id=count_payment_block]',count_month_block:'[id=count_month_block]',connective_payments_month_block:'[id=connective_payments_month_block]',slider_content:'[id=slider_content]',bottom_description_multi:'[id=bottom_description_multi]',bottom_description_single:'[id=bottom_description_single]',cost_per_month_block:'[id=cost_per_month_block]'},selectors:{count_payment_block:'[name=count_payment_block]',count_month_block:'[name=drop_link]',count_month_menu_block:'[name=count_month_block]',count_month_text_block:'[name=count_month_text_block]',bottom_description_multi:'[name=bottom_description_multi]',cost_per_month_decimal:'[name=cost_per_month_decimal]',cost_per_month_unit:'[name=cost_per_month_unit]',count_month_drop_block:'[name=drop_block]',count_month_drop_element:'[name=drop_element]',description_block:''},slider:{selector:'[name=slider]',knob:'[name=knob]',scale:{scale_width:296,scale_width_if_max:308,elem_width:13,max_variants:24,max_elements_on_scale:12,css:{if_max:'slider-scale-on-24-item',children:'credit-tariff-slider-scale-i',first_last_children:'scale-item-marker'}}}},records_html:{},records:{},ordered_records:[],container:null,_changed:false,initialize:function(data,type,options){this.init();this.setOptions(options);this.attachToObserver(['LoadCreditDataContent']);this.data=data;this.type=type;this._initRecords();this._initContent()},init:function(){this.records_html={};this.records={};this.ordered_records=[];this.sliders={};this.type=null;this.data=null},_initContent:function(){this.getRecords().each(function(record){var content=document.createElement('div');content.setHTML(App.getHTML(this.options.template,{item:record,validation_attribute:this.options.validation_attribute}));this.records_html[record.id]=content}.bind(this))},_initRecords:function(){Object.values(this.data[this.options.records_data_key]).each(function(records_data){var record=new CreditRecord_class(records_data,this);this.records[record.id]=record}.bind(this));this.ordered_records=Object.values(this.records).sort(function(a,b){return(a.getOrder()-b.getOrder())||(a.id-b.id)})},getTitleBlock:function(record){return this._getHTML(record,this.options.containers.title)},getDescriptionBlock:function(record){var slider_content='',top_content='',bottom_content,content;if(record.getCountVariants()>1){top_content=this.getTopDescriptionContent(record);slider_content=this.getSliderContent(record)}bottom_content=this.getBottomDescriptionContent(record);content=top_content+slider_content+bottom_content;return content},getCostPerMonthBlock:function(record){return this._getHTML(record,this.options.containers.cost_per_month_block)},getTopDescriptionContent:function(record){var result='',count_payment_bock,count_month_block,connective_block;if(record.getCountVariants()>1){count_payment_bock=this._getHTML(record,this.options.containers.count_payment_block);count_month_block=this._getHTML(record,this.options.containers.count_month_block);connective_block=this._getHTML(record,this.options.containers.connective_payments_month_block);result=count_payment_bock+connective_block+count_month_block}return result},getSliderContent:function(record){var result='';if(record.getCountVariants()>1){result=this._getHTML(record,this.options.containers.slider_content)}return result},getBottomDescriptionContent:function(record){var result,i,elem,scale_items,container,width_between_elems;if(record.getCountVariants()>1){container=this._getHTMLContainer(record,this.options.containers.bottom_description_multi);scale_items=this._getScaleElements(record);width_between_elems=this._getWidthBetweenScaleElements(record,scale_items.length);for(i=0;i<scale_items.length;i++){elem=document.createElement('span');elem.innerHTML=scale_items[i];elem.setStyle('left',Math.round(i*(width_between_elems+this.options.slider.scale.elem_width)));container.getChildren().pop().appendChild(elem)}this._addClassesToScaleElem(container.getChildren().pop(),record);result=container.innerHTML}else{result=this._getHTML(record,this.options.containers.bottom_description_single)}return result},_addClassesToScaleElem:function(container,record){container.setStyle('width',this._getScaleWidth(record));if(record.getAllMonthVariant().length==this.options.slider.scale.max_variants){container.addClass(this.options.slider.scale.css.if_max);container.getChildren().each(function(elem){if(elem==container.getChildren().pop()||elem==container.getChildren()[0]||elem==container.getChildren()[(container.getChildren().length-1)/2]){elem.addClass(this.options.slider.scale.css.first_last_children)}}.bind(this))}container.getChildren().each(function(elem){elem.addClass(this.options.slider.scale.css.children)}.bind(this))},_getScaleWidth:function(record){var scale_width;if(record.getAllMonthVariant().length==this.options.slider.scale.max_variants){scale_width=this.options.slider.scale.scale_width_if_max}else{scale_width=this.options.slider.scale.scale_width}return scale_width},_getWidthBetweenScaleElements:function(record,count_items){return(this._getScaleWidth(record)-count_items*this.options.slider.scale.elem_width)/(count_items-1)},_getScaleElements:function(record){var result=[];if(record.getAllMonthVariant().length<=this.options.slider.scale.max_elements_on_scale){result=record.getAllMonthVariant()}else if(record.getAllMonthVariant().length==this.options.slider.scale.max_variants){result.push(record.getAllMonthVariant().min());record.getAllMonthVariant().each(function(elem,i){!(elem%3)&&result.push(elem)})}else{result.push(record.getAllMonthVariant().min());result.push(record.getAllMonthVariant().max())}return result},onLoadCreditDataContent:function(container){if(container&&container[0]&&this._validateContainer(container[0])){this.container=container[0];this.hasChanges()&&this._reInit();this.fireEvent('LoadTabContent',this.container);this._initSliders();this._initDescriptionBlockEvents();this._changed=false}},_validateContainer:function(container){var result=true,data=this.options.validation_attribute;if(!container.isVisible()||(data.name&&container.getAttribute(data.name)!=data.value)){result=false}return result},_reInit:function(){this._initContent();this._updateDescriptionBlocks();return true},_updateDescriptionBlocks:function(){if(this.options.selectors.description_block){this.getRecords().each(function(record){this._setHTML(this._getBlockByContainer(this.container,this.options.selectors.description_block,record),this.getDescriptionBlock(record))}.bind(this))}},_initSliders:function(){var knob_container,data,record,pm_id,sliders=this.container.getElements(this.options.slider.selector);sliders.each(function(slider_container){knob_container=slider_container.getElement(this.options.slider.knob);pm_id=slider_container.getAttribute('pm_id');record=this.getRecordById(pm_id);if(this._canInitSlider(record,slider_container)){this.sliders[record.id]&&this.sliders[record.id].dropEvents();data={values:record.getAllMonthVariant(),default:record.getChildrenIds().indexOf(record.getPrimary().id)};this.sliders[record.id]=new RozetkaCreditSlider_class(slider_container,knob_container,data);this.sliders[record.id].addEvent('changeStep',this._onSliderStepChange.bind(this,record,this.container));this.sliders[record.id].setDefaultPosition()}}.bind(this))},_canInitSlider:function(record,slider_container){return slider_container.isVisible()&&record&&!record.isDisable()&&(record.getCountVariants()>1)&&(!this.sliders[record.id]||this.sliders[record.id].isBroken()||this.hasChanges())},_initDescriptionBlockEvents:function(){document.addEvent('dropSelectElement',this._onSelectMonthChange.bind(this));document.getElements(this.options.slider.knob).each(function(elem){elem.addEvent('mousedown',function(){$$(this.options.selectors.count_month_drop_block).each(function(drop_elem){drop_elem.addClass('hidden')}.bind(this))}.bind(this))}.bind(this))},_onSelectMonthChange:function(container){if(container&&this._validateContainer(container.target)){var pm_id=container.target.getAttribute('pm_id'),value=container.target.getAttribute('data-value'),record=this.getRecordById(pm_id),values;if(record){values=record.getAllMonthVariant();this.sliders[pm_id].setStep(values.indexOf(value.toInt()))}}},_onSliderStepChange:function(record,container,step){if(this.getRecordById(record.id)&&this._validateContainer(container)){var credits_ids=record.getChildrenIds(),selected_credit_id=credits_ids[step],credit_data=record.getChildById(selected_credit_id),extend_event={record:record,container:container,validation_attribute:this.options.validation_attribute,data_object:this};credit_data&&this._updateHTMLOnUsersActions(container,record,credit_data);credit_data&&this.fireEvent('CreditDataSliderStepChange',extend_event)}},_updateHTMLOnUsersActions:function(container,record,credit_data){this._updatePaymentsBlock(container,record,credit_data);this._updateCostsBlock(container,record,credit_data)},_updatePaymentsBlock:function(container,record,credit_data){this._setHTML(this._getBlockByContainer(container,this.options.selectors.count_payment_block,record),credit_data.number_of_payments+'&nbsp'+credit_data.number_of_payments_text);this._setHTML(this._getBlockByContainer(container,this.options.selectors.count_month_block,record),credit_data.number_of_month);this._setHTML(this._getBlockByContainer(container,this.options.selectors.count_month_text_block,record),credit_data.number_of_month_text);this._getBlocksByContainer(container,this.options.selectors.count_month_drop_element,record).each(function(elem){if(elem.getAttribute('data-value')==credit_data.number_of_month){elem.addClass('active')}else{elem.removeClass('active')}})},_updateCostsBlock:function(container,record,credit_data){this._setHTML(this._getBlockByContainer(container,this.options.selectors.cost_per_month_decimal,record),credit_data.monthly_payment.primary.decimals);this._setHTML(this._getBlockByContainer(container,this.options.selectors.cost_per_month_unit,record),credit_data.monthly_payment.primary.unit)},_getBlocksByContainer:function(container,block,record){return container.getElements(block).filter(function(element){return element.getAttribute('pm_id')==record.id})},_getBlockByContainer:function(container,block,record){return this._getBlocksByContainer(container,block,record).pop()},getRecords:function(all){return(all)?this.ordered_records:this.ordered_records.filter(function(record){return!record.isDisable()})},getRecordHtmlById:function(record_id){return this.records_html[record_id]},_getHTMLContainer:function(record,element_selector){var record_html=this.getRecordHtmlById(record.id);return record_html&&record_html.getElement(element_selector)},_getHTML:function(record,element_selector){var result='';if(this._getHTMLContainer(record,element_selector)){result=this._getHTMLContainer(record,element_selector).innerHTML}return result},_setHTML:function(block,data){block&&data&&block.setHTML(data)},getRecordById:function(id){return this.records[id]},getFirstRecord:function(){var records=this.getRecords(),result=null;if(records.length){result=records[0]}return result},searchRecord:function(id){id=id.toInt();var result=this.getRecordById(id);if(!result){result=Object.values(this.records).filter(function(record){return record.getChildrenIds(true).indexOf(id)>=0}).pop()}return result},getFromData:function(key){return this.data[key]},updateMonthlyPayment:function(record_id,monthly_payment){var record=this.searchRecord(record_id);if(record&&record.getChildById(record_id)){record.getChildById(record_id).monthly_payment=monthly_payment;this._initContent();this.container&&this._updateCostsBlock(this.container,record,record.getChildById(record_id))}},disablePaymentById:function(id){if(this.searchRecord(id)){this.searchRecord(id).disable(id);this.setAsChanged()}},enablePaymentById:function(id){if(this.searchRecord(id)){this.searchRecord(id).enable(id);this.setAsChanged()}},hasChanges:function(){return!!this._changed},setAsChanged:function(){this._changed=true},setUserChoice:function(id){this.searchRecord(id)&&this.searchRecord(id).setUserChoice(id)}});CreditData_class.implement(new Options(),new Events());var FeedbackPopup=Popup_class.extend({_onOpen:function(){this.parent();this.form.getFormElements().each(function(el){if(['text','textarea','password','select-one','select-multiple'].contains(el.type)){el.setStyles({'background-color':''})}})},_onClose:function(){if(this.msg){this.msg.innerHTML=''}if(this._overlay){this._overlay.hide()}if(this.CheckPos){this.CheckPos.stop()}if(this.options.closeOnCOS){$(document.body).removeEvent('click',this._closePopup)}}});var RozetkaFeedBack=new Class({_popup:null,_if_went_through_problem_order:null,_is_show_popup:false,groups:null,options:{popup_template:'<div class=\"popup-css popup-feedback\">\n\t<a href=\"#\" class=\"popup-close\" name=\"close\"><img width=\"18\" height=\"18\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"&times;\" class=\"popup-close-medium-icon sprite\"><\/a>\n\t<div name=\"content\"><\/div>\n<\/div>',message_pattern:'\r\n<h2 class=\"feedback-title\">\u041e\u0431\u0440\u0430\u0442\u043d\u0430\u044f \u0441\u0432\u044f\u0437\u044c<\/h2>\r\n<div id=\"app-message\" name=\"app-message\"><\/div>\r\n<form class=\"feedback-form\" id=\"sendform\" method=\"POST\" action= \u0027\/cgi-bin\/form.php?r=http:\/\/rozetka.com.ua\/feedback\/&action=Feedback\u0027>\r\n\t<div class=\"feedback-form-note\">\u041f\u0438\u0441\u044c\u043c\u043e \u0431\u0443\u0434\u0435\u0442 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e \u0432&nbsp;\u0441\u043b\u0443\u0436\u0431\u0443 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0438. \u041c\u044b&nbsp;\u043f\u0440\u0438\u043b\u043e\u0436\u0438\u043c \u0432\u0441\u0435 \u0443\u0441\u0438\u043b\u0438\u044f \u0434\u043b\u044f \u0442\u043e\u0433\u043e, \u0447\u0442\u043e\u0431\u044b \u043e\u0442\u0432\u0435\u0442\u0438\u0442\u044c \u0432\u0430\u043c \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u0431\u044b\u0441\u0442\u0440\u043e.<\/div>\r\n\t<div class=\"feedback-form-i feedback-form-i-radio clearfix\">\r\n\t\t<div class=\"feedback-form-i-title\">\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u0442\u0434\u0435\u043b \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u0430:<\/div>\r\n\t\t<div class=\"feedback-form-i-field\">\r\n\t\t\t{for record in request_types.cause_of_treatment}\r\n\t\t\t\t{if record.is_section == 1}\r\n\t\t\t\t\t<div class=\"field-radio\">\r\n\t\t\t\t\t\t<label class=\"label-input-radio\">\r\n\t\t\t\t\t\t\t<input type=\"radio\" value=\"${record.id}\" name=\"group\" class=\"input-radio\">\r\n\t\t\t\t\t\t\t<div class=\"input-check-radio-inner\">${record.title}<\/div>\r\n\t\t\t\t\t\t<\/label>\r\n\t\t\t\t\t<\/div>\r\n\t\t\t\t{\/if}\r\n\t\t\t{\/for}\r\n\t\t<\/div>\r\n\t<\/div>\r\n\r\n\t<div class=\"feedback-form-i clearfix\">\r\n\t\t<div class=\"feedback-form-i-title\">\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u043f\u0440\u0438\u0447\u0438\u043d\u0443 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u044f:<\/div>\r\n\t\t<div class=\"feedback-form-i-field\">\r\n\t\t\t<select id=\"cause_problem\" class=\"input-text input-select\" name=\"cause\">\r\n\t\t\t\t<option __with_additional_field=\"0\" value=\"0\"><\/option>\r\n\t\t\t\t{for record in request_types.cause_of_treatment}\r\n\t\t\t\t\t{if record.is_section == 0}\r\n\t\t\t\t\t\t<option __with_additional_field=\"${record.problem_order}\" value=\"${record.id}\" name=\"parent_id_${record.parent_id}\">${record.title}<\/option>\r\n\t\t\t\t\t{\/if}\r\n\t\t\t\t{\/for}\r\n\t\t\t<\/select>\r\n\t\t<\/div>\r\n\t<\/div>\r\n\t<div class=\"feedback-form-i-question auth-message\" id=\"form_question\" style=\"display:none\">\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043d\u0430\u0438\u0431\u043e\u043b\u0435\u0435 \u0442\u043e\u0447\u043d\u0443\u044e \u043f\u0440\u0438\u0447\u0438\u043d\u0443 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u044f, \u043e\u0442&nbsp;\u044d\u0442\u043e\u0433\u043e \u0437\u0430\u0432\u0438\u0441\u0438\u0442 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0432\u0430\u0448\u0435\u0439 \u0437\u0430\u044f\u0432\u043a\u0438<\/div>\r\n\t<div class=\"feedback-form-i clearfix\" id=\"order_number\">\r\n\t\t<div class=\"feedback-form-i-title\">\u041d\u043e\u043c\u0435\u0440 \u0432\u0430\u0448\u0435\u0433\u043e \u0437\u0430\u043a\u0430\u0437\u0430:<\/div>\r\n\t\t<div class=\"feedback-form-i-field\"><span class=\"num-symbol\">\u2116<\/span><input pattern=\"[0-9]*\" class=\"input-text order-number\" name=\"order_number\" type=\"text\"><\/div>\r\n\t<\/div>\r\n\t<div class=\"feedback-form-i feedback-form-i-textarea clearfix\">\r\n\t\t<label class=\"feedback-form-i-title\" for=\"message\">\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435:<\/label>\r\n\t\t<textarea _required=\"1\" class=\"input-textarea\" name=\"message\"><\/textarea>\r\n\t<\/div>\n\t<div class=\"feedback-form-i clearfix\">\n\t\t<div class=\"feedback-form-i-title\">\u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u044c\u0442\u0435\u0441\u044c, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430:<\/div>\n\t\t<div class=\"feedback-form-i-field\"><input _required=\"1\" class=\"input-text\" name=\"fio\" type=\"text\" value=\"${fio}\" pattern=\"^[\\\u0027\\u0022\\(\\)A-Za-z\u0410-\u042f\u0430-\u044f\u0456\u0457\u0451\u0454\u0406\u0407\u0401\u0404\\d\\.\\s_-]{2,50}$\"><\/div>\n\t<\/div>\n\t<div class=\"feedback-form-i clearfix\">\n\t\t<div class=\"feedback-form-i-title\">\u042d\u043b. \u043f\u043e\u0447\u0442\u0430 \u0434\u043b\u044f \u043e\u0442\u0432\u0435\u0442\u0430:<\/div>\n\t\t<div class=\"feedback-form-i-field\"><input pattern=\"^[_A-Za-z0-9-]+(\\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\\.[A-Za-z0-9-]+)*(\\.[A-Za-z0-9]{2,15})$\" _required=\"1\" class=\"input-text\" name=\"contact\" type=\"text\" value=\"${email}\"><\/div>\r\n\t<\/div>\r\n\t<div class=\"feedback-form-i clearfix\">\r\n\t\t<div class=\"feedback-form-i-field\">\r\n\t\t\t<div class=\"btn-link btn-link-blue feedback-form-btn\">\r\n\t\t\t\t<button class=\"btn-link-i\" type=\"submit\">\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435<\/button>\r\n\t\t\t<\/div>\r\n\t\t\t<div class=\"feedback-form-msg\" id=\"form_msg\" style=\"display:none\">\u041d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d \u043e\u0442\u0434\u0435\u043b \u0438 \u043f\u0440\u0438\u0447\u0438\u043d\u0430 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u044f<\/div>\r\n\t\t<\/div>\r\n\t<\/div>\r\n<\/form>',popup_template_on_send:'<div class=\"popup-css popup-feedback-msg\">\n\t<div name=\"content\"><\/div>\n<\/div>',message_pattern_on_send:'<div class=\"app-message\">\n<a href=\"\" class=\"message-close-link\" onclick=\"clearUserMessages(event);\">\n\t<img src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" width=\"24\" height=\"24\" class=\"sprite message-close-link-img\">\n<\/a>\n<h3 class=\"feedback-msg-title\">\u041e\u0431\u0440\u0430\u0442\u043d\u0430\u044f \u0441\u0432\u044f\u0437\u044c<\/h3>\n<h2 class=\"sprite-side feedback-msg-status\">\u0421\u043f\u0430\u0441\u0438\u0431\u043e, {if typeof fio != \u0027undefined\u0027}${fio}, {\/if}\u0432\u0430\u0448\u0430 \u0437\u0430\u044f\u0432\u043a\u0430 \u043f\u0440\u0438\u043d\u044f\u0442\u0430<\/h2>\n<p class=\"feedback-msg-note\">\u041c\u044b&nbsp;\u0441\u0432\u044f\u0436\u0435\u043c\u0441\u044f \u0441&nbsp;\u0432\u0430\u043c\u0438 \u0432&nbsp;\u0431\u043b\u0438\u0436\u0430\u0439\u0448\u0435\u0435 \u0432\u0440\u0435\u043c\u044f<\/p>\n\n<div name=\"close\" class=\"aligned-center\">\n    <span class=\"btn-link btn-link-blue feedback-msg-submit\">\n        <button type=\"submit\" class=\"btn-link-i\">\u041e\u041a<\/button>\n    <\/span>\n<\/div>\n<\/div>',submit_checked_class:'field-submit-checked',submit_unchecked_class:'field-submit',href_problem_with_order:{id:"problem_with_order"},href_feedback:{id:"feedback"},order_number:{id:"order_number"},cause_problem:{id:"cause_problem"},div_popup_container:{id:"feedback_container"},form:{id:"sendform"},form_msg:{id:"form_msg"},form_question:{id:"form_question"}},initialize:function(request_types){this.select_problem=$(this.options.cause_problem.id);this.div_order_number=$(this.options.order_number.id);this.problem_with_order=$(this.options.href_problem_with_order.id);this.feedback=$(this.options.href_feedback.id);this.form=null;this.pElem=$(this.options.div_popup_container);this.groups=[];if(request_types){this.request_types=request_types;this.problem_with_order.addEvent('click',function(e){this._if_went_through_problem_order=true;this.onShowPopup(e,this._if_went_through_problem_order)}.bind(this));this.feedback.addEvent('click',function(e){this._if_went_through_problem_order=false;this.onShowPopup(e,this._if_went_through_problem_order)}.bind(this))}else{this._if_went_through_problem_order=true;if(window.location.pathname.test('feedback')){this._if_went_through_problem_order=false}this._trackEvent('form-open');this.form=$(this.options.form.id);this.form.addEvent('submit',this._onSubmit.bind(this));$$('[name=group]').each(function(el){el.addEvent('change',this.showQuestions.bind(this))}.bind(this));this.select_problem.addEvent('change',function(e){this._trackEvent('reason-'+this.select_problem.options[this.select_problem.selectedIndex].innerHTML);this.showOrderNumber();this._checkQuestion()}.bind(this))}if(this.form){this.prepareQuestions()}},getPopup:function(){if(this._popup==null){document.addEvent('loadS',function(e){if(typeof this._popup!='object'||!this._popup.isOpened()){this._setPopupContent();this._clearPopup()}}.bind(this));this._popup=new FeedbackPopup(this.options.popup_template,this.pElem);popup_property={styles:{'z-index':150}};this._popup._overlay=new Overlay_class(popup_property);this._setPopupContent();this._popup.open();this.form=$(this.options.form.id);this.form.addEvent('submit',this._onSubmit.bind(this));this.select_problem=$(this.options.cause_problem.id);this.div_order_number=$(this.options.order_number.id);this.submit=this._popup.getElement('[type=submit]')}else{App.msg_block?App.msg_block.clear():''}return this._popup},onActionComplete:function(resp){this.form.processStop();var response=new Response_class(resp);if(response.isDone()){this._trackEvent('success-form-send');var popup=new Popup_class(this.options.popup_template_on_send,this.pElem);var message=App.getHTML(this.options.message_pattern_on_send,{fio:App.htmlSpecialChars(this.form.fio.value)});this.form.reset();popup.setContent(message);popup.open()}else{this._trackEvent('unsuccess-form-send-'+response.Message);App.showMessage(response.Message)}},_setupDefaultFields:function(is_problem_with_order){var select=this.getPopup().form.getElementById(this.options.cause_problem.id);if(is_problem_with_order){select.getElement('option[__with_additional_field=1]').selected='select'}else{select.getElement('option[value=0]').selected='select'}select.fireEvent('change')},onShowPopup:function(e,is_problem_with_order){this._trackEvent('form-open');new Event(e).stop();popup=this.getPopup();popup.open();if(is_problem_with_order){select_options=this.select_problem.options;for(var i=0;i<this.select_problem.options.length;i++){var elem_options=select_options[i];if(elem_options.getAttribute('__with_additional_field')==1){var parent_id=elem_options.getAttribute('name').replace(new RegExp("parent_id_(\\d+)"),"$1");this.form.getElements('[name=group]').each(function(el){if(el.value==parent_id){el.checked=true}});elem_options.selected='select'}}}this.showOrderNumber();if(!this._is_show_popup){this._is_show_popup=true;this.select_problem.addEvent('change',function(e){this._trackEvent('reason-'+this.select_problem.options[this.select_problem.selectedIndex].innerHTML);this._checkQuestion();this.showOrderNumber()}.bind(this));this.prepareQuestions();this.form.getElements('[name=group]').each(function(el){el.addEvent('change',this.showQuestions.bind(this))}.bind(this))}this.showQuestions();this._setupDefaultFields(is_problem_with_order)},showOrderNumber:function(){if(this.select_problem.options[this.select_problem.selectedIndex].getAttribute('__with_additional_field')==1){this.div_order_number.style.display=''}else{this.div_order_number.style.display='none'}},_trackEvent:function(action){rozetkaEvents.trackEvent('Forms',this._if_went_through_problem_order?'order-problem':'feedback',action)},_setPopupContent:function(){var popup_message=App.getHTML(this.options.message_pattern,{fio:User.getTitle(),email:User.getEmail(),request_types:this.request_types});this._popup.setContent(popup_message,{})},_onSubmit:function(e){new Event(e).stop();this._trackEvent('submit-click');if(!this._checkForm()||!this.form.trySend({onComplete:this.onActionComplete.bind(this)})){this._trackEvent('unsuccess-form-send-  ')}},_clearPopup:function(){this._popup=null;this._is_show_popup=false},prepareQuestions:function(){var element=null,exist=false,selected_name='';while(typeof(this.select_problem.options[1])!='undefined'&&this.select_problem.options[1]){selected_name=this.select_problem.options[1].getAttribute('name');if(typeof(this.groups[selected_name])=='undefined'){this.groups[selected_name]=new Array()}for(element in this.groups[selected_name]){if(this.groups[selected_name].hasOwnProperty(element)){if(this.groups[selected_name][element].value===this.select_problem.options[1].value){exist=true;break}}}if(!exist){this.groups[selected_name].push(this.select_problem.options[1])}this.select_problem.options[1]=null;exist=false}this.showQuestions()},showQuestions:function(e){var value_id=null;if(typeof(e)=='object'&&e.target){value_id=e.target.value}else{this.form.getElements('[name=group]').each(function(el){if(el.checked==true){value_id=el.value}})}while(typeof(this.select_problem.options[1])!='undefined'&&this.select_problem.options[1]){this.select_problem.options[1]=null}if(value_id){var group_length=this.groups['parent_id_'+value_id].length;for(var i=0;i<group_length;i++){this.select_problem.options.add(this.groups['parent_id_'+value_id][i])}}if(this.select_problem.options.length>1){this.select_problem.disabled=false}else{this.select_problem.disabled=true}this.showOrderNumber();this._checkForm()},_checkForm:function(){var is_checked=false;if(this.form!=null){var form_msg=this.form.getElementById(this.options.form_msg.id);var groups=this.form.getElements('[name=group]')}else{var form_msg=$(this.options.form_msg.id);var groups=$$('[name=group]')}groups.each(function(el){if(el.checked==true){is_checked=true}});if(is_checked){form_msg.style.display='none';is_checked=this._checkQuestion()}else{form_msg.style.display=''}return is_checked},_checkQuestion:function(){var is_checked=false;if(this.form!=null){var form_question=this.form.getElementById(this.options.form_question.id)}else{var form_question=$(this.options.form_question.id)}if(this.select_problem.options.selectedIndex!=0){form_question.style.display='none';is_checked=true}else{form_question.style.display=''}this._checkSubmitButtonClass(is_checked);return is_checked},_checkSubmitButtonClass:function(is_checked){var submit=this.form.getElement('[type=submit]');if(is_checked){var add_class=this.options.submit_checked_class;var rem_class=this.options.submit_unchecked_class}else{var add_class=this.options.submit_unchecked_class;var rem_class=this.options.submit_checked_class}if(submit.hasClass(rem_class)){submit.removeClass(rem_class)}if(!submit.hasClass(add_class)){submit.addClass(add_class)}}});var OAuth2Inform_class=new Class({ACTION:{NEW_USER:1,EXISTING_USER:2,NEED_USER_EMAIL:3,EXISTING_EMAIL:4},popup:null,oauth:null,type:null,options:{popup_class:Popup_class,popup_tpl:'<div class=\"popup-css\">\n\t<a href=\"#\" class=\"popup-close\" name=\"close\"><img width=\"18\" height=\"18\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"&times;\" class=\"popup-close-medium-icon sprite\"><\/a>\n\t<div class=\"auth-new\" name=\"content\"><\/div>\n<\/div>',tpl:{'signin':'<div class=\"auth-social-wrap\">\n\t{if typeof title != \u0027undefined\u0027}<h3 class=\"auth-title\">\u0412\u044b \u0432\u043e\u0448\u043b\u0438 \u043a\u0430\u043a ${title}<\/h3>{\/if}\n\t<form method=\"post\" action=\"\/cgi-bin\/form.php\" name=\"submit-by-ajax\">\n\t\t<div class=\"auth-f-i f-i1\">\n\t\t\t<div class=\"auth-f-i-title\">\u042d\u043b. \u043f\u043e\u0447\u0442\u0430<\/div>\n\t\t\t<input class=\"input-text auth-input-text\" type=\"text\" name=\"login\" {if typeof email != \u0027undefined\u0027}value=\"${email}\"{\/if}>\n\t\t\t<div class=\"auth-message msg\" name=\"msg\">\n\t\t\t\t{if typeof email != \u0027undefined\u0027}\n\t\t\t\t\t<p class=\"auth-message-text\">\n\t\t\t\t\t\t\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0441 \u0430\u0434\u0440\u0435\u0441\u0441\u043e\u043c ${email} \u0443\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d \u043d\u0430 \u0420\u043e\u0437\u0435\u0442\u043a\u0435.<br>\n\t\t\t\t\t\t\u0415\u0441\u043b\u0438 \u044d\u0442\u043e \u0432\u044b - \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c.\n\t\t\t\t\t<\/p>\n\t\t\t\t{\/if}\n\t\t\t<\/div>\n\t\t<\/div>\n\t\t<div class=\"auth-f-i f-i\">\n\t\t\t<div class=\"auth-f-i-title\">\u041f\u0430\u0440\u043e\u043b\u044c<\/div>\n\t\t\t<input class=\"input-text auth-input-text\" type=\"password\" name=\"password\">\n\t\t\t<div class=\"auth-f-remind-pass\">\n\t\t\t\t<a class=\"novisited auth-f-remind-pass-link\" href=\"#\" name=\"remind\">\u041d\u0430\u043f\u043e\u043c\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c<\/a>\n\t\t\t<\/div>\n\t\t<\/div>\n\t\t<div class=\"clearfix f-i auth-f-submit\">\n\t\t\t<div class=\"auth-f-submit-btn\">\n\t\t\t\t<span class=\"btn-link btn-link-blue\">\n\t\t\t\t\t<button class=\"btn-link-i\" type=\"submit\" name=\"signin\">\u0412\u043e\u0439\u0442\u0438<\/button>\n\t\t\t\t<\/span>\n\t\t\t<a class=\"novisited auth-f-cancel\" href=\"#\" name=\"close\">\u041e\u0442\u043c\u0435\u043d\u0430<\/a>\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/form>\n<\/div>','remind_password':'\n<div class=\"auth-social-wrap\">\n\t<h2 class=\"auth-title\">\u041d\u0430\u043f\u043e\u043c\u0438\u043d\u0430\u043d\u0438\u0435 \u043f\u0430\u0440\u043e\u043b\u044f<\/h2>\n\t<form class=\"f-remember\">\n\t\t<div class=\"auth-f-i f-i\">\n\t\t\t<div class=\"auth-f-i-title\">\u042d\u043b. \u043f\u043e\u0447\u0442\u0430 <span class=\"require\">*<\/span><\/div>\n\t\t\t<input type=\"text\" {if typeof email != \u0027undefined\u0027}value=\"${email}\"{\/if} class=\"input-text\" name=\"email\" value=\"${User.getEmail()}\" _required=\"required\" pattern=\"^[_A-Za-z0-9-]+(\\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\\.[A-Za-z0-9-]+)*(\\.[A-Za-z0-9]{2,15})$\">\n\t\t<\/div>\n\n\t\t<div class=\"auth-f-i f-i\">\n\t\t\t<div class=\"auth-f-i-title\">\u041c\u044b \u0432\u044b\u0448\u043b\u0435\u043c \u0432\u0430\u043c \u043f\u0438\u0441\u044c\u043c\u043e \u0441\u043e&nbsp;\u0441\u0441\u044b\u043b\u043a\u043e\u0439 \u0434\u043b\u044f \u0441\u043c\u0435\u043d\u044b \u043f\u0430\u0440\u043e\u043b\u044f<\/div>\n\t\t<\/div>\n\n\t\t<div class=\"clearfix f-i auth-f-submit\">\n\t\t\t<div class=\"auth-remember-pass-submit\">\n\t\t\t\t<span class=\"btn-link btn-link-gray\">\n\t\t\t\t\t<button class=\"btn-link-i\" type=\"submit\" name=\"send_password\">\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c<\/button>\n\t\t\t\t<\/span>\n\t\t\t<\/div>\n\t\t\t<div class=\"auth-remember-pass\">\n\t\t\t\t<a class=\"novisited auth-remember-pass-link\" name=\"return_back\" href=\"#\">\u041e\u0442\u043c\u0435\u043d\u0430<\/a>\n\t\t\t<\/div>\n\t\t<\/div>\n\n\t\t<div name=\"msg\" class=\"msg error\"><\/div>\n\n\t<\/form>\n<\/div>'},selectors:{remind_password:'[name=remind]',return_button:'[name=return_back]'},ajax:{remind_password:'https://my.rozetka.com.ua/remind-password/#remindPassword',signin:'https://my.rozetka.com.ua/signin/#SignIn'},action:{'facebook':{'new_user':'<div>\n\t\u0412\u044b \u0432\u043e\u0448\u043b\u0438 \u043a\u0430\u043a ${title}\n<\/div>','existing_user':'<div>\n\t\u0412\u044b \u0432\u043e\u0448\u043b\u0438 \u043a\u0430\u043a ${title}\n<\/div>','need_email':'<div>\n\t\u0412\u044b \u0432\u043e\u0448\u043b\u0438 \u043a\u0430\u043a ${title}\n<\/div>'},'vkontakte':{'new_user':'<div>\n\t\u0412\u044b \u0432\u043e\u0448\u043b\u0438 \u043a\u0430\u043a ${title}\n<\/div>','existing_user':'<div>\n\t\u0412\u044b \u0432\u043e\u0448\u043b\u0438 \u043a\u0430\u043a ${title}\n<\/div>','need_email':'<div>\n\t\u0412\u044b \u0432\u043e\u0448\u043b\u0438 \u043a\u0430\u043a ${title}\n<\/div>'}}},initialize:function(oauth){this.oauth=oauth},inform:function(value,type){this.type=type;if(value==this.ACTION.NEW_USER){this.informNewUser(this.getData())}else if(value==this.ACTION.EXISTING_USER){this.informExistingUser(this.getData())}else if(value==this.ACTION.NEED_USER_EMAIL){this.onEmptyEmail()}},informNewUser:function(data){this.showPopup(this.options.action[this.type].new_user,data)},informExistingUser:function(data){this.showPopup(this.options.action[this.type].existing_user,data)},getData:function(additional_data){var data=typeof User.S.accounts!='undefined'&&typeof User.S.accounts[this.type]!='undefined'?User.S.accounts[this.type]:{};if(additional_data){data=$merge(data,additional_data)}return data},showPopup:function(tpl,data){var popup=this.getPopup();popup.setContent(tpl,data);popup.open()},getPopup:function(){this.popup=this.popup||new this.options.popup_class(this.options.popup_tpl);return this.popup},onEmptyEmail:function(){this.social_id=this.oauth.get('social_id');this.user_title=this.oauth.get('user_title');var data=this.oauth.getTemplatesData();data['type']=this.type;data['social_id']=this.social_id;data['title']=this.user_title;this.showPopup(this.options.action[this.type].need_email,data);this.addPopupEvents();this.popup.form.addEvent('submit',this.sendEmail.bind(this))},sendEmail:function(e){new Event(e).stop();var options={onComplete:this.onGetEmail.bind(this)};this.popup.form.trySend(options)},onGetEmail:function(resp){this.popup.form.processStop();var response=new Response_class(resp);if(response.isDone()){this.informNewUser(this.getData(response.S.user.accounts[this.type]));S.onLoad(response.S);this.oauth.trackAuth(this.type);this.clearPopupEvents()}else{if(response.action==this.ACTION.EXISTING_EMAIL){this.email=this.popup.getElement('input[name=email]').getValue();this.showSigninPopup()}else{if(response.Message.content){this.popup.content.setHTML(response.Message.content)}}}},showSigninPopup:function(){this.showPopup(this.options.tpl.signin,{email:this.email,social_id:this.social_id,title:this.user_title,type:this.type});this.popup.form.addEvent('submit',this.authorize.bind(this));this.popup.getElement(this.options.selectors.remind_password).addEvent('click',this.showRemindPassword.bind(this))},authorize:function(e){new Event(e).stop();var options={onComplete:this.onAuthorize.bind(this),headers:{ajaxAction:this.options.ajax.signin}};this.popup.form.trySend(options)},onAuthorize:function(resp){this.popup.form.processStop();var response=new Response_class(resp);if(response.isDone()){this.clearPopupEvents();this.bindAccount(this.social_id,this.type);response.doAction();this.popup.close()}else{this.popup.msg.setHTML(response.Message.content)}},bindAccount:function(social_id,type){var options={onComplete:this.onBindAccount.bind(this),method:'post',data:{social_id:social_id},headers:{ajaxAction:'https://my.rozetka.com.ua/signin/oauth/'+type+'/#bindAccount'}};new Ajax('/cgi-bin/form.php',options).request()},onBindAccount:function(resp){var response=new Response_class(resp);if(response.isDone()){this.oauth.trackAuth(this.type);this.clearPopupEvents();this.informExistingUser(this.getData({title:this.user_title}));S.load()}else{this.oauth.trackError(this.type)}},showRemindPassword:function(e){new Event(e).stop();this.showPopup(this.options.tpl.remind_password,{email:this.email});this.popup.form.addEvent('submit',this.sendPassword.bind(this));this.popup.getElement(this.options.selectors.return_button).addEvent('click',this.showSigninPopup.bind(this))},sendPassword:function(e){new Event(e).stop();var options={headers:{'ajaxAction':this.options.ajax.remind_password},onComplete:this.onSendPassword.bind(this)};this.popup.form.trySend(options)},onSendPassword:function(resp){this.popup.form.processStop();var Response=new Response_class(resp);this.popup.msg.setHTML(Response.Message.content)},addPopupEvents:function(){this.getPopup().addEvent('beforeClose',this.onClose.bind(this));this.getPopup().addEvent('close',this.clearPopupEvents.bind(this))},onClose:function(){this.oauth.trackError(this.type)},clearPopupEvents:function(){this.popup.$events.close=null;this.popup.$events.beforeClose=null}});OAuth2Inform_class.implement(new Options);var OAuth2_class=new Class({auth_property_value:null,events_added:false,window:null,informer:null,names:{'social_action':'action','social_error':'error','social_id':'social_id','user_title':'user_title'},options:{informer_class:typeof(OAuth2Inform_class)!=='undefined'?OAuth2Inform_class:null,social_buttons_name:'social_button_auth',csrf_token:null,social_attr:'type',binding:false,inform:false,tpl:{"facebook":'{if User.isAuthInSocial(\"facebook\")}\n\t<form action=\"https:\/\/my.rozetka.com.ua\/cgi-bin\/form.php?r=https%3A%2F%2Fmy.rozetka.com.ua%2Fsignin%2Foauth%2Ffacebook%2F&action=unbindAccount\" class=\"profile-social-unbind-f\" method=\"post\">\n\n\t\t<input type=\"hidden\" name=\"type\" value=\"facebook\">\n\t\t<span class=\"social-bind-i social-bind-i-fb\">\n\t\t\t<span class=\"sprite-side btn-link btn-link-gray activated\">\n\t\t\t    <button type=\"submit\" class=\"btn-link-i\" onclick=\"document.fireEvent(\u0027unbindSocial\u0027, {extend_event: [{name: \u0027eventContent\u0027, value: \u0027Facebook\u0027}]});\">\n\t\t\t\t    <span class=\"social-bind-i-head\">${title}<\/span>\n\t\t\t\t    <span class=\"social-bind-i-link inline novisited xhr\">\u043e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u0432\u044f\u0437\u044c<\/span>\n\t\t\t    <\/button>\n\t\t\t<\/span>\n\t\t<\/span>\n\n\t<\/form>\n{else}\n\t<span class=\"social-bind-i social-bind-i-fb\">\n\t\t<a href=\"http:\/\/www.facebook.com\/v2.0\/dialog\/oauth\/?client_id=205429962821175&redirect_uri=https%3A%2F%2Fmy.rozetka.com.ua%2Fsignin%2Foauth%2Ffacebook%2F&display=popup&scope=email%2Cuser_birthday\" target=\"_blank\" class=\"sprite-side btn-link btn-link-gray\" id=\"checkout_auth_fb\"\n\t\t\tonclick=\"document.fireEvent(\u0027bindSocial\u0027, {extend_event: [{name: \u0027eventContent\u0027, value: \u0027Facebook\u0027}]});\"\n\t\t>\n\t\t\t<span class=\"btn-link-i\">\n\t\t\t\t<span class=\"social-bind-i-head\">Facebook<\/span>\n\t\t\t\t<span class=\"novisited xhr\">\u0421\u0432\u044f\u0437\u0430\u0442\u044c \u0441 \u0441\u043e\u0446\u0441\u0435\u0442\u044c\u044e<\/span>\n\t\t\t<\/a>\n\t\t<\/span>\n\t<\/span>\n{\/if}',"vkontakte":'{if User.isAuthInSocial(\"vkontakte\")}\n\t<form action=\"https:\/\/my.rozetka.com.ua\/cgi-bin\/form.php?r=https%3A%2F%2Fmy.rozetka.com.ua%2Fsignin%2Foauth%2Fvkontakte%2F&action=unbindAccount\" class=\"profile-social-unbind-f\" method=\"post\">\n\n\t\t<input type=\"hidden\" name=\"type\" value=\"vkontakte\">\n\t\t<span class=\"social-bind-i social-bind-i-vk\">\n\t\t\t<span class=\"sprite-side btn-link btn-link-gray activated\">\n\t\t\t    <button type=\"submit\" class=\"btn-link-i\" onclick=\"document.fireEvent(\u0027unbindSocial\u0027, {extend_event: [{name: \u0027eventContent\u0027, value: \u0027VKontakte\u0027}]});\">\n\t\t\t\t    <span class=\"social-bind-i-head\">${title}<\/span>\n\t\t\t\t    <span class=\"social-bind-i-link inline novisited xhr\">\u043e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u0432\u044f\u0437\u044c<\/span>\n\t\t\t    <\/button>\n\t\t\t<\/span>\n\t\t<\/span>\n\n\t<\/form>\n{else}\n\t<span class=\"social-bind-i social-bind-i-vk\">\n\t\t<a href=\"http:\/\/api.vk.com\/oauth\/authorize?client_id=2743724&redirect_uri=https%3A%2F%2Fmy.rozetka.com.ua%2Fsignin%2Foauth%2Fvkontakte%2F&display=popup&scope=notify\" target=\"_blank\" class=\"sprite-side btn-link btn-link-gray\" id=\"checkout_auth_vk\"\n\t\t\tonclick=\"document.fireEvent(\u0027bindSocial\u0027, {extend_event: [{name: \u0027eventContent\u0027, value: \u0027VKontakte\u0027}]});\"\n\t\t>\n\t\t\t<span class=\"btn-link-i\">\n\t\t\t\t<span class=\"social-bind-i-head\">\u0412\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u0435<\/span>\n\t\t\t\t<span class=\"novisited xhr\">\u0421\u0432\u044f\u0437\u0430\u0442\u044c \u0441 \u0441\u043e\u0446\u0441\u0435\u0442\u044c\u044e<\/span>\n\t\t\t<\/a>\n\t\t<\/span>\n\t<\/span>\n{\/if}'}},initialize:function(social_buttons_name){if(social_buttons_name){this.options.social_buttons_name=social_buttons_name}return this},update:function(tpl){var template=null,templates={},element_name=null,form,anchor;if(!this.options.replacement_tpl){templates[this.options.social_buttons_name]=this.options.tpl}else{templates=this.options.replacement_tpl}for(element_name in templates){template=templates[element_name];if(template){if(tpl){template=$merge(template,tpl)}this.updateElements(template,element_name)}}return this},updateElements:function(template,element_name){$ES("[name="+element_name+"]").each(function(el){var account=el.getProperty(this.options.social_attr),form,anchor;if(account){el.setHTML(App.getHTML(template[account],this.getTemplatesData(account)));if(User.isAuthInSocial(account)){form=el.getElement('form');if(form){form.addEvent('submit',function(e){new Event(e).stop();form.trySend()});form.addEvent('onResponseDone',function(){this.trackEvent(account,'unbind');this.fireEvent('social_unbind')}.bind(this))}}else{anchor=el.getElement('a');if(anchor){anchor.removeEvents('click');this.updateAnchorToken(anchor);anchor.addEvent('click',this.authorize.bind(this))}}}}.bind(this))},getTemplatesData:function(accounts){var account=accounts||this.type;return typeof User.S.accounts!=='undefined'&&typeof User.S.accounts[account]!=='undefined'?User.S.accounts[account]:{}},updateAnchorToken:function(el){var state,state_new,match,redirect_uri;if(this.options.csrf_token){state=this.getParamByName(el.href,'state');state_new=md5(decodeURI(Cookie.get('uid')).replace(/[+]/g,' ')+this.options.csrf_token);if(state){el.href=el.href.replace(state,state_new)}else{el.href=el.href+"&state="+state_new}}if(this.options.binding){match=el.href.match(/.*\&redirect_uri=(.[^&]*).*/i);if(match){redirect_uri=match[1]+encodeURIComponent('?type=bind');el.href=el.href.replace(match[1],redirect_uri)}}},getParamByName:function(href,name){var regexS,regex,results;name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");regexS="[\\?&]"+name+"=([^&#]*)";regex=new RegExp(regexS);results=regex.exec(href);return results===null?"":decodeURIComponent(results[1].replace(/\+/g," "))},authorize:function(e){var event=new Event(e),el;event.stop();this.fireEvent('login_start');el=this.searchElementType($(event.target));if(el){this.type=el.getProperty(this.options.social_attr)}this.doAuthorize(this.searchElWithHref($(event.target)))},searchElWithHref:function(el){if(!el.getProperty('href')&&el.getParent()){el=this.searchElWithHref(el.getParent())}return el},searchElementType:function(el){if(!el.getProperty(this.options.social_attr)&&el.getParent()){el=this.searchElementType(el.getParent())}return el},openWindow:function(url,title,w,h){var left,top;left=(screen.width/2)-(w/2);top=(screen.height/2)-(h/2);return window.open(url,title,'toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width='+w+', height='+h+', top='+top+', left='+left)},checkClosed:function(window){if(window&&typeof window!='number'){this.window=window}if(this.window){if(this.window.closed){this.window=null;this.bindEvents();S.load(true)}else{setTimeout(this.checkClosed.bind(this),100)}}},doAuthorize:function(el){if(el.href){this.checkClosed(this.openWindow(el.href,'',600,300))}},bindEvents:function(){if(!this.track_auth){S.addEvent('loadS',function(e){if(this.type){this.handle();this.addSocialEvents();this.type=null}}.bind(this));this.track_auth=true}},handle:function(){var value,name;this.fireEvent('login_complete');for(name in this.names){value=Cookie.get(name);if(value){this[this.names[name]]=value.replace(/\+/g,' ');Cookie.remove(name,{path:'/',domain:'rozetka.com.ua'})}}},addSocialEvents:function(){if(this.type&&User.isAuthInSocial(this.type)){this.trackAuth(this.type);this.onAction(this.get('action'))}else{var action=this.get('action');if(action){this.onAction(action)}else{this.trackError(this.type);this.fireEvent('login_failed',{value:this.get('error')})}}},trackAuth:function(type){var event=this.options.binding?'bind':'login';this.trackEvent(type,event);this.fireEvent('login_success')},trackError:function(type){this.trackEvent(type,'close')},trackEvent:function(type,event){App.trackEvent('SocialAuthorization',type,event)},onAction:function(value){if(this.options.inform&&value){this.getInformer().inform(value,this.type)}},getInformer:function(){this.informer=this.informer||new this.options.informer_class(this);return this.informer},setInformOptions:function(options){this.getInformer().setOptions(options)},get:function(value){var val;if(this[value]){val=this[value];this[value]=null}else{val=null}return val}});OAuth2_class.implement(new Options(),new Events());var RozetkaViewsAnalytics_class=new Class({setEventForSplitTestNewTile:function(parent_elem,href,params){var parent_element=$(parent_elem);if(parent_element){var elements=parent_element.getElements('a[href='+href+']');elements.extend(parent_element.getElements('a[href^='+href+'#]'));for(var index=0;index<elements.length;index++){var event='click-'+params.view_type;elements[index].addEvent('click',function(e){var locations='';if(params.view_type=='list'){locations=params.position}else{locations=params.position+'_'+this._calculateCountColumn(params.flag)+'_'+params.plitka_type}rozetkaEvents.trackEvent(event,params.category,locations,params.rank)}.bind(this))}}},_calculateCountColumn:function(flag){var windowWidth=window.innerWidth;var countColumn=0;if(windowWidth<1260){countColumn=2}else if(windowWidth<1495){countColumn=3}else if(windowWidth<=1860){countColumn=4}else{countColumn=5}if(flag){countColumn+=1}return countColumn}});var Watcher_class=new Class({Class:'Watcher_class',_it:false,x:false,y:false,_track:function(what){new Ajax('/w/?'+md5(new String(new Date().getTime())).substr(0,6)+what).request()},initialize:function(){if('ontouchstart'in document.documentElement||'ontouchstart'in document.documentElement||'ontouchend'in document.documentElement||'ongesturestart'in document.documentElement||'ongesturechange'in document.documentElement||'ongestureend'in document.documentElement){this._track(1);return}document.documentElement.onmousemove=this._mm.bind(this);App.addOnDomReady(function(){$$('[name="price"]').each(function(el){el.addEvent('mousedown',this._md.bind(this));el.addEvent('mouseup',this._mu.bind(this));if($defined(window.ie)){el.addEvent('dblclick',this._pact.bind(this))}}.bind(this))}.bind(this))},_mm:function(e){if(!this._it){var cx=$defined(window.ie)?event.clientX:e.clientX;var cy=$defined(window.ie)?event.clientY:e.clientY;if(!this.x){this.x=cx;this.y=cy}else if(this.x!=cx||this.y!=cy){this._it=true;this._track(2)}}},_pact:function(){var txt;if(window.getSelection){txt=window.getSelection().toString();if(!txt||txt.length<=1){return}}else if(document.selection){var sel=document.selection;txt=sel.createRange().text;if(!txt||txt.length<=1){return}}else{return}this._track(3)},_md:function(){this.pdown=true},_mu:function(){if(this.pdown){this.pdown=false;this._pact()}}});var Watcher=new Watcher_class();var SplitTests_class=new Class({tests:{},options:{url:'/split_tests/getSplitTestValueByNameAJAX'},setVariant:function(test_name,variant){var currentValue=this.getVariant(test_name);if(currentValue!=variant){Cookie.set(test_name,variant,{duration:31,path:'/',domain:'.rozetka.com.ua'})}this.tests[test_name]=variant},getVariant:function(test_name){if(this.tests[test_name]===undefined){this.tests[test_name]=Cookie.get(test_name)}return this.tests[test_name]},getSplitTestVariant:function(name,onCompleteFunction,section_id){var variant=this.getVariant(name);if(variant){onCompleteFunction(variant)}else{this._sendAJAX(name,onCompleteFunction,section_id)}},_sendAJAX:function(name,onCompleteFunction,section_id){var data={name:name,section_id:section_id};new Ajax(this.options.url,{data:data,method:'get',onComplete:function(response){var resp=new Response_class(response);if(resp.isDone()){this.setVariant(name,resp.content)}onCompleteFunction(resp.content)}.bind(this)}).request()}});var CheckoutCheckboxOptions_class=new Class({options:{selectors:{popup:'',button:'',label:'',checkbox:''},cookie_name:'',template_popup:'<div class=\"popup-css popup-checkout-gift\">\n\t<a href=\"#\" class=\"popup-close\" name=\"close\"><img width=\"18\" height=\"18\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"&times;\" class=\"popup-close-medium-icon sprite\"><\/a>\n\t<div name=\"msg\"><\/div>\n\t<div name=\"content\"><\/div>\n<\/div>',template_popup_content:'',GTM_event_from_cart:null},_stack:{},remove:function(){Cookie.remove(this.options.cookie_name,{domain:'rozetka.com.ua',path:'/'})},isChecked:function(){return Cookie.get(this.options.cookie_name)},init:function(container){this.setCheckboxPopup(container);this.setCheckboxEvent(container)},setCheckboxPopup:function(container){var checkbox_parent=$E(this.options.selectors.popup,container),checkbox_btn=$E(this.options.selectors.button,container),checkbox_checkbox=$E(this.options.selectors.checkbox,container);if(checkbox_parent&&checkbox_btn&&checkbox_checkbox){var CheckboxPopup=new Popup_class(this.options.template_popup,checkbox_parent);CheckboxPopup.setContent(this.options.template_popup_content);CheckboxPopup.setOptions({single:true});checkbox_btn.addEvent('click',function(e){new Event(e).stop();CheckboxPopup.isOpened()?CheckboxPopup.close():CheckboxPopup.open()});checkbox_checkbox.addEvent('click',function(e){new Event(e).stopPropagation();if(this.checked&&!CheckboxPopup.isOpened()){CheckboxPopup.open()}else{CheckboxPopup.close()}})}},setCheckboxEvent:function(container){var checkbox_parent=$E(this.options.selectors.label,container),checkbox_input=$E(this.options.selectors.checkbox,container);if(checkbox_parent&&checkbox_input){checkbox_input.checked=this.isChecked();checkbox_parent.addEvent('click',function(e){var event=new Event(e),target=event.target;if(target.tagName=='LABEL'){checkbox_input=target.getElement('input');event.stop()}else{checkbox_input=target;event.stopPropagation()}if(this.isChecked()){this.remove()}else{Cookie.set(this.options.cookie_name,1,{domain:'rozetka.com.ua',path:'/',duration:'7'})}checkbox_input.checked=this.isChecked();if(checkbox_input.getProperty('track_from_cart')&&this.GTM_event_from_cart!=undefined){document.fireEvent(this.GTM_event_from_cart)}}.bindWithEvent(this))}},fillStack:function(order_id){var checkbox_parent,parent_container,i,checkboxes=$ES(this.options.selectors.label);for(i=0;i<checkboxes.length;i++){if(checkboxes[i].getAttribute('order_index')==order_id){checkbox_parent=checkboxes[i].parentElement;parent_container=checkbox_parent.parentElement;checkbox_parent.removeClass('hidden');this._stack[order_id]={'checkbox_parent':checkbox_parent,'parent_container':parent_container};break}}},prepareCheckBox:function(order_id){var dm_id=Checkout.getData().order[order_id].delivery.method_id,pm_id=Checkout.getData().order[order_id].payment.method_id,callback_data=Checkout.getOrderByIndex(order_id).order.show_callback_question;this.fillStack(order_id);if(typeof this._stack[order_id]!='undefined'){if(!callback_data||!callback_data['dm']||!callback_data['pm']||!callback_data['dm'][dm_id]||!callback_data['pm'][pm_id]){try{this._stack[order_id].checkbox_parent.remove()}catch(e){}}else{this._stack[order_id].parent_container.appendChild(this._stack[order_id].checkbox_parent)}}},prepareAdditionalFields:function(order_id){this.fillStack(order_id);if(this._stack[order_id]){var elements=this._stack[order_id].parent_container.getElements('[type=checkbox]'),order=Checkout.getOrderByIndex(order_id);if(order){order.setAdditionalFields(elements.length&&elements[0].checked)}}},initEventForAdditionalFields:function(container){var checkbox_checkbox=$E(this.options.selectors.checkbox,container);checkbox_checkbox.addEvent('change',function(e){this.prepareAdditionalFields(checkbox_checkbox.parentElement.getAttribute('order_index'))}.bind(this))}});CheckoutCheckboxOptions_class.implement(new Options(),new Events());var isIE=(navigator.appVersion.indexOf("MSIE")!=-1)?true:false;var isWin=(navigator.appVersion.toLowerCase().indexOf("win")!=-1)?true:false;var isOpera=(navigator.userAgent.indexOf("Opera")!=-1)?true:false;function ControlVersion(){var version;var axo;var e;try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");version=axo.GetVariable("$version")}catch(e){}if(!version){try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");version="WIN 6,0,21,0";axo.AllowScriptAccess="always";version=axo.GetVariable("$version")}catch(e){}}if(!version){try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");version=axo.GetVariable("$version")}catch(e){}}if(!version){try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");version="WIN 3,0,18,0"}catch(e){}}if(!version){try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");version="WIN 2,0,0,11"}catch(e){version=-1}}return version}function GetSwfVer(){var flashVer=-1;if(navigator.plugins!=null&&navigator.plugins.length>0){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var swVer2=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"";var flashDescription=navigator.plugins["Shockwave Flash"+swVer2].description;var descArray=flashDescription.split(" ");var tempArrayMajor=descArray[2].split(".");var versionMajor=tempArrayMajor[0];var versionMinor=tempArrayMajor[1];var versionRevision=descArray[3];if(versionRevision==""){versionRevision=descArray[4]}if(versionRevision[0]=="d"){versionRevision=versionRevision.substring(1)}else if(versionRevision[0]=="r"){versionRevision=versionRevision.substring(1);if(versionRevision.indexOf("d")>0){versionRevision=versionRevision.substring(0,versionRevision.indexOf("d"))}}var flashVer=versionMajor+"."+versionMinor+"."+versionRevision}}else if(navigator.userAgent.toLowerCase().indexOf("webtv/2.6")!=-1)flashVer=4;else if(navigator.userAgent.toLowerCase().indexOf("webtv/2.5")!=-1)flashVer=3;else if(navigator.userAgent.toLowerCase().indexOf("webtv")!=-1)flashVer=2;else if(isIE&&isWin&&!isOpera){flashVer=ControlVersion()}return flashVer}function DetectFlashVer(reqMajorVer,reqMinorVer,reqRevision){versionStr=GetSwfVer();if(versionStr==-1){return false}else if(versionStr!=0){if(isIE&&isWin&&!isOpera){tempArray=versionStr.split(" ");tempString=tempArray[1];versionArray=tempString.split(",")}else{versionArray=versionStr.split(".")}var versionMajor=versionArray[0];var versionMinor=versionArray[1];var versionRevision=versionArray[2];if(versionMajor>parseFloat(reqMajorVer)){return true}else if(versionMajor==parseFloat(reqMajorVer)){if(versionMinor>parseFloat(reqMinorVer))return true;else if(versionMinor==parseFloat(reqMinorVer)){if(versionRevision>=parseFloat(reqRevision))return true}}return false}}function AC_AddExtension(src,ext){if(src.indexOf('?')!=-1)return src.replace(/\?/,ext+'?');else return src+ext}function AC_Generateobj(objAttrs,params,embedAttrs){var str='';if(isIE&&isWin&&!isOpera){str+='<object ';for(var i in objAttrs){str+=i+'="'+objAttrs[i]+'" '}str+='>';for(var i in params){str+='<param name="'+i+'" value="'+params[i]+'" /> '}str+='</object>'}else{str+='<embed ';for(var i in embedAttrs){str+=i+'="'+embedAttrs[i]+'" '}str+='> </embed>'}document.write(str)}function AC_FL_RunContent(){var ret=AC_GetArgs(arguments,".swf","movie","clsid:d27cdb6e-ae6d-11cf-96b8-444553540000","application/x-shockwave-flash");AC_Generateobj(ret.objAttrs,ret.params,ret.embedAttrs)}function AC_SW_RunContent(){var ret=AC_GetArgs(arguments,".dcr","src","clsid:166B1BCA-3F9C-11CF-8075-444553540000",null);AC_Generateobj(ret.objAttrs,ret.params,ret.embedAttrs)}function AC_GetArgs(args,ext,srcParamName,classid,mimeType){var ret=new Object();ret.embedAttrs=new Object();ret.params=new Object();ret.objAttrs=new Object();for(var i=0;i<args.length;i=i+2){var currArg=args[i].toLowerCase();switch(currArg){case"classid":break;case"pluginspage":ret.embedAttrs[args[i]]=args[i+1];break;case"src":case"movie":args[i+1]=AC_AddExtension(args[i+1],ext);ret.embedAttrs["src"]=args[i+1];ret.params[srcParamName]=args[i+1];break;case"onafterupdate":case"onbeforeupdate":case"onblur":case"oncellchange":case"onclick":case"ondblclick":case"ondrag":case"ondragend":case"ondragenter":case"ondragleave":case"ondragover":case"ondrop":case"onfinish":case"onfocus":case"onhelp":case"onmousedown":case"onmouseup":case"onmouseover":case"onmousemove":case"onmouseout":case"onkeypress":case"onkeydown":case"onkeyup":case"onload":case"onlosecapture":case"onpropertychange":case"onreadystatechange":case"onrowsdelete":case"onrowenter":case"onrowexit":case"onrowsinserted":case"onstart":case"onscroll":case"onbeforeeditfocus":case"onactivate":case"onbeforedeactivate":case"ondeactivate":case"type":case"codebase":case"id":ret.objAttrs[args[i]]=args[i+1];break;case"width":case"height":case"align":case"vspace":case"hspace":case"class":case"title":case"accesskey":case"name":case"tabindex":ret.embedAttrs[args[i]]=ret.objAttrs[args[i]]=args[i+1];break;default:ret.embedAttrs[args[i]]=ret.params[args[i]]=args[i+1]}}ret.objAttrs["classid"]=classid;if(mimeType)ret.embedAttrs["type"]=mimeType;return ret}var TimedResize_class=new Class({options:{min_interval:80},_boundOnTimeout:null,_refresh_interval:50,_lastFiredTime:0,_timeout_id:null,initialize:function(){this._boundOnTimeout=this._onTimeout.bind(this);window.addEvent('resize',this._resizeListener.bind(this))},_resizeListener:function(){clearTimeout(this._timeout_id);this._onTimeout()},_onTimeout:function(){var currentTime=new Date().getTime();if(currentTime-this._lastFiredTime>this.options.min_interval){this._lastFiredTime=currentTime;this._dispatchTimedResizeEvent()}else{this._timeout_id=setTimeout(this._boundOnTimeout,this._refresh_interval)}},_dispatchTimedResizeEvent:function(){var window_size=window.getSize();App.fireEvent('timedResize',window_size)}});TimedResize_class.implement(new Options());var RozetkaImask_class=new Class({options:{targetClass:".iMask",maskEmptyChr:'_',validNumbers:"1234567890",validAlphas:"abcdefghijklmnopqrstuvwxyz",validAlphaNums:"abcdefghijklmnopqrstuvwxyz1234567890",onFocus:Class.empty,onBlur:Class.empty,onValid:Class.empty,onInvalid:Class.empty,onKeyDown:Class.empty},initialize:function(options){this.setOptions(options);var fields=$$(this.options.targetClass);fields.each(function(obj,i){obj.options=Json.evaluate(obj.alt);if(obj.options.type=="number"){obj.setStyle("text-align","right")}obj.addEvent("mousedown",function(event){var event=new Event(event)}.bind(this));obj.addEvent("mouseup",function(event){event=new Event(event);if(obj.selectionStart>=0&&obj.selectionStart<obj.value.length){while(!this._isInputPosition(obj,obj.selectionStart)){this._selectNext(obj)}}this._onMouseUp(event,obj)}.bind(this));obj.addEvent("click",function(event){event=new Event(event);event.stop()});obj.addEvent("keydown",function(event){event=new Event(event);this._onKeyDown(event,obj);this.fireEvent("onKeyDown",obj,20)}.bind(this));obj.addEvent("keypress",function(event){event=new Event(event);this._onKeyPress(event,obj)}.bind(this));obj.addEvent("focus",function(event){event=new Event(event);event.stop();this._onFocus(event,obj);this.fireEvent("onFocus",obj,20)}.bind(this));obj.addEvent("blur",function(event){event=new Event(event);event.stop();this._onBlur(event,obj);this.fireEvent("onBlur",obj,20)}.bind(this))}.bind(this))},_onMouseUp:function(event,obj){if(obj.options.type=="fixed"){var p=this._getSelectionStart(obj);this._setSelection(obj,p,(p+1))}else if(obj.options.type=="number"){this._setEnd(obj)}this._unSelect(obj)},_onKeyDown:function(event,obj){if(event.code==13){obj.blur();this._submitForm(obj)}else if(!(event.code==9)){event.stop();if(obj.options.type=="fixed"){var p=this._getSelectionStart(obj);switch(event.code){case 8:this._selectPrevious(obj);this._updSelection(obj,this._getSelectionStart(obj),this.options.maskEmptyChr);break;case 36:this._selectFirst(obj);break;case 35:this._selectLast(obj);break;case 37:case 38:this._selectPrevious(obj);break;case 39:this._selectNext(obj);case 40:this._selectNext(obj);break;case 46:this._updSelection(obj,p,this.options.maskEmptyChr);this._selectNext(obj);break;default:var chr=this._chrFromEvent(event);if(this._isViableInput(obj,p,chr)){if(event.shift){this._updSelection(obj,p,chr.toUpperCase())}else{this._updSelection(obj,p,chr)}this.fireEvent("onValid",[event,obj],20);this._selectNext(obj)}else{this.fireEvent("onInvalid",[event,obj],20)}break}}else if(obj.options.type=="number"){switch(event.code){case 8:case 46:this._popNumber(obj);break;default:var chr=this._chrFromEvent(event);if(this.options.validNumbers.indexOf(chr)>=0){this._pushNumber(obj,chr);this.fireEvent("onValid",[event,obj],20)}else{this.fireEvent("onInvalid",[event,obj],20)}break}}}},_onKeyPress:function(event,obj){if(!(event.code==9)&&!(event.shift&&event.code==9)&&!(event.code==13)&&!(event.ctrl&&event.code==67)&&!(event.ctrl&&event.code==86)&&!(event.ctrl&&event.code==88)){event.stop()}this._unSelect(obj)},_onFocus:function(event,obj){if(obj.options.type=="fixed"){this._selectFirst.delay(20,this,obj)}else{this._setEnd.delay(20,this,obj)}},_onBlur:function(event,obj){},_selectFirst:function(obj){for(var i=0,len=obj.options.mask.length;i<len;i++){if(this._isInputPosition(obj,i)){this._setSelection(obj,i,(i+1));return}}},_selectLast:function(obj){for(var i=(obj.options.mask.length-1);i>=0;i--){if(this._isInputPosition(obj,i)){this._setSelection(obj,i,(i+1));return}}},_selectPrevious:function(obj,p){if(!$chk(p)){p=this._getSelectionStart(obj)}if(p<=0){this._selectFirst(obj)}else{if(this._isInputPosition(obj,(p-1))){this._setSelection(obj,(p-1),p)}else{this._selectPrevious(obj,(p-1))}}},_selectNext:function(obj,p){if(!$chk(p))p=this._getSelectionEnd(obj);if(p>obj.options.mask.length){this._selectLast(obj)}else{if(this._isInputPosition(obj,p)){this._setSelection(obj,p,(p+1))}else{this._selectNext(obj,(p+1))}}},_setSelection:function(obj,a,b){if(obj.setSelectionRange){obj.focus();obj.setSelectionRange(a,b)}else if(obj.createTextRange){var r=obj.createTextRange();r.collapse();r.moveStart("character",a);r.moveEnd("character",(a-b));r.select()}},_unSelect:function(obj){obj.selectionEnd=obj.selectionStart},_updSelection:function(obj,p,chr){if(this._isInputPosition(obj,p)){var value=obj.value;var output="";output+=value.substring(0,p);if(p<=(obj.options.mask.length-1)){output+=chr}output+=value.substr(p+1);obj.value=output;this._setSelection(obj,p,(p+1))}},_setEnd:function(obj){var len=obj.value.length;this._setSelection(obj,len,len)},_getSelectionStart:function(obj){var p=0;if(obj.selectionStart){if($type(obj.selectionStart)=="number")p=obj.selectionStart}else if(document.selection){var r=document.selection.createRange().duplicate();r.moveEnd("character",obj.value.length);p=obj.value.lastIndexOf(r.text);if(r.text=="")p=obj.value.length}return p},_getSelectionEnd:function(obj){var p=0;if(obj.selectionEnd){if($type(obj.selectionEnd)=="number"){p=obj.selectionEnd}}else if(document.selection){var r=document.selection.createRange().duplicate();r.moveStart("character",-obj.value.length);p=r.text.length}return p},_isInputPosition:function(obj,p){var mask=obj.options.mask.toLowerCase();var chr=mask.charAt(p);if("9ax".indexOf(chr)>=0){return true}return false},_isViableInput:function(obj,p,chr){var mask=obj.options.mask.toLowerCase();var chMask=mask.charAt(p);switch(chMask){case'9':if(this.options.validNumbers.indexOf(chr)>=0){return true}break;case'a':if(this.options.validAlphas.indexOf(chr)>=0){return true}break;case'x':if(this.options.validAlphaNums.indexOf(chr)>=0){return true}break;default:return false;break}},_wearMask:function(obj,str){var mask=obj.options.mask.toLowerCase();var output="";for(var i=0,u=0,len=mask.length;i<len;i++){switch(mask.charAt(i)){case'9':if(this.options.validNumbers.indexOf(str.charAt(u).toLowerCase())>=0){if(str.charAt(u)==""){output+=this.options.maskEmptyChr}else{output+=str.charAt(u++)}}else{output+=this.options.maskEmptyChr}break;case'a':if(this.options.validAlphas.indexOf(str.charAt(u).toLowerCase())>=0){if(str.charAt(u)==""){output+=this.options.maskEmptyChr}else{output+=str.charAt(u++)}}else{output+=this.options.maskEmptyChr}break;case'x':if(this.options.validAlphaNums.indexOf(str.charAt(u).toLowerCase())>=0){if(str.charAt(u)==""){output+=this.options.maskEmptyChr}else{output+=str.charAt(u++)}}else{output+=this.options.maskEmptyChr}break;default:output+=mask.charAt(i);break}}return output},_stripMask:function(obj){var value=obj.value;if(""==value)return"";var output="";if(obj.options.type=="fixed"){for(var i=0,len=value.length;i<len;i++){if((value.charAt(i)!=this.options.maskEmptyChr)&&(this._isInputPosition(obj,i))){output+=value.charAt(i)}}}else if(obj.options.type=="number"){for(var i=0,len=value.length;i<len;i++){if(this.options.validNumbers.indexOf(value.charAt(i))>=0){output+=value.charAt(i)}}}return output},_chrFromEvent:function(event){var chr='';switch(event.code){case 48:case 96:chr='0';break;case 49:case 97:chr='1';break;case 50:case 98:chr='2';break;case 51:case 99:chr='3';break;case 52:case 100:chr='4';break;case 53:case 101:chr='5';break;case 54:case 102:chr='6';break;case 55:case 103:chr='7';break;case 56:case 104:chr='8';break;case 57:case 105:chr='9';break;default:chr=event.key;break}return chr},_pushNumber:function(obj,chr){obj.value=obj.value+chr;this._formatNumber(obj)},_popNumber:function(obj){obj.value=obj.value.substring(0,(obj.value.length-1));this._formatNumber(obj)},_formatNumber:function(obj){var str2=this._stripMask(obj);var str1="";for(var i=0,len=str2.length;i<len;i++){if('0'!=str2.charAt(i)){str1=str2.substr(i);break}}str2=str1;str1="";for(var len=str2.length,i=obj.options.decDigits;len<=i;len++){str1+="0"}str1+=str2;str2=str1.substr(str1.length-obj.options.decDigits);str1=str1.substring(0,(str1.length-obj.options.decDigits));var re=new RegExp("(\\d+)(\\d{"+obj.options.groupDigits+"})");while(re.test(str1)){str1=str1.replace(re,"$1"+obj.options.groupSymbol+"$2")}obj.value=str1+obj.options.decSymbol+str2},_getObjForm:function(obj){var parent=obj.getParent();if(parent.getTag()=="form"){return parent}else{return this._getObjForm(parent)}},_submitForm:function(obj){var form=this._getObjForm(obj);form.submit()}});RozetkaImask_class.implement(new Events,new Options);var ZeroClipboard={version:"1.0.7",clients:{},moviePath:'ZeroClipboard.swf',nextId:1,$:function(thingy){if(typeof(thingy)=='string')thingy=document.getElementById(thingy);if(!thingy.addClass){thingy.hide=function(){this.style.display='none'};thingy.show=function(){this.style.display=''};thingy.addClass=function(name){this.removeClass(name);this.className+=' '+name};thingy.removeClass=function(name){var classes=this.className.split(/\s+/);var idx=-1;for(var k=0;k<classes.length;k++){if(classes[k]==name){idx=k;k=classes.length}}if(idx>-1){classes.splice(idx,1);this.className=classes.join(' ')}return this};thingy.hasClass=function(name){return!!this.className.match(new RegExp("\\s*"+name+"\\s*"))}}return thingy},setMoviePath:function(path){this.moviePath=path},dispatch:function(id,eventName,args){var client=this.clients[id];if(client){client.receiveEvent(eventName,args)}},register:function(id,client){this.clients[id]=client},getDOMObjectPosition:function(obj,stopObj){var info={left:0,top:0,width:obj.width?obj.width:obj.offsetWidth,height:obj.height?obj.height:obj.offsetHeight};while(obj&&(obj!=stopObj)){info.left+=obj.offsetLeft;info.top+=obj.offsetTop;obj=obj.offsetParent}return info},Client:function(elem){this.handlers={};this.id=ZeroClipboard.nextId++;this.movieId='ZeroClipboardMovie_'+this.id;ZeroClipboard.register(this.id,this);if(elem)this.glue(elem)}};ZeroClipboard.Client.prototype={id:0,ready:false,movie:null,clipText:'',handCursorEnabled:true,cssEffects:true,handlers:null,glue:function(elem,appendElem,stylesToAdd){this.domElement=ZeroClipboard.$(elem);var zIndex=99;if(this.domElement.style.zIndex){zIndex=parseInt(this.domElement.style.zIndex,10)+1}if(typeof(appendElem)=='string'){appendElem=ZeroClipboard.$(appendElem)}else if(typeof(appendElem)=='undefined'){appendElem=document.getElementsByTagName('body')[0]}var box=ZeroClipboard.getDOMObjectPosition(this.domElement,appendElem);this.div=document.createElement('div');var style=this.div.style;style.position='absolute';style.left=''+box.left+'px';style.top=''+box.top+'px';style.width=''+box.width+'px';style.height=''+box.height+'px';style.zIndex=zIndex;if(typeof(stylesToAdd)=='object'){for(addedStyle in stylesToAdd){style[addedStyle]=stylesToAdd[addedStyle]}}appendElem.appendChild(this.div);this.div.innerHTML=this.getHTML(box.width,box.height)},getHTML:function(width,height){var html='';var flashvars='id='+this.id+'&width='+width+'&height='+height;if(navigator.userAgent.match(/MSIE/)){var protocol=location.href.match(/^https/i)?'https://':'http://';html+='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="'+protocol+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="'+width+'" height="'+height+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+ZeroClipboard.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+flashvars+'"/><param name="wmode" value="transparent"/></object>'}else{html+='<embed id="'+this.movieId+'" src="'+ZeroClipboard.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+width+'" height="'+height+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+flashvars+'" wmode="transparent" />'}return html},hide:function(){if(this.div){this.div.style.left='-2000px'}},show:function(){this.reposition()},destroy:function(){if(this.domElement&&this.div){this.hide();this.div.innerHTML='';var body=document.getElementsByTagName('body')[0];try{body.removeChild(this.div)}catch(e){}this.domElement=null;this.div=null}},reposition:function(elem){if(elem){this.domElement=ZeroClipboard.$(elem);if(!this.domElement)this.hide()}if(this.domElement&&this.div){var box=ZeroClipboard.getDOMObjectPosition(this.domElement);var style=this.div.style;style.left=''+box.left+'px';style.top=''+box.top+'px'}},setText:function(newText){this.clipText=newText;if(this.ready)this.movie.setText(newText)},addEventListener:function(eventName,func){eventName=eventName.toString().toLowerCase().replace(/^on/,'');if(!this.handlers[eventName])this.handlers[eventName]=[];this.handlers[eventName].push(func)},setHandCursor:function(enabled){this.handCursorEnabled=enabled;if(this.ready)this.movie.setHandCursor(enabled)},setCSSEffects:function(enabled){this.cssEffects=!!enabled},receiveEvent:function(eventName,args){eventName=eventName.toString().toLowerCase().replace(/^on/,'');switch(eventName){case'load':this.movie=document.getElementById(this.movieId);if(!this.movie){var self=this;setTimeout(function(){self.receiveEvent('load',null)},1);return}if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/)){var self=this;setTimeout(function(){self.receiveEvent('load',null)},100);this.ready=true;return}this.ready=true;this.movie.setText(this.clipText);this.movie.setHandCursor(this.handCursorEnabled);break;case'mouseover':if(this.domElement&&this.cssEffects){this.domElement.addClass('hover');if(this.recoverActive)this.domElement.addClass('active')}break;case'mouseout':if(this.domElement&&this.cssEffects){this.recoverActive=false;if(this.domElement.hasClass('active')){this.domElement.removeClass('active');this.recoverActive=true}this.domElement.removeClass('hover')}break;case'mousedown':if(this.domElement&&this.cssEffects){this.domElement.addClass('active')}break;case'mouseup':if(this.domElement&&this.cssEffects){this.domElement.removeClass('active');this.recoverActive=false}break}if(this.handlers[eventName]){for(var idx=0,len=this.handlers[eventName].length;idx<len;idx++){var func=this.handlers[eventName][idx];if(typeof(func)=='function'){func(this,args)}else if((typeof(func)=='object')&&(func.length==2)){func[0][func[1]](this,args)}else if(typeof(func)=='string'){window[func](this,args)}}}}};ZeroClipboard.setMoviePath('https://i.rozetka.com.ua/flash/ZeroClipboard.swf');var VotingPopup_class=new Class({options:{'tpl':{'popup_tpl':'<div class=\"popup-vote\">\n\t<div class=\"popup-css\">\n\t\t<a href=\"#\" class=\"popup-close\" name=\"close\"><img width=\"18\" height=\"18\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"&times;\" class=\"popup-close-medium-icon sprite\"><\/a>\n\t\t<div class=\"auth-new\" name=\"content\"><\/div>\n\t<\/div>\n<\/div>','popup_content_tpl':'<p>\u0427\u0442\u043e\u0431\u044b \u043f\u0440\u043e\u0433\u043e\u043b\u043e\u0441\u043e\u0432\u0430\u0442\u044c <a href=\"#\" name=\"promo-signin\" class=\"underline\">\u0432\u043e\u0439\u0434\u0438\u0442\u0435<\/a> \u0438\u043b\u0438 <a href =\"https:\/\/my.rozetka.com.ua\/signup\/\" class=\"underline\">\u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u0443\u0439\u0442\u0435\u0441\u044c<\/a><\/p>\n'},'signin_selector':'a[name=promo-signin]','timeout':1000},popup:null,is_open:null,content:null,timeout:null,initialize:function(){this.createPopup()},createPopup:function(){this.popup=new Element('div');this.popup.setStyles({position:'absolute',top:0,'z-index':10000});this.hide();this.popup.setHTML(this.options.tpl.popup_tpl);this.content=this.popup.getElement('[name=content]');$(document.body).adopt(this.popup);$(document.body).addEvent('click',this.hide.bind(this));this.popup.addEvent('click',function(e){new Event(e).stopPropagation()});window.addEvent('keydown',function(e){if((new Event(e).key)==='esc'&&this.is_open)this.hide()}.bind(this))},setContent:function(){this.content.setHTML(this.options.tpl.popup_content_tpl)},bindEvents:function(){this.sign_in=this.popup.getElement(this.options.signin_selector);this.sign_in.addEvent('click',function(e){User.toggleSignIn();window.scrollTo(0,0);new Event(e).stop()})},getPopup:function(){return this.popup},getCoordinates:function(){return this.popup.getFirst().getCoordinates()},setStyles:function(styles){this.popup.setStyles(styles)},show:function(){this.setContent();this.bindEvents();this.popup.removeClass('hidden');this.is_open=true},hideOnDelay:function(delay){this.clearTimeout();var delay=delay||this.options.timeout;this.is_open=false;this.timeout=setTimeout(this.checkToHide.bind(this),delay)},checkToHide:function(){if(!this.is_open){this.hide()}},hide:function(){this.popup.addClass('hidden');this.is_open=false},clearTimeout:function(){if(this.timeout){clearTimeout(this.timeout)}}});VotingPopup_class.implement(new Options);var AuthorizationVotingPopup_class=VotingPopup_class.extend({options:{'tpl':{'popup_tpl':'<div class=\"popup-vote\">\n\t<div class=\"popup-css\">\n\t\t<a href=\"#\" class=\"popup-close\" name=\"close\"><img width=\"18\" height=\"18\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"&times;\" class=\"popup-close-medium-icon sprite\"><\/a>\n\t\t<div class=\"auth-new\" name=\"content\"><\/div>\n\t<\/div>\n<\/div>','unauthorized_tpl':'\n<div class=\"mes-red\">\u0414\u043b\u044f \u0442\u043e\u0433\u043e, \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u043e\u0433\u043e\u043b\u043e\u0441\u043e\u0432\u0430\u0442\u044c, \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u043d\u0430&nbsp;\u0441\u0430\u0439\u0442\u0435<\/div>\n<form class=\"f-signin\">\n\t<div class=\"f-item\">\n\t\t<div class=\"f-title\">\u042d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0430\u044f \u043f\u043e\u0447\u0442\u0430:<\/div>\n\t\t<input type=\"text\" class=\"input-text\" name=\"login\" _required=\"required\" value=\"${User.getEmail()}\"\n\t\t\t   pattern=\"^[_A-Za-z0-9-]+(\\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\\.[A-Za-z0-9-]+)*(\\.[A-Za-z0-9]{2,15})$\">\n\t<\/div>\n\n\t<div class=\"f-item\">\n\t\t<div class=\"f-title\">\u041f\u0430\u0440\u043e\u043b\u044c:<\/div>\n\t\t<input type=\"password\" class=\"input-text\" name=\"password\" _required=\"required\">\n\t<\/div>\n\n\t<div name=\"msg\" class=\"error\"><\/div>\n\n\t<div class=\"f-item\">\n\t\t<div class=\"f-title\"><a href=\"#\" class=\"xhr lightblue\" name=\"remind_password\">\u042f \u0437\u0430\u0431\u044b\u043b \u043f\u0430\u0440\u043e\u043b\u044c<\/a><\/div>\n\t<\/div>\n\n\t<div class=\"submit\">\n\t\t<button class=\"button-css-blue\" type=\"submit\" name=\"signin\">\u0412\u043e\u0439\u0442\u0438<\/button>\n\t\t<a class=\"xhr lightblue cancel\" name=\"close\" href=\"#\">\u041e\u0442\u043c\u0435\u043d\u0430<\/a>\n\t<\/div>\n\n\t<div class=\"signup-promo\">\n\t\t\u041d\u0435\u0442 \u0443\u0447\u0435\u0442\u043d\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438?<br>\n\t\t<a href=\"#\" class=\"xhr lightblue\" name=\"registration\">\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u0441\u044f<\/a>\n\t<\/div>\n\n<\/form>\n','registration_tpl':'\n<h4>\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u0443\u0447\u0451\u0442\u043d\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438<\/h4>\n<div class=\"f-comment\">\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u043e\u043b\u044f \u043e\u0442\u043c\u0435\u0447\u0435\u043d\u044b \u0437\u0432\u0435\u0437\u0434\u043e\u0447\u043a\u043e\u0439 <span class=\"require\">*<\/span><\/div>\n<form class=\"f-signup\">\n\t<div class=\"f-item\">\n\t\t<div class=\"f-title\">\u0412\u0430\u0448\u0435 \u0438\u043c\u044f: <span class=\"require\">*<\/span><\/div>\n\t\t<input type=\"text\" class=\"input-text\" name=\"first_name\" _required=\"required\">\n\t<\/div>\n\n\t<div class=\"f-item\">\n\t\t<div class=\"f-title\">\u042d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0430\u044f \u043f\u043e\u0447\u0442\u0430: <span class=\"require\">*<\/span><\/div>\n\t\t<input type=\"text\" class=\"input-text\" name=\"email\" _required=\"required\" value=\"${User.getEmail()}\" pattern=\"^[_A-Za-z0-9-]+(\\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\\.[A-Za-z0-9-]+)*(\\.[A-Za-z0-9]{2,15})$\">\n\t<\/div>\n\n\t<div class=\"f-item\">\n\t\t<div class=\"f-title\">\u041f\u0440\u0438\u0434\u0443\u043c\u0430\u0439\u0442\u0435 \u0441\u0435\u0431\u0435 \u043f\u0430\u0440\u043e\u043b\u044c: <span class=\"require\">*<\/span><\/div>\n\t\t<input type=\"password\" class=\"input-text\" name=\"password\" _required=\"required\" pattern=\"^.{6,}$\">\n\t<\/div>\n\n\t<div class=\"submit\">\n\t\t<button class=\"button-css-green\" type=\"submit\" name=\"register\">\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f<\/button>\n\t\t<a class=\"xhr lightblue cancel\" name=\"return_back\" href=\"#\">\u041e\u0442\u043c\u0435\u043d\u0430<\/a>\n\t<\/div>\n\n\t<div class=\"error\" name=\"msg\"><\/div>\n\n<\/form>\n','remind_password_tpl':'\n<h4>\u041d\u0430\u043f\u043e\u043c\u0438\u043d\u0430\u043d\u0438\u0435 \u043f\u0430\u0440\u043e\u043b\u044f<\/h4>\n<form class=\"f-remember\">\n\t<div class=\"f-item\">\n\t\t<div class=\"f-title\">\u042d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0430\u044f \u043f\u043e\u0447\u0442\u0430: <span class=\"require\">*<\/span><\/div>\n\t\t<input type=\"text\" class=\"input-text\" name=\"email\" _required=\"required\" value=\"${User.getEmail()}\" pattern=\"^[_A-Za-z0-9-]+(\\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\\.[A-Za-z0-9-]+)*(\\.[A-Za-z0-9]{2,15})$\">\n\t<\/div>\n\n\t<div class=\"f-item\">\n\t\t<div class=\"f-title f-comment\">\u041c\u044b \u0432\u044b\u0448\u043b\u0435\u043c \u0432\u0430\u043c \u043f\u0438\u0441\u044c\u043c\u043e \u0441&nbsp;\u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438<br>\u0441\u0433\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u043c \u043f\u0430\u0440\u043e\u043b\u0435\u043c<\/div>\n\t<\/div>\n\n\t<div class=\"submit\">\n\t\t<button class=\"button-css-green\" type=\"submit\" name=\"send_password\">\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c<\/button>\n\t\t<a class=\"xhr lightblue cancel\" name=\"return_back\" href=\"#\">\u041e\u0442\u043c\u0435\u043d\u0430<\/a>\n\t<\/div>\n\n\t<div name=\"msg\" class=\"error\"><\/div>\n\n<\/form>\n','confirm_remind_tpl':'<h5 class=\"auth-title\">\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0447\u0442\u044b<\/h5>\n<div class=\"email-confirm-note\">\n\t<p>\u041d\u0430&nbsp;\u0443\u043a\u0430\u0437\u0430\u043d\u043d\u0443\u044e \u0432\u0430\u043c\u0438 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0443\u044e \u043f\u043e\u0447\u0442\u0443 \u043c\u044b&nbsp;\u043e\u0442\u043f\u0440\u0430\u0432\u0438\u043b\u0438 \u043f\u0438\u0441\u044c\u043c\u043e \u0441\u043e&nbsp;\u0441\u0441\u044b\u043b\u043a\u043e\u0439 \u0434\u043b\u044f \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438. \u0427\u0442\u043e\u0431\u044b \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c \u0441\u0432\u043e\u044e \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0443\u044e \u043f\u043e\u0447\u0442\u0443, \u043f\u0435\u0440\u0435\u0439\u0434\u0438\u0442\u0435 \u043f\u043e&nbsp;\u044d\u0442\u043e\u0439 \u0441\u0441\u044b\u043b\u043a\u0435.<\/p>\n<\/div>','confirm_request_tpl':'<h4>\u0412\u044b \u043d\u0435 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u043b\u0438 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0443\u044e \u043f\u043e\u0447\u0442\u0443<\/h4>\n<div class=\"f-item\">\n\t<div class=\"f-title\">\u0414\u043b\u044f \u0442\u043e\u0433\u043e \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u043e\u0433\u043e\u043b\u043e\u0441\u043e\u0432\u0430\u0442\u044c - \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c \u0441\u0432\u043e\u044e \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0443\u044e \u043f\u043e\u0447\u0442\u0443. \u0414\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u0432 \u043f\u0438\u0441\u044c\u043c\u0435, \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u043c \u043d\u0430\u043c\u0438, \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u0435\u0440\u0435\u0439\u0442\u0438 \u043f\u043e \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u0441\u0441\u044b\u043b\u043a\u0435.<\/div>\n<\/div>\n<div class=\"submit\">\n\t<button class=\"button-css-green\" type=\"submit\" name=\"send_request\">\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u043f\u0438\u0441\u044c\u043c\u043e<\/button>\n\t<a class=\"xhr lightblue cancel\" name=\"close\" href=\"#\">\u0417\u0430\u043a\u0440\u044b\u0442\u044c<\/a>\n<\/div>\n<div name=\"msg\" class=\"error\"><\/div>'},'selectors':{'send_request':'[name=send_request]','registration':'[name=registration]','return_back':'[name=return_back]','remind_password':'[name=remind_password]','send_password':'[name=send_password]','register':'[name=register]','signin':'[name=signin]','msg':'[name=msg]','login':'[name=login]'},'ajax':{'signin':'https://my.rozetka.com.ua/signin/#SignIn','remind':'https://my.rozetka.com.ua/remind-password/#remindPassword','signup':'https://my.rozetka.com.ua/signup/#SignUp','confirm':'https://my.rozetka.com.ua/confirm-email/#sendCode'},'process':'<img src="https://i.rozetka.com.ua/ajax.gif" alt="AJAX process"/>'},currently_signed_up:null,initialize:function(){this.parent();User.addEvent('signIn',this.onSignIn.bind(this));User.addEvent('signOut',this.onUnauthorizedUser.bind(this))},onSignIn:function(){if(this.currently_signed_up){this.onConfirmNotify()}else if(!User.getProperty('confirmed')){this.onRequestConfirm()}else{this.hide()}},onRequestConfirm:function(){this.changeContent(this.options.tpl.confirm_request_tpl);var send_request_btn=this.popup.getElement(this.options.selectors.send_request);send_request_btn.addEvent('click',this.action.bindWithEvent(this,'sendConfirmMail'))},sendConfirmMail:function(){this.popup.processStart(this.options.process);new Ajax('/cgi-bin/form.php',{method:'post',headers:{ajaxAction:this.options.ajax.confirm},onComplete:this.onSendConfirmMail.bind(this)}).request()},onSendConfirmMail:function(resp){this.popup.processStop();var Response=new Response_class(resp);this.popup.getElement(this.options.selectors.send_request).hide();if(Response.Message){this.popup.getElement(this.options.selectors.msg).setHTML(Response.Message.content)}},onUnauthorizedUser:function(){this.changeContent(this.options.tpl.unauthorized_tpl);var registration=this.popup.getElement(this.options.selectors.registration);var remind_password=this.popup.getElement(this.options.selectors.remind_password);var signin=this.popup.getElement(this.options.selectors.signin);var login=this.popup.getElement(this.options.selectors.login);registration.addEvent('click',this.action.bindWithEvent(this,'onRegistration'));remind_password.addEvent('click',this.action.bindWithEvent(this,'onRemindPassword'));signin.addEvent('click',this.action.bindWithEvent(this,'signin'));if(Cookie.get("login")&&login){login.value=Cookie.get("login")}},signin:function(){var options={};options.onComplete=this.onSingnin.bind(this);options.headers={'ajaxAction':this.options.ajax.signin};this.popup.getElement('form').trySend(options)},onSingnin:function(resp){var Response=new Response_class(resp);this.popup.getElement('form').processStop();if(!Response.isError()){Cookie.set('login',this.popup.getElement(this.options.selectors.login).value,{duration:183,domain:'rozetka.com.ua',path:'/'})}else{Cookie.remove('login',{domain:'rozetka.com.ua',path:'/'});if(Response.Message){this.popup.getElement(this.options.selectors.msg).setHTML(Response.Message.content)}}if($defined(Response.action)){$defined(Response.S)?S.onLoad(Response.S):S.load()}},onRegistration:function(){this.changeContent(this.options.tpl.registration_tpl);var return_back=this.popup.getElement(this.options.selectors.return_back);var register=this.popup.getElement(this.options.selectors.register);return_back.addEvent('click',this.action.bindWithEvent(this,'onUnauthorizedUser'));register.addEvent('click',this.action.bindWithEvent(this,'signUp'))},signUp:function(){var options={headers:{'ajaxAction':this.options.ajax.signup},onComplete:this.onSignUp.bind(this)};this.popup.getElement('form').trySend(options)},onSignUp:function(resp){this.popup.getElement('form').processStop();var Response=new Response_class(resp);if(!Response.isDone()&&Response.Message){this.popup.getElement(this.options.selectors.msg).setHTML(Response.Message.content)}if($defined(Response.action)){this.currently_signed_up=true;$defined(Response.S)?S.onLoad(Response.S):S.load()}},onRemindPassword:function(){this.changeContent(this.options.tpl.remind_password_tpl);var return_back=this.popup.getElement(this.options.selectors.return_back);var send_password=this.popup.getElement(this.options.selectors.send_password);var login=this.popup.getElement(this.options.selectors.login);return_back.addEvent('click',this.action.bindWithEvent(this,'onUnauthorizedUser'));send_password.addEvent('click',this.action.bindWithEvent(this,'sendPasswordMail'));if(Cookie.get("login")&&login){login.value=Cookie.get("login")}},sendPasswordMail:function(){var options={headers:{'ajaxAction':this.options.ajax.remind},onComplete:this.onSendPassword.bind(this)};this.popup.getElement('form').trySend(options)},onSendPassword:function(resp){this.popup.getElement('form').processStop();var Response=new Response_class(resp);this.popup.getElement(this.options.selectors.msg).setHTML(Response.Message.content)},onConfirmNotify:function(){this.changeContent(this.options.tpl.confirm_remind_tpl)},action:function(e,method){new Event(e).stop();this[method]()},bindEvents:function(){this.popup.getElements('[name=close]').each(function(elem){elem.addEvent('click',function(e){new Event(e).stop();this.hide()}.bind(this))}.bind(this))},setContent:function(){if(User.isAuth()){if(!User.getProperty('confirmed')){this.onRequestConfirm()}}else{this.onUnauthorizedUser()}},changeContent:function(content){this.content.setHTML(content);this.bindEvents()}});AuthorizationVotingPopup_class.implement(new Options);var Prices_class=new Class({Class:'Prices_class',options:{},is_updated:0,user_price_type:null,initialize:function(options){if(S.checkup)this.onLoadS(S);S.addEvent('loadS',function(S){this.onLoadS(S)}.bind(this));App.addOnDomReady(function(){this.update()}.bind(this))},init:function(id){},onLoadS:function(S){if(S.user&&S.user.price_type){this.user_price_type=S.user.price_type}else{this.user_price_type=null}this.update()},isShowAllowed:function(){return this.user_price_type!=undefined},update:function(){if(this._collectElements()){if(this.isShowAllowed()){this.showAdditionalElemnts()}else{this.hideAdditionalElemnts()}this.fireEvent('update');this.is_updated=1}},showAdditionalElemnts:function(){for(var i=0;i<this.additional_elements.length;i++){if(this.additional_elements[i].hasClass('hidden')){this.additional_elements[i].removeClass('hidden')}}for(var i=0;i<this.original_elements.length;i++){if(!this.original_elements[i].hasClass('hidden')&&this._hasCurrentPriceTypeReplacement(this.original_elements[i])){this.original_elements[i].addClass('hidden')}}},hideAdditionalElemnts:function(){for(var i=0;i<this.additional_elements.length;i++){if(!this.additional_elements[i].hasClass('hidden')){this.additional_elements[i].addClass('hidden')}}for(var i=0;i<this.original_elements.length;i++){if(this.original_elements[i].hasClass('hidden')){this.original_elements[i].removeClass('hidden')}}},_hasCurrentPriceTypeReplacement:function(original_element){var repalcements=original_element.getParent().getElements("[name*=prices|"+this.user_price_type+"]");return repalcements.length},_collectElements:function(){if(this.user_price_type!=null){var selector="[name*=prices|"+this.user_price_type+"]";this.additional_elements=$$(selector);this.original_elements=$$("[name*=prices_active_element_original]")}return this.additional_elements}});Prices_class.implement(new Events);var RozetkaPrices_class=Prices_class.extend({initialize:function(options){this.parent(options);document.addEvent('loadContentComplete',function(){this.update()}.bind(this))},isShowAllowed:function(){var is_allowed=true;var promotions=null;var curentTime=new Date();if(typeof PricesPromotions!="undefined"){promotions=PricesPromotions.getPromotionsData();for(var promotion in promotions){if(promotions[promotion].special_price&&promotions[promotion].special_price==this.user_price_type&&promotions[promotion].end_date<curentTime.getTime()){is_allowed=false;break}}}return this.user_price_type!=undefined&&is_allowed},showAdditionalElemnts:function(){this.parent();window.fireEvent('updateTrackBar')}});var RozetkaPromotions_class=new Class({_goods_id_to_promotion_data:{},_goods_id_to_additional_text:{},setGoodsByPriceType:function(price_type,goods_id){for(var i in this._goods_id_to_promotion_data){if(this._goods_id_to_promotion_data[i].special_price==price_type){if(!this._goods_id_to_promotion_data[i].promo_goods){this._goods_id_to_promotion_data[i].promo_goods=[goods_id]}else{this._goods_id_to_promotion_data[i].promo_goods.push(goods_id)}}}},setPromotionsData:function(goods_id_to_promotion_data){this._goods_id_to_promotion_data=goods_id_to_promotion_data},getPromotionsData:function(){return this._goods_id_to_promotion_data},mergePromotionsData:function(goods_id_to_promotion_data){$extend(this._goods_id_to_promotion_data,goods_id_to_promotion_data)},setAdditionalText:function(goods_id_to_additional_text){this._goods_id_to_additional_text=goods_id_to_additional_text},getAdditionalText:function(){return this._goods_id_to_additional_text},mergeAdditionalText:function(goods_id_to_additional_text){$extend(this._goods_id_to_additional_text,goods_id_to_additional_text)}});var RozetkaPromotionsMembersForm_class=new Class({Class:'RozetkaPromotionsMembersForm_class',options:{selectors:{form:'member_registration_form',get_from_account:'a[name=get_from_account]',rules:'a[name=rules]',agree:'input[name=agree]',pass_block:'div[name=pass]',login_button:'button[name=login]',msg:'div[name=msg]',auth_phone_block:'#phone_auth_block',phone_block_password:'[name="phone_block_password"]'},popup:{header_tpl:'<div class=\"popup-css popup-promo-completed\">\n\t<a href=\"#\" class=\"popup-close-medium-delivery\" name=\"close\">\n\t\t<img width=\"18\" height=\"18\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"\u00d7\" class=\"popup-close-medium-icon sprite\">\n\t<\/a>\n\t<div name=\"content\" class=\"promo-rules-content\"><\/div>\n<\/div>',confirm_request_tpl:'<h5 class=\"auth-title\">\u0412\u044b \u043d\u0435 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u043b\u0438 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0443\u044e \u043f\u043e\u0447\u0442\u0443<\/h5>\n<p>\u0414\u043b\u044f \u0442\u043e\u0433\u043e, \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u0438\u043d\u044f\u0442\u044c \u0443\u0447\u0430\u0441\u0442\u0438\u0435 \u0432 \u0430\u043a\u0446\u0438\u0438, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u0441\u0432\u043e\u044e \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0443\u044e \u043f\u043e\u0447\u0442\u0443.<\/p>\n<p>\u0414\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u0432 \u043f\u0438\u0441\u044c\u043c\u0435, \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u043c \u043d\u0430\u043c\u0438, \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u0435\u0440\u0435\u0439\u0442\u0438 \u043f\u043e \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u0441\u0441\u044b\u043b\u043a\u0435.<\/p>\n<div class=\"auth-f-submit-btn submit-register\">\n    <span class=\"btn-link btn-link-blue\">\n        <button type=\"submit\" class=\"btn-link-i\" name=\"send_request\">\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u043f\u0438\u0441\u044c\u043c\u043e<\/button>\n    <\/span>\n<\/div>\n<div name=\"msg\" class=\"error\"><\/div>'},requestURL:'/cgi-bin/form.php',ajax:{registration:'https://my.rozetka.com.ua/promotions/members/#singUpPromotionMember',user_data:'https://my.rozetka.com.ua/promotions/members/#getUserData',check_sms_code:'https://my.rozetka.com.ua/promotions/members/#checkSmsCode'},message:{tpl:'<div class=\"sprite-side message code${code}\">\n\t<a href=\"#\" class=\"message-close-link\" onclick=\"clearUserMessages(event, \u0027msg\u0027);\">\n\t\t<img src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" width=\"24\" height=\"24\" class=\"sprite message-close-link-img\">\n\t<\/a>\n\t${content}\n<\/div>\n',field_error:'<div class=\"sprite-side message code${code}\">\n\t<a href=\"#\" class=\"message-close-link\" onclick=\"clearUserMessages(event, \u0027${field}\u0027);\">\n\t\t<img src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" width=\"24\" height=\"24\" class=\"sprite message-close-link-img\">\n\t<\/a>\n\t${content}\n<\/div>\n',phone_pass:'<div class=\"viewed-auth-message pos-fix sprite-side message code${code}\">\n\t<a href=\"#\" class=\"message-close-link\" onclick=\"clearUserMessages(event, \u0027phone_block_password\u0027);\">\n\t\t<img src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" width=\"24\" height=\"24\" class=\"sprite message-close-link-img\">\n\t<\/a>\n\t${content}\n<\/div>'},tpl:{message:'<div class="pos-fix sprite-side message code${code}"> <a href="" class="message-close-link" onclick="clearUserMessages(event);"> <img src="https://i.rozetka.com.ua/design/_.gif" width="24" height="24" class="sprite message-close-link-img"> </a> ${content} </div>',field:'<div class=\"promo-auth-f-i-filled\">${text}<\/div>\n<div class=\"promo-auth-f-i-change\">\n\t<a href=\"#\" class=\"xhr novisited\">\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c<\/a>\n<\/div>',password:'<div class=\"promo-details-reg-i clearfix p-form-item\">\n\t<div class=\"promo-details-reg-i-label p-form-i-title\">\u041f\u0430\u0440\u043e\u043b\u044c<\/div>\n\t<div class=\"promo-details-reg-i-right\">\n\t\t<input type=\"password\" name=\"pass\" class=\"input-text \">\n\t<\/div>\n\t<div class=\"clearfix auth-f-submit-btn\">\n\t\t<span class=\"btn-link btn-link-blue\">\n\t\t\t<button name=\"login\" class=\"btn-link-i\">\u0412\u043e\u0439\u0442\u0438<\/button>\n\t\t<\/span>\n\t<\/div>\n<\/div>',successfull_popup_info:'{if promotion_text_popup}\n\t${promotion_text_popup}\n{else}\n\t{if order_id != 0}\n\t\t<h2 class=\"promo-reg-completed-title\">\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u0432 \u0430\u043a\u0446\u0438\u0438 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430<\/h2>\n\t\t<p class=\"promo-reg-completed-text\">\u0421\u043f\u0430\u0441\u0438\u0431\u043e! \u0412\u0430\u0448 \u0437\u0430\u043a\u0430\u0437 <span class=\"bold\">\u2116${order_id}<\/span> \u043f\u0440\u0438\u043d\u044f\u0442<\/p>\n\t\t{if promotion_end_data}\n\t\t\t<p class=\"promo-reg-completed-text-date\">\n\t\t\t\t\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u0440\u043e\u0437\u044b\u0433\u0440\u044b\u0448\u0430 \u0431\u0443\u0434\u0443\u0442 \u043e\u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u043d\u044b <span class=\"bold\">${promotion_end_data[\u0027day\u0027]} ${promotion_end_data[\u0027month\u0027]} ${promotion_end_data[\u0027year\u0027]} \u0433\u043e\u0434\u0430<\/span>\n\t\t\t<\/p>\n\t\t{\/if}\n\t\t<p class=\"promo-reg-completed-text\">\u0418\u0441\u043a\u0440\u0435\u043d\u043d\u0435 \u0436\u0435\u043b\u0430\u0435\u043c \u0432\u0430\u043c \u043f\u043e\u0431\u0435\u0434\u044b!<\/p>\n\t\t<p class=\"promo-reg-completed-remark\">*\u0432\u0441\u0435 \u043d\u043e\u043c\u0435\u0440\u0430 \u0437\u0430\u043a\u0430\u0437\u043e\u0432 \u043f\u0440\u043e\u0445\u043e\u0434\u044f\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443, \u043f\u0440\u0438 \u043d\u0435\u0441\u043e\u0431\u043b\u044e\u0434\u0435\u043d\u0438\u0438 \u043f\u0440\u0430\u0432\u0438\u043b \u0430\u043a\u0446\u0438\u0438 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0430\u043d\u043d\u0443\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u0430<\/p>\n\n\t{else}\n\n\t\t<h2 class=\"promo-reg-completed-title\">\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u0432 \u0430\u043a\u0446\u0438\u0438 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430<\/h2>\n\t\t<p class=\"promo-reg-completed-text\">\u0421\u043f\u0430\u0441\u0438\u0431\u043e!<\/p>\n\t\t<p class=\"promo-reg-completed-text\">\n\t\t\t\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u0440\u043e\u0437\u044b\u0433\u0440\u044b\u0448\u0430 \u0431\u0443\u0434\u0443\u0442 \u043e\u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u043d\u044b \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435 <a class=\"novisited promo-reg-completed-link\" href=\"${promotion_href}\">${promotion_href}<\/a>\n\t\t<\/p>\n\t\t<p class=\"promo-reg-completed-text\">\u0418\u0441\u043a\u0440\u0435\u043d\u043d\u0435 \u0436\u0435\u043b\u0430\u0435\u043c \u0432\u0430\u043c \u043f\u043e\u0431\u0435\u0434\u044b!<\/p>\n\n\t{\/if}\n{\/if}',confirm_phone:'<h2 style=\"color:green\">\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430<\/h2>\n<br>\n<p style=\"font-size: font-size: 1.2em;\">\u0414\u043b\u044f \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430 \u043c\u044b \u0432\u044b\u0441\u043b\u0430\u043b\u0438 \u0432\u0430\u043c \u043f\u0430\u0440\u043e\u043b\u044c \u0432 SMS',auth_by_phone:'<div class=\"auth-by-phone-message auth-message sprite-side\">\n\n\t<h2>\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430<\/h2>\n\t<p>\u0414\u043b\u044f \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430 \u043c\u044b \u0432\u044b\u0441\u043b\u0430\u043b\u0438 \u0432\u0430\u043c \u043f\u0430\u0440\u043e\u043b\u044c \u0432 SMS<\/p>\n\n\t<div class=\"promo-details-reg-i clearfix p-form-item\">\n\t\t<div class=\"promo-details-reg-i-label p-form-i-title\">\u041f\u0430\u0440\u043e\u043b\u044c<\/div>\n\t\t<div class=\"promo-details-auth-by-phone\">\n\t\t\t<input type=\"password\" name=\"pass\" class=\"input-text auth-by-phone-input-text\" _required=\"required\">\n\t\t\t<div name=\"phone_block_password\"><\/div>\n\t\t<\/div>\n\t\t<div class=\"clearfix\">\n\t\t\t<span class=\"btn-link btn-link-blue auth-f-submit-btn\">\n\t\t\t\t<button onclick=\"document.fireEvent(\u0027confirmPhone\u0027)\"\n\t\t\t\t\t\tname=\"login\" class=\"btn-link-i\">\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c<\/button>\n\t\t\t<\/span>\n\t\t<\/div>\n\t<\/div>\n<\/div>',process:'<img src=\"https:\/\/i1.rozetka.com.ua\/design\/check-ajax.gif\" width=\"64\" height=\"64\" alt=\"\u041e\u0442\u043f\u0440\u0430\u0432\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445\" class=\"process\"\/>'},_auth_blocks_options:{tpl:{message:'<div class=\"pos-fix sprite-side message code${code}\">\n\t<a href=\"\" class=\"message-close-link\" onclick=\"clearUserMessages(event, \u0027msg\u0027)\">\n\t\t<img src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" width=\"24\" height=\"24\" class=\"sprite message-close-link-img\">\n\t<\/a>\n\t${content}\n<\/div>'},selectors:{send_form_btn_block:'[name="submit_form_btn_block"]'},track_email_change:true,blocks_type:'promotion'}},user_data:null,wait_auth:null,initialize:function(parent){this.parent=parent;if(this.parent.options.form_options){this.setOptions(this.parent.options.form_options)}this.form=$(this.options.selectors.form);this.form.get_from_account=this.form.getElement(this.options.selectors.get_from_account);this.form.rules=this.form.getElement(this.options.selectors.rules);this.form.agree=this.form.getElement(this.options.selectors.agree);this.form.submit_block=this.form.getElement(this.options._auth_blocks_options.selectors.send_form_btn_block);this.msg_block=this.form.msg=this.form.getElement(this.options.selectors.msg);this.auth_phone_block=this.form.getElement(this.options.selectors.auth_phone_block);this.form.addEvent('submit',this.onSubmit.bind(this));if(this.form.get_from_account){this.form.get_from_account.addEvent('click',this.onGetAccuntData.bind(this))}if(this.form.rules){this.form.rules.addEvent('click',this.parent.showRules.bind(this.parent))}User.addEvent('signIn',this.onSignIn.bind(this));User.addEvent('signInFailed',this.onSignInFailed.bind(this));User.addEvent('signOut',function(){if(this.form){this.form.email&&this.form.email.show();this.form.email_disabled&&this.form.email_disabled.hide()}}.bind(this));User.addEvent('signIn',this.getUserData.bind(this));if(User.isAuth()){this.getUserData()}},onSubmit:function(e){new Event(e).stop();var options={headers:{'ajaxAction':this.options.ajax.registration},onComplete:this.checkResp.bind(this)},agree_msg_content=',     ',not_valid_elements=this.form.notValid();if(!this.form.agree||this.form.agree.checked){this.form.agree_msg&&this.form.agree_msg.remove();this.msg_block&&(this.msg_block.innerHTML='');this.form.agree_msg=null;this._hideConfirmPhoneBlock();this._setGTMErrorFields(not_valid_elements);this.form.trySend(options)}else{if(not_valid_elements&&not_valid_elements.length){not_valid_elements.push(this.form.agree)}this._setGTMErrorFields(not_valid_elements,agree_msg_content);if(!this.form.agree_msg){this.form.agree_msg=new Element('div',{name:'msg'}).inject(this.form.agree,'before')}this.form.agree_msg.setHTML(App.getHTML(this.options.message.tpl,{code:Message_class.prototype.CODE.ERROR,content:agree_msg_content}))}},_setGTMErrorFields:function(fields,message){if(fields&&fields.length){var event_data={extend_event:[]},eventContent=[],separator='/';fields.each(function(field){if(field.getAttribute('name')){eventContent.push(field.getAttribute('name'))}});if(eventContent.length){event_data.extend_event.push({name:'eventContent',value:eventContent.join(separator)});if(message){event_data.extend_event.push({name:'eventError',value:message})}document.fireEvent('promoAttemptLogin',event_data)}}},checkResp:function(resp){this.msg_block&&this.msg_block.hide();this._hideConfirmPhoneBlock();var Response=new Response_class(resp),popup,params;this.form.processStop();if(!Response.isError()&&Response.content){popup=new Popup_class(this.options.popup.header_tpl);popup.setContent(App.getHTML(this.options.tpl.successfull_popup_info,Response.content),this.form);popup.open()}else{if(Response.Message.code==Response.Message.CODE.REQUIRED_AUTHORIZE){params=this.extractMessageParams(Response.Message);this.login_type=params['login_type']?params['login_type']:'email';this._needAuthorize(Response.Message)}else{this._showErrorMessage(Response.Message)}}Response.doAction()},_showErrorMessage:function(Message){this.msg_block=this.form.msg;var field=Message.field&&this.form.getElement('[name="'+Message.field+'"]');if(field){this.msg_block=field;this.msg_block.setHTML(Message.getContentTpl(this.options.message.field_error))}else{this.msg_block.setHTML(Message.getContentTpl(this.options.message.tpl))}this.msg_block.show()},extractMessageParams:function(message){var params=[];if(message.content['text']){for(param_name in message.content){params[param_name]=message.content[param_name]}message.content=message.content['text']}return params},onGetAccuntData:function(e){new Event(e).stop();if(User.isAuth()){this.getUserData()}else{this.showAuthPopup()}},getUserData:function(){this.form.processStart(this.options.tpl.process);new Ajax(this.options.requestURL,{data:{promotion_id:this.form.promotion.value},method:'post',headers:{'ajaxAction':this.options.ajax.user_data},onComplete:this.onGetUserData.bind(this)}).request()},onGetUserData:function(resp){var Response=new Response_class(resp);if(Response.content){this.user_data=Response.content;this.setFields(this.user_data)}this.form.processStop()},setFields:function(data){var names=['fio','phone','email','city'];names.each(function(name){if(data[name]&&this.form[name]){this.form[name].value=data[name];if(name=='email'&&this.form.email_disabled){this.form.email_disabled.value=data[name];this.form.email_disabled.show();this.form.email.hide()}}}.bind(this))},_needAuthorize:function(msg){if('phone'==this.login_type){this._showAuthByPhoneBlock()}else if('email'==this.login_type){if(!this._auth_blocks){this._auth_blocks=new AuthorizationBlocks_class(this.form,this.options._auth_blocks_options)}this._auth_blocks.needAuth(msg)}},_showAuthByPhoneBlock:function(){this.form.submit_block.addClass('disabled');this.form.phone.addEvent('keyup',this._hideConfirmPhoneBlock.bind(this));this.auth_phone_block.setHTML(App.getHTML(this.options.tpl.auth_by_phone));this.auth_phone_block.getElement(this.options.selectors.login_button).addEvent('click',this.onPassInput.bind(this));var msg_block=this.auth_phone_block.getElement(this.options.selectors.phone_block_password);if(msg_block){msg_block.hide()}this.auth_phone_block.show();document.fireEvent('confirmCode')},_hideConfirmPhoneBlock:function(){if(this.auth_phone_block){this.form.phone.removeEvents('keyup');this.auth_phone_block.hide();this.form.submit_block.removeClass('disabled')}},showAuthPopup:function(){if(!this.auth_popup){this.auth_popup=new RozetkaAuthorizationVotingPopup_class();this.auth_popup.setOptions({'tpl':{'confirm_request_tpl':this.options.popup.confirm_request_tpl}})}this.auth_popup.show()},onPassInput:function(e){new Event(e).stop();if('phone'==this.login_type){this.checkSmsCode()}else{this.signIn()}},checkSmsCode:function(){if(this.form.pass.isValid()){this.form.processStart(this.options.tpl.process);this.wait_auth=true;new Ajax(this.options.requestURL,{data:{phone:this.form.phone.value,code:this.form.pass.value,email:this.form.email.value},method:'post',headers:{'ajaxAction':this.options.ajax.check_sms_code},onComplete:User.checkSignIn.bind(User)}).request()}else{this.form.pass.focus();this.form.pass.highlightError()}},signIn:function(){this.form.processStart(this.options.tpl.process);this.wait_auth=true;User.trySignIn({login:this.form[this.login_type].value,password:this.form.pass.value})},onSignIn:function(S){if(!this.wait_auth)return 0;this.msg_block=this.form.msg;this.msg_block.setHTML(App.getHTML(this.options.message.tpl,{code:Message_class.prototype.CODE.DONE,content:'    !'}));if(this.login_type!=='phone'){this.form.pass_block.hide()}else{this._hideConfirmPhoneBlock()}this.form.processStop();this.wait_auth=false},onSignInFailed:function(response_message){if(!this.wait_auth)return 0;if('phone'==this.login_type&&response_message.field=='password'){var msg_block=this.auth_phone_block.getElement(this.options.selectors.phone_block_password);if(msg_block){msg_block.setHTML(response_message.getContentTpl(this.options.message.phone_pass));msg_block.show()}}else{this.msg_block=this.form.msg;this.msg_block.setHTML(response_message.getContentTpl(this.options.message.tpl));this.msg_block.show()}this.form.processStop();this.wait_auth=false}});RozetkaPromotionsMembersForm_class.implement(new Options);var RozetkaPromotionsWithCardMemebersForm_class=RozetkaPromotionsMembersForm_class.extend({Class:'RozetkaPromotionsWithCardMemebersForm_class',options:{card_number_container:'card_number',form_fields_checker_templates:{card_number:{ok:'<span class=\"promo-msg-good\">\u041a\u0430\u0440\u0442\u0430 \u043f\u0440\u0438\u043d\u044f\u0442\u0430<\/span>',fail:'<span class=\"promo-msg-bad\">\u041d\u0435 \u0432\u0430\u043b\u0438\u0434\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u043a\u0430\u0440\u0442\u044b<\/span>'},default_template:{ok:'<span class=\"promo-msg-good\">Ok!<\/span>',fail:'<span class=\"promo-msg-bad\">\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u0432\u0432\u043e\u0434\u0430<\/span>'}}},ga_category:'Special clubs',initialize:function(parent){this.parent(parent);this.form.getElements("input[type=text]").each(function(elem){elem.addEvent('blur',this.onBlur.bindWithEvent(this));if(elem.name!=this.options.card_number_container){elem.disabled=1}}.bind(this));$(this.options.card_number_container).addEvent('keyup',this.onBlur.bindWithEvent(this));this.form.getElement("button[type=submit]").disabled=1;this.form.getElement("button[type=submit]").getParent().addClass('disabled');this.msg_container=$('promotion_msg');this.form['email'].addEvent('keyup',function(event){var evnt=new Event(event);if(evnt.key.length==1||evnt.key=='delete'||evnt.key=='backspace'){clearTimeout(this.timer);this.timer=setTimeout(this.onBlur(event),300)}}.bind(this));this.form.setFocus()},onBlur:function(event){var event=new Event(event);var not_valid_fields;not_valid_fields=this.form.notValid();if($(this.options.card_number_container)==$(event.target)){var need_check=true;if($(this.options.card_number_container).value.length<13){need_check=false}if(need_check){this.showCheckResult($(this.options.card_number_container),this.validateCardNumber());if(this.validateCardNumber()){this.form['email'].disabled=0;$(this.options.card_number_container).removeClass('active');$('login_href').removeClass('hidden');$('login_href').getElement('a').removeEvents();$('login_href').getElement('a').addEvent('click',function(e){new Event(e).stop();rozetkaEvents.trackEvent(this.ga_category,this.options.promotion.name,'form/authorization/enter');this.showPassField()}.bindWithEvent(this))}}}else if($(event.target).name=='email'){if(!not_valid_fields.contains(event.target)){this.showCheckResult($(event.target),this.validateEmail($(event.target).value))}else if(event.type!='keyup'){this.showCheckResult($(event.target),!not_valid_fields.contains(event.target))}}else{this.showCheckResult($(event.target),!not_valid_fields.contains(event.target))}},validateCardNumber:function(){var is_valid=false;var check_sum=0;var card_number=$(this.options.card_number_container).value;card_number=card_number.replace(/[^0-9]/g,'');if(card_number.length==13&&card_number.substr(0,4)==2013){for(var i=0;i<card_number.length;i++){check_sum+=card_number[i]*((i%2)?3:1)}is_valid=!(check_sum%10)}return is_valid},validateEmail:function(email){var is_valid=true;this.form.processStart(this.options.tpl.process);new Ajax('/cgi-bin/form.php',{method:'post',data:{email:email},headers:{ajaxAction:this.options.ajax.check_email},onComplete:this.oncheckEmail.bind(this)}).request();return is_valid},hidePassField:function(){if(this.form.pass_block){this.form.pass_block.hide()}},hideRemindPassField:function(){if(this.form.remind_block){this.form.remind_block.hide()}},onPassInput:function(e){var not_valid_fields=this.form.notValid();new Event(e).stop();if(not_valid_fields.contains(this.form['email'])){this.showCheckResult(this.form['email'],false)}else{if('phone'==this.login_type){this.checkSmsCode()}else{this.signIn()}}},showPassField:function(){this.hideRemindPassField();this.parent();this.form.remind_href=this.form.pass_block.getElement('a[name="remind_password"]');this.form.remind_href.removeEvents();$('login_close').removeEvents();$('login_close').addEvent('click',function(e){new Event(e).stop();this.hidePassField()}.bindWithEvent(this));this.form.remind_href.addEvent('click',function(e){new Event(e).stop();this.showRemindPassField();rozetkaEvents.trackEvent(this.ga_category,this.options.promotion.name,'form/authorization/forgot')}.bind(this))},showRemindPassField:function(){this.hidePassField();if(!this.form.remind_block){this.form.remind_block=new Element('div').setHTML(App.getHTML(this.options.tpl.remind_password)).injectAfter(this.form.msg);this.form.remind_button=this.form.remind_block.getElement('button[name=remind]');this.form.remind_button.addEvent('click',this.onRemindPassword.bindWithEvent(this));$('remind_close').addEvent('click',function(e){new Event(e).stop();this.hideRemindPassField()}.bind(this))}else{this.form.remind_block.show()}if('phone'==this.login_type){var popup=new Popup_class(this.options.popup.header_tpl);popup.setContent(App.getHTML(this.options.tpl.confirm_phone),this.form);popup.open()}},onRemindPassword:function(e){new Event(e).stop();var not_valid_fields=this.form.notValid();if(not_valid_fields.contains(this.form['email'])){this.showCheckResult(this.form['email'],!not_valid_fields.contains(this.form['email']))}else{this.form.processStart(this.options.tpl.process);new Ajax('/cgi-bin/form.php',{method:'post',data:{email:this.form['email'].value},headers:{ajaxAction:this.options.ajax.remind_password},onComplete:this.onRemindComplete.bind(this)}).request();rozetkaEvents.trackEvent(this.ga_category,this.options.promotion.name,'form/authorization/new-password')}},onRemindComplete:function(resp){this.form.processStop();this.hideRemindPassField();this.showPassField();var Response=new Response_class(resp);if(!Response.isError()){if(Response.Message){this.form.msg.setHTML(Response.Message.getContentTpl(this.options.message.tpl));this.form.msg.show()}}},onSignIn:function(S){this.form.pass_block.hide();this.form.msg.hide();rozetkaEvents.trackEvent(this.ga_category,this.options.promotion.name,'form/authorization/login-success');$('login_href').hide();if($('email_msg'))$('email_msg').hide();if($('phone_msg'))$('phone_msg').hide();if($('fio_msg'))$('fio_msg').hide();this.form.getElements('[name$=helper]').each(function(elem){elem.hide()});this.form.processStop();this.wait_auth=false},onSignInFailed:function(response_message){if(this.parent(response_message)!==0){this.form.msg.show();rozetkaEvents.trackEvent(this.ga_category,this.options.promotion.name,'form/authorization/login-error')}},oncheckEmail:function(response){this.form.msg.hide();this.form.processStop();var Response=new Response_class(response);if(Response.Message){msg=this.form.msg;if(Response.Message.code==Response.Message.CODE.REQUIRED_AUTHORIZE){var params=this.extractMessageParams(Response.Message);this.login_type=params['login_type']?params['login_type']:'email';this.showPassField();msg=this.form['email'].getParent().getNext();msg.setHTML(Response.Message.getContentTpl('<span class=\"promo-msg-bad\">${content}<\/span>'));rozetkaEvents.trackEvent(this.ga_category,this.options.promotion.name,'form/send/error-client-existing-email');msg.show()}}else{this.hidePassField();this.form.getElements("input[type=text]").each(function(elem){elem.disabled=0}.bind(this));this.form.getElement("button[type=submit]").disabled=0;this.form.getElement("button[type=submit]").getParent().removeClass('disabled')}},showCheckResult:function(element,valid){var tempalte_name="default_template";var msg=new Element('span');msg.id=element.name+"_msg";if(this.options.form_fields_checker_templates[element.id]){tempalte_name=element.id}msg.setHTML(App.getHTML(this.options.form_fields_checker_templates[tempalte_name][(valid)?'ok':'fail']));if($(element.name+"_msg")){$(element.name+"_msg").remove()}if(this.form.getElement('[name='+element.name+'_helper]')){this.form.getElement('[name='+element.name+'_helper]').hide()}msg.injectAfter(element.getParent());if(valid){element.removeClass('error')}else{element.addClass('error')}if(!valid){rozetkaEvents.trackEvent(this.ga_category,this.options.promotion.name,'form/send/error-client-not-valid-'+element.name)}},onSubmit:function(e){new Event(e).stop();if(this.validateCardNumber()){this.parent(e)}},checkResp:function(resp){this.form.msg.hide();Response=new Response_class(resp);this.form.processStop();if(!Response.isError()&&Response.content){this.msg_container.setHTML(App.getHTML(this.options.tpl.successfull_popup_info,Response.content));this.form.msg.hide();this.form.hide();rozetkaEvents.trackEvent(this.ga_category,this.options.promotion.name,'form/send/success');if(Response.S.user&&Response.S.user.register_from_promotion){rozetkaEvents.trackEvent(this.ga_category,this.options.promotion.name,'registered/new')}else if(Response.S.user&&!Response.S.user.register_from_promotion){rozetkaEvents.trackEvent(this.ga_category,this.options.promotion.name,'registered/existing')}}else{msg=this.form.msg;if(Response.Message.code==Response.Message.CODE.REQUIRED_AUTHORIZE){var params=this.extractMessageParams(Response.Message);this.login_type=params['login_type']?params['login_type']:'email';this.showPassField();msg=this.form.msg}msg.setHTML(Response.Message.getContentTpl(this.options.message.tpl));msg.show();if(Response.Message.content.search('   ')){rozetkaEvents.trackEvent(this.ga_category,this.options.promotion.name,'form/send/error-server-dublicate-card_number')}else if(Response.Message.content.search('')){rozetkaEvents.trackEvent(this.ga_category,this.options.promotion.name,'form/send/error-server-not-valid-phone')}}Response.doAction()},setFields:function(data){if(data['already_registered']){this.msg_container.setHTML(App.getHTML(this.options.tpl.successfull_popup_info,data));this.form.msg.hide();this.form.hide();document.getElements('a[name=prices_active_element_original]').each(function(elem){elem.hide()})}else{var names=['fio','phone','email','city','card_number'];names.each(function(name){if(this.form[name]){this.form[name].disabled=0}this.form.getElement("button[type=submit]").disabled=0;this.form.getElement("button[type=submit]").getParent().removeClass('disabled');if(data[name]&&this.form[name]&&this.form[name].value==''){this.form[name].value=data[name];if(!this.form[name].lable){this.form[name].lable=this.form[name].getNext('span[name=label]')}if(name=='email'){this.form[name].lable.setHTML(App.getHTML(this.options.tpl.label_of_email,{'text':data[name]}));this.form[name].hide()}else{this.form[name].lable.setHTML(App.getHTML(this.options.tpl.field,{'text':data[name]}));this.form[name].hide()}if(this.form[name].lable.getElement('a')){this.form[name].lable.getElement('a').addEvent('click',function(e){new Event(e).stop();this.form[name].lable.empty();this.form[name].show();this.form[name].focus()}.bind(this))}}}.bind(this))}}});var RozetkaPromotionsMembers_class=new Class({Class:'RozetkaPromotionsMembers_class',options:{classes:{members_form:RozetkaPromotionsMembersForm_class},selectors:{rules:'show_rules',card_number:'show_card_number'},popup:{header_tpl:'<div class=\"popup-css popup-viewed-auth\">\n\t<a href=\"#\" class=\"popup-close-medium-delivery\" name=\"close\">\n\t\t<img width=\"18\" height=\"18\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"\u00d7\" class=\"popup-close-medium-icon sprite\">\n\t<\/a>\n\t<div name=\"content\" class=\"promo-rules-content\"><\/div>\n<\/div>'},text:{rules:'',card_number:''}},initialize:function(options){this.setOptions(options);this.members_form=new this.options.classes.members_form(this);this.members_form.login_type="email";this.rules=$(this.options.selectors.rules);this.card_number=$(this.options.selectors.card_number);if(this.rules){this.rules.addEvent('click',this.showRules.bind(this))}if(this.card_number){this.card_number.addEvent('click',this.showCardNumber.bind(this))}},showRules:function(e){new Event(e).stop();var popup=new Popup_class(this.options.popup.header_tpl);popup.setContent(this.options.text.rules,this);popup.open()},showCardNumber:function(e){new Event(e).stop();var popup=new Popup_class(this.options.popup.header_tpl);popup.setContent(this.options.text.card_number,this);popup.open()}});RozetkaPromotionsMembers_class.implement(new Options);var RozetkaAuthorizationVotingPopup_class=AuthorizationVotingPopup_class.extend({Class:'RozetkaAuthorizationVotingPopup_class',options:{'popup_class':Popup_class,'tpl':{'popup_tpl':'<div class=\"popup-css popup-viewed-auth\">\n\t<a href=\"#\" class=\"popup-close-medium-delivery\" name=\"close\"><img width=\"18\" height=\"18\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"\u00d7\" class=\"popup-close-medium-icon sprite\"><\/a>\n\t<div name=\"content\"><\/div>\n<\/div>','popup_content_tpl':'\n<h5 class=\"auth-title\">\u0412\u0445\u043e\u0434 \u0432 \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442-\u043c\u0430\u0433\u0430\u0437\u0438\u043d<\/h5>\n<div name=\"msg\" class=\"social-msg\"><\/div>\n<form class=\"auth-f clearfix\" method=\"post\">\n\t<div class=\"auth-f-email\">\n\t\t<div class=\"auth-f-msg\" name=\"msg\"><\/div>\n\t\t<div class=\"auth-f-i\">\n\t\t\t<div class=\"auth-f-i-title\">\u042d\u043b. \u043f\u043e\u0447\u0442\u0430<\/div>\n\t\t\t<input type=\"text\" class=\"input-text auth-input-text\" name=\"login\" _required=\"required\" value=\"${User.getEmail()}\" pattern=\"^[_A-Za-z0-9-]+(\\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\\.[A-Za-z0-9-]+)*(\\.[A-Za-z0-9]{2,15})$\">\n\t\t\t<div name=\"email_hint_block\" class=\"hidden\"><\/div>\n\t\t<\/div>\n\t\t<div name=\"auth_blocks\"><\/div>\n\t<\/div>\n\t<div class=\"auth-f-social\">\n\t\t<div class=\"auth-f-social-title\">\u0412\u043e\u0439\u0442\u0438 \u043a\u0430\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c<\/div>\n\t\t<div name=\"social_button_auth_popup\" type=\"vkontakte\" class=\"auth-f-social-i\"><\/div>\n\t\t<div name=\"social_button_auth_popup\" type=\"facebook\" class=\"auth-f-social-i\"><\/div>\n\t\t<div class=\"auth-f-signup\">\n\t\t\t{var is_promotions = new RegExp(\u0027news-articles-promotions\/promotions\u0027).test(location.pathname)}\n\t\t\t<a href=\"https:\/\/my.rozetka.com.ua\/signup\/\"\n\t\t\t   name=\"registration\"\n\t\t\t   class=\"novisited auth-f-signup-link\"\n\t\t\t   onclick=\"document.fireEvent(\u0027registration\u0027, {extend_event: [{if is_promotions}{name: \u0027eventLocation\u0027, value: \u0027Promotions\u0027}{\/if}]});\"\n\t\t\t>\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f<\/a>\n\t\t<\/div>\n\t<\/div>\n<\/form>','unauthorized_tpl':'\n<h5 class=\"auth-title\">\u0412\u0445\u043e\u0434 \u0432 \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442-\u043c\u0430\u0433\u0430\u0437\u0438\u043d<\/h5>\n<div name=\"msg\" class=\"social-msg\"><\/div>\n<form class=\"auth-f clearfix\" method=\"post\">\n\t<div class=\"auth-f-email\">\n\t\t<div class=\"auth-f-msg\" name=\"msg\"><\/div>\n\t\t<div class=\"auth-f-i\">\n\t\t\t<div class=\"auth-f-i-title\">\u042d\u043b. \u043f\u043e\u0447\u0442\u0430<\/div>\n\t\t\t<input type=\"text\" class=\"input-text auth-input-text\" name=\"login\" _required=\"required\" value=\"${User.getEmail()}\" pattern=\"^[_A-Za-z0-9-]+(\\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\\.[A-Za-z0-9-]+)*(\\.[A-Za-z0-9]{2,15})$\">\n\t\t\t<div name=\"email_hint_block\" class=\"hidden\"><\/div>\n\t\t<\/div>\n\t\t<div name=\"auth_blocks\"><\/div>\n\t<\/div>\n\t<div class=\"auth-f-social\">\n\t\t<div class=\"auth-f-social-title\">\u0412\u043e\u0439\u0442\u0438 \u043a\u0430\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c<\/div>\n\t\t<div name=\"social_button_auth_popup\" type=\"vkontakte\" class=\"auth-f-social-i\"><\/div>\n\t\t<div name=\"social_button_auth_popup\" type=\"facebook\" class=\"auth-f-social-i\"><\/div>\n\t\t<div class=\"auth-f-signup\">\n\t\t\t{var is_promotions = new RegExp(\u0027news-articles-promotions\/promotions\u0027).test(location.pathname)}\n\t\t\t<a href=\"https:\/\/my.rozetka.com.ua\/signup\/\"\n\t\t\t   name=\"registration\"\n\t\t\t   class=\"novisited auth-f-signup-link\"\n\t\t\t   onclick=\"document.fireEvent(\u0027registration\u0027, {extend_event: [{if is_promotions}{name: \u0027eventLocation\u0027, value: \u0027Promotions\u0027}{\/if}]});\"\n\t\t\t>\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f<\/a>\n\t\t<\/div>\n\t<\/div>\n<\/form>','registration_tpl':'\n<div class=\"container-auth popup-promotions-registration\">\n\t<h5 class=\"auth-title\">\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f<\/h5>\n\t<div name=\"app-message\"><\/div>\n\t<div class=\"authorization-options clearfix\">\n\t\t<div class=\"row\">\n\t\t\t<div class=\"authorization-direct\">\n\t\t\t\t<div class=\"msg\"><\/div>\n\t\t\t<\/div>\n\t\t<\/div>\n\t\t<div class=\"auth-f-email\">\n\t\t\t<form class=\"auth\" method=\"post\">\n\t\t\t\t<div class=\"auth-f-i\">\n\t\t\t\t\t<div class=\"auth-f-i-title\">\u0412\u0430\u0448\u0435 \u0438\u043c\u044f<\/div>\n\t\t\t\t\t<input class=\"input-text auth-input-text\" type=\"text\" name=\"title\" _required=\"required\" pattern=\"^[\\\u0027\\&quot;\\(\\)A-Za-z\u0410-\u042f\u0430-\u044f\u0456\u0457\u0451\u0454\u0406\u0407\u0401\u0404\\d\\.\\s_-]{2,50}$\">\n\t\t\t\t<\/div>\n\t\t\t\t<div class=\"auth-f-i\">\n\t\t\t\t\t<div class=\"auth-f-i-title\">\u042d\u043b. \u043f\u043e\u0447\u0442\u0430<\/div>\n\t\t\t\t\t<input class=\"input-text auth-input-text\" type=\"text\" name=\"email\" _required=\"required\" value=\"${User.getEmail()}\" pattern=\"^[_A-Za-z0-9-]+(\\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\\.[A-Za-z0-9-]+)*(\\.[A-Za-z0-9]{2,15})$\">\n\t\t\t\t<\/div>\n\t\t\t\t<div class=\"auth-f-i\">\n\t\t\t\t\t<div class=\"auth-f-i-title\">\u041f\u0440\u0438\u0434\u0443\u043c\u0430\u0439\u0442\u0435 \u0441\u0435\u0431\u0435 \u043f\u0430\u0440\u043e\u043b\u044c<\/div>\n\t\t\t\t\t<input class=\"input-text auth-input-text\" type=\"password\" name=\"password\" _required=\"required\" pattern=\".{6,}\">\n\t\t\t\t<\/div>\n                <div class=\"auth-f-submit-btn submit-register popup-reg-container\">\n                    <span class=\"btn-link btn-link-green\">\n                        <button type=\"submit\" class=\"btn-link-i\" name=\"register\">\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f<\/button>\n                    <\/span>\n                    <a href=\"#\" class=\"novisited xhr auth-f-cancel\" name=\"return_back\">\u041e\u0442\u043c\u0435\u043d\u0430<\/a>\n                <\/div>\n\t\t\t<\/form>\n\t\t<\/div>\n\t\t<div class=\"auth-f-social\">\n\t\t\t<div class=\"auth-f-social-title\">\u0427\u0435\u0440\u0435\u0437 \u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u0441\u0435\u0442\u0438<\/div>\n\t\t\t<div name=\"social_button_auth_popup\" type=\"vkontakte\" class=\"auth-f-social-i\"><\/div>\n\t\t\t<div name=\"social_button_auth_popup\" type=\"facebook\" class=\"auth-f-social-i\"><\/div>\n\t\t\t<div name=\"msg\" class=\"social-msg\"><\/div>\n\t\t<\/div>\n\t<\/div>\n<\/div>','remind_password_tpl':'\n<div class=\"auth-social-wrap\">\n\t<h2 class=\"auth-title\">\u041d\u0430\u043f\u043e\u043c\u0438\u043d\u0430\u043d\u0438\u0435 \u043f\u0430\u0440\u043e\u043b\u044f<\/h2>\n\t<form class=\"f-remember\">\n\t\t<div class=\"auth-f-i f-i\">\n\t\t\t<div class=\"auth-f-i-title\">\u042d\u043b. \u043f\u043e\u0447\u0442\u0430 <span class=\"require\">*<\/span><\/div>\n\t\t\t<input type=\"text\" {if typeof email != \u0027undefined\u0027}value=\"${email}\"{\/if} class=\"input-text\" name=\"email\" value=\"${User.getEmail()}\" _required=\"required\" pattern=\"^[_A-Za-z0-9-]+(\\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\\.[A-Za-z0-9-]+)*(\\.[A-Za-z0-9]{2,15})$\">\n\t\t<\/div>\n\n\t\t<div class=\"auth-f-i f-i\">\n\t\t\t<div class=\"auth-f-i-title\">\u041c\u044b \u0432\u044b\u0448\u043b\u0435\u043c \u0432\u0430\u043c \u043f\u0438\u0441\u044c\u043c\u043e \u0441\u043e&nbsp;\u0441\u0441\u044b\u043b\u043a\u043e\u0439 \u0434\u043b\u044f \u0441\u043c\u0435\u043d\u044b \u043f\u0430\u0440\u043e\u043b\u044f<\/div>\n\t\t<\/div>\n\n\t\t<div class=\"clearfix f-i auth-f-submit\">\n\t\t\t<div class=\"auth-remember-pass-submit\">\n\t\t\t\t<span class=\"btn-link btn-link-gray\">\n\t\t\t\t\t<button class=\"btn-link-i\" type=\"submit\" name=\"send_password\">\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c<\/button>\n\t\t\t\t<\/span>\n\t\t\t<\/div>\n\t\t\t<div class=\"auth-remember-pass\">\n\t\t\t\t<a class=\"novisited auth-remember-pass-link\" name=\"return_back\" href=\"#\">\u041e\u0442\u043c\u0435\u043d\u0430<\/a>\n\t\t\t<\/div>\n\t\t<\/div>\n\n\t\t<div name=\"msg\" class=\"msg error\"><\/div>\n\n\t<\/form>\n<\/div>','confirm_request_tpl':'<h2>\u0412\u044b \u043d\u0435 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u043b\u0438 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0443\u044e \u043f\u043e\u0447\u0442\u0443<\/h2>\n<p class=\"auth-simply-mesage\">\u0414\u043b\u044f \u0442\u043e\u0433\u043e, \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u043e\u0433\u043e\u043b\u043e\u0441\u043e\u0432\u0430\u0442\u044c, \u0432\u0430\u043c \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c<br \/>\u0441\u0432\u043e\u044e \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0443\u044e \u043f\u043e\u0447\u0442\u0443.<\/p>\n<p class=\"auth-simply-mesage\">\u0414\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u043f\u0435\u0440\u0435\u0439\u0434\u0438\u0442\u0435 \u043f\u043e&nbsp;\u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u0441\u0441\u044b\u043b\u043a\u0435 \u0432&nbsp;\u043f\u0438\u0441\u044c\u043c\u0435,<br \/>\u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u0431\u0443\u0434\u0435\u0442 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e \u0432\u0430\u043c \u043d\u0430&nbsp;\u043f\u043e\u0447\u0442\u0443.<\/p>\n<br \/>\n<div class=\"auth-f-submit auth-f-submit-btn\">\n\t<button class=\"btn-link btn-link-blue\" type=\"submit\" name=\"send_request\">\n\t\t<span class=\"btn-link-i\">\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u043f\u0438\u0441\u044c\u043c\u043e<\/span>\n\t<\/button>\n\t<a class=\"novisited auth-f-cancel\" name=\"close\" href=\"#\">\u041e\u0442\u043c\u0435\u043d\u0430<\/a>\n<\/div>\n<div name=\"msg\" class=\"msg\" class=\"error\"><\/div>','confirm_success_tpl':'<p>${content}<\/p>','info':'<h4>\u0412\u044b \u043d\u0435 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u043b\u0438 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0443\u044e \u043f\u043e\u0447\u0442\u0443<\/h4>\n<div class=\"f-item\">\n\t<div class=\"f-title\">\u0414\u043b\u044f \u0442\u043e\u0433\u043e \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u043e\u0433\u043e\u043b\u043e\u0441\u043e\u0432\u0430\u0442\u044c - \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e <br>\u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c \u0441\u0432\u043e\u044e \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0443\u044e \u043f\u043e\u0447\u0442\u0443.<br>\u0414\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u0432 \u043f\u0438\u0441\u044c\u043c\u0435, \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u043c \u043d\u0430\u043c\u0438,<br>\u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u0435\u0440\u0435\u0439\u0442\u0438 \u043f\u043e \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u0441\u0441\u044b\u043b\u043a\u0435.<\/div>\n<\/div>\n<div class=\"submit\">\n\t<button class=\"button-css-green\" type=\"submit\" name=\"send_request\">\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u043f\u0438\u0441\u044c\u043c\u043e<\/button>\n\t<a class=\"xhr lightblue cancel\" name=\"close\" href=\"#\">\u0417\u0430\u043a\u0440\u044b\u0442\u044c<\/a>\n<\/div>\n<div name=\"msg\" class=\"msg\" class=\"error\"><\/div>','existing_email':'\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0441 \u0430\u0434\u0440\u0435\u0441\u043e\u043c ${email} \u0443\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d.'},selectors:{'login':'input[name=login]','msg':'[class*=msg]','email':'[name=email]','app_message':'[name="app-message"]'},'signin_url':'https://my.rozetka.com.ua/signin/',_auth_blocks_options:{tpl:{message:'<div class=\"pos-fix sprite-side message code${code}\">\n\t<a href=\"\" class=\"message-close-link\" onclick=\"clearUserMessages(event, \u0027msg\u0027)\">\n\t\t<img src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" width=\"24\" height=\"24\" class=\"sprite message-close-link-img\">\n\t<\/a>\n\t${content}\n<\/div>'},blocks:{simple_auth:'<div name=\"simple_auth\" class=\"hidden\">\n\t<div class=\"auth-f-i\">\n\t\t<div class=\"auth-f-i-title\">\u041f\u0430\u0440\u043e\u043b\u044c<\/div>\n\t\t<input type=\"password\" class=\"input-text auth-input-text\" name=\"password\" _required=\"required\">\n\t\t<div class=\"auth-message hidden\" name=\"wrong_password_block\">\n\t\t\t<h5 class=\"auth-forgot-pass-tooltip-title\" name=\"password_hint\"><\/h5>\n\t\t\t<p class=\"auth-forgot-pass-tooltip-note\">\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0440\u0430\u0441\u043a\u043b\u0430\u0434\u043a\u0443 \u043a\u043b\u0430\u0432\u0438\u0430\u0442\u0443\u0440\u044b \u0438&nbsp;Caps Lock<\/p>\n\t\t\t<p class=\"auth-forgot-pass-tooltip-text\"><a class=\"xhr\" href=\"#\" name=\"send_temp_pass\">\u041f\u0440\u0438\u0448\u043b\u0438\u0442\u0435 \u043c\u043d\u0435 \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c<\/a><br>\n\t\t\t    \u043d\u0430&nbsp;\u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 \u0430\u0434\u0440\u0435\u0441 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0447\u0442\u044b<\/p>\n\t\t<\/div>\n\t\t<div class=\"auth-f-remind-pass\">\n\t\t\t<a href=\"https:\/\/my.rozetka.com.ua\/remind-password\/\" name=\"forgot_button\" class=\"novisited auth-f-remind-pass-link\">\u041d\u0430\u043f\u043e\u043c\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c<\/a>\n\t\t<\/div>\n\t\t<label class=\"checkbox auth-f-i-remember\">\n\t\t\t<input class=\"hidden checkbox-input\" type=\"checkbox\" name=\"remember\" checked=\"checked\" value=\"1\">\n\t\t\t<span class=\"checkbox-label sprite-side auth-f-i-remember-text\">\u0417\u0430\u043f\u043e\u043c\u043d\u0438\u0442\u044c \u043c\u0435\u043d\u044f<\/span>\n\t\t<\/label>\n\t<\/div>\n\t<div class=\"clearfix f-i auth-f-submit\">\n\t\t<div class=\"auth-f-submit-btn\">\n\t\t\t<span class=\"btn-link btn-link-blue\">\n\t\t\t\t<button type=\"submit\" class=\"btn-link-i\" name=\"auth_submit\">\u0412\u043e\u0439\u0442\u0438<\/button>\n\t\t\t<\/span>\n\t\t\t<a href=\"#\" class=\"novisited auth-f-cancel\" name=\"close\">\u041e\u0442\u043c\u0435\u043d\u0430<\/a>\n\t\t<\/div>\n\t<\/div>\n<\/div>'},selectors:{msg:'[name="msg"]',email:'[name="login"]'},blocks_type:'popup'}},initialize:function(){this.parent();OAuth2.addEvent('login_failed',this.onError.bind(this))},onSendPassword:function(resp){this.parent(resp);this.popup.getElement(this.options.selectors.send_password).setAttribute('disabled','disabled')},createPopup:function(){this.options.popup_class.prototype.processStart=function(process){if(this.isOpened()){this.content.processStart(process)}};this.options.popup_class.prototype.processStop=function(){if(this.isOpened()){this.content.processStop()}};this.popup=new this.options.popup_class(this.options.tpl.popup_tpl)},changeContent:function(content,data){this.popup.setContent(content,data);this.popup._posUpdate();this.bindEvents()},show:function(){this.setContent();this.bindEvents();this.popup.open();if(!User.isAuth()){this.updateOAuth()}},hide:function(){this.popup.close()},is_opened:function(){return this.popup.isOpened()},onSignIn:function(){if(this.is_opened()){rozetkaEvents.trackEvent('authorization','success','popup-comment')}this.parent()},signUp:function(){var msg_block=this.popup.getElement(this.options.selectors.app_message);msg_block&&(msg_block.innerHTML='');this.parent()},onSignUp:function(resp){this.popup.getElement('form').processStop();var Response=new Response_class(resp);if(Response.isError()){if(Response.Message){this.popup.getElement(this.options.selectors.msg).setHTML(Response.Message.content)}App.setMessageBlock(this.popup.getElement(this.options.selectors.app_message));if(Response.location==this.options.signin_url){var email=this.popup.getElement(this.options.selectors.email).getValue();Cookie.set('login',email);this.onUnauthorizedUser();this.popup.getElement(this.options.selectors.msg).setHTML(App.getHTML(this.options.tpl.existing_email,{email:email}))}}if($defined(Response.action)){this.currently_signed_up=true;$defined(Response.S)?S.onLoad(Response.S):S.load(true)}},onRegistration:function(){this.parent();this.updateOAuth()},onUnauthorizedUser:function(){this.changeContent(this.options.tpl.unauthorized_tpl);var registration=this.popup.getElement(this.options.selectors.registration),login=this.popup.getElement(this.options.selectors.login);registration.addEvent('click',this.action.bindWithEvent(this,'onRegistration'));if(Cookie.get("login")&&login){login.value=Cookie.get("login")}this.updateOAuth();this._auth_blocks=new AuthorizationBlocks_class(this.popup.form,this.options._auth_blocks_options);this.popup.getElements('[name="close"]').each(function(elem){elem.addEvent('click',function(e){new Event(e).stop();this.popup.close()}.bind(this))}.bind(this));this._auth_blocks.needAuth()},updateOAuth:function(){OAuth2.update({facebook:'{if !User.isAuthInSocial(\"facebook\")}\n\t<span class=\"btn-link btn-auth-fb sprite-side\">\n\t\t<a\n\t\t\thref=\"http:\/\/www.facebook.com\/v2.0\/dialog\/oauth\/?client_id=205429962821175&redirect_uri=https%3A%2F%2Fmy.rozetka.com.ua%2Fsignin%2Foauth%2Ffacebook%2F&display=popup&scope=email%2Cuser_birthday\"\n\t\t\ttarget=\"_blank\"\n\t\t\tclass=\"btn-link-i\"\n\t\t\tonclick=\"document.fireEvent(\u0027clickSocial\u0027, {extend_event: [{name: \u0027eventContent\u0027, value: \u0027Facebook\u0027}]})\"\n\t\t>Facebook<\/a>\n\t<\/span>\n{\/if}',vkontakte:'{if !User.isAuthInSocial(\"vkontakte\")}\n\t<span class=\"btn-link btn-auth-vk sprite-side\">\n\t\t<a\n\t\t\thref=\"http:\/\/api.vk.com\/oauth\/authorize?client_id=2743724&redirect_uri=https%3A%2F%2Fmy.rozetka.com.ua%2Fsignin%2Foauth%2Fvkontakte%2F&display=popup&scope=notify\"\n\t\t\ttarget=\"_blank\"\n\t\t\tclass=\"btn-link-i\"\n\t\t\tonclick=\"document.fireEvent(\u0027clickSocial\u0027, {extend_event: [{name: \u0027eventContent\u0027, value: \u0027VKontakte\u0027}]})\"\n\t\t>\u0412\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u0435<\/a>\n\t<\/span>\n{\/if}'})},onError:function(params){if(this.popup.msg){if(params&&params.value){this.popup.msg.innerHTML=params.value;this.popup.msg.style.color='#f00'}else{this.popup.msg.innerHTML=''}}},onSendConfirmMail:function(resp){var response=new Response_class(resp);this.popup.processStop();if(response.Message.code==response.Message.CODE.NOTIFY){this.changeContent(this.options.tpl.confirm_success_tpl,{content:response.Message.content})}else{this.popup.getElement(this.options.selectors.msg).setHTML(response.Message.content)}}});RozetkaAuthorizationVotingPopup_class.implement(new Options);var RozetkaTagPopup_class=Popup_class.extend({popup_message:'<h3 class=\"icons-title\" name=\"title\">${title}<\/h3>\n<div class=\"icons-text\">\n\t${text}\n<\/div>\n{if link&&link_title}\n\t<p class=\"text-right\"><a href=\"${link}\" target=\"_blank\" class=\"icons-link arrow-link novisited\"><span class=\"arrow-link-inner\">${link_title}<\/span>&nbsp;&rarr;<\/a><\/p>\n{\/if}',popup_template:'<div class=\"icons-popup aligned-left\" name=\"content\"><\/div>',data:{title:null,text:null,link:null,link_title:null},timeout:400,popup_is_opened:false,initialize:function(parent){this.parent(this.popup_template,parent);this.data={title:null,text:null,link:null,link_title:null};parent.addEvent('mouseenter',function(e){this.popup_is_opened=true;setTimeout(function(){if(this.popup_is_opened){this.setContent(this.popup_message,this.data);this.elem.getElements('a').each(function(el){el.target='_blank'});this.open()}}.bind(this),this.timeout)}.bind(this));parent.addEvent('mouseleave',function(e){this.popup_is_opened=false;setTimeout(function(){if(!this.popup_is_opened){this.close()}}.bind(this),this.timeout)}.bind(this));return this},setTitle:function(title){this.data.title=title;return this},setText:function(text){this.data.text=text;return this},setExternalLink:function(title,link){var element;this.data.link_title=title.trim();this.data.link=link.trim();if(this.data.link.length!=0&&this.data.link_title==''){element=new Element('a');element.href=this.data.link;this.data.link_title=element.hostname}return this}});var RozetkaCheckoutSuggest_class=Suggest_class.extend({options:{view_default:false,tip_selector:'tip_for_input',loader_css_class:'suggest-loader',arrow_css_class:'suggest-arrow',title_by_another_locality:'  ...',links_of_tips_for_suggest_tpl:'<div class=\"f-i-sign\">\n\t{var count=0}\n\t{for record in records}\n\t\t{if count<limit }\n\t\t\t\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, <a href=\"#\" class=\"lightblue xhr\" locality_id=${record.id}>${record.title}<\/a>\n\t\t{\/if}\n\t\t{var count=count+1}\n\t{\/for}\n<\/div>',url:'/suggest/action=getLocalitiesForSuggestJSON/',full_title:'${title}{if big_city==0}{if region} - ${region} \u043e\u0431\u043b.{if show_all && district}, ${district} \u0440-\u043d{\/if}{\/if}{\/if}',scroll_settings:{height_by_step:25,height_of_block:250,count_elements_in_block:12}},initialize:function(){this._defaultData={};this._currentValue='';this._defaultValue='';this._history={};this._suggest=null;this._isChosenLocality=false;this.elem=new Element('div')},init:function(input){this.parent(input);this.input.addEvent('click',function(){this.input.select();document.fireEvent('clickToPopupCity',{extend_event:[{name:'eventLocation',value:'contactData'},{name:'userCityId',value:this.getSityIdByName(this.input.value)}]})}.bind(this));this.tip_for_input=$(this.options.tip_selector);this.tip_for_input.addEvent('click',function(){this.isOpened()||this.input.select()}.bind(this));if(this.input.value==''){this._initLinksOfTips()}this._defaultValue=this.input.value;this.initCityChooser()},getSityIdByName:function(name){var result={},result_id=null;if(this._defaultData&&this._defaultData.records){result=this._defaultData.records.filter(function(record){return record.title==name}).pop()}if(result&&result.hasOwnProperty('id')){result_id=result['id']}return result_id},initCityChooser:function(){CityChooser.addEvent('citySelected',this._onCitySelectedFromChooser.bind(this));this.input.addEvent('ChangeLocality',function(p){document.fireEvent('ChangeLocality',p)})},_moveActive:function(shift){with(this._suggest){this._setActive(key==null?(shift<0?elems.length-1:0):(0<=key+shift&&key+shift<=elems.length-1?key+shift:shift<0?elems.length-1:0))}this._scroll()},_scroll:function(){var current_min,current_max,key=this._suggest.key+1,ul=this.elem.getElement('ul'),length=this._suggest.elems.length;current_min=Math.round(ul.scrollTop/this.options.scroll_settings.height_by_step);current_max=current_min+this.options.scroll_settings.count_elements_in_block;if(key==1){ul.scrollTo(0,0)}else if(key==length){ul.scrollTo(0,this.options.scroll_settings.height_by_step*(key-this.options.scroll_settings.count_elements_in_block))}else if(key>current_max){ul.scrollTo(0,ul.scrollTop+this.options.scroll_settings.height_by_step)}else if(key<=current_min){ul.scrollTo(0,ul.scrollTop-this.options.scroll_settings.height_by_step)}},_initLinksOfTips:function(){var div=new Element('div').setHTML(App.getHTML(this.options.links_of_tips_for_suggest_tpl,{records:this._defaultData.records,random_record:this._defaultData.random_record,current_city:CityChooser.getCurrentCity(),limit:1})).getElement('div').injectAfter(this.tip_for_input);this.addXHRClickEvent(div.getElements('a'))},addXHRClickEvent:function(elems,records_storage){if(!records_storage){records_storage=this._defaultData}elems.each(function(e){e.addEvent('click',function(event){new Event(event).stop();var record,key;for(key in records_storage.records){if(records_storage.records[key].id==e.getProperty('locality_id')){record=records_storage.records[key]}}if(!record&&records_storage.random_record.id==e.getProperty('locality_id')){record=records_storage.random_record}this._isChosenLocality=true;this.input.fireEvent('ChangeLocality',{element:record,view_default:this.options.view_default});this.trackCitySelectedEvent(record.id);this.input.value=this._currentValue=this._defaultValue=e.innerHTML}.bind(this))}.bind(this))},setDefaultData:function(data){this._defaultData=data;this._defaultData.records.push({id:0,another_locality:true,title:this.options.title_by_another_locality})},onFocus:function(e){this._currentValue=this.input.value;this._isChosenLocality=false;this._checkChanges('default_data')},onBlur:function(e){if(this.input.value==this._defaultValue||this.input.value==''){this.input.value=this._defaultValue}else if(!this._isChosenLocality){this._resetChangedValues()}this._hide()},onKeyDown:function(e){e=new Event(e);if(e.key=='up'||e.key=='down'){e.stop();this._moveActive(e.key=='up'?-1:1)}else if(e.key=='enter'){e.stop();var key=this._suggest.elems.length==1?0:this._suggest.key;if(key!==null){this._enterActive(key)}}else if(e.key=='esc'){this.input.value='';this._checkChanges(false)}else if(e.key=='tab'){this._hide()}},onKeyUp:function(e){if(this.input.value!==this._currentValue){this._currentValue=this.input.value;this._checkChanges.delay(333,this,[this.input.value])}},_enterActive:function(k,item){this._isChosenLocality=true;if(this._suggest.records[k]&&this._suggest.records[k]['another_locality']){this.input.value=this._defaultValue='';this.input.focus()}else{var text=this.elem.getElement('[name'+'='+k+']');this.input.value=this._currentValue=this._defaultValue=text.getProperty('text');this.input.fireEvent('ChangeLocality',{element:this._suggest.records[k],view_default:this.options.view_default});this.trackCitySelectedEvent(this._suggest.records[k].id)}this._hide()},_resetChangedValues:function(){this.input.value='';this.input.fireEvent('ChangeLocality',{element:{id:0}})},_checkChanges:function(value){if(this.input.value.length==0||value=='default_data'){if(!$defined(this._history['default_data'])){this._history['default_data']=$extend({html:App.getHTML(this.options.tpl,this._defaultData)},this._defaultData)}this._suggestion('default_data');this.options.view_default=true}else if(this.input.value.length<3){this._hide()}else if(value==this.input.value){if($defined(this._history[this.input.value])){this._suggestion(this.input.value)}else if(isNaN(value)){this._processStart();this._getSuggest(this.input.value)}this.options.view_default=false}},_suggestion:function(test){this._suggest=$extend({elems:[],key:null,active:null},this._history[test.toLowerCase()]);this.elem.setHTML(this._suggest.html);this._processStop();this._show();if(this._suggest.count){this._suggest.records.each(function(item,key){this._suggest.elems.include(this._markupSuggestion(this.elem.getElement('[name='+key+']')).addEvent('mousemove',this._setActive.bind(this,key)).addEvent('click',this._enterActive.bind(this,key)))}.bind(this))}if(this._suggest.elems.length==1){this._setActive(0)}},_getSuggest:function(test){var options={method:'get',onSuccess:this._setSuggest.bind(this),onComplete:this._suggestion.bind(this,test)},url=this.options.url+'?name='+test.toLowerCase().url_encode();new Ajax(url,options).request()},_setSuggest:function(resp){resp=decodeURIComponent(resp);var Response=new Response_class(resp);Response.doAction();if(!Response.isError()){Response.content.records=Response.content.records.sort(this._compareRecords.bind(this));this._history[Response.content.text]=$extend({html:App.getHTML(this.options.tpl,Response.content)},Response.content)}},_markupSuggestion:function(el){var et_regex=new RegExp('(^'+this.input.value+')','i');return el.setHTML(el.getText().replace(et_regex,'<span class="queriedValue">$1</span>'))},_processStart:function(){this.tip_for_input.removeClass(this.options.arrow_css_class);this.tip_for_input.addClass(this.options.loader_css_class)},_processStop:function(){this.tip_for_input.removeClass(this.options.loader_css_class);this.tip_for_input.addClass(this.options.arrow_css_class)},_onCitySelectedFromChooser:function(city){if(city.id){this._isChosenLocality=true;this.input.fireEvent('ChangeLocality',{element:city,view_default:this.options.view_default});if(city.id!=CityChooser.default_city.id){this.input.highlightReset();this.input.value=this._currentValue=this._defaultValue=App.getHTML(this.options.full_title,city)}}},_compareRecords:function(a,b){var result;result=b.big_city-a.big_city;if(result==0){result=this._compareStrings(a.title,b.title);result=result?result:this._compareStrings(a.region,b.region);result=result?result:this._compareStrings(a.district,b.district)}return result},_compareStrings:function(a,b){if(a>b){return 1}else if(a<b){return-1}else{return 0}},trackCitySelectedEvent:function(id){$(document).fireEvent('checkoutCitySelected',{extend_event:[{name:'eventContext'},{name:'eventTab'},{name:'eventContent',value:id}]})},resetValue:function(){this.input.value=this._currentValue=this._defaultValue=''}});var RozetkaCityChooser_class=new Class({options:{selectors:{current_city_container_id:'city-chooser',current_city_element:'a[name=city]',xhr_container_id:'[name=xhr_container]',suggest_input_id:'popup_suggest_locality',info_popup:'[name=popup]'},tpl:{chooser_popup:'<div class=\"popup-css header-city-choose-popup\">\n\t<a href=\"#\" class=\"popup-close\" name=\"close\">\n\t\t<img width=\"28\" height=\"28\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"&times;\" class=\"popup-close-small-icon sprite\">\n\t<\/a>\n\t<div name=\"msg\"><\/div>\n\t<div name=\"content\"><\/div>\n<\/div>',chooser_popup_content:'<h2 class=\"header-city-title\">\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u0432\u043e\u0439 \u0433\u043e\u0440\u043e\u0434<\/h2>\n<p class=\"header-city-delivery sprite-side\">\u041c\u044b&nbsp;\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u043c \u0437\u0430\u043a\u0430\u0437\u044b \u043f\u043e&nbsp;\u0432\u0441\u0435\u0439 \u0423\u043a\u0440\u0430\u0438\u043d\u0435!<\/p>\n<div class=\"header-city-box clearfix\" name=\"xhr_container\">\n\t{var i = 0}\n\t{for city in records}\n\t\t{if city.id}\n\t\t\t{if i % 3 == 0}<div class=\"clearfix\">{\/if}\n\t\t\t{if city.id == current_city.id}\n\t\t\t\t<div class=\"header-city-i\">\n\t\t\t\t\t<span class=\"header-city-i-text\" locality_id=${city.id}>\n\t\t\t\t\t\t${city.title}\n\t\t\t\t\t<\/span>\n\t\t\t\t<\/div>\n\t\t\t{else}\n\t\t\t\t<div class=\"header-city-i\">\n\t\t\t\t\t<a href=\"#\" class=\"header-city-i-link novisited\" locality_id=${city.id}>\n\t\t\t\t\t\t${city.title}\n\t\t\t\t\t<\/a>\n\t\t\t\t<\/div>\n\t\t\t{\/if}\n\t\t\t{eval}i++{\/eval}\n\t\t\t{if i % 3 == 0 || records.length == i}<\/div>{\/if}\n\t\t{\/if}\n\t{\/for}\n<\/div>\n<p>\u0418\u043b\u0438 \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0434\u0440\u0443\u0433\u043e\u0439 \u043d\u0430\u0441\u0435\u043b\u0435\u043d\u043d\u044b\u0439 \u043f\u0443\u043d\u043a\u0442 \u0423\u043a\u0440\u0430\u0438\u043d\u044b<\/p>\n<div class=\"header-city-search\">\n\t<input\n\t\t\tid=\"popup_suggest_locality\"\n\t\t\tautocomplete=\"off\"\n\t\t\tname=\"suggest_locality\"\n\t\t\ttype=\"text\"\n\t\t\tplaceholder=\"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0432\u043e\u0439 \u0433\u043e\u0440\u043e\u0434\"\n\t\t\ttabindex=\"6\"\n\t\t\tvalue=\"\"\n\t\t\tclass=\"input-text header-city-search-input-text\"\n\t\t\t>\n\t<div id=\"tip_for_input\"><\/div>\n<\/div>\n<div class=\"header-city-search-example\" name=\"xhr_container\">\n\t{if random_record}\n\t\t\u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, <a href=\"#\" class=\"novisited header-city-search-example-link\" locality_id=${random_record.id}>${random_record.title}<\/a>\n\t{\/if}\n<\/div>\n<p class=\"header-city-info\">\u0412\u044b\u0431\u043e\u0440 \u0433\u043e\u0440\u043e\u0434\u0430 \u043f\u043e\u043c\u043e\u0436\u0435\u0442 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0430\u043a\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e&nbsp;\u043d\u0430\u043b\u0438\u0447\u0438\u0438 \u0442\u043e\u0432\u0430\u0440\u0430, \u0435\u0433\u043e \u0446\u0435\u043d\u044b \u0438&nbsp;\u0441\u043f\u043e\u0441\u043e\u0431\u043e\u0432 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438 \u0432&nbsp;\u0432\u0430\u0448\u0435\u043c \u0433\u043e\u0440\u043e\u0434\u0435! \u042d\u0442\u043e \u043f\u043e\u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0434\u043b\u044f \u0432\u0430\u0441!<\/p>',info_popup_content:'<div class=\"header-city-location\">\n\t<div class=\"header-city-location-i header-city-location-town\">${title}<\/div>\n\t{if region}<div class=\"header-city-location-i header-city-location-region\">${region} \u043e\u0431\u043b.<\/div>{\/if}\n\t{if show_all}<div class=\"header-city-location-i header-city-location-district\">${district} \u0440-\u043d<\/div>{\/if}\n\t<div class=\"header-city-location-change\">\n\t\t<a href=\"#\" class=\"xhr sprite-side header-city-location-change-link\">\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0440\u0435\u0433\u0438\u043e\u043d<\/a>\n\t<\/div>\n<\/div>',suggest:'{if count}\n\t<ul class=\"suggestions\">\n\t\t{for record in records}\n\t\t\t<li class=\"suggestion-i\"\n\t\t\t\ttext=\"${record.title}{if record.big_city==0}{if record.region} - ${record.region} \u043e\u0431\u043b.{if record.show_all && record.district}, ${record.district} \u0440-\u043d{\/if}{\/if}{\/if}\"\n\t\t\t\tname=\"${record_index}\">${record.title}{if record.big_city==0}{if record.region} - ${record.region} \u043e\u0431\u043b.{if record.show_all && record.district}, ${record.district} \u0440-\u043d{\/if}{\/if}{\/if}\n\t\t\t<\/li>\n\t\t{\/for}\n\t<\/ul>\n{else}\n\t<ul class=\"suggestions\">\n\t\t<li class=\"suggestion-i not-found\">\u0413\u043e\u0440\u043e\u0434 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d. <br\/>\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0438\u043b\u0438 \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0431\u043b\u0438\u0436\u0430\u0439\u0448\u0438\u0439 \u043a \u0432\u0430\u043c!<\/li>\n\t<\/ul>\n{\/if}',current_city:'<a href=\"#\" class=\"novisited sprite-side header-city-select-link\" name=\"city\" onclick=\"document.fireEvent(\u0027clickToPopupCity\u0027, {extend_event: [{name:\u0027userCityId\u0027, value: ${id}}]});\">\n\t<span class=\"xhr bold\">${sliced_title}<\/span>\n<\/a>\n<div name=\"popup\" class=\"popup-css header-city-popup hidden\"><\/div>',links_of_tips_for_suggest_tpl:''},suggest_url:'http://rozetka.com.ua/',cities_action:'/suggest/action=getLocalityInfo/',city_slice_title_length:14,mouseEnterDelay:500},popup_cities:{},default_city:{id:'0',title:' ',big_city:null,region:null,district:null,show_all:null},current_city:null,current_city_element:null,current_city_container:null,suggest:null,info_popup:null,popup:null,mouseEnterTimeoutId:0,initialize:function(popup_cities){this.current_city=this.default_city;this.popup_cities=popup_cities;this.suggest=new RozetkaCityChooserSuggest_class().setOptions({tpl:this.options.tpl.suggest,links_of_tips_for_suggest_tpl:this.options.tpl.links_of_tips_for_suggest_tpl})},init:function(){this.current_city_container=$(this.options.selectors.current_city_container_id);if(!S.checkup){S.addEventOnce('loadS',function(){this._initCurrentCity();this.setDefaultSuggestData()}.bind(this))}else{this._initCurrentCity();this.setDefaultSuggestData()}User.addEvent('currentlySignedIn',this._onUserSignIn.bind(this));User.addEvent('signOut',function(){this.suggest.setDefaultData({count:0,records:[],text:'default_data'});this.suggest.clearDefaultDataHistory()}.bind(this));OAuth2.addEvent('login_success',this._onUserSignIn.bind(this));document.addEvent('ChangeLocality',this._onCityChange.bind(this))},setDefaultSuggestData:function(){if(User.S&&User.S.suggest_cities&&User.S.suggest_cities.count){this.suggest.clearDefaultDataHistory();this.suggest.setDefaultData(User.S.suggest_cities)}},showCurrentCity:function(){this.current_city_container.setHTML(App.getHTML(this.options.tpl.current_city,this.getCurrentCity()));this.current_city_element=this.current_city_container.getElement(this.options.selectors.current_city_element);this.current_city_element.removeEvents();this._addAskCityEventToElem(this.current_city_element);if(this.current_city.id){this.info_popup=this.current_city_container.getElement(this.options.selectors.info_popup);App.addOnDomReady(function(){this.fireEvent('citySelected',this.getCurrentCity())}.bind(this));this.info_popup.removeEvents();this._addCityHoverEvents()}},_addAskCityEventToElem:function(elem){elem.addEvent('click',this.askCity.bind(this))},_addCityHoverEvents:function(){this.current_city_element.addEvent('mouseenter',function(){this.mouseEnterTimeoutId=setTimeout(this._showInfo.bind(this),this.options.mouseEnterDelay)}.bind(this));this.current_city_container.addEvent('mouseleave',this._hideInfo.bind(this))},_hideInfo:function(){if(this.info_popup){this.info_popup.hide()}clearTimeout(this.mouseEnterTimeoutId)},_showInfo:function(){if(this.info_popup&&(!this.popup||!this.popup.isOpened())){this.info_popup.setHTML(App.getHTML(this.options.tpl.info_popup_content,this.getCurrentCity()));this._addAskCityEventToElem(this.info_popup);this.info_popup.show()}},_initCurrentCity:function(){var city_id=User.getVisitorCity();if(city_id&&city_id.toInt()){this._getCityByIdAJAX(city_id.toInt())}else{this.showCurrentCity()}},_onUserSignIn:function(){var visitor_city=User.getProperty('visitor_city');if(visitor_city){User.setVisitorCustomVar(visitor_city);this._initCurrentCity()}this.setDefaultSuggestData()},_unsetCityIdCookie:function(){Cookie.set('visitor_city',0,{domain:'.rozetka.com.ua',path:'/'})},_getCityByIdAJAX:function(id){var options={method:'get',onComplete:this._onCityGet.bind(this)},url=this.options.cities_action+'?id='+id;new Ajax(url,options).request()},_onCityGet:function(resp){resp=decodeURIComponent(resp);if(resp){resp='{code:'+'1'.toInt()+',content:'+resp+'}';resp=new Response_class(resp);this.current_city=resp.content;this._setVisitorCity()}else{this._unsetCityIdCookie()}this.showCurrentCity()},askCity:function(e,popup_options){if(e){new Event(e).stop()}if(popup_options){this.popup=new Popup_class(popup_options.hasOwnProperty('tpl')?popup_options.tpl:this.options.tpl.chooser_popup,popup_options.hasOwnProperty('parent')?popup_options.parent:this.current_city_container)}else{this.popup=new Popup_class(this.options.tpl.chooser_popup,this.current_city_container)}this.popup.addEvent('close',this._onPopupClose.bind(this));this._hideInfo();var data=this.popup_cities;data.current_city=this.getCurrentCity();this.popup.setContent(this.options.tpl.chooser_popup_content,data);this.popup.getElements(this.options.selectors.xhr_container_id).each(function(elem){this.suggest.addXHRClickEvent(elem.getElements('a'),this.popup_cities)}.bind(this));this.popup.open();this._initSuggest();if(this.current_city.id){this.fireEvent('citySelected',this.getCurrentCity())}$(document).fireEvent('currentCityChanged',{extends_event:[{name:'userCityId',value:this.current_city.id}]})},_initSuggest:function(){this.suggest.init(this.options.selectors.suggest_input_id)},_onCityChange:function(params){if(this._setCurrentCity(params.element)){if(this.popup&&this.popup.isOpened()){this.popup.close()}else{this._onPopupClose()}}},_setVisitorCity:function(){User.setVisitorCustomVar(this.current_city.id)},_onPopupClose:function(){if(this.current_city.id){this._setVisitorCity()}this.showCurrentCity()},getCurrentCity:function(){var title_length=this.options.city_slice_title_length,sliced_title='';if(title_length&&this.current_city.title.length>title_length){sliced_title=this.current_city.title.slice(0,title_length)+'...'}else{sliced_title=this.current_city.title}return $merge(this.current_city,{sliced_title:sliced_title})},_setCurrentCity:function(data){var result=false;if(data.id&&data.id!=this.current_city.id){this.current_city=data;result=true;document.fireEvent('changeCity',{extend_event:[{name:'userCityId',value:data.id}]})}return result},resetCity:function(){this.current_city=this.default_city;this._unsetCityIdCookie();this.showCurrentCity()}});RozetkaCityChooser_class.implement(new Events());var RozetkaCityChooserSuggest_class=RozetkaCheckoutSuggest_class.extend({init:function(input){this.parent(input);if(this.input.value!=''){this._initLinksOfTips()}},_initLinksOfTips:function(){},_suggestion:function(test){if(test!=='default_data'||this._defaultData.count){this.parent(test)}},trackCitySelectedEvent:function(id){$(document).fireEvent('checkoutCitySelected',{extend_event:[{name:'eventContext',value:'Head'},{name:'eventContent',value:id}]})},clearDefaultDataHistory:function(){this._history.default_data=null}});var RozetkaYandexMapBase_class=new Class({options:{api_url:location.protocol+'//api-maps.yandex.ru/2.0-stable/'+'?load=package.map,package.controls,package.geoObjects&lang=ru-RU&mode=release',map_div_id:'YMapsID',bounds:{offset:0.005,ukraine:{min:[44.103232,22.197485],max:[52.692818,40.544653]}},place_mark:{zoom:15,preset:'twirl#blueStretchyIcon'},on_api_ready:null},points:null,_place_mark_colection:null,zoom_control:null,map:null,api_ready:false,_recreate_map:false,initialize:function(options){this.setOptions(options);Asset.javascript(this.options.api_url,{onload:function(){ymaps.ready(function(){this.api_ready=true;if('function'==typeof this.options.on_api_ready){this.options.on_api_ready()}}.bind(this))}.bind(this)});window.addEvent('resize',function(){this._recreate_map=true}.bind(this))},isReady:function(){return this.api_ready},removeAllPoints:function(){this.points=null;if(this._place_mark_colection){this._place_mark_colection.removeAll()}},setNewPoints:function(points){this.points=points},closeBalloon:function(){if(this.map.balloon.isOpen()){this.map.balloon.close()}},_getBoundsForPoints:function(){var j,point_position,current_point,min=[],max=[];if(this.points){for(point_position=0;point_position<this.points.length;point_position++){if(this.points[point_position].coordinates[0]&&this.points[point_position].coordinates[1]){current_point=this.points[point_position].coordinates;if(!(min.length&&max.length)){for(j=0;j<2;j++){max[j]=current_point[j].toFloat();min[j]=current_point[j].toFloat()}}for(j=0;j<2;j++){if(max[j]<current_point[j].toFloat()){max[j]=current_point[j].toFloat()}if(min[j]>current_point[j].toFloat()){min[j]=current_point[j].toFloat()}}}}}if(min.length&&max.length){if(this.options.bounds.offset){min[1]-=this.options.bounds.offset;min[0]-=this.options.bounds.offset;max[1]+=this.options.bounds.offset;max[0]+=this.options.bounds.offset}}else{min=this.options.bounds.ukraine.min;max=this.options.bounds.ukraine.max}return[min,max]},_setMap:function(){if(!this.map||this._recreate_map){if(this.map){this.map.destroy()}this.map=new ymaps.Map(this.options.map_div_id,{bounds:this._getBoundsForPoints()});this.addZoomControl();this.map.behaviors.enable('scrollZoom');this.map.events.add('click',function(){this.closeBalloon()}.bind(this));this._recreate_map=false}},addZoomControl:function(){if(!this.zoom_control){this.zoom_control=new ymaps.control.ZoomControl()}this.map.controls.add(this.zoom_control)},removeZoomControl:function(){if(this.zoom_control){this.map.controls.remove(this.zoom_control)}},showBaloon:function(point){if(point&&this._place_mark_colection){this._place_mark_colection.each(function(place_mark){if(place_mark.geometry.getCoordinates()===point.coordinates){place_mark.balloon.open()}})}},show:function(){this._setMap();this._setPointsForMap();this.map.setBounds(this._getBoundsForPoints())},_setPointsForMap:function(){var i,current_point;if(this.points&&this.map){if(!this._place_mark_colection){this._place_mark_colection=new ymaps.GeoObjectCollection()}for(i=0;i<this.points.length;i++){current_point=this.points[i];if(current_point.coordinates[0]&&current_point.coordinates[1]){this._place_mark_colection.add(this._makePlaceMark(current_point))}}this.map.geoObjects.add(this._place_mark_colection)}},_makePlaceMark:function(point){var place_mark_options=this.options.place_mark,mark_property={iconContent:point.iconContent||point.title,balloonContentHeader:point.balloonContentHeader||point.title,balloonContent:point.balloonContent||point.description,hintContent:point.hintContent||point.title},placemark;if(point.place_mark_options){place_mark_options=point.place_mark_options;if(place_mark_options.iconImageHref){mark_property.iconContent=''}}placemark=new ymaps.Placemark(point.coordinates,mark_property,place_mark_options);placemark.events.add('click',function(e){document.fireEvent('mapPinClick',{extend_event:[{name:'eventContent',value:e.get('target').properties.get('hintContent')}]})});return placemark}});RozetkaYandexMapBase_class.implement(new Options(),new Events());var RozetkaYandexMap_class=RozetkaYandexMapBase_class.extend({options:{service_log_img:'img_logo',img_height_class:'check-map-img-logo',popup:{header_tpl:'<div class=\"popup-css popup-map-container\">\n\t<div name=\"close\" class=\"popup-close popup-map-close\">\n\t    <a href=\"#\" class=\"inline\">\n\t        <img width=\"37\" height=\"37\" class=\"popup-close-small-icon sprite\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"X\">\n\t    <\/a>\n\t<\/div>\n\t<div name=\"msg\"><\/div>\n\t<div name=\"content\" class=\"popup-map-content\"><\/div>\n<\/div>\n',info_tpl:'<div class=\"clearfix\">\n\t<div class=\"check-map-cities\">\n\t\t<div class=\"aligned-center check-map-img-logo responsive-img\" name=\"img_logo\"><\/div>\n\t\t<div class=\"check-map-l\" name=\"pickups_list\"><\/div>\n\t<\/div>\n\t<div class=\"check-map\" id=\"YMapsID\"><\/div>\n<\/div>',pickups_tpl:'<a href=\"#\" class=\"check-map-l-i novisited\" name=\"pickup_${id}\"  name=\"control\" element_id=\"${id}\">\n\t<div class=\"clearfix check-map-l-title\" name=\"control\" element_id=\"${id}\">\n\t\t<div class=\"check-map-l-number\">${office_number}<\/div>\n\t\t${title}\n\t<\/div>\n\t<p class=\"check-map-l-content\" name=\"slide_elem\">${description}<\/p>\n<\/a>',balloon_tpl:'<div class=\"popup-map-baloon{if image_for_map} popup-map-baloon-wide{\/if}\">\n\t{if image_for_map}\n\t\t<div class=\"popup-map-baloon-img\">${image_for_map}<\/div>\n\t{\/if}\n\t<div class=\"popup-map-baloon-number\">${number}<\/div>\n\t<address class=\"popup-map-baloon-address\">${address}<\/address>\n\t<p class=\"popup-map-baloon-text\">${description}<\/p>\n<\/div>'},selectors:{pickups_list:'[name=pickups_list]'},slide_duration:300},_logo_image_url:null,_is_points_renew:true,_popup:null,_pickups_list:[],_current_pickup:null,_pickup_id_to_set_active:null,_office_number_to_id:{},setNewPoints:function(points,service_image){var i;for(i=0;i<this._pickups_list.length;i++){if(this._pickups_list[i].place_mark){this.map.geoObjects.remove(this._pickups_list[i].place_mark)}}this._pickup_id_to_set_active=null;this._pickups_list=[];this._current_pickup=null;this.parent(points);this._is_points_renew=true;if(this._popup&&this._popup.elem){this._setServiceLogo(service_image);this._logo_image_url=service_image}else{this._logo_image_url=service_image}},_setServiceLogo:function(service_image){var img=this._popup.elem.getElement('div[name='+this.options.service_log_img+']');if(service_image){img.innerHTML=service_image;if(!img.hasClass(this.options.img_height_class)){img.addClass(this.options.img_height_class)}}else{img.removeClass(this.options.img_height_class);img.innerHTML=""}},getCurrentPickupId:function(){var result=null;if(this._current_pickup&&this._current_pickup.id){result=this._current_pickup.id}return result},_setPointAsSelected:function(place_mark){place_mark.options.set('preset','twirl#redStretchyIcon');place_mark.getMap().setCenter(place_mark.geometry.getCoordinates(),this.options.place_mark.zoom)},_setPointAsUnSelected:function(place_mark){place_mark.options.set('preset','twirl#blueStretchyIcon')},setActivePickup:function(id){this._pickup_id_to_set_active=id},_setActivePickupItemById:function(id){var i;if(id!==null){for(i=0;i<this._pickups_list.length;i++){if(this._pickups_list[i].id==id){this._onSelectPickupItem(i)}}}},_onSelectPickupItem:function(item_id){if(this._current_pickup!=this._pickups_list[item_id]){this.closeBalloon();this._unSelectPickups(item_id);if(this._pickups_list[item_id].place_mark){this._setPointAsSelected(this._pickups_list[item_id].place_mark)}else{this.map.setBounds(this._getBoundsForPoints())}this._pickups_list[item_id].slider.slideIn();this._pickups_list[item_id].slide_item.addClass('active');setTimeout(function(){var container=this._popup.elem.getElement(this.options.selectors.pickups_list),x=0,y=this._pickups_list[item_id].slide_item.offsetTop-container.getChildren().shift().offsetTop;new Fx.Scroll(container).scrollTo(x,y)}.bind(this),this.options.slide_duration);this._current_pickup=this._pickups_list[item_id]}},isVisibleInPickupsList:function(elem){var container=this._popup.elem.getElement(this.options.selectors.pickups_list),containerTop=container.scrollTop,containerBot=containerTop+container.getSize().size.y,elemTop=elem.offsetTop,elemBot=elemTop+elem.getSize().size.y;return((elemBot<=containerBot)&&(elemTop>=containerTop))},_unSelectPickups:function(active_item_id){var i;for(i=0;i<this._pickups_list.length;i++){if(i!=active_item_id){if(this._pickups_list[i].place_mark){this._setPointAsUnSelected(this._pickups_list[i].place_mark)}this._pickups_list[i].slider.slideOut();this._pickups_list[i].slide_item.removeClass('active')}}},_createPointSelectList:function(place_mark,id){var list_elem,pickups_div=this._popup.elem.getElement(this.options.selectors.pickups_list),list_item=pickups_div.getElement('[name=pickup_'+this._pickups_list.length+']'),control=list_item.getElement('[name=control]'),slide_elem=list_item.getElement('[name=slide_elem]'),slider=new Fx.Slide(slide_elem,{duration:this.options.slide_duration});slider.wrapper.setStyles({'margin':0,'height':'0px'});control.addEvent('click',function(e){new Event(e).stop();this._onSelectPickupItem(e.target.getProperty('element_id'))}.bind(this));if(place_mark){place_mark.events.add('click',function(e){this._onSelectPickupItem(this._getIdByOfficeNumber(e.get("target").properties.get('iconContent')))},this)}list_elem={place_mark:place_mark,control:control,slide_elem:slide_elem,slider:slider,id:id,slide_item:list_item};this._pickups_list.push(list_elem)},_getIdByOfficeNumber:function(office_number){return this._office_number_to_id[office_number.toString()]},_setOfficeNumberToId:function(office_number,id){this._office_number_to_id[office_number.toString()]=id},_showMap:function(){this._setMap();if(!this._pickups_list.length&&this._is_points_renew){this._setPointsForMap();this._is_points_renew=false}},_getPopup:function(){if(!this._popup){this._popup=new Popup_class(this.options.popup.header_tpl);var popup_content=App.getHTML(this.options.popup.info_tpl,{});this._popup.setContent(popup_content);this._popup.addEvent('close',function(e){this.fireEvent('pickup_selected',this.getCurrentPickupId())}.bind(this))}return this._popup},_setMap:function(){var map_recreated=this._recreate_map,points=this.points,active_pickup=this._pickup_id_to_set_active;this.parent();if(map_recreated){this.setNewPoints(points);this.setActivePickup(active_pickup)}},show:function(){var popup=this._getPopup();popup.open();this._setServiceLogo(this._logo_image_url);popup.elem.addEvent('click',function(e){new Event(e).stop()}.bind(this));this._showMap();if(this._pickup_id_to_set_active&&this._pickup_id_to_set_active!==""){this._setActivePickupItemById(this._pickup_id_to_set_active);this._pickup_id_to_set_active=null}else{this.map.setBounds(this._getBoundsForPoints());this._unSelectPickups();this._current_pickup=null}},_makePointOnMap:function(point,title){var place_mark=null,coordinates=point.coordinates;if(this.map){place_mark=new ymaps.Placemark(coordinates,{iconContent:title,balloonContent:App.getHTML(this.options.popup.balloon_tpl,point),hintContent:point.title},{preset:'twirl#blueStretchyIcon'});this.map.geoObjects.add(place_mark)}return place_mark},_setPointsForMap:function(){var i,place_mark,current_point;if(this.points){this._popup.elem.getElement(this.options.selectors.pickups_list).innerHTML="";place_mark=[];for(i=0;i<this.points.length;i++){current_point=this.points[i];if(current_point.coordinates[0]&&current_point.coordinates[1]){place_mark[i]=this._makePointOnMap(current_point,current_point.office_number);this._setOfficeNumberToId(current_point.office_number,i)}this._createItemDiv(current_point,i)}for(i=0;i<this.points.length;i++){this._createPointSelectList(place_mark[i],this.points[i].id)}}},_createItemDiv:function(current_point,i){var pickups_div=this._popup.elem.getElement(this.options.selectors.pickups_list),data={title:current_point.title,description:current_point.description,id:i,office_number:current_point.office_number};pickups_div.innerHTML+=App.getHTML(this.options.popup.pickups_tpl,data)}});var RozetkaGTMEvents_class=new Class({Class:'GTMEvents_class',initDataBlocks:function(data_blocks){data_blocks.each(this._setGTMEvents.bind(this))},_setGTMEvents:function(block){var index,action,event_element,event_elements=block.getEventElements();for(index in event_elements){event_element=event_elements[index];action=event_element.action||block.default_action;if(event_element.event_name){this._AddEventToListen(event_element,action,block)}else if(event_element.selector){this._addGTMEvent(event_element,action,block)}}},_addGTMEvent:function(event_object,action,block){var elements;if(event_object.container&&$(event_object.container)){elements=$(event_object.container).getElements(event_object.selector)}else{elements=$$(event_object.selector)}if(elements){elements.each(function(elem){elem.addEvent(action,function(e){this._trackGTMEvent(event_object,block,e,elem)}.bind(this))}.bind(this))}},_extendGTMEvent:function(block,extender,e,elem){var event=Object.clone(block.base_GTM_event),data_id,type,i;for(i in extender){if((extender.hasOwnProperty(i)&&extender[i].name=='goods_id')||extender[i].name=='kit_id'){data_id=extender[i].value;type=extender[i].name.replace('_id','');delete extender[i];break}}extender.each(function(item){var value;value=item.value||(item.handler?block[item.handler](e,elem):false)||(item.handlerID?block[item.handlerID](data_id,type):false)||block.getDefaultValueByName(item.name,e);if(value){event[item.name]=value}}.bind(this));return event},_trackGTMEvent:function(event_object,block,event,elem){event_object=this._extendGTMEvent(block,event_object.extend_event,event,elem);App.trackGTMEvent(event_object,event_object.event?true:false)},_AddEventToListen:function(event_object,action,block){$(document).addEvent(event_object.event_name,function(data){var new_event_object=Object.clone(event_object);if(data&&data.extend_event){data.extend_event.each(function(extender){new_event_object.extend_event.push(extender)})}if(new_event_object.selector){this._addGTMEvent(new_event_object,action,block)}else{this._trackGTMEvent(new_event_object,block,data)}}.bind(this))},trackSocial:function(longName,shortName){document.fireEvent("trackSocial",{extend_event:[{name:"eventContent",value:longName}]})}});Array.extend({clone:function(){var i=this.length,clone=[i];while(i--){clone[i]=cloneOf(this[i])}return clone}});var GTMData_BaseAbstract_class=new Class({Class:'GTMData_BaseAbstract_class',options:{GTM:{events:{}}},base_GTM_event:{},default_action:'click',default_handler_by_name:{},getDefaultValueByName:function(name,data){var value=null;if(this.default_handler_by_name[name]){value=this[this.default_handler_by_name[name]](name,data)}return value},getEventElements:function(){return this.options.GTM.events},extendBaseEvent:function(event){if(event&&$type(event)=='object'){Object.merge(this.base_GTM_event,event)}}});var GTMData_Storage_class=new Class({_storage:{'goods':[],'kit':[]},default_type:'goods',goods_id:null,initialize:function(){this.attachToObserver(['LoadGTMData'])},onLoadGTMData:function(data){if(data){Object.values(data).each(function(record){record.id&&this.setGoodsData(record.id,record)}.bind(this))}},setGoodsData:function(id,data,type){var resulted_type=type||this.default_type;if(this.existGoodsData(id,resulted_type)){Object.merge(data,this.getGoodsData(id,resulted_type))}this._storage[resulted_type][id]=data},setGoodsDataOnce:function(id,key,value,type){var obj={};obj[key]=value;this._storage[type||this.default_type][id]=obj},getGoodsData:function(id,type){var source_type=type||this.default_type;return this._storage[source_type][id]||null},getGoodsDataField:function(id,field,type){var source_type=type||this.default_type;return(this._storage[source_type][id]&&this._storage[source_type][id][field])?this._storage[source_type][id][field]:null},existGoodsData:function(id,type){return!!this._storage[type||this.default_type][id]},removeGoodsData:function(id,type){var source_type=type||this.default_type;if(this._storage[source_type][id]){delete this._storage[source_type][id]}},setGoodsId:function(id){this.goods_id=parseInt(id,10)},getGoodsId:function(){return this.goods_id}});GTMData_Storage_class.implement(new Events());var GTMData_Banners_class=GTMData_BaseAbstract_class.extend({Class:'GTMData_Banners_class',data:[],mini_promo_position:1,options:{GTM:{events:{click_promo:{event_name:'clickPromo',extend_event:[{name:'eventAction',handler:'getAction'},{name:'promoContext',handler:'getContext'},{name:'promoContent',handler:'getContent'},{name:'eventPosition',handler:'getPosition'},{name:'eventLocation',value:'fat-menu'}]},switch_promo:{event_name:'switchPromo',extend_event:[{name:'eventAction',handler:'getAction'},{name:'eventContext',handler:'getContext'},{name:'eventContent',handler:'getContent'},{name:'eventPosition',handler:'getPosition'}]},show_promo:{event_name:'showPromo',extend_event:[{name:'eventAction',handler:'getAction'},{name:'eventContext',handler:'getContext'},{name:'eventContent',handler:'getContent'},{name:'eventPosition',handler:'getPosition'},{name:'eventNoninteraction',value:true}]},show_stretch:{event_name:'showStretch',extend_event:[{name:'eventAction',handler:'getAction'},{name:'eventContext',handler:'getContext'},{name:'eventContent',handler:'getContent'},{name:'eventNoninteraction',value:true}]},click_stretch:{event_name:'clickStretch',extend_event:[{name:'eventAction',handler:'getAction'},{name:'promoContext',handler:'getContext'},{name:'promoContent',handler:'getContent'},{name:'eventLocation',value:'fat-menu'}]},show_promo_banners:{event_name:'initialShowPromo',extend_event:[{name:'eventAction',value:'show'},{name:'eventCategory',value:'Interactions'},{name:'eventLabel',value:'banner'},{name:'eventNoninteraction',value:true},{name:'promotionImpressions',handler:'getPromotionImpressions'}]},close_update:{event_name:'closeUpdate',extend_event:[{name:'eventLabel',value:'closeUpdate'},{name:'eventAction',value:'click'},{name:'eventCategory',value:'Interactions'}]},update_browser:{event_name:'updateBrowser',extend_event:[{name:'eventLabel',value:'updateBrowser'},{name:'eventAction',value:'click'},{name:'eventCategory',value:'Interactions'}]},pagination_click_big_promo:{event_name:'switchPaginationPromo',extend_event:[{name:'eventAction',value:'switch'},{name:'eventContext',handler:'getContext'},{name:'eventContent',handler:'getContent'},{name:'eventPosition',handler:'getPosition'}]}}}},base_GTM_event:{eventCategory:'Interactions',eventLabel:'banner'},initialize:function(){this.attachToObserver(['switchBigPromo']);App.addOnDomReady(this._fireImpressionEvent.bind(this))},onSwitchBigPromo:function(e){if(App.domIsReady){this.setEventData(e[0],'big_promo',null,'Promo',e[1],e[2]?e[2]:null)}else{this.setEventDataImpression(e[0],'big_promo',null,'Promo',e[1],e[2]?e[2]:null)}},setEventData:function(content,context,elem,name,position,action){this.data=this.getPromotionData(content,context,position,action);if(this.data.eventAction=='switch'&&context=='big_promo'){document.fireEvent(this.data.eventAction+'Pagination'+name)}else if(this.data.eventAction!='show'){document.fireEvent(this.data.eventAction+name)}if(this.isImg(elem)){this.bindClickListeners(elem,content,name,this.data)}},isImg:function(elem){return elem&&elem.getElement('img')&&elem.getElement('img').getAttribute('alt')},bindClickListeners:function(elem,content,name,event_data){var data=[];data[content]=event_data;elem.getElement('img').addEvent('click',function(){this.data=data[elem.getElement('img').getAttribute('alt')];this.data['eventAction']='click';document.fireEvent('click'+name)}.bind(this))},getPromotionData:function(content,context,position,action){var data={eventAction:action||'show',promoContent:content,promoContext:context};if(position&&context!='mini_promo'){data['eventPosition']=position}else if(context=='mini_promo'){data['eventPosition']=this.mini_promo_position;this.mini_promo_position++}return data},setEventDataImpression:function(content,context,elem,name,position,action){var promotionImpression=this.getPromotionData(content,context,position,action);if(!this.data['promotionImpressions']){this.data['promotionImpressions']=[]}this.data['promotionImpressions'].push(promotionImpression)},_fireImpressionEvent:function(){if(this.data['promotionImpressions']){document.fireEvent('initialShowPromo')}},getAction:function(){return this.data.eventAction},getContext:function(){return this.data.promoContext},getContent:function(){return this.data.promoContent},getPosition:function(){return this.data.eventPosition},getPromotionImpressions:function(){return this.data.promotionImpressions}});Array.extend({clone:function(){var i=this.length,clone=[i];while(i--){clone[i]=cloneOf(this[i])}return clone}});GTMData_Banners_class.implement(new Events);var GTMData_FatMenu_class=GTMData_BaseAbstract_class.extend({Class:'GTMData_FatMenu_class',options:{GTM:{events:{mini_promo_show:{event_name:'fatmenuMiniPromoShow',extend_event:[{name:'eventLabel',value:'banner'},{name:'eventContext',value:'mini-promo'},{name:'eventAction',value:'show'},{name:'eventNoninteraction',value:1}]},mini_promo_click:{selector:'[name="fatmenu_minipromo"] img',extend_event:[{name:'eventLabel',value:'banner'},{name:'eventContext',value:'mini-promo'},{name:'eventContent',handler:'getBannerTitle'}]},banner_click:{selector:'[name="fatmenu_big_banner"]',extend_event:[{name:'eventLabel',value:'openPromoPage'},{name:'eventContext',handler:'getBannerHref'}]},menu_elem_click:{selector:'[name="m-main-i"] a[name="fat_menu_link"]',extend_event:[{name:'eventLocation',handler:'getElementNestingLevel'},{name:'eventContent',handler:'getElemNovelty'},{name:'eventContext',handler:'getTabTitle'},{name:'eventLabel',value:'fat-menu'}]},catalog_button_click:{selector:'#fat_menu_btn',extend_event:[{name:'eventLabel',value:'catalog'},{name:'eventLocation',value:'leftMenu'},{name:'eventContent',value:' '}]},scroll_click_main:{selector:'#m-main [name="controls"]',extend_event:[{name:'eventAction',value:'scroll'},{name:'eventLabel',value:'fat-menu'},{name:'eventLocation',value:'level2'}]}}}},base_GTM_event:{eventLocation:'fat-menu',eventAction:'click',eventCategory:'Interactions'},getBannerTitle:function(e){var target=new Event(e).target;return target.getProperty('alt')},getBannerHref:function(e){var target=new Event(e).target;return target.getParent().getProperty('href')},getElementNestingLevel:function(e){var target=new Event(e).target;return target.getProperty('level')},getElemNovelty:function(e){var target=new Event(e).target;return target.getProperty('is_new')},getTabTitle:function(e){var target=new Event(e).target;return target.getText()}});var GTMData_Footer_class=GTMData_BaseAbstract_class.extend({Class:'GTMData_Footer_class',options:{GTM:{events:{click_app_footer:{event_name:'clickAppFooter',extend_event:[]}}}},base_GTM_event:{eventCategory:'Conversions',eventAction:'click'}});var GTMData_SocialLinkPopup_class=GTMData_BaseAbstract_class.extend({Class:'GTMData_SocialLinkPopup_class',options:{GTM:{events:{linkFacebook:{event_name:'showHeaderSocialPopup',container:'social_popup',selector:'[type=facebook]',extend_event:[{name:'eventLabel',value:'linkFacebook'}]},linkVkontakte:{event_name:'showHeaderSocialPopup',container:'social_popup',selector:'[type=vkontakte]',extend_event:[{name:'eventLabel',value:'linkVkontakte'}]},closeLinkSocial:{event_name:'showHeaderSocialPopup',container:'social_popup',selector:'[name=close]',extend_event:[{name:'eventLabel',value:'closeLinkSocial'}]},social:{event_name:'loginSuccessSocialPopup',extend_event:[{name:'eventCategory',value:'Conversions'},{name:'eventAction',value:'signup'},{name:'eventLabel',value:'social'}]}}}},base_GTM_event:{eventCategory:'Interactions',eventAction:'click',eventLocation:'popUp'}});App.addOnDomReady(function(){GTMEvents.initDataBlocks([new GTMData_SocialLinkPopup_class()])});var GTMData_AuthBlocks_class=GTMData_BaseAbstract_class.extend({options:{GTM:{events:{get_temp_pass:{event_name:'authBlocksGetTempPass',extend_event:[{name:'eventAction',value:'click'},{name:'eventLabel',value:'getTempPassword'}]},remembered_password:{event_name:'authBlocksRememberedPassword',extend_event:[{name:'eventAction',value:'click'},{name:'eventLabel',value:'rememberedPassword'}]},forgot_password:{event_name:'authBlocksForgotPassword',extend_event:[{name:'eventAction',value:'click'},{name:'eventLabel',value:'forgotPassword'}]},blocks_opened:{event_name:'authBlocksOpened',extend_event:[{name:'eventAction',value:'open'},{name:'eventLabel',value:'popup'}]},email_exists:{event_name:'authBlocksEmailExists',extend_event:[{name:'eventAction',value:'error'},{name:'eventLabel',value:'emailExist'}]},successful_signin:{event_name:'authBlocksSignIn',extend_event:[{name:'eventAction',value:'signin'}]},wrong_password:{event_name:'authBlocksWrongPassword',extend_event:[{name:'eventAction',value:'error'},{name:'eventLabel',value:'wrongPassword'}]}}}},base_GTM_event:{eventCategory:'Interactions'}});App.addOnDomReady(function(){GTMEvents.initDataBlocks([new GTMData_AuthBlocks_class()])});var ShowMoreClass=new Class({text:null,link:null,options:{cssClasses:{boxHide:"box-hide"}},initialize:function(linkId,textId){this.text=$(textId);this.link=$(linkId);if(this.text.getCoordinates().height<parseInt(this.text.getStyle('max-height'),10)){this.show()}else{this.link.addEvent("click",function(event){event.preventDefault();this.show();document.fireEvent('descriptionMore')}.bind(this))}},show:function(event){this.link.hide();this.text.removeClass(this.options.cssClasses.boxHide)}});var ShowMoreSeoClass=ShowMoreClass.extend({layout:null,container:null,options:{cssClasses:{layoutFixId:"layout_fix",textContainerId:"text-description-page"}},initialize:function(linkId,textId){this.parent(linkId,textId);this.layout=$(this.options.cssClasses.layoutFixId);this.container=$(this.options.cssClasses.textContainerId);this.setHeight();this.link.addEvent("click",this.setHeight.bind(this));window.addEvent("resize",this.setHeight.bind(this))},setHeight:function(){this.layout.setStyle('height',this.container.clientHeight)}});OutdatedBrowserBanner_class=RozetkaStretchBanner.extend({_navigator:navigator.userAgent,options:{cookie_name:'banner_outdated_browser_disable',cookie_options:{duration:0,path:'/'}},getActualBanner:function(){var i,u,re;if(this._banners.length&&!this._actual_banner){find:for(i=0;i<this._banners.length;i++){for(u=0;u<this._banners[i].regular_expressions.length;u++){re=new RegExp(this._banners[i].regular_expressions[u],'gim');if(re.exec(this._navigator)){this._actual_banner=this._banners[i];break find}}}}return this._actual_banner},_setGTMEvents:function(){this.parent();if(this.getContainer('banner_place').getElement('a')){this.getContainer('banner_place').getElement('a').addEvent('click',function(){document.fireEvent('updateBrowser')})}if(this.getContainer('close_block').getElement('a')){this.getContainer('close_block').getElement('a').addEvent('click',function(){document.fireEvent('closeUpdate')})}},isDisable:function(){return(this.getActualBanner()&&!this._checkCookie())}});var SpecialPriceShow_class=new Class({Class:'SpecialPriceShow_class',options:{jst:{popup:'<div class=\"popup-css popup-addprice\">\n\t<a href=\"#\" class=\"popup-close\" name=\"close\"><img width=\"18\" height=\"18\" src=\"https:\/\/i.rozetka.com.ua\/design\/_.gif\" alt=\"&times;\" class=\"popup-close-medium-icon sprite\"><\/a>\n\t<div name=\"content\"><\/div>\n<\/div>',info:'{if description} <div class="popup-addprice-description"> <h2>${title}</h2> <p>${description}</p> </div> {/if}'}},popup:{},initSpecialPriceInfo:function(special_price_info_id,info_details,info_title,event,extend_event){var info_button=$(special_price_info_id);if(info_button!=undefined){info_button.addEvent('click',function(e,data){new Event(e).stop();this.onInfoClick(data.price_info_id,data.info_details,data.info_title,data.event,data.extend_event)}.bindAsEventListener(this,{price_info_id:special_price_info_id,info_details:info_details,info_title:info_title,event:event,extend_event:extend_event}))}},onInfoClick:function(price_info_id,info_details,info_title,event,extend_event){if(event!=undefined){document.fireEvent(event,extend_event)}if(!this.popup.hasOwnProperty(price_info_id)){this.popup[price_info_id]=new Popup_class(this.options.jst.popup);this.popup[price_info_id].setContent(this.options.jst.info,{description:info_details,title:info_title})}this.popup[price_info_id].open()}});var ShareButton_class=new Class({Class:'ShareButton_class',options:{tpl:{content:'<input type=\"text\" class=\"comparison-share-link-popup-input\" name=\"share-button-input\" value=\"${getUrl()}\"\/>'},selectors:{button:'[name=share-button-button]',popup:'[name=share-button-popup]',input:'input[name=share-button-input]'},url:''},_container:null,_button:null,_popup:null,_input:null,initialize:function(container){this._container=container;this.attachToObserver([])},init:function(){this._button=this._container.getElement(this.options.selectors.button);this._popup=this._container.getElement(this.options.selectors.popup);this._popup.setHTML(App.getHTML(this.options.tpl.content,this));this._input=this._popup.getElement(this.options.selectors.input);this._button.addEvent('click',this._onButtonHandler.bind(this));document.body.addEvent('click',this._onHidePopup.bind(this));this._container.addEvent('click',function(e){new Event(e).stop()});return this},getUrl:function(){return this.options.url||window.location.href.replace('#','')},_onButtonHandler:function(e){new Event(e).stop();this._popup.toggle();if(this._popup.isDisplayed()&&this._input){this._input.select()}},_onHidePopup:function(e){if(this._popup.isDisplayed()){this._popup.hide()}}});ShareButton_class.implement(new Events(),new Options());var SlideEffect_class=new Class({_slider:null,_is_visible:true,_is_transitory:false,initialize:function(elem){this._slider=new Fx.Slide(elem);this._slider.addEvent('onComplete',function(){this._is_transitory=false}.bind(this))},show:function(){if(!this._is_transitory&&!this._is_visible){this._is_transitory=true;this._slider.slideIn();this._is_visible=true}},hide:function(){if(!this._is_transitory&&this._is_visible){this._is_transitory=true;this._slider.slideOut();this._is_visible=false}},toggle:function(){if(!this._is_transitory){this._is_transitory=true;if(this._is_visible){this._slider.slideOut();this._is_visible=false}else{this._slider.slideIn();this._is_visible=true}}}});var PopupEffect_class=new Class({options:{tpl:'<div> <div name=\"content\"><\/div> <\/div>',overlay:{enabled:false,background:'#fff',zindex:200}},_popup:null,_elem_name:null,initialize:function(elem,options){if(options!=undefined&&options.is_absolute==true){this._popup=new Popup_class(this.options.tpl)}else{this._popup=new Popup_class(this.options.tpl,elem)}if(options&&options.overlay&&options.overlay.enabled){this._popup.overlayON({styles:{'z-index':this.options.overlay.zindex,'background-color':this.options.overlay.background}})}if(elem.innerHTML!=undefined&&elem.innerHTML){this._popup.setContent(elem.innerHTML)}elem.innerHTML='';elem.removeClass('hidden');this._elem_name=elem.getAttribute('name');this._popup.addEvent('close',function(){document.fireEvent('closePopup_'+this._elem_name)}.bind(this))},show:function(){if(!this._popup.isOpened()){this._popup.open()}else{this._popup.close()}},hide:function(){this._popup.close()}});var StyleEffect_class=new Class({_is_visible:true,_elem:null,_class_show:null,_class_hide:null,initialize:function(elem){this._elem=elem;this._class_show=this._elem.getAttribute('class_show');this._class_hide=this._elem.getAttribute('class_hide')},show:function(){if(!this._is_visible){this._elem.setAttribute('class',this._class_show);this._is_visible=true}},hide:function(){if(this._is_visible){this._elem.setAttribute('class',this._class_hide);this._is_visible=false}},toggle:function(){if(this._is_visible){this._elem.setAttribute('class',this._class_hide);this._is_visible=false}else{this._elem.setAttribute('class',this._class_show);this._is_visible=true}}});var ElementEffect_class=new Class({options:{attribute_name:'effect_type',effect_id_attribute:'effect_id'},effect_element:{},effect_id_counter:0,initialize:function(options){if(options){this.setOptions(options)}},init:function(){var elements=document.getElements("["+this.options.attribute_name+"]");elements.forEach(function(elem){if(this._getEffect(elem)==undefined){this._createEffect(elem.getAttribute(this.options.attribute_name),elem)}}.bind(this))},removeHidden:function(){var elements=document.getElements("["+this.options.attribute_name+"]");elements.forEach(function(elem){elem.removeClass('hidden')})},_createEffect:function(effect_name,elem){var result=undefined;if(effect_name!=undefined){switch(effect_name){case'slide':result=this.effect_element[this.effect_id_counter]=new SlideEffect_class(elem);break;case'popup':result=this.effect_element[this.effect_id_counter]=new PopupEffect_class(elem);break;case'absolute_popup':result=this.effect_element[this.effect_id_counter]=new PopupEffect_class(elem,{is_absolute:true});break;case'absolute_overlay_popup':result=this.effect_element[this.effect_id_counter]=new PopupEffect_class(elem,{is_absolute:true,overlay:{enabled:true}});break;case'style':result=this.effect_element[this.effect_id_counter]=new StyleEffect_class(elem);break;default:console.log(' '+elem+'    ');break}elem.setAttribute(this.options.effect_id_attribute,this.effect_id_counter);this.effect_id_counter=this.effect_id_counter+1}return result},show:function(elem){var effect=this._getEffect(elem);if(effect!=undefined){effect.show()}else{elem.show()}return effect||elem},hide:function(elem){var effect=this._getEffect(elem);if(effect==undefined){effect=this._createEffect(elem.getAttribute(this.options.attribute_name),elem)}if(effect==undefined){elem.hide()}else{effect.hide()}return effect||elem},toggle:function(elem){var effect=this._getEffect(elem);if(effect==undefined){effect=this._createEffect(elem.getAttribute(this.options.attribute_name),elem)}if(effect==undefined){elem.toggle()}else{effect.toggle()}return effect||elem},_getEffect:function(elem){var effect,effect_num=elem.getAttribute(this.options.effect_id_attribute);if(effect_num!=undefined){effect=this.effect_element[effect_num]}return effect}});ElementEffect_class.implement(new Events);var RozetkaSplashBoxClass=new Class({Class:'RozetkaSplashBoxClass',options:{selectors:{button:'[name=splash-button]',popup:'[name=splash-popup]'},hide_class:'hidden',delayBefore:400,delayAfter:600},_container:null,_button:null,_timer:0,initialize:function(container){this._container=container;this.attachToObserver(['ShowingSplashPopup'])},init:function(){this._button=this._container.getElement(this.options.selectors.button);this._button.removeEvents('click');if(App.isDesktop()){this._container.addEvent('mouseenter',this._onButtonMouseEnter.bind(this));this._container.addEvent('mouseleave',this._onContainerMouseLeave.bind(this))}else{this._button.addEvent('click',this._onButtonClick.bind(this));document.body.addEvent('click',this._hidePopup.bind(this))}return this},onShowingSplashPopup:function(data){if(data[0]!==this){this._hidePopup()}},_onButtonMouseEnter:function(e){clearTimeout(this._timer);this._timer=setTimeout(this._showPopup.bind(this),this.options.delayBefore)},_onContainerMouseLeave:function(e){clearTimeout(this._timer);this._timer=setTimeout(this._hidePopup.bind(this),this.options.delayAfter)},_onButtonClick:function(e){if(!this._isVisible()){new Event(e).stop();this._showPopup()}},_showPopup:function(){var popup=this.getPopup();clearTimeout(this._timer);if(popup&&!this._isVisible()){this.fireEvent('ShowingSplashPopup',this);popup.removeClass(this.options.hide_class)}},_hidePopup:function(){var popup=this.getPopup();if(popup&&this._isVisible()){popup.addClass(this.options.hide_class)}},_isVisible:function(){var popup=this.getPopup();return(popup&&!popup.hasClass(this.options.hide_class))},getPopup:function(){return this._container.getElement(this.options.selectors.popup)}});RozetkaSplashBoxClass.implement(new Events(),new Options());var RozetkaSplashCartBoxClass=RozetkaSplashBoxClass.extend({Class:'RozetkaSplashCartBoxClass',_cart:null,options:{hide_if_empty:false},initialize:function(container,cart_object){this.parent(container);this._cart=cart_object;this._cart.addEvent('update',this._onCartUpdated.bind(this))},init:function(){this.parent();if(App.isDesktop()){this._button.addEvent('click',this._onButtonClick.bind(this))}return this},_hideEmptyCart:function(){if(this._cart.empty()){this._container.addClass(this.options.hide_class)}else{this._container.removeClass(this.options.hide_class)}},_onCartUpdated:function(){if(this.options.hide_if_empty){this._hideEmptyCart()}},_onButtonClick:function(e){new Event(e).stop();if(!App.isDesktop()){if(this._isVisible()){this._hidePopup();this._openCart()}else{this._showPopup()}}else{this._openCart()}},_openCart:function(){this._cart.openCart()}});RozetkaSplashCartBoxClass.implement(new Events(),new Options());var CSRF_TokenManager_class=new Class({Binds:['_filterFormToInjectCSRFToken','_addTokenInputToForm'],Class:'CSRF_TokenManager_class',options:{token_cookie_name:'uid',token_field_name:'request_token',protect_always:'1',csrf_sign_form:'data-secure-csrf'},initialize:function(){this.attachToObserver(['contentUpdate','LoadTabCompleted']);document.addEventListener('DOMNodeInserted',this.onDOMNodeInserted.bind(this))},addProtect:function(container){var container_to_protect=container||$(document.body);container_to_protect.getElements('form').filter(this._filterFormToAttribute.bind(this)).filter(this._filterFormToInjectCSRFToken.bind(this)).each(this._addTokenInputToForm.bind(this))},_addTokenInputToForm:function(form,index,all_forms){form.appendChild(new Element('input',{type:'hidden',name:this.options.token_field_name,value:Cookie.get(this.options.token_cookie_name)}))},_filterFormToInjectCSRFToken:function(form,index,all_forms){return!$(form).getElements('input[name='+this.options.token_field_name+']').length&&(!form.getAttribute('method')||form.getAttribute('method').toLowerCase()!=='get')},onContentUpdate:function(elem){this.addProtect(elem[0])},onLoadTabCompleted:function(arg){this.addProtect()},onDOMNodeInserted:function(event){var target_element=event.target||event.srcElement;if(target_element.tagName=='FORM'&&this._filterFormToInjectCSRFToken(target_element)){this._addTokenInputToForm(target_element)}},_filterFormToAttribute:function(form){return form.getAttribute(this.options.csrf_sign_form)==='1'||this.options.protect_always==='1'}});CSRF_TokenManager_class.implement(new Events());var KitsConstructor_class=new Class({Class:'KitsConstructor_class',_units:{},_kit_costs:{},_kit_unit_goods_ids:{},_current_goods_ids:{},_code_element:null,options:{price_block_id_prefix:'kit_price',code_block_id_prefix:'kit_code',url:'http://rozetka.com.ua/kits_costs/'},catalog_item:null,initialize:function(catalog_item,goods_ids){var source_data=catalog_item.getSource().getData();this._kit_unit_goods_ids=goods_ids;this.catalog_item=catalog_item;this._current_goods_ids=source_data.unit_ids;this._cacheData(source_data.kit_id)},changeCurrentState:function(unit_number,position){var units_hash,url,source_data=this.catalog_item.getSource().getData();this._current_goods_ids[unit_number]=this._kit_unit_goods_ids[unit_number][position];source_data.unit_ids=this._current_goods_ids;units_hash=this._getCurrentUnitsHash();$(this.options.code_block_id_prefix+source_data.kit_id).setHTML(this._getKitCode(source_data));if(this._kit_costs[units_hash]!==undefined){$(this.options.price_block_id_prefix+source_data.kit_id).setHTML(this._kit_costs[units_hash]);this.catalog_item.update()}else{url=App.buildUrl(this.options.url,{goods_id:source_data.goods_id,kit_id:source_data.kit_id,unit_ids:Object.keys(source_data.unit_ids),unit_goods_ids:Object.values(source_data.unit_ids)});new Ajax(url,{method:'get',update:this.options.price_block_id_prefix+source_data.kit_id,onSuccess:function(){this.catalog_item.update();this._cacheData(source_data.kit_id)}.bind(this)}).request()}},_getKitCode:function(source_data){var data=[source_data.kit_id,source_data.goods_id,Object.values(source_data.unit_ids).join('-')];return data.join('-')},_cacheData:function(kit_id){var units_hash=this._getCurrentUnitsHash();this._kit_costs[units_hash]=$(this.options.price_block_id_prefix+kit_id).innerHTML},_getCurrentUnitsHash:function(){return Object.values(this._current_goods_ids).join('_')}});KitsConstructor_class.implement(new Events(),new Options());var KitCarousel_class=new Class({Class:'KitCarousel_class',options:{container:'[name=carousel_container]',element:'[name=carousel_element]',controls:{prev:'[name=carousel_control_left]',next:'[name=carousel_control_right]'},controls_css:{prev:'disabled',next:'disabled'},control_size:0,is_centered:true,is_vertical:false,is_stretchable:false,is_circular:false,is_single:false,scroll_count:null},_parent:null,_container:null,_elements:null,_controls:{},_fx:null,_size_style:'width',_offset_style:'margin-left',_element_size:0,_current_pos:0,_is_run:false,initialize:function(parent){this._parent=$(parent);this._controls={};this.attachToObserver(['ChangeBlockOffer'])},onChangeBlockOffer:function(){this._resize()},run:function(){if(this.options.is_vertical){this._size_style='height';this._offset_style='margin-top'}if(this.options.is_single){this.options.scroll_count=1}this._container=this._parent.getElement(this.options.container);if(this._container&&this._getElements()&&this._getElements().length){this.reset();this._bindEvents();this._updateFx();this._resize();if(this.options.is_stretchable){window.addEvent('resize',function(){this._resize()}.bind(this))}}return this},reset:function(){this._container.setStyle(this._size_style,9000);this._elements=null;var size=this._getElementsTotalSize();this._element_size=size/this._getElements().length;this._container.setStyle(this._size_style,size);this._container.setStyle(this._offset_style,this.options.control_size-(this._getVisibleAreaSize()*this._current_pos));this._checkControls()},_bindEvents:function(){this._getControl('prev').addEvent('click',function(e){new Event(e).stop();this._controlsClickHandler('prev')}.bind(this));this._getControl('next').addEvent('click',function(e){new Event(e).stop();this._controlsClickHandler('next')}.bind(this))},_getElementsTotalSize:function(){var size=0;this._getElements().each(function(el){size+=this.options.is_vertical?el.offsetHeight:el.offsetWidth}.bind(this));return Math.ceil(size)},_resize:function(){if(this.options.is_single){this._element_size=this._getVisibleAreaSize();this._getElements().each(function(el){el.setStyle(this._size_style,this._element_size)}.bind(this));this._container.setStyle(this._size_style,this._getElementsTotalSize());this._container.setStyle(this._offset_style,this.options.control_size-(this._getVisibleAreaSize()*this._current_pos))}else{var limits=this._getLimits(),offset;if(limits.prev==limits.next){offset=this.options.is_centered?(this._getVisibleAreaSize()-this._getContainerSize(this._container))/2:0;this._container.setStyle(this._offset_style,this.options.control_size+offset)}else if(this._getContainerOffset()<limits.next){this._container.setStyle(this._offset_style,limits.next)}else if(this._getContainerOffset()>limits.prev){this._container.setStyle(this._offset_style,limits.prev)}}this._checkControls()},_controlsClickHandler:function(direction){var newOffset=this._getNewOffset(direction);if(newOffset!=null&&!this._is_run){switch(direction){case'prev':this._current_pos--;break;case'next':this._current_pos++;break}this._slide(newOffset,direction)}},_getNewOffset:function(direction,multiplier){multiplier=multiplier||1;var result=null,offset=this._getContainerOffset(),limits=this._getLimits();if(this._getContainerSize(this._container)>this._getVisibleAreaSize()){switch(direction){case'prev':if(offset<limits.prev){result=offset+this._getScrollAmount()*multiplier;result=result>limits.prev?limits.prev:result}break;case'next':if(offset>limits.next){result=offset-this._getScrollAmount()*multiplier;result=result<limits.next?limits.next:result}break}}return result},_getScrollAmount:function(){return this.options.scroll_count?this._element_size*this.options.scroll_count:this._getVisibleAreaSize()-this._element_size},_getContainerSize:function(container){return this.options.is_vertical?container.getSize().size.y:container.getSize().size.x},_getVisibleAreaSize:function(){return(this.options.is_vertical?this._parent.getSize().size.y:this._parent.getSize().size.x)-2*this.options.control_size},_slide:function(newOffset,direction){this._is_run=true;this.getFx().start(newOffset);this.fireEvent('slide',[this._current_pos,direction])},_switch:function(newOffset){this._updateSwitchFx(newOffset);this._is_run=true;this.getFx().start('opacity',0)},_checkControls:function(){var offset=this._getContainerOffset(),limits=this._getLimits();if(limits.prev==limits.next){this._getControl('next').addClass('hidden');this._getControl('prev').addClass('hidden')}else{this._getControl('next').removeClass('hidden');this._getControl('prev').removeClass('hidden');if(offset>=limits.prev){this._getControl('prev').addClass(this.options.controls_css.prev)}else{this._getControl('prev').removeClass(this.options.controls_css.prev)}if(offset<=limits.next){this._getControl('next').addClass(this.options.controls_css.next)}else{this._getControl('next').removeClass(this.options.controls_css.next)}}this.fireEvent('checkControls')},_getElements:function(){if(this._elements==null){this._elements=this._parent.getElements(this.options.element).filter(function(el){return(!el.hasClass('hidden'))})}return this._elements},_getControl:function(direction){if(this._controls[direction]==null){this._controls[direction]=this._parent.getElement(this.options.controls[direction])}return this._controls[direction]},_getContainerOffset:function(){return this._container.getStyle(this._offset_style).toInt()},_getLimits:function(){var limits={prev:this.options.control_size,next:this._getContainerSize(this._parent)-this._getContainerSize(this._container)-this.options.control_size};if(limits.next>limits.prev){limits.next=limits.prev}return limits},_updateFx:function(){var fx=new Fx.Style(this._container,'margin-top',{onComplete:function(){this._is_run=false;this._checkControls()}.bind(this)});this.setFx(fx)},_updateSwitchFx:function(newOffset){var fx=new Fx.Style(this._container,'margin-top',{duration:'short',onComplete:function(){this._is_run=false;this._container.setStyle(this._offset_style,newOffset);this._checkControls();this._updateFx()}.bind(this)});this.setFx(fx)},getFx:function(){return this._fx},setFx:function(fx){this._fx=fx},getPagesCount:function(){return Math.ceil(this._getContainerSize(this._container)/this._getScrollAmount())},getActivePage:function(){return Math.ceil((this.options.control_size-this._getContainerOffset())/this._getScrollAmount())+1},goToPage:function(page){var diff,newOffset,active_page=this.getActivePage(),direction=page<active_page?'prev':'next';if(page!=active_page&&page>=1&&page<=this.getPagesCount()&&!this._is_run){diff=Math.abs(active_page-page);newOffset=this._getNewOffset(direction,diff);if(diff<=2){this._slide(newOffset,direction)}else{this._switch(newOffset)}}}});KitCarousel_class.implement(new Events(),new Options());var SellerInfo_class=new Class({options:{tpl:{popup:'<div class=\"pistil-{if options.layout == \u0027bottom\u0027}top{else}right{\/if} merchant-popup\" style=\"position:absolute;\" name=\"about_seller\">\n\t<div class=\"goods-popup-hover\">\n\t\t<div class=\"popup-css\">\n\t\t\t<div name=\"msg\"><\/div>\n\t\t\t<div name=\"content\" class=\"goods-popup-hover-content\"><\/div>\n\t\t\t<div class=\"pistil\" name=\"pistil\"><\/div>\n\t\t<\/div>\n\t<\/div>\n<\/div>\n',content:'<div>${data.docket}<\/div>\n{if data.is_show_feedback}\n<div class=\"merchant-popup-ask-question\">\n\t<a class=\"novisited\" href=\"${controller.getQuestionHref(data.id)}\">\u0417\u0430\u0434\u0430\u0442\u044c \u0432\u043e\u043f\u0440\u043e\u0441 \u043f\u0440\u043e\u0434\u0430\u0432\u0446\u0443<\/a>\n<\/div>\n{\/if}'},selectors:{btn_seller:'[name="show_seller_info"]',popup_parent:'[name="popup_parent"]'},question_href:'https://my.rozetka.com.ua/profile/market/message/add/uq/'},_data:{},initialize:function(){document.addEvent('updateSellerInfoHandlers',this._updateHandlers.bind(this))},_updateHandlers:function(){document.getElements(this.options.selectors.btn_seller).each(function(elem){elem.addEvent('click',this._onClick.bind(this));elem.removeProperty('name')}.bind(this))},getQuestionHref:function(seller_id){return this.options.question_href+seller_id},_onClick:function(e){e=new Event(e).stop();var target=e.target,seller_block=target.getParentByName('seller_block'),layout=seller_block.getProperty('popup_layout'),onComplete;seller_block.popup_parent=seller_block.getElement(this.options.selectors.popup_parent);onComplete=function(data){var options={layout:layout};if(data.docket){seller_block.popup=new Seller_Popup(this.options.tpl.popup,seller_block.popup_parent||document.body);seller_block.popup.setOptions(options);seller_block.popup.setContent(this.options.tpl.content,{data:data,controller:this});seller_block.popup.elem.setStyle('visibility','hidden');if(!seller_block.popup_parent){seller_block.popup.initUpdatePosition(seller_block,target,layout)}seller_block.popup.open();seller_block.popup._setPosition(seller_block,target,layout);seller_block.popup.elem.setStyle('visibility','')}else{document.fireEvent('closeOtherPopups')}}.bind(this);if(!seller_block.popup){this.getSellerData(seller_block.getProperty('seller_id'),onComplete)}else{if(!seller_block.popup.isOpened()){seller_block.popup.elem.setStyle('visibility','hidden');seller_block.popup.open();if(!seller_block.popup_parent){seller_block.popup._setPosition(seller_block,target,layout)}seller_block.popup.elem.setStyle('visibility','')}else{seller_block.popup.close()}}},getSellerData:function(seller_id,onComplete){if(this._data[seller_id]){onComplete(this._data[seller_id])}else{new Ajax(window.location.protocol+"//"+window.location.hostname+'/sellers/action=getSellerInfoJSON;seller_id='+seller_id+'/',{method:'get',onComplete:function(resp){resp=new Response_class(resp);if(resp.isDone()){this._data[resp.content.id]=resp.content;onComplete(this._data[resp.content.id])}}.bind(this)}).request()}}});var Seller_Popup=Popup_class.extend({options:{selectors:{pistil:'[name="pistil"]',about_seller:'[name="about_seller"]'}},_block:null,initialize:function(tpl,pElem){this.parent(tpl,pElem);this.attachToObserver(['ChangeBlockOffer'])},initUpdatePosition:function(block,target,layout){this._updatePosition=function(){if(this.isOpened()){this._setPosition(block,target,layout)}}.bind(this);this.addEvent('open',function(){window.addEvent('resize',this._updatePosition)}.bind(this));this.addEvent('close',function(){window.removeEvent('resize',this._updatePosition)}.bind(this))},onChangeBlockOffer:function(){if('function'==typeof this._updatePosition){this._updatePosition()}},_setPosition:function(block,target,layout){var pistil=this.getElement(this.options.selectors.pistil),pistil_left,d_width,p_width,block_coords,styles,left,center;if('bottom'==layout){if(!block.popup_parent){block_coords=block.getCoordinates();d_width=document.body.getSize().size.x;p_width=this.getElement(this.options.selectors.about_seller).offsetWidth;center=p_width/2-target.offsetWidth/2;left=block_coords.left-center;if((left+p_width)>d_width){left=d_width-p_width-10}this.elem.setStyles({position:'absolute',left:left,top:block_coords.top+block.offsetHeight+pistil.offsetHeight})}else{block.popup_parent.setStyle('top',pistil.offsetHeight)}pistil_left=target.getPosition().x-this.elem.getPosition().x-pistil.offsetWidth/2+target.offsetWidth/2;pistil.setStyle('left',pistil_left)}if('left'==layout){styles={top:-parseInt(pistil.getStyle('top'),10)-pistil.offsetHeight/2+target.offsetHeight/2,left:-this.getElement(this.options.selectors.about_seller).offsetWidth-pistil.offsetWidth};block.popup_parent.setStyles(styles)}}});(function(){new SellerInfo_class()}());var VKLightbox=new Class({initialize:function(){var param=new Array();count_visit=Cookie.get("count_visit_from_vkontakte");if(count_visit==3){this.create_popup();this.trackEvent()}var get_param=location.search;if((get_param!='')&&((get_param.search("from=vkontakte_paid")!=-1)||(get_param.search("campaign=recreative_p")!=-1))){if((!count_visit)||isNaN(count_visit)||(count_visit>=3)){count_visit=1}}if((count_visit)&&(count_visit<4)){Cookie.set('count_visit_from_vkontakte',parseInt(count_visit)+1,{duration:0,path:"/",domain:"rozetka.com.ua"})}},create_popup:function(){parent_div=$("popup_from_vkontakte");parent_div=document.getElementById("popup_from_vkontakte");popup_message='';popup_template='<div name=\"content\">sdsd<\/div>\n<div class=\"popup_from_vkontakte\">\n\t<div name=\"content\" class=\"bg-vk\">\n\t\t<h3>\u041f\u043e\u0434\u043f\u0438\u0441\u044b\u0432\u0430\u0439\u0441\u044f \u0412\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u0435 \u043d\u0430 \u043d\u043e\u0432\u043e\u0441\u0442\u0438 \u00ab\u0420\u043e\u0437\u0435\u0442\u043a\u0438\u00bb \u0438 \u043f\u043e\u043b\u0443\u0447\u0430\u0439<br>\u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043d\u0430\u0448\u0438\u0445 \u0430\u043a\u0446\u0438\u044f\u0445 \u0438 \u043d\u043e\u0432\u0438\u043d\u043a\u0430\u0445 \u0440\u0430\u043d\u044c\u0448\u0435 \u0432\u0441\u0435\u0445!<\/h3>\n\t\t<div class=\"vk-vidget\">\n\t\t\t<div class=\"box\">\n\t\t\t\t<div id=\"vk_groups\"><\/div>\n\t\t\t<\/div>\n\t\t<\/div>\n\t\t<div visible=false name=\"close\" class=\"close-vk\"><a href=\"#\" id=\"popup_button_close\"><\/a><\/div>\n\t<\/div>\n<\/div>';popup=new Popup_class(popup_template,parent_div);popup.setContent(popup_message,{});popup.open();try{var vk='<iframe name="fXD20877147" onload="$(\'vk_groups\').show()" width="200px" scrolling="no" frameborder="0" style="overflow: hidden; height: 117px;" src="http://vkontakte.ru/widget_groups.php?app=0&amp;width=200px&amp;gid=20877147&amp;mode=1&amp;height=115"></iframe>';$('vk_groups').setHTML(vk)}catch(e){}},trackEvent:function(){rozetkaEvents.trackEvent('social','vkontakte_paid','popup open')}});